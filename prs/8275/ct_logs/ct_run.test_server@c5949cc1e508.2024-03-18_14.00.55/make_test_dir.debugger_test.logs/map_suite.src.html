<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/lib/debugger/make_test_dir/debugger_test/map_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%% %CopyrightBegin%</i>
<a name="2"/>    2: <i>%%</i>
<a name="3"/>    3: <i>%% Copyright Ericsson AB 2013. All Rights Reserved.</i>
<a name="4"/>    4: <i>%%</i>
<a name="5"/>    5: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="6"/>    6: <i>%% you may not use this file except in compliance with the License.</i>
<a name="7"/>    7: <i>%% You may obtain a copy of the License at</i>
<a name="8"/>    8: <i>%%</i>
<a name="9"/>    9: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="10"/>   10: <i>%%</i>
<a name="11"/>   11: <i>%% Unless required by applicable law or agreed to in writing, software</i>
<a name="12"/>   12: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="13"/>   13: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="14"/>   14: <i>%% See the License for the specific language governing permissions and</i>
<a name="15"/>   15: <i>%% limitations under the License.</i>
<a name="16"/>   16: <i>%%</i>
<a name="17"/>   17: <i>%% %CopyrightEnd%</i>
<a name="18"/>   18: <i>%%</i>
<a name="19"/>   19: <b>-module</b>(map_SUITE).
<a name="20"/>   20: 
<a name="21"/>   21: <i>%% Copied from map_SUITE in erts.</i>
<a name="22"/>   22: 
<a name="23"/>   23: <b>-export</b>([all/0, suite/0,groups/0,init_per_suite/1, end_per_suite/1,
<a name="24"/>   24: 	init_per_group/2,end_per_group/2
<a name="25"/>   25:     ]).
<a name="26"/>   26: 
<a name="27"/>   27: <b>-export</b>([
<a name="28"/>   28: 	t_build_and_match_literals/1, t_build_and_match_literals_large/1,
<a name="29"/>   29: 	t_update_literals/1, t_update_literals_large/1,
<a name="30"/>   30:         t_match_and_update_literals/1, t_match_and_update_literals_large/1,
<a name="31"/>   31: 	t_update_map_expressions/1,
<a name="32"/>   32: 	t_update_assoc/1, t_update_assoc_large/1,
<a name="33"/>   33:         t_update_exact/1, t_update_exact_large/1,
<a name="34"/>   34: 	t_guard_bifs/1,
<a name="35"/>   35:         t_guard_sequence/1, t_guard_sequence_large/1,
<a name="36"/>   36:         t_guard_update/1, t_guard_update_large/1,
<a name="37"/>   37: 	t_guard_receive/1, t_guard_receive_large/1,
<a name="38"/>   38:         t_guard_fun/1,
<a name="39"/>   39: 	t_list_comprehension/1,
<a name="40"/>   40: 	t_map_sort_literals/1,
<a name="41"/>   41: 	t_map_size/1,
<a name="42"/>   42: 	t_build_and_match_aliasing/1,
<a name="43"/>   43: 
<a name="44"/>   44: 	%% variables
<a name="45"/>   45: 	t_build_and_match_variables/1,
<a name="46"/>   46: 	t_update_assoc_variables/1,t_update_exact_variables/1,
<a name="47"/>   47: 	t_nested_pattern_expressions/1,
<a name="48"/>   48: 	t_guard_update_variables/1,
<a name="49"/>   49: 	t_guard_sequence_variables/1,
<a name="50"/>   50: 	t_guard_sequence_mixed/1,
<a name="51"/>   51: 	t_frequency_table/1,
<a name="52"/>   52: 
<a name="53"/>   53: 	%% not covered in 17.0-rc1
<a name="54"/>   54: 	t_build_and_match_over_alloc/1,
<a name="55"/>   55: 	t_build_and_match_empty_val/1,
<a name="56"/>   56: 	t_build_and_match_val/1,
<a name="57"/>   57: 	t_build_and_match_nil/1,
<a name="58"/>   58: 	t_build_and_match_structure/1,
<a name="59"/>   59: 
<a name="60"/>   60: 	%% errors in 17.0-rc1
<a name="61"/>   61: 	t_update_values/1,
<a name="62"/>   62:         t_expand_map_update/1,
<a name="63"/>   63:         t_export/1,
<a name="64"/>   64:  
<a name="65"/>   65: 	%% Specific Map BIFs
<a name="66"/>   66: 	t_bif_map_get/1,
<a name="67"/>   67: 	t_bif_map_find/1,
<a name="68"/>   68: 	t_bif_map_is_key/1,
<a name="69"/>   69: 	t_bif_map_keys/1,
<a name="70"/>   70: 	t_bif_map_merge/1,
<a name="71"/>   71: 	t_bif_map_new/1,
<a name="72"/>   72: 	t_bif_map_put/1,
<a name="73"/>   73: 	t_bif_map_remove/1,
<a name="74"/>   74: 	t_bif_map_update/1,
<a name="75"/>   75: 	t_bif_map_values/1,
<a name="76"/>   76: 	t_bif_map_to_list/1,
<a name="77"/>   77: 	t_bif_map_from_list/1,
<a name="78"/>   78: 
<a name="79"/>   79: 	%% erlang
<a name="80"/>   80: 	t_erlang_hash/1,
<a name="81"/>   81: 	t_map_encode_decode/1,
<a name="82"/>   82: 
<a name="83"/>   83: 	%% maps module not bifs
<a name="84"/>   84: 	t_maps_fold/1,
<a name="85"/>   85: 	t_maps_map/1,
<a name="86"/>   86: 	t_maps_size/1,
<a name="87"/>   87: 	t_maps_without/1,
<a name="88"/>   88: 
<a name="89"/>   89: 	%% misc
<a name="90"/>   90: 	t_pdict/1,
<a name="91"/>   91:         t_ets/1,
<a name="92"/>   92: 
<a name="93"/>   93:         %% new in OTP 23
<a name="94"/>   94:         t_key_expressions/1
<a name="95"/>   95:     ]).
<a name="96"/>   96: 
<a name="97"/>   97: <b>-include_lib</b>(&quot;stdlib/include/ms_transform.hrl&quot;).
<a name="98"/>   98: 
<a name="suite-0"/><a name="suite-last_expr"/><a name="99"/>   99: <b>suite</b>() -&gt; [].
<a name="100"/>  100: 
<a name="all-0"/><a name="all-last_expr"/><a name="101"/>  101: <b>all</b>() -&gt; [
<a name="102"/>  102: 	t_build_and_match_literals, t_build_and_match_literals_large,
<a name="103"/>  103: 	t_update_literals, t_update_literals_large,
<a name="104"/>  104:         t_match_and_update_literals, t_match_and_update_literals_large,
<a name="105"/>  105: 	t_update_map_expressions,
<a name="106"/>  106: 	t_update_assoc, t_update_assoc_large,
<a name="107"/>  107:         t_update_exact, t_update_exact_large,
<a name="108"/>  108: 	t_guard_bifs,
<a name="109"/>  109:         t_guard_sequence, t_guard_sequence_large,
<a name="110"/>  110:         t_guard_update, t_guard_update_large,
<a name="111"/>  111: 	t_guard_receive, t_guard_receive_large,
<a name="112"/>  112:         t_guard_fun, t_list_comprehension,
<a name="113"/>  113: 	t_map_sort_literals,
<a name="114"/>  114: 	t_build_and_match_aliasing,
<a name="115"/>  115: 
<a name="116"/>  116: 	%% variables
<a name="117"/>  117: 	t_build_and_match_variables,
<a name="118"/>  118: 	t_update_assoc_variables,t_update_exact_variables,
<a name="119"/>  119: 	t_nested_pattern_expressions,
<a name="120"/>  120: 	t_guard_update_variables,
<a name="121"/>  121: 	t_guard_sequence_variables,
<a name="122"/>  122: 	t_guard_sequence_mixed,
<a name="123"/>  123: 	t_frequency_table,
<a name="124"/>  124: 
<a name="125"/>  125: 	%% not covered in 17.0-rc1
<a name="126"/>  126: 	t_build_and_match_over_alloc,
<a name="127"/>  127: 	t_build_and_match_empty_val,
<a name="128"/>  128: 	t_build_and_match_val,
<a name="129"/>  129: 	t_build_and_match_nil,
<a name="130"/>  130: 	t_build_and_match_structure,
<a name="131"/>  131: 
<a name="132"/>  132: 
<a name="133"/>  133: 	%% errors in 17.0-rc1
<a name="134"/>  134: 	t_update_values,
<a name="135"/>  135:         t_expand_map_update,
<a name="136"/>  136:         t_export,
<a name="137"/>  137:     
<a name="138"/>  138: 	%% Specific Map BIFs
<a name="139"/>  139: 	t_bif_map_get,t_bif_map_find,t_bif_map_is_key,
<a name="140"/>  140: 	t_bif_map_keys, t_bif_map_merge, t_bif_map_new,
<a name="141"/>  141: 	t_bif_map_put,
<a name="142"/>  142: 	t_bif_map_remove, t_bif_map_update,
<a name="143"/>  143: 	t_bif_map_values,
<a name="144"/>  144: 	t_bif_map_to_list, t_bif_map_from_list,
<a name="145"/>  145: 
<a name="146"/>  146: 	%% erlang
<a name="147"/>  147: 	t_erlang_hash, t_map_encode_decode,
<a name="148"/>  148: 	t_map_size,
<a name="149"/>  149: 
<a name="150"/>  150: 	%% maps module
<a name="151"/>  151: 	t_maps_fold, t_maps_map,
<a name="152"/>  152: 	t_maps_size, t_maps_without,
<a name="153"/>  153: 
<a name="154"/>  154:         %% Other functions
<a name="155"/>  155: 	t_pdict,
<a name="156"/>  156: 	t_ets,
<a name="157"/>  157: 
<a name="158"/>  158:         %% new in OTP 23
<a name="159"/>  159:         t_key_expressions
<a name="160"/>  160:     ].
<a name="161"/>  161: 
<a name="groups-0"/><a name="groups-last_expr"/><a name="162"/>  162: <b>groups</b>() -&gt; [].
<a name="163"/>  163: 
<a name="init_per_suite-1"/><a name="164"/>  164: <b>init_per_suite</b>(Config) -&gt;
<a name="165"/>  165:     test_lib:interpret(?MODULE),
<a name="init_per_suite-last_expr"/><a name="166"/>  166:     Config.
<a name="167"/>  167: 
<a name="end_per_suite-1"/><a name="end_per_suite-last_expr"/><a name="168"/>  168: <b>end_per_suite</b>(_Config) -&gt; ok.
<a name="169"/>  169: 
<a name="init_per_group-2"/><a name="init_per_group-last_expr"/><a name="170"/>  170: <b>init_per_group</b>(_GroupName, Config) -&gt; Config.
<a name="end_per_group-2"/><a name="end_per_group-last_expr"/><a name="171"/>  171: <b>end_per_group</b>(_GroupName, Config) -&gt; Config.
<a name="172"/>  172: 
<a name="173"/>  173: <i>%% tests</i>
<a name="174"/>  174: 
<a name="t_build_and_match_literals-1"/><a name="175"/>  175: <b>t_build_and_match_literals</b>(Config) when is_list(Config) -&gt;
<a name="176"/>  176:     #{} = id(#{}),
<a name="177"/>  177:     #{1:=a} = id(#{1=&gt;a}),
<a name="178"/>  178:     #{1:=a,2:=b} = id(#{1=&gt;a,2=&gt;b}),
<a name="179"/>  179:     #{1:=a,2:=b,3:=&quot;c&quot;} = id(#{1=&gt;a,2=&gt;b,3=&gt;&quot;c&quot;}),
<a name="180"/>  180:     #{1:=a,2:=b,3:=&quot;c&quot;,&quot;4&quot;:=&quot;d&quot;} = id(#{1=&gt;a,2=&gt;b,3=&gt;&quot;c&quot;,&quot;4&quot;=&gt;&quot;d&quot;}),
<a name="181"/>  181:     #{1:=a,2:=b,3:=&quot;c&quot;,&quot;4&quot;:=&quot;d&quot;,&lt;&lt;&quot;5&quot;&gt;&gt;:=&lt;&lt;&quot;e&quot;&gt;&gt;} =
<a name="182"/>  182: 	id(#{1=&gt;a,2=&gt;b,3=&gt;&quot;c&quot;,&quot;4&quot;=&gt;&quot;d&quot;,&lt;&lt;&quot;5&quot;&gt;&gt;=&gt;&lt;&lt;&quot;e&quot;&gt;&gt;}),
<a name="183"/>  183:     #{1:=a,2:=b,3:=&quot;c&quot;,&quot;4&quot;:=&quot;d&quot;,&lt;&lt;&quot;5&quot;&gt;&gt;:=&lt;&lt;&quot;e&quot;&gt;&gt;,{&quot;6&quot;,7}:=&quot;f&quot;} =
<a name="184"/>  184: 	id(#{1=&gt;a,2=&gt;b,3=&gt;&quot;c&quot;,&quot;4&quot;=&gt;&quot;d&quot;,&lt;&lt;&quot;5&quot;&gt;&gt;=&gt;&lt;&lt;&quot;e&quot;&gt;&gt;,{&quot;6&quot;,7}=&gt;&quot;f&quot;}),
<a name="185"/>  185:     #{1:=a,2:=b,3:=&quot;c&quot;,&quot;4&quot;:=&quot;d&quot;,&lt;&lt;&quot;5&quot;&gt;&gt;:=&lt;&lt;&quot;e&quot;&gt;&gt;,{&quot;6&quot;,7}:=&quot;f&quot;,8:=g} =
<a name="186"/>  186: 	id(#{1=&gt;a,2=&gt;b,3=&gt;&quot;c&quot;,&quot;4&quot;=&gt;&quot;d&quot;,&lt;&lt;&quot;5&quot;&gt;&gt;=&gt;&lt;&lt;&quot;e&quot;&gt;&gt;,{&quot;6&quot;,7}=&gt;&quot;f&quot;,8=&gt;g}),
<a name="187"/>  187: 
<a name="188"/>  188:     #{&lt;&lt;&quot;hi all&quot;&gt;&gt; := 1} = id(#{&lt;&lt;&quot;hi&quot;,32,&quot;all&quot;&gt;&gt; =&gt; 1}),
<a name="189"/>  189: 
<a name="190"/>  190:     #{a:=X,a:=X=3,b:=4} = id(#{a=&gt;3,b=&gt;4}), % weird but ok =)
<a name="191"/>  191: 
<a name="192"/>  192:     #{ a:=#{ b:=#{c := third, b:=second}}, b:=first} =
<a name="193"/>  193: 	id(#{ b=&gt;first, a=&gt;#{ b=&gt;#{c =&gt; third, b=&gt; second}}}),
<a name="194"/>  194: 
<a name="195"/>  195:     M = #{ map_1=&gt;#{ map_2=&gt;#{value_3 =&gt; third}, value_2=&gt; second}, value_1=&gt;first},
<a name="196"/>  196:     M = #{ map_1:=#{ map_2:=#{value_3 := third}, value_2:= second}, value_1:=first} =
<a name="197"/>  197: 	 id(#{ map_1=&gt;#{ map_2=&gt;#{value_3 =&gt; third}, value_2=&gt; second}, value_1=&gt;first}),
<a name="198"/>  198: 
<a name="199"/>  199:     %% error case
<a name="200"/>  200:     %% V = 32,
<a name="201"/>  201:     %%{'EXIT',{{badmatch,_},_}} = (catch (#{&lt;&lt;&quot;hi all&quot;&gt;&gt; =&gt; 1} = id(#{&lt;&lt;&quot;hi&quot;,V,&quot;all&quot;&gt;&gt; =&gt; 1}))),
<a name="202"/>  202:     {'EXIT',{{badmatch,_},_}} = (catch (#{x:=3,x:=2} = id(#{x=&gt;3}))),
<a name="203"/>  203:     {'EXIT',{{badmatch,_},_}} = (catch (#{x:=2} = id(#{x=&gt;3}))),
<a name="204"/>  204:     {'EXIT',{{badmatch,_},_}} = (catch (#{x:=3} = id({a,b,c}))),
<a name="205"/>  205:     {'EXIT',{{badmatch,_},_}} = (catch (#{x:=3} = id(#{y=&gt;3}))),
<a name="206"/>  206:     {'EXIT',{{badmatch,_},_}} = (catch (#{x:=3} = id(#{x=&gt;&quot;three&quot;}))),
<a name="t_build_and_match_literals-last_expr"/><a name="207"/>  207:     ok.
<a name="208"/>  208: 
<a name="t_build_and_match_literals_large-1"/><a name="209"/>  209: <b>t_build_and_match_literals_large</b>(Config) when is_list(Config) -&gt;
<a name="210"/>  210:     %% normal non-repeating
<a name="211"/>  211:     M0 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="212"/>  212:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="213"/>  213:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="214"/>  214:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="215"/>  215:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="216"/>  216: 
<a name="217"/>  217:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="218"/>  218:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="219"/>  219:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="220"/>  220:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="221"/>  221:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; }),
<a name="222"/>  222: 
<a name="223"/>  223:     #{10:=a0,20:=b0,30:=&quot;c0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M0,
<a name="224"/>  224:     #{11:=a1,21:=b1,31:=&quot;c1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M0,
<a name="225"/>  225:     #{12:=a2,22:=b2,32:=&quot;c2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M0,
<a name="226"/>  226:     #{13:=a3,23:=b3,33:=&quot;c3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M0,
<a name="227"/>  227:     #{14:=a4,24:=b4,34:=&quot;c4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M0,
<a name="228"/>  228: 
<a name="229"/>  229:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M0,
<a name="230"/>  230:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M0,
<a name="231"/>  231:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M0,
<a name="232"/>  232:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M0,
<a name="233"/>  233:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M0,
<a name="234"/>  234: 
<a name="235"/>  235:     60 = map_size(M0),
<a name="236"/>  236:     60 = maps:size(M0),
<a name="237"/>  237: 
<a name="238"/>  238:     %% with repeating
<a name="239"/>  239:     M1 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="240"/>  240:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="241"/>  241:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="242"/>  242:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="243"/>  243:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="244"/>  244: 
<a name="245"/>  245:                10=&gt;na0,20=&gt;nb0,30=&gt;&quot;nc0&quot;,&quot;40&quot;=&gt;&quot;nd0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;ne0&quot;,{[&quot;00&quot;]}=&gt;&quot;n10&quot;,
<a name="246"/>  246:                11=&gt;na1,21=&gt;nb1,31=&gt;&quot;nc1&quot;,&quot;41&quot;=&gt;&quot;nd1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;ne1&quot;,{[&quot;01&quot;]}=&gt;&quot;n11&quot;,
<a name="247"/>  247:                12=&gt;na2,22=&gt;nb2,32=&gt;&quot;nc2&quot;,&quot;42&quot;=&gt;&quot;nd2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;ne2&quot;,{[&quot;02&quot;]}=&gt;&quot;n12&quot;,
<a name="248"/>  248: 
<a name="249"/>  249:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="250"/>  250:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="251"/>  251:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="252"/>  252: 
<a name="253"/>  253:                13=&gt;na3,23=&gt;nb3,33=&gt;&quot;nc3&quot;,&quot;43&quot;=&gt;&quot;nd3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;ne3&quot;,{[&quot;03&quot;]}=&gt;&quot;n13&quot;,
<a name="254"/>  254:                14=&gt;na4,24=&gt;nb4,34=&gt;&quot;nc4&quot;,&quot;44&quot;=&gt;&quot;nd4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;ne4&quot;,{[&quot;04&quot;]}=&gt;&quot;n14&quot;,
<a name="255"/>  255: 
<a name="256"/>  256:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="257"/>  257:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; }),
<a name="258"/>  258: 
<a name="259"/>  259:     #{10:=na0,20:=nb0,30:=&quot;nc0&quot;,&quot;40&quot;:=&quot;nd0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;ne0&quot;,{[&quot;00&quot;]}:=&quot;n10&quot;} = M1,
<a name="260"/>  260:     #{11:=na1,21:=nb1,31:=&quot;nc1&quot;,&quot;41&quot;:=&quot;nd1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;ne1&quot;,{[&quot;01&quot;]}:=&quot;n11&quot;} = M1,
<a name="261"/>  261:     #{12:=na2,22:=nb2,32:=&quot;nc2&quot;,&quot;42&quot;:=&quot;nd2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;ne2&quot;,{[&quot;02&quot;]}:=&quot;n12&quot;} = M1,
<a name="262"/>  262:     #{13:=na3,23:=nb3,33:=&quot;nc3&quot;,&quot;43&quot;:=&quot;nd3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;ne3&quot;,{[&quot;03&quot;]}:=&quot;n13&quot;} = M1,
<a name="263"/>  263:     #{14:=na4,24:=nb4,34:=&quot;nc4&quot;,&quot;44&quot;:=&quot;nd4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;ne4&quot;,{[&quot;04&quot;]}:=&quot;n14&quot;} = M1,
<a name="264"/>  264: 
<a name="265"/>  265:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M1,
<a name="266"/>  266:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M1,
<a name="267"/>  267:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M1,
<a name="268"/>  268:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M1,
<a name="269"/>  269:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M1,
<a name="270"/>  270: 
<a name="271"/>  271:     60 = map_size(M1),
<a name="272"/>  272:     60 = maps:size(M1),
<a name="273"/>  273: 
<a name="274"/>  274:     %% with floats
<a name="275"/>  275: 
<a name="276"/>  276:     M2 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="277"/>  277:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="278"/>  278:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="279"/>  279:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="280"/>  280:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="281"/>  281: 
<a name="282"/>  282:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="283"/>  283:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="284"/>  284:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="285"/>  285:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="286"/>  286:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="287"/>  287: 
<a name="288"/>  288:                10.0=&gt;fa0,20.0=&gt;fb0,30.0=&gt;&quot;fc0&quot;,
<a name="289"/>  289:                11.0=&gt;fa1,21.0=&gt;fb1,31.0=&gt;&quot;fc1&quot;,
<a name="290"/>  290:                12.0=&gt;fa2,22.0=&gt;fb2,32.0=&gt;&quot;fc2&quot;,
<a name="291"/>  291:                13.0=&gt;fa3,23.0=&gt;fb3,33.0=&gt;&quot;fc3&quot;,
<a name="292"/>  292:                14.0=&gt;fa4,24.0=&gt;fb4,34.0=&gt;&quot;fc4&quot;,
<a name="293"/>  293: 
<a name="294"/>  294:                15.0=&gt;fa5,25.0=&gt;fb5,35.0=&gt;&quot;fc5&quot;,
<a name="295"/>  295:                16.0=&gt;fa6,26.0=&gt;fb6,36.0=&gt;&quot;fc6&quot;,
<a name="296"/>  296:                17.0=&gt;fa7,27.0=&gt;fb7,37.0=&gt;&quot;fc7&quot;,
<a name="297"/>  297:                18.0=&gt;fa8,28.0=&gt;fb8,38.0=&gt;&quot;fc8&quot;,
<a name="298"/>  298:                19.0=&gt;fa9,29.0=&gt;fb9,39.0=&gt;&quot;fc9&quot;}),
<a name="299"/>  299: 
<a name="300"/>  300:     #{10:=a0,20:=b0,30:=&quot;c0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M2,
<a name="301"/>  301:     #{11:=a1,21:=b1,31:=&quot;c1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M2,
<a name="302"/>  302:     #{12:=a2,22:=b2,32:=&quot;c2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M2,
<a name="303"/>  303:     #{13:=a3,23:=b3,33:=&quot;c3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M2,
<a name="304"/>  304:     #{14:=a4,24:=b4,34:=&quot;c4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M2,
<a name="305"/>  305: 
<a name="306"/>  306:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M2,
<a name="307"/>  307:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M2,
<a name="308"/>  308:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M2,
<a name="309"/>  309:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M2,
<a name="310"/>  310:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M2,
<a name="311"/>  311: 
<a name="312"/>  312:     #{10.0:=fa0,20.0:=fb0,30.0:=&quot;fc0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M2,
<a name="313"/>  313:     #{11.0:=fa1,21.0:=fb1,31.0:=&quot;fc1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M2,
<a name="314"/>  314:     #{12.0:=fa2,22.0:=fb2,32.0:=&quot;fc2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M2,
<a name="315"/>  315:     #{13.0:=fa3,23.0:=fb3,33.0:=&quot;fc3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M2,
<a name="316"/>  316:     #{14.0:=fa4,24.0:=fb4,34.0:=&quot;fc4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M2,
<a name="317"/>  317: 
<a name="318"/>  318:     #{15.0:=fa5,25.0:=fb5,35.0:=&quot;fc5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M2,
<a name="319"/>  319:     #{16.0:=fa6,26.0:=fb6,36.0:=&quot;fc6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M2,
<a name="320"/>  320:     #{17.0:=fa7,27.0:=fb7,37.0:=&quot;fc7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M2,
<a name="321"/>  321:     #{18.0:=fa8,28.0:=fb8,38.0:=&quot;fc8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M2,
<a name="322"/>  322:     #{19.0:=fa9,29.0:=fb9,39.0:=&quot;fc9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M2,
<a name="323"/>  323: 
<a name="324"/>  324:     90 = map_size(M2),
<a name="325"/>  325:     90 = maps:size(M2),
<a name="326"/>  326: 
<a name="327"/>  327:     %% with bignums
<a name="328"/>  328:     M3 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="329"/>  329:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="330"/>  330:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="331"/>  331:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="332"/>  332:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="333"/>  333: 
<a name="334"/>  334:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="335"/>  335:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="336"/>  336:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="337"/>  337:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="338"/>  338:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="339"/>  339: 
<a name="340"/>  340:                10.0=&gt;fa0,20.0=&gt;fb0,30.0=&gt;&quot;fc0&quot;,
<a name="341"/>  341:                11.0=&gt;fa1,21.0=&gt;fb1,31.0=&gt;&quot;fc1&quot;,
<a name="342"/>  342:                12.0=&gt;fa2,22.0=&gt;fb2,32.0=&gt;&quot;fc2&quot;,
<a name="343"/>  343:                13.0=&gt;fa3,23.0=&gt;fb3,33.0=&gt;&quot;fc3&quot;,
<a name="344"/>  344:                14.0=&gt;fa4,24.0=&gt;fb4,34.0=&gt;&quot;fc4&quot;,
<a name="345"/>  345: 
<a name="346"/>  346:                15.0=&gt;fa5,25.0=&gt;fb5,35.0=&gt;&quot;fc5&quot;,
<a name="347"/>  347:                16.0=&gt;fa6,26.0=&gt;fb6,36.0=&gt;&quot;fc6&quot;,
<a name="348"/>  348:                17.0=&gt;fa7,27.0=&gt;fb7,37.0=&gt;&quot;fc7&quot;,
<a name="349"/>  349:                18.0=&gt;fa8,28.0=&gt;fb8,38.0=&gt;&quot;fc8&quot;,
<a name="350"/>  350:                19.0=&gt;fa9,29.0=&gt;fb9,39.0=&gt;&quot;fc9&quot;,
<a name="351"/>  351: 
<a name="352"/>  352:                36893488147419103232=&gt;big1,  73786976294838206464=&gt;big2,
<a name="353"/>  353:                147573952589676412928=&gt;big3, 18446744073709551616=&gt;big4,
<a name="354"/>  354:                4294967296=&gt;big5,            8589934592=&gt;big6,
<a name="355"/>  355:                4294967295=&gt;big7,            67108863=&gt;big8
<a name="356"/>  356:              }),
<a name="357"/>  357: 
<a name="358"/>  358:     #{10:=a0,20:=b0,30:=&quot;c0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M3,
<a name="359"/>  359:     #{11:=a1,21:=b1,31:=&quot;c1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M3,
<a name="360"/>  360:     #{12:=a2,22:=b2,32:=&quot;c2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M3,
<a name="361"/>  361:     #{13:=a3,23:=b3,33:=&quot;c3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M3,
<a name="362"/>  362:     #{14:=a4,24:=b4,34:=&quot;c4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M3,
<a name="363"/>  363: 
<a name="364"/>  364:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M3,
<a name="365"/>  365:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M3,
<a name="366"/>  366:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M3,
<a name="367"/>  367:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M3,
<a name="368"/>  368:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M3,
<a name="369"/>  369: 
<a name="370"/>  370:     #{10.0:=fa0,20.0:=fb0,30.0:=&quot;fc0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M3,
<a name="371"/>  371:     #{11.0:=fa1,21.0:=fb1,31.0:=&quot;fc1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M3,
<a name="372"/>  372:     #{12.0:=fa2,22.0:=fb2,32.0:=&quot;fc2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M3,
<a name="373"/>  373:     #{13.0:=fa3,23.0:=fb3,33.0:=&quot;fc3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M3,
<a name="374"/>  374:     #{14.0:=fa4,24.0:=fb4,34.0:=&quot;fc4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M3,
<a name="375"/>  375: 
<a name="376"/>  376:     #{15.0:=fa5,25.0:=fb5,35.0:=&quot;fc5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M3,
<a name="377"/>  377:     #{16.0:=fa6,26.0:=fb6,36.0:=&quot;fc6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M3,
<a name="378"/>  378:     #{17.0:=fa7,27.0:=fb7,37.0:=&quot;fc7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M3,
<a name="379"/>  379:     #{18.0:=fa8,28.0:=fb8,38.0:=&quot;fc8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M3,
<a name="380"/>  380:     #{19.0:=fa9,29.0:=fb9,39.0:=&quot;fc9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M3,
<a name="381"/>  381: 
<a name="382"/>  382:     #{36893488147419103232:=big1,67108863:=big8,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M3,
<a name="383"/>  383:     #{147573952589676412928:=big3,8589934592:=big6,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M3,
<a name="384"/>  384:     #{4294967296:=big5,18446744073709551616:=big4,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M3,
<a name="385"/>  385:     #{4294967295:=big7,73786976294838206464:=big2,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M3,
<a name="386"/>  386: 
<a name="387"/>  387:     98 = map_size(M3),
<a name="388"/>  388:     98 = maps:size(M3),
<a name="389"/>  389: 
<a name="390"/>  390:     %% with maps
<a name="391"/>  391: 
<a name="392"/>  392:     M4 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="393"/>  393:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="394"/>  394:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="395"/>  395:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="396"/>  396:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="397"/>  397: 
<a name="398"/>  398:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="399"/>  399:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="400"/>  400:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="401"/>  401:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="402"/>  402:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="403"/>  403: 
<a name="404"/>  404:                10.0=&gt;fa0,20.0=&gt;fb0,30.0=&gt;&quot;fc0&quot;,
<a name="405"/>  405:                11.0=&gt;fa1,21.0=&gt;fb1,31.0=&gt;&quot;fc1&quot;,
<a name="406"/>  406:                12.0=&gt;fa2,22.0=&gt;fb2,32.0=&gt;&quot;fc2&quot;,
<a name="407"/>  407:                13.0=&gt;fa3,23.0=&gt;fb3,33.0=&gt;&quot;fc3&quot;,
<a name="408"/>  408:                14.0=&gt;fa4,24.0=&gt;fb4,34.0=&gt;&quot;fc4&quot;,
<a name="409"/>  409: 
<a name="410"/>  410:                15.0=&gt;fa5,25.0=&gt;fb5,35.0=&gt;&quot;fc5&quot;,
<a name="411"/>  411:                16.0=&gt;fa6,26.0=&gt;fb6,36.0=&gt;&quot;fc6&quot;,
<a name="412"/>  412:                17.0=&gt;fa7,27.0=&gt;fb7,37.0=&gt;&quot;fc7&quot;,
<a name="413"/>  413:                18.0=&gt;fa8,28.0=&gt;fb8,38.0=&gt;&quot;fc8&quot;,
<a name="414"/>  414:                19.0=&gt;fa9,29.0=&gt;fb9,39.0=&gt;&quot;fc9&quot;,
<a name="415"/>  415: 
<a name="416"/>  416:                #{ one =&gt; small, map =&gt; key } =&gt; &quot;small map key 1&quot;,
<a name="417"/>  417:                #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="418"/>  418:                #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="419"/>  419: 
<a name="420"/>  420:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="421"/>  421:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="422"/>  422:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="423"/>  423:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="424"/>  424:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="425"/>  425: 
<a name="426"/>  426:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="427"/>  427:                   16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="428"/>  428:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="429"/>  429:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="430"/>  430:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="431"/>  431: 
<a name="432"/>  432:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="433"/>  433:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="434"/>  434:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="435"/>  435:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="436"/>  436:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="437"/>  437: 
<a name="438"/>  438:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="439"/>  439:                   k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="440"/>  440:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="441"/>  441:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="442"/>  442:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 2&quot; }),
<a name="443"/>  443: 
<a name="444"/>  444:     #{10:=a0,20:=b0,30:=&quot;c0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M4,
<a name="445"/>  445:     #{11:=a1,21:=b1,31:=&quot;c1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M4,
<a name="446"/>  446:     #{12:=a2,22:=b2,32:=&quot;c2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M4,
<a name="447"/>  447:     #{13:=a3,23:=b3,33:=&quot;c3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M4,
<a name="448"/>  448:     #{14:=a4,24:=b4,34:=&quot;c4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M4,
<a name="449"/>  449: 
<a name="450"/>  450:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M4,
<a name="451"/>  451:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M4,
<a name="452"/>  452:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M4,
<a name="453"/>  453:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M4,
<a name="454"/>  454:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M4,
<a name="455"/>  455: 
<a name="456"/>  456:     #{ #{ one =&gt; small, map =&gt; key }    := &quot;small map key 1&quot;,
<a name="457"/>  457:        #{ second =&gt; small, map =&gt; key } := &quot;small map key 2&quot;,
<a name="458"/>  458:        #{ third =&gt; small, map =&gt; key }  := &quot;small map key 3&quot; } = M4,
<a name="459"/>  459: 
<a name="460"/>  460:     #{ #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="461"/>  461:           11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="462"/>  462:           12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="463"/>  463:           13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="464"/>  464:           14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="465"/>  465: 
<a name="466"/>  466:           15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="467"/>  467:           16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="468"/>  468:           17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="469"/>  469:           18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="470"/>  470:           19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } := &quot;large map key 1&quot;,
<a name="471"/>  471: 
<a name="472"/>  472:        #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="473"/>  473:           11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="474"/>  474:           12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="475"/>  475:           13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="476"/>  476:           14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="477"/>  477: 
<a name="478"/>  478:           15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="479"/>  479:           k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="480"/>  480:           17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="481"/>  481:           18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="482"/>  482:           19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } := &quot;large map key 2&quot; } = M4,
<a name="483"/>  483: 
<a name="484"/>  484: 
<a name="485"/>  485:     #{ 15:=V1,25:=b5,35:=V2,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=V3,{[&quot;05&quot;]}:=&quot;15&quot;,
<a name="486"/>  486:        #{ one =&gt; small, map =&gt; key }    := &quot;small map key 1&quot;,
<a name="487"/>  487:        #{ second =&gt; small, map =&gt; key } := V4,
<a name="488"/>  488:        #{ third =&gt; small, map =&gt; key }  := &quot;small map key 3&quot;,
<a name="489"/>  489:        #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="490"/>  490:           11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="491"/>  491:           12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="492"/>  492:           13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="493"/>  493:           14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="494"/>  494: 
<a name="495"/>  495:           15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="496"/>  496:           16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="497"/>  497:           17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="498"/>  498:           18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="499"/>  499:           19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } := V5 } = M4,
<a name="500"/>  500: 
<a name="501"/>  501:     a5   = V1,
<a name="502"/>  502:     &quot;c5&quot; = V2,
<a name="503"/>  503:     &quot;e5&quot; = V3,
<a name="504"/>  504:     &quot;small map key 2&quot; = V4,
<a name="505"/>  505:     &quot;large map key 1&quot; = V5,
<a name="506"/>  506: 
<a name="507"/>  507:     95 = map_size(M4),
<a name="508"/>  508:     95 = maps:size(M4),
<a name="509"/>  509: 
<a name="510"/>  510:     %% call for value
<a name="511"/>  511: 
<a name="512"/>  512:     M5 = id(#{ 10=&gt;id(a0),20=&gt;b0,30=&gt;id(&quot;c0&quot;),&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;id(&quot;e0&quot;),{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="513"/>  513:                11=&gt;id(a1),21=&gt;b1,31=&gt;id(&quot;c1&quot;),&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;id(&quot;e1&quot;),{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="514"/>  514:                12=&gt;id(a2),22=&gt;b2,32=&gt;id(&quot;c2&quot;),&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;id(&quot;e2&quot;),{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="515"/>  515:                13=&gt;id(a3),23=&gt;b3,33=&gt;id(&quot;c3&quot;),&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;id(&quot;e3&quot;),{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="516"/>  516:                14=&gt;id(a4),24=&gt;b4,34=&gt;id(&quot;c4&quot;),&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;id(&quot;e4&quot;),{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="517"/>  517: 
<a name="518"/>  518:                15=&gt;id(a5),25=&gt;b5,35=&gt;id(&quot;c5&quot;),&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;id(&quot;e5&quot;),{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="519"/>  519:                16=&gt;id(a6),26=&gt;b6,36=&gt;id(&quot;c6&quot;),&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;id(&quot;e6&quot;),{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="520"/>  520:                17=&gt;id(a7),27=&gt;b7,37=&gt;id(&quot;c7&quot;),&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;id(&quot;e7&quot;),{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="521"/>  521:                18=&gt;id(a8),28=&gt;b8,38=&gt;id(&quot;c8&quot;),&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;id(&quot;e8&quot;),{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="522"/>  522:                19=&gt;id(a9),29=&gt;b9,39=&gt;id(&quot;c9&quot;),&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;id(&quot;e9&quot;),{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="523"/>  523: 
<a name="524"/>  524:                10.0=&gt;fa0,20.0=&gt;id(fb0),30.0=&gt;id(&quot;fc0&quot;),
<a name="525"/>  525:                11.0=&gt;fa1,21.0=&gt;id(fb1),31.0=&gt;id(&quot;fc1&quot;),
<a name="526"/>  526:                12.0=&gt;fa2,22.0=&gt;id(fb2),32.0=&gt;id(&quot;fc2&quot;),
<a name="527"/>  527:                13.0=&gt;fa3,23.0=&gt;id(fb3),33.0=&gt;id(&quot;fc3&quot;),
<a name="528"/>  528:                14.0=&gt;fa4,24.0=&gt;id(fb4),34.0=&gt;id(&quot;fc4&quot;),
<a name="529"/>  529: 
<a name="530"/>  530:                15.0=&gt;fa5,25.0=&gt;id(fb5),35.0=&gt;id(&quot;fc5&quot;),
<a name="531"/>  531:                16.0=&gt;fa6,26.0=&gt;id(fb6),36.0=&gt;id(&quot;fc6&quot;),
<a name="532"/>  532:                17.0=&gt;fa7,27.0=&gt;id(fb7),37.0=&gt;id(&quot;fc7&quot;),
<a name="533"/>  533:                18.0=&gt;fa8,28.0=&gt;id(fb8),38.0=&gt;id(&quot;fc8&quot;),
<a name="534"/>  534:                19.0=&gt;fa9,29.0=&gt;id(fb9),39.0=&gt;id(&quot;fc9&quot;),
<a name="535"/>  535: 
<a name="536"/>  536:                #{ one =&gt; small, map =&gt; key } =&gt; id(&quot;small map key 1&quot;),
<a name="537"/>  537:                #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="538"/>  538:                #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="539"/>  539: 
<a name="540"/>  540:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="541"/>  541:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="542"/>  542:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="543"/>  543:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="544"/>  544:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="545"/>  545: 
<a name="546"/>  546:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="547"/>  547:                   16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="548"/>  548:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="549"/>  549:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="550"/>  550:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="551"/>  551: 
<a name="552"/>  552:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="553"/>  553:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="554"/>  554:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="555"/>  555:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="556"/>  556:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="557"/>  557: 
<a name="558"/>  558:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="559"/>  559:                   k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="560"/>  560:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="561"/>  561:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="562"/>  562:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; id(&quot;large map key 2&quot;) }),
<a name="563"/>  563: 
<a name="564"/>  564:     #{10:=a0,20:=b0,30:=&quot;c0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M5,
<a name="565"/>  565:     #{11:=a1,21:=b1,31:=&quot;c1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M5,
<a name="566"/>  566:     #{12:=a2,22:=b2,32:=&quot;c2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M5,
<a name="567"/>  567:     #{13:=a3,23:=b3,33:=&quot;c3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M5,
<a name="568"/>  568:     #{14:=a4,24:=b4,34:=&quot;c4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M5,
<a name="569"/>  569: 
<a name="570"/>  570:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M5,
<a name="571"/>  571:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M5,
<a name="572"/>  572:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M5,
<a name="573"/>  573:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M5,
<a name="574"/>  574:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M5,
<a name="575"/>  575: 
<a name="576"/>  576:     #{ #{ one =&gt; small, map =&gt; key }    := &quot;small map key 1&quot;,
<a name="577"/>  577:        #{ second =&gt; small, map =&gt; key } := &quot;small map key 2&quot;,
<a name="578"/>  578:        #{ third =&gt; small, map =&gt; key }  := &quot;small map key 3&quot; } = M5,
<a name="579"/>  579: 
<a name="580"/>  580:     #{ #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="581"/>  581:           11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="582"/>  582:           12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="583"/>  583:           13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="584"/>  584:           14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="585"/>  585: 
<a name="586"/>  586:           15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="587"/>  587:           16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="588"/>  588:           17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="589"/>  589:           18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="590"/>  590:           19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } := &quot;large map key 1&quot;,
<a name="591"/>  591: 
<a name="592"/>  592:        #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="593"/>  593:           11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="594"/>  594:           12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="595"/>  595:           13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="596"/>  596:           14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="597"/>  597: 
<a name="598"/>  598:           15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="599"/>  599:           k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="600"/>  600:           17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="601"/>  601:           18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="602"/>  602:           19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } := &quot;large map key 2&quot; } = M5,
<a name="603"/>  603: 
<a name="604"/>  604:     95 = map_size(M5),
<a name="605"/>  605:     95 = maps:size(M5),
<a name="606"/>  606: 
<a name="607"/>  607:     %% remember
<a name="608"/>  608: 
<a name="609"/>  609:     #{10:=a0,20:=b0,30:=&quot;c0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M0,
<a name="610"/>  610:     #{11:=a1,21:=b1,31:=&quot;c1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M0,
<a name="611"/>  611:     #{12:=a2,22:=b2,32:=&quot;c2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M0,
<a name="612"/>  612:     #{13:=a3,23:=b3,33:=&quot;c3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M0,
<a name="613"/>  613:     #{14:=a4,24:=b4,34:=&quot;c4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M0,
<a name="614"/>  614: 
<a name="615"/>  615:     #{10:=na0,20:=nb0,30:=&quot;nc0&quot;,&quot;40&quot;:=&quot;nd0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;ne0&quot;,{[&quot;00&quot;]}:=&quot;n10&quot;} = M1,
<a name="616"/>  616:     #{11:=na1,21:=nb1,31:=&quot;nc1&quot;,&quot;41&quot;:=&quot;nd1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;ne1&quot;,{[&quot;01&quot;]}:=&quot;n11&quot;} = M1,
<a name="617"/>  617:     #{12:=na2,22:=nb2,32:=&quot;nc2&quot;,&quot;42&quot;:=&quot;nd2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;ne2&quot;,{[&quot;02&quot;]}:=&quot;n12&quot;} = M1,
<a name="618"/>  618:     #{13:=na3,23:=nb3,33:=&quot;nc3&quot;,&quot;43&quot;:=&quot;nd3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;ne3&quot;,{[&quot;03&quot;]}:=&quot;n13&quot;} = M1,
<a name="619"/>  619:     #{14:=na4,24:=nb4,34:=&quot;nc4&quot;,&quot;44&quot;:=&quot;nd4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;ne4&quot;,{[&quot;04&quot;]}:=&quot;n14&quot;} = M1,
<a name="620"/>  620: 
<a name="621"/>  621:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M1,
<a name="622"/>  622:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M1,
<a name="623"/>  623:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M1,
<a name="624"/>  624:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M1,
<a name="625"/>  625:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M1,
<a name="626"/>  626: 
<a name="627"/>  627:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M2,
<a name="628"/>  628:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M2,
<a name="629"/>  629:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M2,
<a name="630"/>  630:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M2,
<a name="631"/>  631:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M2,
<a name="632"/>  632: 
<a name="633"/>  633:     #{10.0:=fa0,20.0:=fb0,30.0:=&quot;fc0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M2,
<a name="634"/>  634:     #{11.0:=fa1,21.0:=fb1,31.0:=&quot;fc1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M2,
<a name="635"/>  635:     #{12.0:=fa2,22.0:=fb2,32.0:=&quot;fc2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M2,
<a name="636"/>  636:     #{13.0:=fa3,23.0:=fb3,33.0:=&quot;fc3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M2,
<a name="637"/>  637:     #{14.0:=fa4,24.0:=fb4,34.0:=&quot;fc4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M2,
<a name="638"/>  638: 
<a name="639"/>  639:     #{15:=a5,25:=b5,35:=&quot;c5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M3,
<a name="640"/>  640:     #{16:=a6,26:=b6,36:=&quot;c6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M3,
<a name="641"/>  641:     #{17:=a7,27:=b7,37:=&quot;c7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M3,
<a name="642"/>  642:     #{18:=a8,28:=b8,38:=&quot;c8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M3,
<a name="643"/>  643:     #{19:=a9,29:=b9,39:=&quot;c9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M3,
<a name="644"/>  644: 
<a name="645"/>  645:     #{10.0:=fa0,20.0:=fb0,30.0:=&quot;fc0&quot;,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;,{[&quot;00&quot;]}:=&quot;10&quot;} = M3,
<a name="646"/>  646:     #{11.0:=fa1,21.0:=fb1,31.0:=&quot;fc1&quot;,&quot;41&quot;:=&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;:=&quot;e1&quot;,{[&quot;01&quot;]}:=&quot;11&quot;} = M3,
<a name="647"/>  647:     #{12.0:=fa2,22.0:=fb2,32.0:=&quot;fc2&quot;,&quot;42&quot;:=&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;:=&quot;e2&quot;,{[&quot;02&quot;]}:=&quot;12&quot;} = M3,
<a name="648"/>  648:     #{13.0:=fa3,23.0:=fb3,33.0:=&quot;fc3&quot;,&quot;43&quot;:=&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;:=&quot;e3&quot;,{[&quot;03&quot;]}:=&quot;13&quot;} = M3,
<a name="649"/>  649:     #{14.0:=fa4,24.0:=fb4,34.0:=&quot;fc4&quot;,&quot;44&quot;:=&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;:=&quot;e4&quot;,{[&quot;04&quot;]}:=&quot;14&quot;} = M3,
<a name="650"/>  650: 
<a name="651"/>  651:     #{15.0:=fa5,25.0:=fb5,35.0:=&quot;fc5&quot;,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M3,
<a name="652"/>  652:     #{16.0:=fa6,26.0:=fb6,36.0:=&quot;fc6&quot;,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M3,
<a name="653"/>  653:     #{17.0:=fa7,27.0:=fb7,37.0:=&quot;fc7&quot;,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M3,
<a name="654"/>  654:     #{18.0:=fa8,28.0:=fb8,38.0:=&quot;fc8&quot;,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M3,
<a name="655"/>  655:     #{19.0:=fa9,29.0:=fb9,39.0:=&quot;fc9&quot;,&quot;49&quot;:=&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;:=&quot;e9&quot;,{[&quot;09&quot;]}:=&quot;19&quot;} = M3,
<a name="656"/>  656: 
<a name="657"/>  657:     #{36893488147419103232:=big1,67108863:=big8,&quot;45&quot;:=&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;:=&quot;e5&quot;,{[&quot;05&quot;]}:=&quot;15&quot;} = M3,
<a name="658"/>  658:     #{147573952589676412928:=big3,8589934592:=big6,&quot;46&quot;:=&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;:=&quot;e6&quot;,{[&quot;06&quot;]}:=&quot;16&quot;} = M3,
<a name="659"/>  659:     #{4294967296:=big5,18446744073709551616:=big4,&quot;47&quot;:=&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;:=&quot;e7&quot;,{[&quot;07&quot;]}:=&quot;17&quot;} = M3,
<a name="660"/>  660:     #{4294967295:=big7,73786976294838206464:=big2,&quot;48&quot;:=&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;:=&quot;e8&quot;,{[&quot;08&quot;]}:=&quot;18&quot;} = M3,
<a name="661"/>  661: 
<a name="t_build_and_match_literals_large-last_expr"/><a name="662"/>  662:     ok.
<a name="663"/>  663: 
<a name="664"/>  664: 
<a name="t_map_size-1"/><a name="665"/>  665: <b>t_map_size</b>(Config) when is_list(Config) -&gt;
<a name="666"/>  666:     0 = map_size(id(#{})),
<a name="667"/>  667:     1 = map_size(id(#{a=&gt;1})),
<a name="668"/>  668:     1 = map_size(id(#{a=&gt;&quot;wat&quot;})),
<a name="669"/>  669:     2 = map_size(id(#{a=&gt;1, b=&gt;2})),
<a name="670"/>  670:     3 = map_size(id(#{a=&gt;1, b=&gt;2, b=&gt;&quot;3&quot;,&quot;33&quot;=&gt;&lt;&lt;&quot;n&quot;&gt;&gt;})),
<a name="671"/>  671: 
<a name="672"/>  672:     true = map_is_size(#{a=&gt;1}, 1),
<a name="673"/>  673:     true = map_is_size(#{a=&gt;1, a=&gt;2}, 1),
<a name="674"/>  674:     M = #{ &quot;a&quot; =&gt; 1, &quot;b&quot; =&gt; 2},
<a name="675"/>  675:     true  = map_is_size(M, 2),
<a name="676"/>  676:     false = map_is_size(M, 3),
<a name="677"/>  677:     true  = map_is_size(M#{ &quot;a&quot; =&gt; 2}, 2),
<a name="678"/>  678:     false = map_is_size(M#{ &quot;c&quot; =&gt; 2}, 2),
<a name="679"/>  679: 
<a name="680"/>  680:     %% Error cases.
<a name="681"/>  681:     do_badmap(fun(T) -&gt;
<a name="682"/>  682:                     {'EXIT',{{badmap,T},_}} =
<a name="683"/>  683:                       (catch map_size(T))
<a name="684"/>  684:               end),
<a name="t_map_size-last_expr"/><a name="685"/>  685:     ok.
<a name="686"/>  686: 
<a name="map_is_size-2"/><a name="687"/>  687: <b>map_is_size</b>(M,N) when map_size(M) =:= N -&gt; true;
<a name="map_is_size-last_expr"/><a name="688"/>  688: <b>map_is_size</b>(_,_) -&gt; false.
<a name="689"/>  689: 
<a name="690"/>  690: <i>%% test map updates without matching</i>
<a name="t_update_literals-1"/><a name="691"/>  691: <b>t_update_literals</b>(Config) when is_list(Config) -&gt;
<a name="692"/>  692:     Map = #{x=&gt;1,y=&gt;2,z=&gt;3,q=&gt;4},
<a name="693"/>  693:     #{x:=&quot;d&quot;,q:=&quot;4&quot;} = loop_update_literals_x_q(Map, [
<a name="694"/>  694: 		{&quot;a&quot;,&quot;1&quot;},{&quot;b&quot;,&quot;2&quot;},{&quot;c&quot;,&quot;3&quot;},{&quot;d&quot;,&quot;4&quot;}
<a name="695"/>  695: 	]),
<a name="t_update_literals-last_expr"/><a name="696"/>  696:     ok.
<a name="697"/>  697: 
<a name="t_update_literals_large-1"/><a name="698"/>  698: <b>t_update_literals_large</b>(Config) when is_list(Config) -&gt;
<a name="699"/>  699:     Map = id(#{ 10=&gt;id(a0),20=&gt;b0,30=&gt;id(&quot;c0&quot;),&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;id(&quot;e0&quot;),{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="700"/>  700:                 11=&gt;id(a1),21=&gt;b1,31=&gt;id(&quot;c1&quot;),&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;id(&quot;e1&quot;),{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="701"/>  701:                 12=&gt;id(a2),22=&gt;b2,32=&gt;id(&quot;c2&quot;),&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;id(&quot;e2&quot;),{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="702"/>  702:                 13=&gt;id(a3),23=&gt;b3,33=&gt;id(&quot;c3&quot;),&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;id(&quot;e3&quot;),{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="703"/>  703:                 14=&gt;id(a4),24=&gt;b4,34=&gt;id(&quot;c4&quot;),&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;id(&quot;e4&quot;),{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="704"/>  704: 
<a name="705"/>  705:                 15=&gt;id(a5),25=&gt;b5,35=&gt;id(&quot;c5&quot;),&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;id(&quot;e5&quot;),{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="706"/>  706:                 16=&gt;id(a6),26=&gt;b6,36=&gt;id(&quot;c6&quot;),&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;id(&quot;e6&quot;),{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="707"/>  707:                 17=&gt;id(a7),27=&gt;b7,37=&gt;id(&quot;c7&quot;),&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;id(&quot;e7&quot;),{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="708"/>  708:                 18=&gt;id(a8),28=&gt;b8,38=&gt;id(&quot;c8&quot;),&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;id(&quot;e8&quot;),{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="709"/>  709:                 19=&gt;id(a9),29=&gt;b9,39=&gt;id(&quot;c9&quot;),&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;id(&quot;e9&quot;),{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="710"/>  710: 
<a name="711"/>  711:                 10.0=&gt;fa0,20.0=&gt;id(fb0),30.0=&gt;id(&quot;fc0&quot;),
<a name="712"/>  712:                 11.0=&gt;fa1,21.0=&gt;id(fb1),31.0=&gt;id(&quot;fc1&quot;),
<a name="713"/>  713:                 12.0=&gt;fa2,22.0=&gt;id(fb2),32.0=&gt;id(&quot;fc2&quot;),
<a name="714"/>  714:                 13.0=&gt;fa3,23.0=&gt;id(fb3),33.0=&gt;id(&quot;fc3&quot;),
<a name="715"/>  715:                 14.0=&gt;fa4,24.0=&gt;id(fb4),34.0=&gt;id(&quot;fc4&quot;),
<a name="716"/>  716: 
<a name="717"/>  717:                 15.0=&gt;fa5,25.0=&gt;id(fb5),35.0=&gt;id(&quot;fc5&quot;),
<a name="718"/>  718:                 16.0=&gt;fa6,26.0=&gt;id(fb6),36.0=&gt;id(&quot;fc6&quot;),
<a name="719"/>  719:                 17.0=&gt;fa7,27.0=&gt;id(fb7),37.0=&gt;id(&quot;fc7&quot;),
<a name="720"/>  720:                 18.0=&gt;fa8,28.0=&gt;id(fb8),38.0=&gt;id(&quot;fc8&quot;),
<a name="721"/>  721:                 19.0=&gt;fa9,29.0=&gt;id(fb9),39.0=&gt;id(&quot;fc9&quot;),
<a name="722"/>  722: 
<a name="723"/>  723:                 #{ one =&gt; small, map =&gt; key } =&gt; id(&quot;small map key 1&quot;),
<a name="724"/>  724:                 #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="725"/>  725:                 #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="726"/>  726: 
<a name="727"/>  727:                 #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="728"/>  728:                    11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="729"/>  729:                    12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="730"/>  730:                    13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="731"/>  731:                    14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="732"/>  732: 
<a name="733"/>  733:                    15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="734"/>  734:                    16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="735"/>  735:                    17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="736"/>  736:                    18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="737"/>  737:                    19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="738"/>  738: 
<a name="739"/>  739:                 #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="740"/>  740:                    11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="741"/>  741:                    12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="742"/>  742:                    13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="743"/>  743:                    14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="744"/>  744: 
<a name="745"/>  745:                    15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="746"/>  746:                    k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="747"/>  747:                    17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="748"/>  748:                    18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="749"/>  749:                    19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; id(&quot;large map key 2&quot;) }),
<a name="750"/>  750: 
<a name="751"/>  751:     #{x:=&quot;d&quot;,q:=&quot;4&quot;} = loop_update_literals_x_q(Map, [
<a name="752"/>  752: 		{&quot;a&quot;,&quot;1&quot;},{&quot;b&quot;,&quot;2&quot;},{&quot;c&quot;,&quot;3&quot;},{&quot;d&quot;,&quot;4&quot;}
<a name="753"/>  753: 	]),
<a name="t_update_literals_large-last_expr"/><a name="754"/>  754:     ok.
<a name="755"/>  755: 
<a name="loop_update_literals_x_q-2"/><a name="756"/>  756: <b>loop_update_literals_x_q</b>(Map, []) -&gt; Map;
<a name="757"/>  757: <b>loop_update_literals_x_q</b>(Map, [{X,Q}|Vs]) -&gt;
<a name="loop_update_literals_x_q-last_expr"/><a name="758"/>  758: <b>    loop_update_literals_x_q</b>(Map#{q=&gt;Q,x=&gt;X},Vs).
<a name="759"/>  759: 
<a name="760"/>  760: <i>%% test map updates with matching</i>
<a name="t_match_and_update_literals-1"/><a name="761"/>  761: <b>t_match_and_update_literals</b>(Config) when is_list(Config) -&gt;
<a name="762"/>  762:     Map = #{ x=&gt;0,y=&gt;&quot;untouched&quot;,z=&gt;&quot;also untouched&quot;,q=&gt;1,
<a name="763"/>  763:              #{ &quot;one&quot; =&gt; small, map =&gt; key } =&gt; &quot;small map key 1&quot; },
<a name="764"/>  764:     #{x:=16,q:=21,y:=&quot;untouched&quot;,z:=&quot;also untouched&quot;} = loop_match_and_update_literals_x_q(Map, [
<a name="765"/>  765: 	    {1,2},{3,4},{5,6},{7,8}
<a name="766"/>  766: 	]),
<a name="767"/>  767:     M0 = id(#{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="768"/>  768: 	    4 =&gt; number, 18446744073709551629 =&gt; wat}),
<a name="769"/>  769:     M1 = id(#{}),
<a name="770"/>  770:     M2 = M1#{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="771"/>  771: 	4 =&gt; number, 18446744073709551629 =&gt; wat},
<a name="772"/>  772:     M0 = M2,
<a name="773"/>  773: 
<a name="774"/>  774:     #{ 4 := another_number, int := 3 } = M2#{ 4 =&gt; another_number },
<a name="t_match_and_update_literals-last_expr"/><a name="775"/>  775:     ok.
<a name="776"/>  776: 
<a name="t_match_and_update_literals_large-1"/><a name="777"/>  777: <b>t_match_and_update_literals_large</b>(Config) when is_list(Config) -&gt;
<a name="778"/>  778:     Map = id(#{ 10=&gt;id(a0),20=&gt;b0,30=&gt;id(&quot;c0&quot;),&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;id(&quot;e0&quot;),{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="779"/>  779:                 11=&gt;id(a1),21=&gt;b1,31=&gt;id(&quot;c1&quot;),&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;id(&quot;e1&quot;),{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="780"/>  780:                 12=&gt;id(a2),22=&gt;b2,32=&gt;id(&quot;c2&quot;),&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;id(&quot;e2&quot;),{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="781"/>  781:                 13=&gt;id(a3),23=&gt;b3,33=&gt;id(&quot;c3&quot;),&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;id(&quot;e3&quot;),{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="782"/>  782:                 14=&gt;id(a4),24=&gt;b4,34=&gt;id(&quot;c4&quot;),&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;id(&quot;e4&quot;),{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="783"/>  783: 
<a name="784"/>  784:                 15=&gt;id(a5),25=&gt;b5,35=&gt;id(&quot;c5&quot;),&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;id(&quot;e5&quot;),{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="785"/>  785:                 16=&gt;id(a6),26=&gt;b6,36=&gt;id(&quot;c6&quot;),&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;id(&quot;e6&quot;),{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="786"/>  786:                 17=&gt;id(a7),27=&gt;b7,37=&gt;id(&quot;c7&quot;),&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;id(&quot;e7&quot;),{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="787"/>  787:                 18=&gt;id(a8),28=&gt;b8,38=&gt;id(&quot;c8&quot;),&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;id(&quot;e8&quot;),{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="788"/>  788:                 19=&gt;id(a9),29=&gt;b9,39=&gt;id(&quot;c9&quot;),&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;id(&quot;e9&quot;),{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="789"/>  789: 
<a name="790"/>  790:                 10.0=&gt;fa0,20.0=&gt;id(fb0),30.0=&gt;id(&quot;fc0&quot;),
<a name="791"/>  791:                 11.0=&gt;fa1,21.0=&gt;id(fb1),31.0=&gt;id(&quot;fc1&quot;),
<a name="792"/>  792:                 12.0=&gt;fa2,22.0=&gt;id(fb2),32.0=&gt;id(&quot;fc2&quot;),
<a name="793"/>  793:                 13.0=&gt;fa3,23.0=&gt;id(fb3),33.0=&gt;id(&quot;fc3&quot;),
<a name="794"/>  794:                 14.0=&gt;fa4,24.0=&gt;id(fb4),34.0=&gt;id(&quot;fc4&quot;),
<a name="795"/>  795: 
<a name="796"/>  796:                 15.0=&gt;fa5,25.0=&gt;id(fb5),35.0=&gt;id(&quot;fc5&quot;),
<a name="797"/>  797:                 16.0=&gt;fa6,26.0=&gt;id(fb6),36.0=&gt;id(&quot;fc6&quot;),
<a name="798"/>  798:                 17.0=&gt;fa7,27.0=&gt;id(fb7),37.0=&gt;id(&quot;fc7&quot;),
<a name="799"/>  799:                 18.0=&gt;fa8,28.0=&gt;id(fb8),38.0=&gt;id(&quot;fc8&quot;),
<a name="800"/>  800:                 19.0=&gt;fa9,29.0=&gt;id(fb9),39.0=&gt;id(&quot;fc9&quot;),
<a name="801"/>  801: 
<a name="802"/>  802:                 x=&gt;0,y=&gt;&quot;untouched&quot;,z=&gt;&quot;also untouched&quot;,q=&gt;1,
<a name="803"/>  803: 
<a name="804"/>  804:                 #{ &quot;one&quot; =&gt; small, map =&gt; key } =&gt; id(&quot;small map key 1&quot;),
<a name="805"/>  805:                 #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="806"/>  806:                 #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="807"/>  807: 
<a name="808"/>  808:                 #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="809"/>  809:                    11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="810"/>  810:                    12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="811"/>  811:                    13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="812"/>  812:                    14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="813"/>  813: 
<a name="814"/>  814:                    15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="815"/>  815:                    16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="816"/>  816:                    17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="817"/>  817:                    18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="818"/>  818:                    19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="819"/>  819: 
<a name="820"/>  820:                 #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="821"/>  821:                    11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="822"/>  822:                    12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="823"/>  823:                    13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="824"/>  824:                    14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="825"/>  825: 
<a name="826"/>  826:                    15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="827"/>  827:                    k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="828"/>  828:                    17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="829"/>  829:                    18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="830"/>  830:                    19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; id(&quot;large map key 2&quot;) }),
<a name="831"/>  831: 
<a name="832"/>  832:     #{x:=16,q:=21,y:=&quot;untouched&quot;,z:=&quot;also untouched&quot;} = loop_match_and_update_literals_x_q(Map, [
<a name="833"/>  833: 	    {1,2},{3,4},{5,6},{7,8}
<a name="834"/>  834: 	]),
<a name="835"/>  835:     M0 = id(Map#{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="836"/>  836:                   4 =&gt; number, 18446744073709551629 =&gt; wat}),
<a name="837"/>  837:     M1 = id(Map#{}),
<a name="838"/>  838:     M2 = M1#{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="839"/>  839:               4 =&gt; number, 18446744073709551629 =&gt; wat},
<a name="840"/>  840:     M0 = M2,
<a name="841"/>  841: 
<a name="842"/>  842:     #{ 4 := another_number, int := 3 } = M2#{ 4 =&gt; another_number },
<a name="t_match_and_update_literals_large-last_expr"/><a name="843"/>  843:     ok.
<a name="844"/>  844: 
<a name="loop_match_and_update_literals_x_q-2"/><a name="845"/>  845: <b>loop_match_and_update_literals_x_q</b>(Map, []) -&gt; Map;
<a name="846"/>  846: <b>loop_match_and_update_literals_x_q</b>(#{ q:=Q0, x:=X0,
<a name="847"/>  847:                                      #{ &quot;one&quot; =&gt; small, map =&gt; key } := &quot;small map key 1&quot; } = Map, [{X,Q}|Vs]) -&gt;
<a name="loop_match_and_update_literals_x_q-last_expr"/><a name="848"/>  848: <b>    loop_match_and_update_literals_x_q</b>(Map#{q=&gt;Q0+Q,x=&gt;X0+X},Vs).
<a name="849"/>  849: 
<a name="850"/>  850: 
<a name="t_update_map_expressions-1"/><a name="851"/>  851: <b>t_update_map_expressions</b>(Config) when is_list(Config) -&gt;
<a name="852"/>  852:     M = maps:new(),
<a name="853"/>  853:     #{ a := 1 } = M#{a =&gt; 1},
<a name="854"/>  854: 
<a name="855"/>  855:     #{ b := 2 } = (maps:new())#{ b =&gt; 2 },
<a name="856"/>  856: 
<a name="857"/>  857:     #{ a :=42, b:=42, c:=42 } = (maps:from_list([{a,1},{b,2},{c,3}]))#{ a := 42, b := 42, c := 42 },
<a name="858"/>  858:     #{ &quot;a&quot; :=1, &quot;b&quot;:=42, &quot;c&quot;:=42 } = (maps:from_list([{&quot;a&quot;,1},{&quot;b&quot;,2}]))#{ &quot;b&quot; := 42, &quot;c&quot; =&gt; 42 },
<a name="859"/>  859: 
<a name="860"/>  860:     %% Error cases.
<a name="861"/>  861:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},_}} = (catch (id(&lt;&lt;&gt;&gt;))#{ a := 42, b =&gt; 2 }),
<a name="862"/>  862:     {'EXIT',{{badmap,[]},_}} = (catch (id([]))#{ a := 42, b =&gt; 2 }),
<a name="t_update_map_expressions-last_expr"/><a name="863"/>  863:     ok.
<a name="864"/>  864: 
<a name="865"/>  865: 
<a name="t_update_assoc-1"/><a name="866"/>  866: <b>t_update_assoc</b>(Config) when is_list(Config) -&gt;
<a name="867"/>  867:     M0 = id(#{1=&gt;a,2=&gt;b,3.0=&gt;c,4=&gt;d,5=&gt;e}),
<a name="868"/>  868: 
<a name="869"/>  869:     M1 = M0#{1=&gt;42,2=&gt;100,4=&gt;[a,b,c]},
<a name="870"/>  870:     #{1:=42,2:=100,3.0:=c,4:=[a,b,c],5:=e} = M1,
<a name="871"/>  871:     #{1:=42,2:=b,4:=d,5:=e,2.0:=100,3.0:=c,4.0:=[a,b,c]} = M0#{1.0=&gt;float,1:=42,2.0=&gt;wrong,2.0=&gt;100,4.0=&gt;[a,b,c]},
<a name="872"/>  872: 
<a name="873"/>  873:     M2 = M0#{3.0=&gt;new},
<a name="874"/>  874:     #{1:=a,2:=b,3.0:=new,4:=d,5:=e} = M2,
<a name="875"/>  875:     M2 = M0#{3.0:=wrong,3.0=&gt;new},
<a name="876"/>  876: 
<a name="877"/>  877:     %% Errors cases.
<a name="878"/>  878:     BadMap = id(not_a_good_map),
<a name="879"/>  879:     {'EXIT',{{badmap,BadMap},_}} = (catch BadMap#{nonexisting=&gt;val}),
<a name="880"/>  880: 
<a name="t_update_assoc-last_expr"/><a name="881"/>  881:     ok.
<a name="882"/>  882: 
<a name="t_update_assoc_large-1"/><a name="883"/>  883: <b>t_update_assoc_large</b>(Config) when is_list(Config) -&gt;
<a name="884"/>  884:     M0 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="885"/>  885:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="886"/>  886:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="887"/>  887:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="888"/>  888:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="889"/>  889: 
<a name="890"/>  890:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="891"/>  891:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="892"/>  892:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="893"/>  893:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="894"/>  894:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="895"/>  895: 
<a name="896"/>  896:                10.0=&gt;fa0,20.0=&gt;fb0,30.0=&gt;&quot;fc0&quot;,
<a name="897"/>  897:                11.0=&gt;fa1,21.0=&gt;fb1,31.0=&gt;&quot;fc1&quot;,
<a name="898"/>  898:                12.0=&gt;fa2,22.0=&gt;fb2,32.0=&gt;&quot;fc2&quot;,
<a name="899"/>  899:                13.0=&gt;fa3,23.0=&gt;fb3,33.0=&gt;&quot;fc3&quot;,
<a name="900"/>  900:                14.0=&gt;fa4,24.0=&gt;fb4,34.0=&gt;&quot;fc4&quot;,
<a name="901"/>  901: 
<a name="902"/>  902:                15.0=&gt;fa5,25.0=&gt;fb5,35.0=&gt;&quot;fc5&quot;,
<a name="903"/>  903:                16.0=&gt;fa6,26.0=&gt;fb6,36.0=&gt;&quot;fc6&quot;,
<a name="904"/>  904:                17.0=&gt;fa7,27.0=&gt;fb7,37.0=&gt;&quot;fc7&quot;,
<a name="905"/>  905:                18.0=&gt;fa8,28.0=&gt;fb8,38.0=&gt;&quot;fc8&quot;,
<a name="906"/>  906:                19.0=&gt;fa9,29.0=&gt;fb9,39.0=&gt;&quot;fc9&quot;,
<a name="907"/>  907: 
<a name="908"/>  908:                #{ one =&gt; small, map =&gt; key } =&gt; &quot;small map key 1&quot;,
<a name="909"/>  909:                #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="910"/>  910:                #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="911"/>  911: 
<a name="912"/>  912:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="913"/>  913:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="914"/>  914:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="915"/>  915:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="916"/>  916:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="917"/>  917: 
<a name="918"/>  918:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="919"/>  919:                   16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="920"/>  920:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="921"/>  921:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="922"/>  922:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="923"/>  923: 
<a name="924"/>  924:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="925"/>  925:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="926"/>  926:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="927"/>  927:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="928"/>  928:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="929"/>  929: 
<a name="930"/>  930:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="931"/>  931:                   k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="932"/>  932:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="933"/>  933:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="934"/>  934:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 2&quot; }),
<a name="935"/>  935: 
<a name="936"/>  936: 
<a name="937"/>  937:     M1 = M0#{1=&gt;42,2=&gt;100,4=&gt;[a,b,c]},
<a name="938"/>  938:     #{1:=42,2:=100,10.0:=fa0,4:=[a,b,c],25:=b5} = M1,
<a name="939"/>  939:     #{ 10:=43, 24:=b4, 15:=a5, 35:=&quot;c5&quot;, 2.0:=100, 13.0:=fa3, 4.0:=[a,b,c]} =
<a name="940"/>  940:         M0#{1.0=&gt;float,10:=43,2.0=&gt;wrong,2.0=&gt;100,4.0=&gt;[a,b,c]},
<a name="941"/>  941: 
<a name="942"/>  942:     M2 = M0#{13.0=&gt;new},
<a name="943"/>  943:     #{10:=a0,20:=b0,13.0:=new,&quot;40&quot;:=&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;:=&quot;e0&quot;} = M2,
<a name="944"/>  944:     M2 = M0#{13.0:=wrong,13.0=&gt;new},
<a name="945"/>  945: 
<a name="946"/>  946:     %% Errors cases.
<a name="947"/>  947:     BadMap = id(a_bad_map),
<a name="948"/>  948:     {'EXIT',{{badmap,BadMap},_}} = (catch BadMap#{nonexisting=&gt;M0}),
<a name="t_update_assoc_large-last_expr"/><a name="949"/>  949:     ok.
<a name="950"/>  950: 
<a name="951"/>  951: 
<a name="t_update_exact-1"/><a name="952"/>  952: <b>t_update_exact</b>(Config) when is_list(Config) -&gt;
<a name="953"/>  953:     M0 = id(#{1=&gt;a,2=&gt;b,3.0=&gt;c,4=&gt;d,5=&gt;e}),
<a name="954"/>  954: 
<a name="955"/>  955:     M1 = M0#{1:=42,2:=100,4:=[a,b,c]},
<a name="956"/>  956:     #{1:=42,2:=100,3.0:=c,4:=[a,b,c],5:=e} = M1,
<a name="957"/>  957:     M1 = M0#{1:=wrong,1=&gt;42,2=&gt;wrong,2:=100,4:=[a,b,c]},
<a name="958"/>  958: 
<a name="959"/>  959:     M2 = M0#{3.0:=new},
<a name="960"/>  960:     #{1:=a,2:=b,3.0:=new,4:=d,5:=e} = M2,
<a name="961"/>  961:     M2 = M0#{3.0=&gt;wrong,3.0:=new},
<a name="962"/>  962:     %% M2 = M0#{3=&gt;wrong,3.0:=new}, %% FIXME
<a name="963"/>  963: 
<a name="964"/>  964:     %% Errors cases.
<a name="965"/>  965:     do_badmap(fun(T) -&gt;
<a name="966"/>  966: 		      {'EXIT',{{badmap,T},_}} =
<a name="967"/>  967: 			  (catch T#{nonexisting=&gt;val})
<a name="968"/>  968: 	      end),
<a name="969"/>  969:     Empty = id(#{}),
<a name="970"/>  970:     {'EXIT',{{badkey,nonexisting},_}} = (catch Empty#{nonexisting:=val}),
<a name="971"/>  971:     {'EXIT',{{badkey,nonexisting},_}} = (catch M0#{nonexisting:=val}),
<a name="972"/>  972:     {'EXIT',{{badkey,1.0},_}} = (catch M0#{1.0:=v,1.0=&gt;v2}),
<a name="973"/>  973:     {'EXIT',{{badkey,_},_}} = (catch M0#{42.0:=v,42:=v2}),
<a name="974"/>  974:     {'EXIT',{{badkey,_},_}} = (catch M0#{42=&gt;v1,42.0:=v2,42:=v3}),
<a name="975"/>  975: 
<a name="976"/>  976:     %% Evaluation order.
<a name="977"/>  977:     BadMap = id([no,map]),
<a name="978"/>  978:     {'EXIT',{blurf,_}} =
<a name="979"/>  979: 	(catch BadMap#{whatever:=id(error(blurf))}),
<a name="980"/>  980:     {'EXIT',{blurf,_}} =
<a name="981"/>  981: 	(catch BadMap#{id(error(blurf)):=whatever}),
<a name="982"/>  982:     {'EXIT',{{badmap,BadMap},_}} =
<a name="983"/>  983: 	(catch BadMap#{nonexisting:=whatever}),
<a name="t_update_exact-last_expr"/><a name="984"/>  984:     ok.
<a name="985"/>  985: 
<a name="t_update_exact_large-1"/><a name="986"/>  986: <b>t_update_exact_large</b>(Config) when is_list(Config) -&gt;
<a name="987"/>  987:     M0 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="988"/>  988:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="989"/>  989:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="990"/>  990:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="991"/>  991:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="992"/>  992: 
<a name="993"/>  993:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="994"/>  994:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="995"/>  995:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="996"/>  996:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="997"/>  997:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot;,
<a name="998"/>  998: 
<a name="999"/>  999:                10.0=&gt;fa0,20.0=&gt;fb0,30.0=&gt;&quot;fc0&quot;,
<a name="1000"/> 1000:                11.0=&gt;fa1,21.0=&gt;fb1,31.0=&gt;&quot;fc1&quot;,
<a name="1001"/> 1001:                12.0=&gt;fa2,22.0=&gt;fb2,32.0=&gt;&quot;fc2&quot;,
<a name="1002"/> 1002:                13.0=&gt;fa3,23.0=&gt;fb3,33.0=&gt;&quot;fc3&quot;,
<a name="1003"/> 1003:                14.0=&gt;fa4,24.0=&gt;fb4,34.0=&gt;&quot;fc4&quot;,
<a name="1004"/> 1004: 
<a name="1005"/> 1005:                15.0=&gt;fa5,25.0=&gt;fb5,35.0=&gt;&quot;fc5&quot;,
<a name="1006"/> 1006:                16.0=&gt;fa6,26.0=&gt;fb6,36.0=&gt;&quot;fc6&quot;,
<a name="1007"/> 1007:                17.0=&gt;fa7,27.0=&gt;fb7,37.0=&gt;&quot;fc7&quot;,
<a name="1008"/> 1008:                18.0=&gt;fa8,28.0=&gt;fb8,38.0=&gt;&quot;fc8&quot;,
<a name="1009"/> 1009:                19.0=&gt;fa9,29.0=&gt;fb9,39.0=&gt;&quot;fc9&quot;,
<a name="1010"/> 1010: 
<a name="1011"/> 1011:                #{ one =&gt; small, map =&gt; key } =&gt; &quot;small map key 1&quot;,
<a name="1012"/> 1012:                #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="1013"/> 1013:                #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="1014"/> 1014: 
<a name="1015"/> 1015:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="1016"/> 1016:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="1017"/> 1017:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="1018"/> 1018:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="1019"/> 1019:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="1020"/> 1020: 
<a name="1021"/> 1021:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="1022"/> 1022:                   16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="1023"/> 1023:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="1024"/> 1024:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="1025"/> 1025:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="1026"/> 1026: 
<a name="1027"/> 1027:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="1028"/> 1028:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="1029"/> 1029:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="1030"/> 1030:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="1031"/> 1031:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="1032"/> 1032: 
<a name="1033"/> 1033:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="1034"/> 1034:                   k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="1035"/> 1035:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="1036"/> 1036:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="1037"/> 1037:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 2&quot; }),
<a name="1038"/> 1038: 
<a name="1039"/> 1039: 
<a name="1040"/> 1040:     M1 = M0#{10:=42,&lt;&lt;&quot;55&quot;&gt;&gt;:=100,10.0:=[a,b,c]},
<a name="1041"/> 1041:     #{ 10:=42,&lt;&lt;&quot;55&quot;&gt;&gt;:=100,{[&quot;05&quot;]}:=&quot;15&quot;,10.0:=[a,b,c],
<a name="1042"/> 1042:        #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="1043"/> 1043:           11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="1044"/> 1044:           12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="1045"/> 1045:           13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="1046"/> 1046:           14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="1047"/> 1047: 
<a name="1048"/> 1048:           15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="1049"/> 1049:           16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="1050"/> 1050:           17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="1051"/> 1051:           18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="1052"/> 1052:           19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } := &quot;large map key 1&quot; } = M1,
<a name="1053"/> 1053: 
<a name="1054"/> 1054:     M1 = M0#{10:=wrong,10=&gt;42,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;wrong,&lt;&lt;&quot;55&quot;&gt;&gt;:=100,10.0:=[a,b,c]},
<a name="1055"/> 1055: 
<a name="1056"/> 1056:     M2 = M0#{13.0:=new},
<a name="1057"/> 1057:     #{10:=a0,20:=b0,13.0:=new} = M2,
<a name="1058"/> 1058:     M2 = M0#{13.0=&gt;wrong,13.0:=new},
<a name="1059"/> 1059: 
<a name="1060"/> 1060:     %% Errors cases.
<a name="1061"/> 1061:     {'EXIT',{{badkey,nonexisting},_}} = (catch M0#{nonexisting:=val}),
<a name="1062"/> 1062:     {'EXIT',{{badkey,1.0},_}} = (catch M0#{1.0:=v,1.0=&gt;v2}),
<a name="1063"/> 1063:     {'EXIT',{{badkey,_},_}} = (catch M0#{42.0:=v,42:=v2}),
<a name="1064"/> 1064:     {'EXIT',{{badkey,_},_}} = (catch M0#{42=&gt;v1,42.0:=v2,42:=v3}),
<a name="1065"/> 1065: 
<a name="t_update_exact_large-last_expr"/><a name="1066"/> 1066:     ok.
<a name="1067"/> 1067: 
<a name="1068"/> 1068: 
<a name="t_update_values-1"/><a name="1069"/> 1069: <b>t_update_values</b>(Config) when is_list(Config) -&gt;
<a name="1070"/> 1070:     V0 = id(1337),
<a name="1071"/> 1071:     M0 = #{ a =&gt; 1, val =&gt; V0},
<a name="1072"/> 1072:     V1 = get_val(M0),
<a name="1073"/> 1073:     M1 = id(M0#{ val := [V0,V1], &quot;wazzup&quot; =&gt; 42 }),
<a name="1074"/> 1074:     [1337, {some_val, 1337}] = get_val(M1),
<a name="1075"/> 1075:     M2 = id(M1#{ &lt;&lt;42:333&gt;&gt; =&gt; 1337 }),
<a name="1076"/> 1076:     {bin_key,1337} = get_val(M2),
<a name="1077"/> 1077: 
<a name="1078"/> 1078:     N = 110,
<a name="1079"/> 1079:     List = [{[I,1,2,3,I],{1,2,3,&quot;wat&quot;,I}}|| I &lt;- lists:seq(1,N)],
<a name="1080"/> 1080: 
<a name="1081"/> 1081:     {_,_,#{val2 := {1,2,3,&quot;wat&quot;,N}, val1 := [N,1,2,3,N]}} = lists:foldl(fun
<a name="1082"/> 1082: 	    ({V2,V3},{Old2,Old3,Mi}) -&gt;
<a name="1083"/> 1083: 		ok = check_val(Mi,Old2,Old3),
<a name="1084"/> 1084: 		#{ val1 := Old2, val2 := Old3 } = Mi,
<a name="1085"/> 1085: 		{V2,V3, Mi#{ val1 := id(V2), val2 := V1, val2 =&gt; id(V3)}}
<a name="1086"/> 1086: 	end, {none, none, #{val1=&gt;none,val2=&gt;none}},List),
<a name="t_update_values-last_expr"/><a name="1087"/> 1087:     ok.
<a name="1088"/> 1088: 
<a name="t_expand_map_update-1"/><a name="1089"/> 1089: <b>t_expand_map_update</b>(Config) when is_list(Config) -&gt;
<a name="1090"/> 1090:     M = #{&lt;&lt;&quot;hello&quot;&gt;&gt; =&gt; &lt;&lt;&quot;world&quot;&gt;&gt;}#{&lt;&lt;&quot;hello&quot;&gt;&gt; := &lt;&lt;&quot;les gens&quot;&gt;&gt;},
<a name="1091"/> 1091:     #{&lt;&lt;&quot;hello&quot;&gt;&gt; := &lt;&lt;&quot;les gens&quot;&gt;&gt;} = M,
<a name="t_expand_map_update-last_expr"/><a name="1092"/> 1092:     ok.
<a name="1093"/> 1093: 
<a name="t_export-1"/><a name="1094"/> 1094: <b>t_export</b>(Config) when is_list(Config) -&gt;
<a name="1095"/> 1095:     Raclette = id(#{}),
<a name="1096"/> 1096:     case brie of brie -&gt; Fromage = Raclette end,
<a name="1097"/> 1097:     Raclette = Fromage#{},
<a name="t_export-last_expr"/><a name="1098"/> 1098:     ok.
<a name="1099"/> 1099: 
<a name="check_val-3"/><a name="check_val-last_expr"/><a name="1100"/> 1100: <b>check_val</b>(#{val1:=V1, val2:=V2},V1,V2) -&gt; ok.
<a name="1101"/> 1101: 
<a name="get_val-1"/><a name="1102"/> 1102: <b>get_val</b>(#{ &lt;&lt;42:333&gt;&gt; := V }) -&gt; {bin_key, V};
<a name="1103"/> 1103: <b>get_val</b>(#{ &quot;wazzup&quot; := _, val := V}) -&gt; V;
<a name="get_val-last_expr"/><a name="1104"/> 1104: <b>get_val</b>(#{ val := V }) -&gt; {some_val, V}.
<a name="1105"/> 1105: 
<a name="1106"/> 1106: 
<a name="t_guard_bifs-1"/><a name="1107"/> 1107: <b>t_guard_bifs</b>(Config) when is_list(Config) -&gt;
<a name="1108"/> 1108:     true   = map_guard_head(#{a=&gt;1}),
<a name="1109"/> 1109:     false  = map_guard_head([]),
<a name="1110"/> 1110:     true   = map_guard_body(#{a=&gt;1}),
<a name="1111"/> 1111:     false  = map_guard_body({}),
<a name="1112"/> 1112:     true   = map_guard_pattern(#{a=&gt;1, &lt;&lt;&quot;hi&quot;&gt;&gt; =&gt; &quot;hi&quot; }),
<a name="1113"/> 1113:     false  = map_guard_pattern(&quot;list&quot;),
<a name="t_guard_bifs-last_expr"/><a name="1114"/> 1114:     ok.
<a name="1115"/> 1115: 
<a name="map_guard_head-1"/><a name="1116"/> 1116: <b>map_guard_head</b>(M) when is_map(M) -&gt; true;
<a name="map_guard_head-last_expr"/><a name="1117"/> 1117: <b>map_guard_head</b>(_) -&gt; false.
<a name="1118"/> 1118: 
<a name="map_guard_body-1"/><a name="map_guard_body-last_expr"/><a name="1119"/> 1119: <b>map_guard_body</b>(M) -&gt; is_map(M).
<a name="1120"/> 1120: 
<a name="map_guard_pattern-1"/><a name="1121"/> 1121: <b>map_guard_pattern</b>(#{}) -&gt; true;
<a name="map_guard_pattern-last_expr"/><a name="1122"/> 1122: <b>map_guard_pattern</b>(_)   -&gt; false.
<a name="1123"/> 1123: 
<a name="t_guard_sequence-1"/><a name="1124"/> 1124: <b>t_guard_sequence</b>(Config) when is_list(Config) -&gt;
<a name="1125"/> 1125: 	{1, &quot;a&quot;} = map_guard_sequence_1(#{seq=&gt;1,val=&gt;id(&quot;a&quot;)}),
<a name="1126"/> 1126: 	{2, &quot;b&quot;} = map_guard_sequence_1(#{seq=&gt;2,val=&gt;id(&quot;b&quot;)}),
<a name="1127"/> 1127: 	{3, &quot;c&quot;} = map_guard_sequence_1(#{seq=&gt;3,val=&gt;id(&quot;c&quot;)}),
<a name="1128"/> 1128: 	{4, &quot;d&quot;} = map_guard_sequence_1(#{seq=&gt;4,val=&gt;id(&quot;d&quot;)}),
<a name="1129"/> 1129: 	{5, &quot;e&quot;} = map_guard_sequence_1(#{seq=&gt;5,val=&gt;id(&quot;e&quot;)}),
<a name="1130"/> 1130: 
<a name="1131"/> 1131: 	{1,M1}       = map_guard_sequence_2(M1 = id(#{a=&gt;3})),
<a name="1132"/> 1132: 	{2,M2}       = map_guard_sequence_2(M2 = id(#{a=&gt;4, b=&gt;4})),
<a name="1133"/> 1133: 	{3,gg,M3}    = map_guard_sequence_2(M3 = id(#{a=&gt;gg, b=&gt;4})),
<a name="1134"/> 1134: 	{4,sc,sc,M4} = map_guard_sequence_2(M4 = id(#{a=&gt;sc, b=&gt;3, c=&gt;sc2})),
<a name="1135"/> 1135: 	{5,kk,kk,M5} = map_guard_sequence_2(M5 = id(#{a=&gt;kk, b=&gt;other, c=&gt;sc2})),
<a name="1136"/> 1136: 
<a name="1137"/> 1137: 	%% error case
<a name="1138"/> 1138: 	{'EXIT',{function_clause,_}} = (catch map_guard_sequence_1(#{seq=&gt;6,val=&gt;id(&quot;e&quot;)})),
<a name="1139"/> 1139: 	{'EXIT',{function_clause,_}} = (catch map_guard_sequence_2(#{b=&gt;5})),
<a name="t_guard_sequence-last_expr"/><a name="1140"/> 1140: 	ok.
<a name="1141"/> 1141: 
<a name="t_guard_sequence_large-1"/><a name="1142"/> 1142: <b>t_guard_sequence_large</b>(Config) when is_list(Config) -&gt;
<a name="1143"/> 1143:     M0 = id(#{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;,03]}=&gt;&quot;10&quot;,
<a name="1144"/> 1144:                11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;,03]}=&gt;&quot;11&quot;,
<a name="1145"/> 1145:                12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;,03]}=&gt;&quot;12&quot;,
<a name="1146"/> 1146:                13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;,03]}=&gt;&quot;13&quot;,
<a name="1147"/> 1147:                14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;,03]}=&gt;&quot;14&quot;,
<a name="1148"/> 1148: 
<a name="1149"/> 1149:                15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;,03]}=&gt;&quot;15&quot;,
<a name="1150"/> 1150:                16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;,03]}=&gt;&quot;16&quot;,
<a name="1151"/> 1151:                17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;,03]}=&gt;&quot;17&quot;,
<a name="1152"/> 1152:                18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;,03]}=&gt;&quot;18&quot;,
<a name="1153"/> 1153:                19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;,03]}=&gt;&quot;19&quot;,
<a name="1154"/> 1154: 
<a name="1155"/> 1155:                10.0=&gt;fa0,20.0=&gt;fb0,30.0=&gt;&quot;fc0&quot;,
<a name="1156"/> 1156:                11.0=&gt;fa1,21.0=&gt;fb1,31.0=&gt;&quot;fc1&quot;,
<a name="1157"/> 1157:                12.0=&gt;fa2,22.0=&gt;fb2,32.0=&gt;&quot;fc2&quot;,
<a name="1158"/> 1158:                13.0=&gt;fa3,23.0=&gt;fb3,33.0=&gt;&quot;fc3&quot;,
<a name="1159"/> 1159:                14.0=&gt;fa4,24.0=&gt;fb4,34.0=&gt;&quot;fc4&quot;,
<a name="1160"/> 1160: 
<a name="1161"/> 1161:                15.0=&gt;fa5,25.0=&gt;fb5,35.0=&gt;&quot;fc5&quot;,
<a name="1162"/> 1162:                16.0=&gt;fa6,26.0=&gt;fb6,36.0=&gt;&quot;fc6&quot;,
<a name="1163"/> 1163:                17.0=&gt;fa7,27.0=&gt;fb7,37.0=&gt;&quot;fc7&quot;,
<a name="1164"/> 1164:                18.0=&gt;fa8,28.0=&gt;fb8,38.0=&gt;&quot;fc8&quot;,
<a name="1165"/> 1165:                19.0=&gt;fa9,29.0=&gt;fb9,39.0=&gt;&quot;fc9&quot;,
<a name="1166"/> 1166: 
<a name="1167"/> 1167:                #{ one =&gt; small, map =&gt; key } =&gt; &quot;small map key 1&quot;,
<a name="1168"/> 1168:                #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="1169"/> 1169:                #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="1170"/> 1170: 
<a name="1171"/> 1171:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="1172"/> 1172:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="1173"/> 1173:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="1174"/> 1174:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="1175"/> 1175:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="1176"/> 1176: 
<a name="1177"/> 1177:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="1178"/> 1178:                   16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="1179"/> 1179:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="1180"/> 1180:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="1181"/> 1181:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="1182"/> 1182: 
<a name="1183"/> 1183:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="1184"/> 1184:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="1185"/> 1185:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="1186"/> 1186:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="1187"/> 1187:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="1188"/> 1188: 
<a name="1189"/> 1189:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="1190"/> 1190:                   k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="1191"/> 1191:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="1192"/> 1192:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="1193"/> 1193:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 2&quot; }),
<a name="1194"/> 1194: 
<a name="1195"/> 1195: 	{1, &quot;a&quot;} = map_guard_sequence_1(M0#{seq=&gt;1,val=&gt;id(&quot;a&quot;)}),
<a name="1196"/> 1196: 	{2, &quot;b&quot;} = map_guard_sequence_1(M0#{seq=&gt;2,val=&gt;id(&quot;b&quot;)}),
<a name="1197"/> 1197: 	{3, &quot;c&quot;} = map_guard_sequence_1(M0#{seq=&gt;3,val=&gt;id(&quot;c&quot;)}),
<a name="1198"/> 1198: 	{4, &quot;d&quot;} = map_guard_sequence_1(M0#{seq=&gt;4,val=&gt;id(&quot;d&quot;)}),
<a name="1199"/> 1199: 	{5, &quot;e&quot;} = map_guard_sequence_1(M0#{seq=&gt;5,val=&gt;id(&quot;e&quot;)}),
<a name="1200"/> 1200: 
<a name="1201"/> 1201: 	{1,M1}       = map_guard_sequence_2(M1 = id(M0#{a=&gt;3})),
<a name="1202"/> 1202: 	{2,M2}       = map_guard_sequence_2(M2 = id(M0#{a=&gt;4, b=&gt;4})),
<a name="1203"/> 1203: 	{3,gg,M3}    = map_guard_sequence_2(M3 = id(M0#{a=&gt;gg, b=&gt;4})),
<a name="1204"/> 1204: 	{4,sc,sc,M4} = map_guard_sequence_2(M4 = id(M0#{a=&gt;sc, b=&gt;3, c=&gt;sc2})),
<a name="1205"/> 1205: 	{5,kk,kk,M5} = map_guard_sequence_2(M5 = id(M0#{a=&gt;kk, b=&gt;other, c=&gt;sc2})),
<a name="1206"/> 1206: 
<a name="1207"/> 1207: 	{'EXIT',{function_clause,_}} = (catch map_guard_sequence_1(M0#{seq=&gt;6,val=&gt;id(&quot;e&quot;)})),
<a name="1208"/> 1208: 	{'EXIT',{function_clause,_}} = (catch map_guard_sequence_2(M0#{b=&gt;5})),
<a name="t_guard_sequence_large-last_expr"/><a name="1209"/> 1209:         ok.
<a name="1210"/> 1210: 
<a name="map_guard_sequence_1-1"/><a name="1211"/> 1211: <b>map_guard_sequence_1</b>(#{seq:=1=Seq, val:=Val}) -&gt; {Seq,Val};
<a name="1212"/> 1212: <b>map_guard_sequence_1</b>(#{seq:=2=Seq, val:=Val}) -&gt; {Seq,Val};
<a name="1213"/> 1213: <b>map_guard_sequence_1</b>(#{seq:=3=Seq, val:=Val}) -&gt; {Seq,Val};
<a name="1214"/> 1214: <b>map_guard_sequence_1</b>(#{seq:=4=Seq, val:=Val}) -&gt; {Seq,Val};
<a name="map_guard_sequence_1-last_expr"/><a name="1215"/> 1215: <b>map_guard_sequence_1</b>(#{seq:=5=Seq, val:=Val}) -&gt; {Seq,Val}.
<a name="1216"/> 1216: 
<a name="map_guard_sequence_2-1"/><a name="1217"/> 1217: <b>map_guard_sequence_2</b>(#{ a:=3 }=M) -&gt; {1, M};
<a name="1218"/> 1218: <b>map_guard_sequence_2</b>(#{ a:=4 }=M) -&gt; {2, M};
<a name="1219"/> 1219: <b>map_guard_sequence_2</b>(#{ a:=X, a:=X, b:=4 }=M) -&gt; {3,X,M};
<a name="1220"/> 1220: <b>map_guard_sequence_2</b>(#{ a:=X, a:=Y, b:=3 }=M) when X =:= Y -&gt; {4,X,Y,M};
<a name="map_guard_sequence_2-last_expr"/><a name="1221"/> 1221: <b>map_guard_sequence_2</b>(#{ a:=X, a:=Y }=M) when X =:= Y -&gt; {5,X,Y,M}.
<a name="1222"/> 1222: 
<a name="1223"/> 1223: 
<a name="t_guard_update-1"/><a name="1224"/> 1224: <b>t_guard_update</b>(Config) when is_list(Config) -&gt;
<a name="1225"/> 1225:     error  = map_guard_update(#{},#{}),
<a name="1226"/> 1226:     first  = map_guard_update(#{}, #{x=&gt;first}),
<a name="1227"/> 1227:     second = map_guard_update(#{y=&gt;old}, #{x=&gt;second,y=&gt;old}),
<a name="t_guard_update-last_expr"/><a name="1228"/> 1228:     ok.
<a name="1229"/> 1229: 
<a name="t_guard_update_large-1"/><a name="1230"/> 1230: <b>t_guard_update_large</b>(Config) when is_list(Config) -&gt;
<a name="1231"/> 1231:     M0 = id(#{ 70=&gt;a0,80=&gt;b0,90=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;,03]}=&gt;&quot;10&quot;,
<a name="1232"/> 1232:                71=&gt;a1,81=&gt;b1,91=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;,03]}=&gt;&quot;11&quot;,
<a name="1233"/> 1233:                72=&gt;a2,82=&gt;b2,92=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;,03]}=&gt;&quot;12&quot;,
<a name="1234"/> 1234:                73=&gt;a3,83=&gt;b3,93=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;,03]}=&gt;&quot;13&quot;,
<a name="1235"/> 1235:                74=&gt;a4,84=&gt;b4,94=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;,03]}=&gt;&quot;14&quot;,
<a name="1236"/> 1236: 
<a name="1237"/> 1237:                75=&gt;a5,85=&gt;b5,95=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;,03]}=&gt;&quot;15&quot;,
<a name="1238"/> 1238:                76=&gt;a6,86=&gt;b6,96=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;,03]}=&gt;&quot;16&quot;,
<a name="1239"/> 1239:                77=&gt;a7,87=&gt;b7,97=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;,03]}=&gt;&quot;17&quot;,
<a name="1240"/> 1240:                78=&gt;a8,88=&gt;b8,98=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;,03]}=&gt;&quot;18&quot;,
<a name="1241"/> 1241:                79=&gt;a9,89=&gt;b9,99=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;,03]}=&gt;&quot;19&quot;,
<a name="1242"/> 1242: 
<a name="1243"/> 1243:                70.0=&gt;fa0,80.0=&gt;fb0,90.0=&gt;&quot;fc0&quot;,
<a name="1244"/> 1244:                71.0=&gt;fa1,81.0=&gt;fb1,91.0=&gt;&quot;fc1&quot;,
<a name="1245"/> 1245:                72.0=&gt;fa2,82.0=&gt;fb2,92.0=&gt;&quot;fc2&quot;,
<a name="1246"/> 1246:                73.0=&gt;fa3,83.0=&gt;fb3,93.0=&gt;&quot;fc3&quot;,
<a name="1247"/> 1247:                74.0=&gt;fa4,84.0=&gt;fb4,94.0=&gt;&quot;fc4&quot;,
<a name="1248"/> 1248: 
<a name="1249"/> 1249:                75.0=&gt;fa5,85.0=&gt;fb5,95.0=&gt;&quot;fc5&quot;,
<a name="1250"/> 1250:                76.0=&gt;fa6,86.0=&gt;fb6,96.0=&gt;&quot;fc6&quot;,
<a name="1251"/> 1251:                77.0=&gt;fa7,87.0=&gt;fb7,97.0=&gt;&quot;fc7&quot;,
<a name="1252"/> 1252:                78.0=&gt;fa8,88.0=&gt;fb8,98.0=&gt;&quot;fc8&quot;,
<a name="1253"/> 1253:                79.0=&gt;fa9,89.0=&gt;fb9,99.0=&gt;&quot;fc9&quot;,
<a name="1254"/> 1254: 
<a name="1255"/> 1255:                #{ one =&gt; small, map =&gt; key } =&gt; &quot;small map key 1&quot;,
<a name="1256"/> 1256:                #{ second =&gt; small, map =&gt; key } =&gt; &quot;small map key 2&quot;,
<a name="1257"/> 1257:                #{ third =&gt; small, map =&gt; key } =&gt; &quot;small map key 3&quot;,
<a name="1258"/> 1258: 
<a name="1259"/> 1259:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="1260"/> 1260:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="1261"/> 1261:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="1262"/> 1262:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="1263"/> 1263:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="1264"/> 1264: 
<a name="1265"/> 1265:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="1266"/> 1266:                   16=&gt;a6,26=&gt;b6,36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="1267"/> 1267:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="1268"/> 1268:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="1269"/> 1269:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 1&quot;,
<a name="1270"/> 1270: 
<a name="1271"/> 1271:                #{ 10=&gt;a0,20=&gt;b0,30=&gt;&quot;c0&quot;,&quot;40&quot;=&gt;&quot;d0&quot;,&lt;&lt;&quot;50&quot;&gt;&gt;=&gt;&quot;e0&quot;,{[&quot;00&quot;]}=&gt;&quot;10&quot;,
<a name="1272"/> 1272:                   11=&gt;a1,21=&gt;b1,31=&gt;&quot;c1&quot;,&quot;41&quot;=&gt;&quot;d1&quot;,&lt;&lt;&quot;51&quot;&gt;&gt;=&gt;&quot;e1&quot;,{[&quot;01&quot;]}=&gt;&quot;11&quot;,
<a name="1273"/> 1273:                   12=&gt;a2,22=&gt;b2,32=&gt;&quot;c2&quot;,&quot;42&quot;=&gt;&quot;d2&quot;,&lt;&lt;&quot;52&quot;&gt;&gt;=&gt;&quot;e2&quot;,{[&quot;02&quot;]}=&gt;&quot;12&quot;,
<a name="1274"/> 1274:                   13=&gt;a3,23=&gt;b3,33=&gt;&quot;c3&quot;,&quot;43&quot;=&gt;&quot;d3&quot;,&lt;&lt;&quot;53&quot;&gt;&gt;=&gt;&quot;e3&quot;,{[&quot;03&quot;]}=&gt;&quot;13&quot;,
<a name="1275"/> 1275:                   14=&gt;a4,24=&gt;b4,34=&gt;&quot;c4&quot;,&quot;44&quot;=&gt;&quot;d4&quot;,&lt;&lt;&quot;54&quot;&gt;&gt;=&gt;&quot;e4&quot;,{[&quot;04&quot;]}=&gt;&quot;14&quot;,
<a name="1276"/> 1276: 
<a name="1277"/> 1277:                   15=&gt;a5,25=&gt;b5,35=&gt;&quot;c5&quot;,&quot;45&quot;=&gt;&quot;d5&quot;,&lt;&lt;&quot;55&quot;&gt;&gt;=&gt;&quot;e5&quot;,{[&quot;05&quot;]}=&gt;&quot;15&quot;,
<a name="1278"/> 1278:                   k16=&gt;a6,k26=&gt;b6,k36=&gt;&quot;c6&quot;,&quot;46&quot;=&gt;&quot;d6&quot;,&lt;&lt;&quot;56&quot;&gt;&gt;=&gt;&quot;e6&quot;,{[&quot;06&quot;]}=&gt;&quot;16&quot;,
<a name="1279"/> 1279:                   17=&gt;a7,27=&gt;b7,37=&gt;&quot;c7&quot;,&quot;47&quot;=&gt;&quot;d7&quot;,&lt;&lt;&quot;57&quot;&gt;&gt;=&gt;&quot;e7&quot;,{[&quot;07&quot;]}=&gt;&quot;17&quot;,
<a name="1280"/> 1280:                   18=&gt;a8,28=&gt;b8,38=&gt;&quot;c8&quot;,&quot;48&quot;=&gt;&quot;d8&quot;,&lt;&lt;&quot;58&quot;&gt;&gt;=&gt;&quot;e8&quot;,{[&quot;08&quot;]}=&gt;&quot;18&quot;,
<a name="1281"/> 1281:                   19=&gt;a9,29=&gt;b9,39=&gt;&quot;c9&quot;,&quot;49&quot;=&gt;&quot;d9&quot;,&lt;&lt;&quot;59&quot;&gt;&gt;=&gt;&quot;e9&quot;,{[&quot;09&quot;]}=&gt;&quot;19&quot; } =&gt; &quot;large map key 2&quot; }),
<a name="1282"/> 1282: 
<a name="1283"/> 1283: 
<a name="1284"/> 1284:     error  = map_guard_update(M0#{},M0#{}),
<a name="1285"/> 1285:     first  = map_guard_update(M0#{},M0#{x=&gt;first}),
<a name="1286"/> 1286:     second = map_guard_update(M0#{y=&gt;old}, M0#{x=&gt;second,y=&gt;old}),
<a name="t_guard_update_large-last_expr"/><a name="1287"/> 1287:     ok.
<a name="1288"/> 1288: 
<a name="map_guard_update-2"/><a name="1289"/> 1289: <b>map_guard_update</b>(M1, M2) when M1#{x=&gt;first}  =:= M2 -&gt; first;
<a name="1290"/> 1290: <b>map_guard_update</b>(M1, M2) when M1#{x=&gt;second} =:= M2 -&gt; second;
<a name="map_guard_update-last_expr"/><a name="1291"/> 1291: <b>map_guard_update</b>(_, _) -&gt; error.
<a name="1292"/> 1292: 
<a name="t_guard_receive-1"/><a name="1293"/> 1293: <b>t_guard_receive</b>(Config) when is_list(Config) -&gt;
<a name="1294"/> 1294:     M0  = #{ id =&gt; 0 },
<a name="1295"/> 1295:     Pid = spawn_link(fun() -&gt; guard_receive_loop() end),
<a name="1296"/> 1296:     Big = 36893488147419103229,
<a name="1297"/> 1297:     B1  = &lt;&lt;&quot;some text&quot;&gt;&gt;,
<a name="1298"/> 1298:     B2  = &lt;&lt;&quot;was appended&quot;&gt;&gt;,
<a name="1299"/> 1299:     B3  = &lt;&lt;B1/binary, B2/binary&gt;&gt;,
<a name="1300"/> 1300: 
<a name="1301"/> 1301:     #{id:=1, res:=Big} = M1 = call(Pid, M0#{op=&gt;sub,in=&gt;{1 bsl 65, 3}}),
<a name="1302"/> 1302:     #{id:=2, res:=26}  = M2 = call(Pid, M1#{op=&gt;idiv,in=&gt;{53,2}}),
<a name="1303"/> 1303:     #{id:=3, res:=832} = M3 = call(Pid, M2#{op=&gt;imul,in=&gt;{26,32}}),
<a name="1304"/> 1304:     #{id:=4, res:=4}   = M4 = call(Pid, M3#{op=&gt;add,in=&gt;{1,3}}),
<a name="1305"/> 1305:     #{id:=5, res:=Big} = M5 = call(Pid, M4#{op=&gt;sub,in=&gt;{1 bsl 65, 3}}),
<a name="1306"/> 1306:     #{id:=6, res:=B3}  = M6 = call(Pid, M5#{op=&gt;&quot;append&quot;,in=&gt;{B1,B2}}),
<a name="1307"/> 1307:     #{id:=7, res:=4}   = _  = call(Pid, M6#{op=&gt;add,in=&gt;{1,3}}),
<a name="1308"/> 1308: 
<a name="1309"/> 1309: 
<a name="1310"/> 1310:     %% update old maps and check id update
<a name="1311"/> 1311:     #{id:=2, res:=B3} = call(Pid, M1#{op=&gt;&quot;append&quot;,in=&gt;{B1,B2}}),
<a name="1312"/> 1312:     #{id:=5, res:=99} = call(Pid, M4#{op=&gt;add,in=&gt;{33, 66}}),
<a name="1313"/> 1313: 
<a name="1314"/> 1314:     %% cleanup
<a name="1315"/> 1315:     done = call(Pid, done),
<a name="t_guard_receive-last_expr"/><a name="1316"/> 1316:     ok.
<a name="1317"/> 1317: 
<a name="1318"/> 1318: <b>-define</b>(t_guard_receive_large_procs, 50).
<a name="1319"/> 1319: 
<a name="t_guard_receive_large-1"/><a name="1320"/> 1320: <b>t_guard_receive_large</b>(Config) when is_list(Config) -&gt;
<a name="1321"/> 1321:     M = lists:foldl(fun(_,#{procs := Ps } = M) -&gt;
<a name="1322"/> 1322:                             M#{ procs := Ps#{ spawn_link(fun() -&gt; grecv_loop() end) =&gt; 0 }}
<a name="1323"/> 1323:                     end, #{procs =&gt; #{}, done =&gt; 0}, lists:seq(1,?t_guard_receive_large_procs)),
<a name="1324"/> 1324:     lists:foreach(fun(Pid) -&gt;
<a name="1325"/> 1325:                           Pid ! {self(), hello}
<a name="1326"/> 1326:                   end, maps:keys(maps:get(procs,M))),
<a name="1327"/> 1327:     ok = guard_receive_large_loop(M),
<a name="t_guard_receive_large-last_expr"/><a name="1328"/> 1328:     ok.
<a name="1329"/> 1329: 
<a name="guard_receive_large_loop-1"/><a name="1330"/> 1330: <b>guard_receive_large_loop</b>(#{done := ?t_guard_receive_large_procs}) -&gt;
<a name="1331"/> 1331:     ok;
<a name="1332"/> 1332: <b>guard_receive_large_loop</b>(M) -&gt;
<a name="guard_receive_large_loop-last_expr"/><a name="1333"/> 1333:     receive
<a name="1334"/> 1334:         #{pid := Pid, msg := hello} -&gt;
<a name="1335"/> 1335:             case M of
<a name="1336"/> 1336:                 #{done := Count, procs := #{Pid := 15}} -&gt;
<a name="1337"/> 1337:                     Pid ! {self(), done},
<a name="1338"/> 1338:                     guard_receive_large_loop(M#{done := Count + 1});
<a name="1339"/> 1339:                 #{procs := #{Pid := Count} = Ps} -&gt;
<a name="1340"/> 1340:                     Pid ! {self(), hello},
<a name="1341"/> 1341:                     guard_receive_large_loop(M#{procs := Ps#{Pid := Count + 1}})
<a name="1342"/> 1342:             end
<a name="1343"/> 1343:     end.
<a name="1344"/> 1344: 
<a name="grecv_loop-0"/><a name="1345"/> 1345: <b>grecv_loop</b>() -&gt;
<a name="grecv_loop-last_expr"/><a name="1346"/> 1346:     receive
<a name="1347"/> 1347:         {_, done} -&gt;
<a name="1348"/> 1348:             ok;
<a name="1349"/> 1349:         {Pid, hello} -&gt;
<a name="1350"/> 1350:             Pid ! #{pid=&gt;self(), msg=&gt;hello},
<a name="1351"/> 1351:             grecv_loop()
<a name="1352"/> 1352:     end.
<a name="1353"/> 1353: 
<a name="call-2"/><a name="1354"/> 1354: <b>call</b>(Pid, M) -&gt;
<a name="call-last_expr"/><a name="1355"/> 1355: <b>    Pid ! {self</b>(), M}, receive {Pid, Res} -&gt; Res end.
<a name="1356"/> 1356: 
<a name="guard_receive_loop-0"/><a name="1357"/> 1357: <b>guard_receive_loop</b>() -&gt;
<a name="guard_receive_loop-last_expr"/><a name="1358"/> 1358:     receive
<a name="1359"/> 1359: 	{Pid, #{ id:=Id, op:=&quot;append&quot;, in:={X,Y}}=M} when is_binary(X), is_binary(Y) -&gt;
<a name="1360"/> 1360: 	    Pid ! {self(), M#{ id=&gt;Id+1, res=&gt;&lt;&lt;X/binary,Y/binary&gt;&gt;}},
<a name="1361"/> 1361: 	    guard_receive_loop();
<a name="1362"/> 1362: 	{Pid, #{ id:=Id, op:=add, in:={X,Y}}} -&gt;
<a name="1363"/> 1363: 	    Pid ! {self(), #{ id=&gt;Id+1, res=&gt;X+Y}},
<a name="1364"/> 1364: 	    guard_receive_loop();
<a name="1365"/> 1365: 	{Pid, #{ id:=Id, op:=sub,  in:={X,Y}}=M} -&gt;
<a name="1366"/> 1366: 	    Pid ! {self(), M#{ id=&gt;Id+1, res=&gt;X-Y}},
<a name="1367"/> 1367: 	    guard_receive_loop();
<a name="1368"/> 1368: 	{Pid, #{ id:=Id, op:=idiv, in:={X,Y}}=M} -&gt;
<a name="1369"/> 1369: 	    Pid ! {self(), M#{ id=&gt;Id+1, res=&gt;X div Y}},
<a name="1370"/> 1370: 	    guard_receive_loop();
<a name="1371"/> 1371: 	{Pid, #{ id:=Id, op:=imul, in:={X,Y}}=M} -&gt;
<a name="1372"/> 1372: 	    Pid ! {self(), M#{ id=&gt;Id+1, res=&gt;X * Y}},
<a name="1373"/> 1373: 	    guard_receive_loop();
<a name="1374"/> 1374: 	{Pid, done} -&gt;
<a name="1375"/> 1375: 	    Pid ! {self(), done};
<a name="1376"/> 1376: 	{Pid, Other} -&gt;
<a name="1377"/> 1377: 	    Pid ! {error, Other},
<a name="1378"/> 1378: 	    guard_receive_loop()
<a name="1379"/> 1379:     end.
<a name="1380"/> 1380: 
<a name="1381"/> 1381: 
<a name="t_list_comprehension-1"/><a name="1382"/> 1382: <b>t_list_comprehension</b>(Config) when is_list(Config) -&gt;
<a name="1383"/> 1383:     [#{k:=1},#{k:=2},#{k:=3}] = [#{k=&gt;I} || I &lt;- [1,2,3]],
<a name="1384"/> 1384:     Ls = id([#{&lt;&lt;2:301&gt;&gt; =&gt; I, &quot;wat&quot; =&gt; I + 1} || I &lt;- [1,2,3]]),
<a name="1385"/> 1385:     [#{&lt;&lt;2:301&gt;&gt;:=1,&quot;wat&quot;:=2},#{&lt;&lt;2:301&gt;&gt;:=2,&quot;wat&quot;:=3},#{&lt;&lt;2:301&gt;&gt;:=3,&quot;wat&quot;:=4}] = Ls,
<a name="1386"/> 1386:     [{1,2},{2,3},{3,4}] = id([{I2,I1} || #{&quot;wat&quot; := I1, &lt;&lt;2:301&gt;&gt; := I2} &lt;- Ls]),
<a name="1387"/> 1387: 
<a name="1388"/> 1388:     Ks = lists:seq($a,$z),
<a name="1389"/> 1389:     Ms = [#{[K1,K2]=&gt;{K1,K2}} || K1 &lt;- Ks, K2 &lt;- Ks],
<a name="1390"/> 1390:     [#{&quot;aa&quot; := {$a,$a}},#{&quot;ab&quot;:={$a,$b}}|_] = Ms,
<a name="1391"/> 1391:     [#{&quot;zz&quot; := {$z,$z}},#{&quot;zy&quot;:={$z,$y}}|_] = lists:reverse(Ms),
<a name="t_list_comprehension-last_expr"/><a name="1392"/> 1392:     ok.
<a name="1393"/> 1393: 
<a name="t_guard_fun-1"/><a name="1394"/> 1394: <b>t_guard_fun</b>(Config) when is_list(Config) -&gt;
<a name="1395"/> 1395:     F1 = fun
<a name="1396"/> 1396: 	    (#{s:=v,v:=V})     -&gt; {v,V};
<a name="1397"/> 1397: 	    (#{s:=t,v:={V,V}}) -&gt; {t,V};
<a name="1398"/> 1398: 	    (#{s:=l,v:=[V,V]}) -&gt; {l,V}
<a name="1399"/> 1399:     end,
<a name="1400"/> 1400: 
<a name="1401"/> 1401:     F2 = fun
<a name="1402"/> 1402: 	    (#{s:=T,v:={V,V}}) -&gt; {T,V};
<a name="1403"/> 1403: 	    (#{s:=T,v:=[V,V]}) -&gt; {T,V};
<a name="1404"/> 1404: 	    (#{s:=T,v:=V})     -&gt; {T,V}
<a name="1405"/> 1405:     end,
<a name="1406"/> 1406:     V = &lt;&lt;&quot;hi&quot;&gt;&gt;,
<a name="1407"/> 1407: 
<a name="1408"/> 1408:     {v,V} = F1(#{s=&gt;v,v=&gt;V}),
<a name="1409"/> 1409:     {t,V} = F1(#{s=&gt;t,v=&gt;{V,V}}),
<a name="1410"/> 1410:     {l,V} = F1(#{s=&gt;l,v=&gt;[V,V]}),
<a name="1411"/> 1411: 
<a name="1412"/> 1412:     {v,V} = F2(#{s=&gt;v,v=&gt;V}),
<a name="1413"/> 1413:     {t,V} = F2(#{s=&gt;t,v=&gt;{V,V}}),
<a name="1414"/> 1414:     {l,V} = F2(#{s=&gt;l,v=&gt;[V,V]}),
<a name="1415"/> 1415: 
<a name="1416"/> 1416:     %% error case
<a name="1417"/> 1417:     {'EXIT', {function_clause,[{?MODULE,_,[#{s:=none,v:=none}],_}|_]}} = (catch F1(#{s=&gt;none,v=&gt;none})),
<a name="t_guard_fun-last_expr"/><a name="1418"/> 1418:     ok.
<a name="1419"/> 1419: 
<a name="1420"/> 1420: 
<a name="t_map_sort_literals-1"/><a name="1421"/> 1421: <b>t_map_sort_literals</b>(Config) when is_list(Config) -&gt;
<a name="1422"/> 1422:     %% test relation
<a name="1423"/> 1423: 
<a name="1424"/> 1424:     %% size order
<a name="1425"/> 1425:     true  = #{ a =&gt; 1, b =&gt; 2} &lt; id(#{ a =&gt; 1, b =&gt; 1, c =&gt; 1}),
<a name="1426"/> 1426:     true  = #{ b =&gt; 1, a =&gt; 1} &lt; id(#{ c =&gt; 1, a =&gt; 1, b =&gt; 1}),
<a name="1427"/> 1427:     false = #{ c =&gt; 1, b =&gt; 1, a =&gt; 1} &lt; id(#{ c =&gt; 1, a =&gt; 1}),
<a name="1428"/> 1428: 
<a name="1429"/> 1429:     %% key order
<a name="1430"/> 1430:     true  = #{ a =&gt; 1 } &lt; id(#{ b =&gt; 1}),
<a name="1431"/> 1431:     false = #{ b =&gt; 1 } &lt; id(#{ a =&gt; 1}),
<a name="1432"/> 1432:     true  = #{ a =&gt; 1, b =&gt; 1, c =&gt; 1 } &lt; id(#{ b =&gt; 1, c =&gt; 1, d =&gt; 1}),
<a name="1433"/> 1433:     true  = #{ b =&gt; 1, c =&gt; 1, d =&gt; 1 } &gt; id(#{ a =&gt; 1, b =&gt; 1, c =&gt; 1}),
<a name="1434"/> 1434:     true  = #{ c =&gt; 1, b =&gt; 1, a =&gt; 1 } &lt; id(#{ b =&gt; 1, c =&gt; 1, d =&gt; 1}),
<a name="1435"/> 1435:     true  = #{ &quot;a&quot; =&gt; 1 } &lt; id(#{ &lt;&lt;&quot;a&quot;&gt;&gt; =&gt; 1}),
<a name="1436"/> 1436:     false = #{ &lt;&lt;&quot;a&quot;&gt;&gt; =&gt; 1 } &lt; id(#{ &quot;a&quot; =&gt; 1}),
<a name="1437"/> 1437:     true  = #{ 1 =&gt; 1 } &lt; id(#{ 1.0 =&gt; 1}),
<a name="1438"/> 1438:     false = #{ 1.0 =&gt; 1 } &lt; id(#{ 1 =&gt; 1}),
<a name="1439"/> 1439: 
<a name="1440"/> 1440:     %% value order
<a name="1441"/> 1441:     true  = #{ a =&gt; 1 } &lt; id(#{ a =&gt; 2}),
<a name="1442"/> 1442:     false = #{ a =&gt; 2 } &lt; id(#{ a =&gt; 1}),
<a name="1443"/> 1443:     false = #{ a =&gt; 2, b =&gt; 1 } &lt; id(#{ a =&gt; 1, b =&gt; 3}),
<a name="1444"/> 1444:     true  = #{ a =&gt; 1, b =&gt; 1 } &lt; id(#{ a =&gt; 1, b =&gt; 3}),
<a name="1445"/> 1445: 
<a name="1446"/> 1446:     true  = #{ &quot;a&quot; =&gt; &quot;hi&quot;, b =&gt; 134 } == id(#{ b =&gt; 134,&quot;a&quot; =&gt; &quot;hi&quot;}),
<a name="1447"/> 1447: 
<a name="1448"/> 1448:     %% lists:sort
<a name="1449"/> 1449: 
<a name="1450"/> 1450:     SortVs = [#{&quot;a&quot;=&gt;1},#{a=&gt;2},#{1=&gt;3},#{&lt;&lt;&quot;a&quot;&gt;&gt;=&gt;4}],
<a name="1451"/> 1451:     [#{1:=ok},#{a:=ok},#{&quot;a&quot;:=ok},#{&lt;&lt;&quot;a&quot;&gt;&gt;:=ok}] = lists:sort([#{&quot;a&quot;=&gt;ok},#{a=&gt;ok},#{1=&gt;ok},#{&lt;&lt;&quot;a&quot;&gt;&gt;=&gt;ok}]),
<a name="1452"/> 1452:     [#{1:=3},#{a:=2},#{&quot;a&quot;:=1},#{&lt;&lt;&quot;a&quot;&gt;&gt;:=4}] = lists:sort(SortVs),
<a name="1453"/> 1453:     [#{1:=3},#{a:=2},#{&quot;a&quot;:=1},#{&lt;&lt;&quot;a&quot;&gt;&gt;:=4}] = lists:sort(lists:reverse(SortVs)),
<a name="1454"/> 1454: 
<a name="t_map_sort_literals-last_expr"/><a name="1455"/> 1455:     ok.
<a name="1456"/> 1456: 
<a name="1457"/> 1457: <i>%% BIFs</i>
<a name="t_bif_map_get-1"/><a name="1458"/> 1458: <b>t_bif_map_get</b>(Config) when is_list(Config) -&gt;
<a name="1459"/> 1459: 
<a name="1460"/> 1460:     1    = maps:get(a, #{ a=&gt; 1}),
<a name="1461"/> 1461:     2    = maps:get(b, #{ a=&gt; 1, b =&gt; 2}),
<a name="1462"/> 1462:     &quot;hi&quot; = maps:get(&quot;hello&quot;, #{ a=&gt;1, &quot;hello&quot; =&gt; &quot;hi&quot;}),
<a name="1463"/> 1463:     &quot;tuple hi&quot; = maps:get({1,1.0}, #{ a=&gt;a, {1,1.0} =&gt; &quot;tuple hi&quot;}),
<a name="1464"/> 1464: 
<a name="1465"/> 1465:     M    = id(#{ k1=&gt;&quot;v1&quot;, &lt;&lt;&quot;k2&quot;&gt;&gt; =&gt; &lt;&lt;&quot;v3&quot;&gt;&gt; }),
<a name="1466"/> 1466:     &quot;v4&quot; = maps:get(&lt;&lt;&quot;k2&quot;&gt;&gt;, M#{ &lt;&lt;&quot;k2&quot;&gt;&gt; =&gt; &quot;v4&quot; }),
<a name="1467"/> 1467: 
<a name="1468"/> 1468:     %% error case
<a name="1469"/> 1469:     {'EXIT',{{badmap,[]},[{maps,get,_,_}|_]}} = (catch maps:get(a, [])),
<a name="1470"/> 1470:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,get,_,_}|_]}} = (catch maps:get(a, &lt;&lt;&gt;&gt;)),
<a name="1471"/> 1471:     {'EXIT',{{badkey,{1,1}},[{maps,get,_,_}|_]}} = (catch maps:get({1,1}, #{{1,1.0} =&gt; &quot;tuple&quot;})),
<a name="1472"/> 1472:     {'EXIT',{{badkey,a},[{maps,get,_,_}|_]}} = (catch maps:get(a, #{})),
<a name="1473"/> 1473:     {'EXIT',{{badkey,a},[{maps,get,_,_}|_]}} = (catch maps:get(a, #{ b=&gt;1, c=&gt;2})),
<a name="t_bif_map_get-last_expr"/><a name="1474"/> 1474:     ok.
<a name="1475"/> 1475: 
<a name="t_bif_map_find-1"/><a name="1476"/> 1476: <b>t_bif_map_find</b>(Config) when is_list(Config) -&gt;
<a name="1477"/> 1477: 
<a name="1478"/> 1478:     {ok, 1}     = maps:find(a, #{ a=&gt; 1}),
<a name="1479"/> 1479:     {ok, 2}     = maps:find(b, #{ a=&gt; 1, b =&gt; 2}),
<a name="1480"/> 1480:     {ok, &quot;int&quot;} = maps:find(1, #{ 1   =&gt; &quot;int&quot;}),
<a name="1481"/> 1481:     {ok, &quot;float&quot;} = maps:find(1.0, #{ 1.0=&gt; &quot;float&quot;}),
<a name="1482"/> 1482: 
<a name="1483"/> 1483:     {ok, &quot;hi&quot;} = maps:find(&quot;hello&quot;, #{ a=&gt;1, &quot;hello&quot; =&gt; &quot;hi&quot;}),
<a name="1484"/> 1484:     {ok, &quot;tuple hi&quot;} = maps:find({1,1.0}, #{ a=&gt;a, {1,1.0} =&gt; &quot;tuple hi&quot;}),
<a name="1485"/> 1485: 
<a name="1486"/> 1486:     M = id(#{ k1=&gt;&quot;v1&quot;, &lt;&lt;&quot;k2&quot;&gt;&gt; =&gt; &lt;&lt;&quot;v3&quot;&gt;&gt; }),
<a name="1487"/> 1487:     {ok, &quot;v4&quot;} = maps:find(&lt;&lt;&quot;k2&quot;&gt;&gt;, M#{ &lt;&lt;&quot;k2&quot;&gt;&gt; =&gt; &quot;v4&quot; }),
<a name="1488"/> 1488: 
<a name="1489"/> 1489:     %% error case
<a name="1490"/> 1490:     error = maps:find(a,#{}),
<a name="1491"/> 1491:     error = maps:find(a,#{b=&gt;1, c=&gt;2}),
<a name="1492"/> 1492:     error = maps:find(1.0, #{ 1 =&gt; &quot;int&quot;}),
<a name="1493"/> 1493:     error = maps:find(1, #{ 1.0  =&gt; &quot;float&quot;}),
<a name="1494"/> 1494:     error = maps:find({1.0,1}, #{ a=&gt;a, {1,1.0} =&gt; &quot;tuple hi&quot;}), % reverse types in tuple key
<a name="1495"/> 1495: 
<a name="1496"/> 1496: 
<a name="1497"/> 1497:     {'EXIT',{{badmap,[]},[{maps,find,_,_}|_]}} =
<a name="1498"/> 1498: 	(catch maps:find(a, id([]))),
<a name="1499"/> 1499:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,find,_,_}|_]}} =
<a name="1500"/> 1500: 	(catch maps:find(a, id(&lt;&lt;&gt;&gt;))),
<a name="t_bif_map_find-last_expr"/><a name="1501"/> 1501:     ok.
<a name="1502"/> 1502: 
<a name="1503"/> 1503: 
<a name="t_bif_map_is_key-1"/><a name="1504"/> 1504: <b>t_bif_map_is_key</b>(Config) when is_list(Config) -&gt;
<a name="1505"/> 1505:     M1 = #{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;, 4 =&gt; number},
<a name="1506"/> 1506: 
<a name="1507"/> 1507:     true  = maps:is_key(&quot;hi&quot;, M1),
<a name="1508"/> 1508:     true  = maps:is_key(int, M1),
<a name="1509"/> 1509:     true  = maps:is_key(&lt;&lt;&quot;key&quot;&gt;&gt;, M1),
<a name="1510"/> 1510:     true  = maps:is_key(4, M1),
<a name="1511"/> 1511: 
<a name="1512"/> 1512:     false = maps:is_key(5, M1),
<a name="1513"/> 1513:     false = maps:is_key(&lt;&lt;&quot;key2&quot;&gt;&gt;, M1),
<a name="1514"/> 1514:     false = maps:is_key(&quot;h&quot;, M1),
<a name="1515"/> 1515:     false = maps:is_key(&quot;hello&quot;, M1),
<a name="1516"/> 1516:     false = maps:is_key(atom, M1),
<a name="1517"/> 1517:     false = maps:is_key(any, id(#{})),
<a name="1518"/> 1518: 
<a name="1519"/> 1519:     false = maps:is_key(&quot;hi&quot;, maps:remove(&quot;hi&quot;, M1)),
<a name="1520"/> 1520:     true  = maps:is_key(&quot;hi&quot;, M1),
<a name="1521"/> 1521:     true  = maps:is_key(1, maps:put(1, &quot;number&quot;, M1)),
<a name="1522"/> 1522:     false = maps:is_key(1.0, maps:put(1, &quot;number&quot;, M1)),
<a name="1523"/> 1523: 
<a name="1524"/> 1524:     %% error case
<a name="1525"/> 1525:     {'EXIT',{{badmap,[]},[{maps,is_key,_,_}|_]}} = (catch maps:is_key(a, id([]))),
<a name="1526"/> 1526:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,is_key,_,_}|_]}} = (catch maps:is_key(a, id(&lt;&lt;&gt;&gt;))),
<a name="t_bif_map_is_key-last_expr"/><a name="1527"/> 1527:     ok.
<a name="1528"/> 1528: 
<a name="t_bif_map_keys-1"/><a name="1529"/> 1529: <b>t_bif_map_keys</b>(Config) when is_list(Config) -&gt;
<a name="1530"/> 1530:     [] = maps:keys(#{}),
<a name="1531"/> 1531: 
<a name="1532"/> 1532:     [1,2,3,4,5] = lists:sort(maps:keys(#{ 1 =&gt; a, 2 =&gt; b, 3 =&gt; c, 4 =&gt; d, 5 =&gt; e})),
<a name="1533"/> 1533:     [1,2,3,4,5] = lists:sort(maps:keys(#{ 4 =&gt; d, 5 =&gt; e, 1 =&gt; a, 2 =&gt; b, 3 =&gt; c})),
<a name="1534"/> 1534: 
<a name="1535"/> 1535:     M1 = #{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;, 4 =&gt; number},
<a name="1536"/> 1536:     [4,int,&quot;hi&quot;,&lt;&lt;&quot;key&quot;&gt;&gt;] = lists:sort(maps:keys(M1)),
<a name="1537"/> 1537: 
<a name="1538"/> 1538:     %% error case
<a name="1539"/> 1539:     BigNum = 1 bsl 65 + 3,
<a name="1540"/> 1540:     {'EXIT',{{badmap,BigNum},[{maps,keys,_,_}|_]}} = (catch maps:keys(BigNum)),
<a name="1541"/> 1541:     {'EXIT',{{badmap,154},[{maps,keys,_,_}|_]}} = (catch maps:keys(154)),
<a name="1542"/> 1542:     {'EXIT',{{badmap,atom},[{maps,keys,_,_}|_]}} = (catch maps:keys(atom)),
<a name="1543"/> 1543:     {'EXIT',{{badmap,[]},[{maps,keys,_,_}|_]}} = (catch maps:keys([])),
<a name="1544"/> 1544:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,keys,_,_}|_]}} = (catch maps:keys(&lt;&lt;&gt;&gt;)),
<a name="t_bif_map_keys-last_expr"/><a name="1545"/> 1545:     ok.
<a name="1546"/> 1546: 
<a name="t_bif_map_new-1"/><a name="1547"/> 1547: <b>t_bif_map_new</b>(Config) when is_list(Config) -&gt;
<a name="1548"/> 1548:     #{} = maps:new(),
<a name="1549"/> 1549:     0   = erlang:map_size(maps:new()),
<a name="t_bif_map_new-last_expr"/><a name="1550"/> 1550:     ok.
<a name="1551"/> 1551: 
<a name="t_bif_map_merge-1"/><a name="1552"/> 1552: <b>t_bif_map_merge</b>(Config) when is_list(Config) -&gt;
<a name="1553"/> 1553:     0   = erlang:map_size(maps:merge(#{},#{})),
<a name="1554"/> 1554: 
<a name="1555"/> 1555:     M0 = #{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1556"/> 1556: 	4 =&gt; number, 18446744073709551629 =&gt; wat},
<a name="1557"/> 1557: 
<a name="1558"/> 1558:     #{ &quot;hi&quot; := &quot;hello&quot;, int := 3, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1559"/> 1559: 	4 := number, 18446744073709551629 := wat} = maps:merge(#{}, M0),
<a name="1560"/> 1560: 
<a name="1561"/> 1561:     #{ &quot;hi&quot; := &quot;hello&quot;, int := 3, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1562"/> 1562: 	4 := number, 18446744073709551629 := wat} = maps:merge(M0, #{}),
<a name="1563"/> 1563: 
<a name="1564"/> 1564:     M1 = #{ &quot;hi&quot; =&gt; &quot;hello again&quot;, float =&gt; 3.3, {1,2} =&gt; &quot;tuple&quot;, 4 =&gt; integer },
<a name="1565"/> 1565: 
<a name="1566"/> 1566:     #{4 := number, 18446744073709551629 := wat, float := 3.3, int := 3,
<a name="1567"/> 1567: 	{1,2} := &quot;tuple&quot;, &quot;hi&quot; := &quot;hello&quot;, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;} = maps:merge(M1,M0),
<a name="1568"/> 1568: 
<a name="1569"/> 1569:     #{4 := integer, 18446744073709551629 := wat, float := 3.3, int := 3,
<a name="1570"/> 1570: 	{1,2} := &quot;tuple&quot;, &quot;hi&quot; := &quot;hello again&quot;, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;} = maps:merge(M0,M1),
<a name="1571"/> 1571: 
<a name="1572"/> 1572:     %% error case
<a name="1573"/> 1573:     BigNum = 1 bsl 65 + 3,
<a name="1574"/> 1574:     {'EXIT',{{badmap,BigNum},[{maps,merge,_,_}|_]}} = (catch maps:merge(BigNum, &lt;&lt;&gt;&gt;)),
<a name="1575"/> 1575:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,merge,_,_}|_]}} = (catch maps:merge(&lt;&lt;&gt;&gt;, id(#{ a =&gt; 1}))),
<a name="1576"/> 1576:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,merge,_,_}|_]}} = (catch maps:merge(id(#{ a =&gt; 2}), &lt;&lt;&gt;&gt; )),
<a name="1577"/> 1577: 
<a name="t_bif_map_merge-last_expr"/><a name="1578"/> 1578:     ok.
<a name="1579"/> 1579: 
<a name="t_bif_map_put-1"/><a name="1580"/> 1580: <b>t_bif_map_put</b>(Config) when is_list(Config) -&gt;
<a name="1581"/> 1581:     M0 = #{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1582"/> 1582: 	4 =&gt; number, 18446744073709551629 =&gt; wat},
<a name="1583"/> 1583: 
<a name="1584"/> 1584:     M1 = #{ &quot;hi&quot; := &quot;hello&quot;} = maps:put(&quot;hi&quot;, &quot;hello&quot;, #{}),
<a name="1585"/> 1585: 
<a name="1586"/> 1586:     true = is_members([&quot;hi&quot;],maps:keys(M1)),
<a name="1587"/> 1587:     true = is_members([&quot;hello&quot;],maps:values(M1)),
<a name="1588"/> 1588: 
<a name="1589"/> 1589:     M2 = #{ int := 3 } = maps:put(int, 3, M1),
<a name="1590"/> 1590: 
<a name="1591"/> 1591:     true = is_members([int,&quot;hi&quot;],maps:keys(M2)),
<a name="1592"/> 1592:     true = is_members([3,&quot;hello&quot;],maps:values(M2)),
<a name="1593"/> 1593: 
<a name="1594"/> 1594:     M3 = #{ &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt; } = maps:put(&lt;&lt;&quot;key&quot;&gt;&gt;, &lt;&lt;&quot;value&quot;&gt;&gt;, M2),
<a name="1595"/> 1595: 
<a name="1596"/> 1596:     true = is_members([int,&quot;hi&quot;,&lt;&lt;&quot;key&quot;&gt;&gt;],maps:keys(M3)),
<a name="1597"/> 1597:     true = is_members([3,&quot;hello&quot;,&lt;&lt;&quot;value&quot;&gt;&gt;],maps:values(M3)),
<a name="1598"/> 1598: 
<a name="1599"/> 1599:     M4 = #{ 18446744073709551629 := wat } = maps:put(18446744073709551629, wat, M3),
<a name="1600"/> 1600: 
<a name="1601"/> 1601:     true = is_members([18446744073709551629,int,&quot;hi&quot;,&lt;&lt;&quot;key&quot;&gt;&gt;],maps:keys(M4)),
<a name="1602"/> 1602:     true = is_members([wat,3,&quot;hello&quot;,&lt;&lt;&quot;value&quot;&gt;&gt;],maps:values(M4)),
<a name="1603"/> 1603: 
<a name="1604"/> 1604:     M0 = #{ 4 := number } = M5 = maps:put(4, number, M4),
<a name="1605"/> 1605: 
<a name="1606"/> 1606:     true = is_members([4,18446744073709551629,int,&quot;hi&quot;,&lt;&lt;&quot;key&quot;&gt;&gt;],maps:keys(M5)),
<a name="1607"/> 1607:     true = is_members([number,wat,3,&quot;hello&quot;,&lt;&lt;&quot;value&quot;&gt;&gt;],maps:values(M5)),
<a name="1608"/> 1608: 
<a name="1609"/> 1609:     M6 = #{ &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;other value&quot;&gt;&gt; } = maps:put(&lt;&lt;&quot;key&quot;&gt;&gt;, &lt;&lt;&quot;other value&quot;&gt;&gt;, M5),
<a name="1610"/> 1610: 
<a name="1611"/> 1611:     true = is_members([4,18446744073709551629,int,&quot;hi&quot;,&lt;&lt;&quot;key&quot;&gt;&gt;],maps:keys(M6)),
<a name="1612"/> 1612:     true = is_members([number,wat,3,&quot;hello&quot;,&lt;&lt;&quot;other value&quot;&gt;&gt;],maps:values(M6)),
<a name="1613"/> 1613: 
<a name="1614"/> 1614:     %% error case
<a name="1615"/> 1615:     BigNum = 1 bsl 65 + 3,
<a name="1616"/> 1616:     {'EXIT',{{badmap,BigNum},[{maps,put,_,_}|_]}} = (catch maps:put(1, a, BigNum)),
<a name="1617"/> 1617:     {'EXIT',{{badmap,154},[{maps,put,_,_}|_]}} = (catch maps:put(1, a, 154)),
<a name="1618"/> 1618:     {'EXIT',{{badmap,atom},[{maps,put,_,_}|_]}} = (catch maps:put(1, a, atom)),
<a name="1619"/> 1619:     {'EXIT',{{badmap,[]},[{maps,put,_,_}|_]}} = (catch maps:put(1, a, [])),
<a name="1620"/> 1620:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,put,_,_}|_]}} = (catch maps:put(1, a, &lt;&lt;&gt;&gt;)),
<a name="t_bif_map_put-last_expr"/><a name="1621"/> 1621:     ok.
<a name="1622"/> 1622: 
<a name="is_members-2"/><a name="1623"/> 1623: <b>is_members</b>(Ks,Ls) when length(Ks) =/= length(Ls) -&gt; false;
<a name="is_members-last_expr"/><a name="1624"/> 1624: <b>is_members</b>(Ks,Ls) -&gt; is_members_do(Ks,Ls).
<a name="1625"/> 1625: 
<a name="is_members_do-2"/><a name="1626"/> 1626: <b>is_members_do</b>([],[]) -&gt; true;
<a name="1627"/> 1627: <b>is_members_do</b>([],_) -&gt; false;
<a name="1628"/> 1628: <b>is_members_do</b>([K|Ks],Ls) -&gt;
<a name="is_members_do-last_expr"/><a name="1629"/> 1629: <b>    is_members_do</b>(Ks, lists:delete(K,Ls)).
<a name="1630"/> 1630: 
<a name="1631"/> 1631: 
<a name="t_bif_map_update-1"/><a name="1632"/> 1632: <b>t_bif_map_update</b>(Config) when is_list(Config) -&gt;
<a name="1633"/> 1633:     M0 = #{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1634"/> 1634: 	4 =&gt; number, 18446744073709551629 =&gt; wat},
<a name="1635"/> 1635: 
<a name="1636"/> 1636:     #{ &quot;hi&quot; := &quot;hello again&quot;, int := 3, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1637"/> 1637: 	4 := number, 18446744073709551629 := wat} = maps:update(&quot;hi&quot;, &quot;hello again&quot;, M0),
<a name="1638"/> 1638: 
<a name="1639"/> 1639:     #{ &quot;hi&quot; := &quot;hello&quot;, int := 1337, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1640"/> 1640: 	4 := number, 18446744073709551629 := wat} = maps:update(int, 1337, M0),
<a name="1641"/> 1641: 
<a name="1642"/> 1642:     #{ &quot;hi&quot; := &quot;hello&quot;, int := 3, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;new value&quot;&gt;&gt;,
<a name="1643"/> 1643: 	4 := number, 18446744073709551629 := wat} = maps:update(&lt;&lt;&quot;key&quot;&gt;&gt;, &lt;&lt;&quot;new value&quot;&gt;&gt;, M0),
<a name="1644"/> 1644: 
<a name="1645"/> 1645:     #{ &quot;hi&quot; := &quot;hello&quot;, int := 3, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1646"/> 1646: 	4 := integer, 18446744073709551629 := wat} = maps:update(4, integer, M0),
<a name="1647"/> 1647: 
<a name="1648"/> 1648:     #{ &quot;hi&quot; := &quot;hello&quot;, int := 3, &lt;&lt;&quot;key&quot;&gt;&gt; := &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1649"/> 1649: 	4 := number, 18446744073709551629 := wazzup} = maps:update(18446744073709551629, wazzup, M0),
<a name="1650"/> 1650: 
<a name="1651"/> 1651:     %% error case
<a name="1652"/> 1652:     {'EXIT',{{badmap,{}},[{maps,update,_,_}|_]}} = (catch maps:update(1, none, {})),
<a name="1653"/> 1653:     {'EXIT',{{badmap,&lt;&lt;&quot;value&quot;&gt;&gt;},[{maps,update,_,_}|_]}} =
<a name="1654"/> 1654: 	(catch maps:update(1, none, &lt;&lt;&quot;value&quot;&gt;&gt;)),
<a name="1655"/> 1655:     {'EXIT',{{badkey,5},[{maps,update,_,_}|_]}} = (catch maps:update(5, none, M0)),
<a name="1656"/> 1656: 
<a name="t_bif_map_update-last_expr"/><a name="1657"/> 1657:     ok.
<a name="1658"/> 1658: 
<a name="t_bif_map_remove-1"/><a name="1659"/> 1659: <b>t_bif_map_remove</b>(Config) when is_list(Config) -&gt;
<a name="1660"/> 1660:     0  = erlang:map_size(maps:remove(some_key, #{})),
<a name="1661"/> 1661: 
<a name="1662"/> 1662:     M0 = #{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;,
<a name="1663"/> 1663: 	4 =&gt; number, 18446744073709551629 =&gt; wat},
<a name="1664"/> 1664: 
<a name="1665"/> 1665:     M1 = maps:remove(&quot;hi&quot;, M0),
<a name="1666"/> 1666:     true = is_members([4,18446744073709551629,int,&lt;&lt;&quot;key&quot;&gt;&gt;],maps:keys(M1)),
<a name="1667"/> 1667:     true = is_members([number,wat,3,&lt;&lt;&quot;value&quot;&gt;&gt;],maps:values(M1)),
<a name="1668"/> 1668: 
<a name="1669"/> 1669:     M2 = maps:remove(int, M1),
<a name="1670"/> 1670:     true = is_members([4,18446744073709551629,&lt;&lt;&quot;key&quot;&gt;&gt;],maps:keys(M2)),
<a name="1671"/> 1671:     true = is_members([number,wat,&lt;&lt;&quot;value&quot;&gt;&gt;],maps:values(M2)),
<a name="1672"/> 1672: 
<a name="1673"/> 1673:     M3 = maps:remove(&lt;&lt;&quot;key&quot;&gt;&gt;, M2),
<a name="1674"/> 1674:     true = is_members([4,18446744073709551629],maps:keys(M3)),
<a name="1675"/> 1675:     true = is_members([number,wat],maps:values(M3)),
<a name="1676"/> 1676: 
<a name="1677"/> 1677:     M4 = maps:remove(18446744073709551629, M3),
<a name="1678"/> 1678:     true = is_members([4],maps:keys(M4)),
<a name="1679"/> 1679:     true = is_members([number],maps:values(M4)),
<a name="1680"/> 1680: 
<a name="1681"/> 1681:     M5 = maps:remove(4, M4),
<a name="1682"/> 1682:     [] = maps:keys(M5),
<a name="1683"/> 1683:     [] = maps:values(M5),
<a name="1684"/> 1684: 
<a name="1685"/> 1685:     M0 = maps:remove(5,M0),
<a name="1686"/> 1686:     M0 = maps:remove(&quot;hi there&quot;,M0),
<a name="1687"/> 1687: 
<a name="1688"/> 1688:     #{ &quot;hi&quot; := &quot;hello&quot;, int := 3, 4 := number} = maps:remove(18446744073709551629,maps:remove(&lt;&lt;&quot;key&quot;&gt;&gt;,M0)),
<a name="1689"/> 1689: 
<a name="1690"/> 1690:     %% error case
<a name="1691"/> 1691:     BigNum = 1 bsl 65 + 3,
<a name="1692"/> 1692:     {'EXIT',{{badmap,BigNum},[{maps,remove,_,_}|_]}} = (catch maps:remove(a, BigNum)),
<a name="1693"/> 1693:     {'EXIT',{{badmap,154},[{maps,remove,_,_}|_]}} = (catch maps:remove(1, 154)),
<a name="1694"/> 1694:     {'EXIT',{{badmap,atom},[{maps,remove,_,_}|_]}} = (catch maps:remove(a, atom)),
<a name="1695"/> 1695:     {'EXIT',{{badmap,[]},[{maps,remove,_,_}|_]}} = (catch maps:remove(1, [])),
<a name="1696"/> 1696:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,remove,_,_}|_]}} = (catch maps:remove(a, &lt;&lt;&gt;&gt;)),
<a name="t_bif_map_remove-last_expr"/><a name="1697"/> 1697:     ok.
<a name="1698"/> 1698: 
<a name="t_bif_map_values-1"/><a name="1699"/> 1699: <b>t_bif_map_values</b>(Config) when is_list(Config) -&gt;
<a name="1700"/> 1700: 
<a name="1701"/> 1701:     [] = maps:values(#{}),
<a name="1702"/> 1702:     [1] = maps:values(#{a=&gt;1}),
<a name="1703"/> 1703: 
<a name="1704"/> 1704:     true = is_members([a,b,c,d,e],maps:values(#{ 1 =&gt; a, 2 =&gt; b, 3 =&gt; c, 4 =&gt; d, 5 =&gt; e})),
<a name="1705"/> 1705:     true = is_members([a,b,c,d,e],maps:values(#{ 4 =&gt; d, 5 =&gt; e, 1 =&gt; a, 2 =&gt; b, 3 =&gt; c})),
<a name="1706"/> 1706: 
<a name="1707"/> 1707:     M1 = #{ &quot;hi&quot; =&gt; &quot;hello&quot;, int =&gt; 3, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt;, 4 =&gt; number},
<a name="1708"/> 1708:     M2 = M1#{ &quot;hi&quot; =&gt; &quot;hello2&quot;, &lt;&lt;&quot;key&quot;&gt;&gt; =&gt; &lt;&lt;&quot;value2&quot;&gt;&gt; },
<a name="1709"/> 1709:     true = is_members([number,3,&quot;hello2&quot;,&lt;&lt;&quot;value2&quot;&gt;&gt;],maps:values(M2)),
<a name="1710"/> 1710:     true = is_members([number,3,&quot;hello&quot;,&lt;&lt;&quot;value&quot;&gt;&gt;],maps:values(M1)),
<a name="1711"/> 1711: 
<a name="1712"/> 1712:     %% error case
<a name="1713"/> 1713:     BigNum = 1 bsl 65 + 3,
<a name="1714"/> 1714:     {'EXIT',{{badmap,BigNum},[{maps,values,_,_}|_]}} = (catch maps:values(BigNum)),
<a name="1715"/> 1715:     {'EXIT',{{badmap,atom},[{maps,values,_,_}|_]}} = (catch maps:values(atom)),
<a name="1716"/> 1716:     {'EXIT',{{badmap,[]},[{maps,values,_,_}|_]}} = (catch maps:values([])),
<a name="1717"/> 1717:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},[{maps,values,_,_}|_]}} = (catch maps:values(&lt;&lt;&gt;&gt;)),
<a name="t_bif_map_values-last_expr"/><a name="1718"/> 1718:     ok.
<a name="1719"/> 1719: 
<a name="1720"/> 1720: 
<a name="1721"/> 1721: 
<a name="t_erlang_hash-1"/><a name="1722"/> 1722: <b>t_erlang_hash</b>(Config) when is_list(Config) -&gt;
<a name="1723"/> 1723:     ok = t_bif_erlang_phash2(),
<a name="1724"/> 1724:     ok = t_bif_erlang_phash(),
<a name="t_erlang_hash-last_expr"/><a name="1725"/> 1725:     ok.
<a name="1726"/> 1726: 
<a name="t_bif_erlang_phash2-0"/><a name="1727"/> 1727: <b>t_bif_erlang_phash2</b>() -&gt;
<a name="1728"/> 1728:     39679005 = erlang:phash2(#{}),
<a name="1729"/> 1729:     33667975 = erlang:phash2(#{ a =&gt; 1, &quot;a&quot; =&gt; 2, &lt;&lt;&quot;a&quot;&gt;&gt; =&gt; 3, {a,b} =&gt; 4 }), % 78942764
<a name="1730"/> 1730:     95332690 = erlang:phash2(#{ 1 =&gt; a, 2 =&gt; &quot;a&quot;, 3 =&gt; &lt;&lt;&quot;a&quot;&gt;&gt;, 4 =&gt; {a,b} }), % 37338230
<a name="1731"/> 1731:     108954384 = erlang:phash2(#{ 1 =&gt; a }), % 14363616
<a name="1732"/> 1732:     59617982 = erlang:phash2(#{ a =&gt; 1 }), % 51612236
<a name="1733"/> 1733: 
<a name="1734"/> 1734:     42770201 = erlang:phash2(#{{} =&gt; &lt;&lt;&gt;&gt;}), % 37468437
<a name="1735"/> 1735:     71687700 = erlang:phash2(#{&lt;&lt;&gt;&gt; =&gt; {}}), % 44049159
<a name="1736"/> 1736: 
<a name="1737"/> 1737:     M0 = #{ a =&gt; 1, &quot;key&quot; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt; },
<a name="1738"/> 1738:     M1 = maps:remove(&quot;key&quot;,M0),
<a name="1739"/> 1739:     M2 = M1#{ &quot;key&quot; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt; },
<a name="1740"/> 1740: 
<a name="1741"/> 1741:     70249457 = erlang:phash2(M0), % 118679416
<a name="1742"/> 1742:     59617982 = erlang:phash2(M1), % 51612236
<a name="1743"/> 1743:     70249457 = erlang:phash2(M2), % 118679416
<a name="t_bif_erlang_phash2-last_expr"/><a name="1744"/> 1744:     ok.
<a name="1745"/> 1745: 
<a name="t_bif_erlang_phash-0"/><a name="1746"/> 1746: <b>t_bif_erlang_phash</b>() -&gt;
<a name="1747"/> 1747:     Sz = 1 bsl 32,
<a name="1748"/> 1748:     1113425985 = erlang:phash(#{},Sz), % 268440612
<a name="1749"/> 1749:     1510068139 = erlang:phash(#{ a =&gt; 1, &quot;a&quot; =&gt; 2, &lt;&lt;&quot;a&quot;&gt;&gt; =&gt; 3, {a,b} =&gt; 4 },Sz), % 1196461908
<a name="1750"/> 1750:     3182345590 = erlang:phash(#{ 1 =&gt; a, 2 =&gt; &quot;a&quot;, 3 =&gt; &lt;&lt;&quot;a&quot;&gt;&gt;, 4 =&gt; {a,b} },Sz), % 3944426064
<a name="1751"/> 1751:     2927531828 = erlang:phash(#{ 1 =&gt; a },Sz), % 1394238263
<a name="1752"/> 1752:     1670235874 = erlang:phash(#{ a =&gt; 1 },Sz), % 4066388227
<a name="1753"/> 1753: 
<a name="1754"/> 1754:     3935089469 = erlang:phash(#{{} =&gt; &lt;&lt;&gt;&gt;},Sz), % 1578050717
<a name="1755"/> 1755:     71692856   = erlang:phash(#{&lt;&lt;&gt;&gt; =&gt; {}},Sz), % 1578050717
<a name="1756"/> 1756: 
<a name="1757"/> 1757:     M0 = #{ a =&gt; 1, &quot;key&quot; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt; },
<a name="1758"/> 1758:     M1 = maps:remove(&quot;key&quot;,M0),
<a name="1759"/> 1759:     M2 = M1#{ &quot;key&quot; =&gt; &lt;&lt;&quot;value&quot;&gt;&gt; },
<a name="1760"/> 1760: 
<a name="1761"/> 1761:     2620391445 = erlang:phash(M0,Sz), % 3590546636
<a name="1762"/> 1762:     1670235874 = erlang:phash(M1,Sz), % 4066388227
<a name="1763"/> 1763:     2620391445 = erlang:phash(M2,Sz), % 3590546636
<a name="t_bif_erlang_phash-last_expr"/><a name="1764"/> 1764:     ok.
<a name="1765"/> 1765: 
<a name="t_map_encode_decode-1"/><a name="1766"/> 1766: <b>t_map_encode_decode</b>(Config) when is_list(Config) -&gt;
<a name="1767"/> 1767:     &lt;&lt;131,116,0,0,0,0&gt;&gt; = erlang:term_to_binary(#{}),
<a name="1768"/> 1768:     Pairs = [
<a name="1769"/> 1769: 	{a,b},{&quot;key&quot;,&quot;values&quot;},{&lt;&lt;&quot;key&quot;&gt;&gt;,&lt;&lt;&quot;value&quot;&gt;&gt;},
<a name="1770"/> 1770: 	{1,b},{[atom,1],{&lt;&lt;&quot;wat&quot;&gt;&gt;,1,2,3}},
<a name="1771"/> 1771: 	{aa,&quot;values&quot;},
<a name="1772"/> 1772: 	{1 bsl 64 + (1 bsl 50 - 1), sc1},
<a name="1773"/> 1773: 	{99, sc2},
<a name="1774"/> 1774: 	{1 bsl 65 + (1 bsl 51 - 1), sc3},
<a name="1775"/> 1775: 	{88, sc4},
<a name="1776"/> 1776: 	{1 bsl 66 + (1 bsl 52 - 1), sc5},
<a name="1777"/> 1777: 	{77, sc6},
<a name="1778"/> 1778: 	{1 bsl 67 + (1 bsl 53 - 1), sc3},
<a name="1779"/> 1779: 	{75, sc6}, {-10,sc8},
<a name="1780"/> 1780: 	{&lt;&lt;&gt;&gt;, sc9}, {3.14158, sc10},
<a name="1781"/> 1781: 	{[3.14158], sc11}, {more_atoms, sc12},
<a name="1782"/> 1782: 	{{more_tuples}, sc13}, {self(), sc14},
<a name="1783"/> 1783: 	{{},{}},{[],[]}
<a name="1784"/> 1784:     ],
<a name="1785"/> 1785:     ok = map_encode_decode_and_match(Pairs,[],#{}),
<a name="1786"/> 1786: 
<a name="1787"/> 1787:     %% check sorting
<a name="1788"/> 1788: 
<a name="1789"/> 1789:     %% literally #{ b=&gt;2, a=&gt;1 } in the internal order
<a name="1790"/> 1790:     #{ a:=1, b:=2 } =
<a name="1791"/> 1791: 	erlang:binary_to_term(&lt;&lt;131,116,0,0,0,2,100,0,1,98,97,2,100,0,1,97,97,1&gt;&gt;),
<a name="1792"/> 1792: 
<a name="1793"/> 1793: 
<a name="1794"/> 1794:     %% literally #{ &quot;hi&quot; =&gt; &quot;value&quot;, a=&gt;33, b=&gt;55 } in the internal order
<a name="1795"/> 1795:     #{ a:=33, b:=55, &quot;hi&quot; := &quot;value&quot;} = erlang:binary_to_term(&lt;&lt;131,116,0,0,0,3,
<a name="1796"/> 1796: 	107,0,2,104,105, % &quot;hi&quot; :: list()
<a name="1797"/> 1797: 	107,0,5,118,97,108,117,101, % &quot;value&quot; :: list()
<a name="1798"/> 1798: 	100,0,1,97, % a :: atom()
<a name="1799"/> 1799: 	97,33, % 33 :: integer()
<a name="1800"/> 1800: 	100,0,1,98, % b :: atom()
<a name="1801"/> 1801: 	97,55  % 55 :: integer()
<a name="1802"/> 1802: 	&gt;&gt;),
<a name="1803"/> 1803: 
<a name="1804"/> 1804: 
<a name="1805"/> 1805:     %% error cases
<a name="1806"/> 1806:     %% template: &lt;&lt;131,116,0,0,0,2,100,0,1,97,100,0,1,98,97,1,97,1&gt;&gt;
<a name="1807"/> 1807:     %% which is: #{ a=&gt;1, b=&gt;1 }
<a name="1808"/> 1808: 
<a name="1809"/> 1809:     %% uniqueness violation
<a name="1810"/> 1810:     %% literally #{ a=&gt;1, &quot;hi&quot;=&gt;&quot;value&quot;, a=&gt;2 }
<a name="1811"/> 1811:     {'EXIT',{badarg,[{_,_,_,_}|_]}} = (catch
<a name="1812"/> 1812: 	erlang:binary_to_term(&lt;&lt;131,116,0,0,0,3,100,0,1,97,107,0,2,104,105,100,0,1,97,97,1,107,0,5,118,97,108,117,101,97,2&gt;&gt;)),
<a name="1813"/> 1813: 
<a name="1814"/> 1814:     %% bad size (too large)
<a name="1815"/> 1815:     {'EXIT',{badarg,[{_,_,_,_}|_]}} = (catch
<a name="1816"/> 1816: 	erlang:binary_to_term(&lt;&lt;131,116,0,0,0,12,100,0,1,97,100,0,1,98,97,1,97,1&gt;&gt;)),
<a name="1817"/> 1817: 
<a name="1818"/> 1818:     %% bad size (too small) .. should fail just truncate it .. weird.
<a name="1819"/> 1819:     %% possibly change external format so truncated will be #{a:=1}
<a name="1820"/> 1820:     #{ a:=b } =
<a name="1821"/> 1821: 	erlang:binary_to_term(&lt;&lt;131,116,0,0,0,1,100,0,1,97,100,0,1,98,97,1,97,1&gt;&gt;),
<a name="1822"/> 1822: 
<a name="t_map_encode_decode-last_expr"/><a name="1823"/> 1823:     ok.
<a name="1824"/> 1824: 
<a name="map_encode_decode_and_match-3"/><a name="1825"/> 1825: <b>map_encode_decode_and_match</b>([{K,V}|Pairs], EncodedPairs, M0) -&gt;
<a name="1826"/> 1826:     M1 = maps:put(K,V,M0),
<a name="1827"/> 1827:     B0 = erlang:term_to_binary(M1),
<a name="1828"/> 1828:     Ls = [{erlang:term_to_binary(K), erlang:term_to_binary(V)}|EncodedPairs],
<a name="1829"/> 1829:     ok = match_encoded_map(B0, length(Ls), Ls),
<a name="1830"/> 1830:     %% decode and match it
<a name="1831"/> 1831:     M1 = erlang:binary_to_term(B0),
<a name="1832"/> 1832:     map_encode_decode_and_match(Pairs,Ls,M1);
<a name="map_encode_decode_and_match-last_expr"/><a name="1833"/> 1833: <b>map_encode_decode_and_match</b>([],_,_) -&gt; ok.
<a name="1834"/> 1834: 
<a name="match_encoded_map-3"/><a name="1835"/> 1835: <b>match_encoded_map</b>(&lt;&lt;131,116,Size:32,Encoded/binary&gt;&gt;,Size,Items) -&gt;
<a name="1836"/> 1836:     match_encoded_map_stripped_size(Encoded,Items,Items);
<a name="match_encoded_map-last_expr"/><a name="1837"/> 1837: <b>match_encoded_map</b>(_,_,_) -&gt; no_match_size.
<a name="1838"/> 1838: 
<a name="match_encoded_map_stripped_size-3"/><a name="1839"/> 1839: <b>match_encoded_map_stripped_size</b>(&lt;&lt;&gt;&gt;,_,_) -&gt; ok;
<a name="1840"/> 1840: <b>match_encoded_map_stripped_size</b>(B0,[{&lt;&lt;131,K/binary&gt;&gt;,&lt;&lt;131,V/binary&gt;&gt;}|Items],Ls) -&gt;
<a name="1841"/> 1841:     Ksz = byte_size(K),
<a name="1842"/> 1842:     Vsz = byte_size(V),
<a name="1843"/> 1843:     case B0 of
<a name="1844"/> 1844: 	&lt;&lt;K:Ksz/binary,V:Vsz/binary,B1/binary&gt;&gt; -&gt;
<a name="1845"/> 1845: 	    match_encoded_map_stripped_size(B1,Ls,Ls);
<a name="1846"/> 1846: 	_ -&gt;
<a name="1847"/> 1847: 	    match_encoded_map_stripped_size(B0,Items,Ls)
<a name="1848"/> 1848:     end;
<a name="match_encoded_map_stripped_size-last_expr"/><a name="1849"/> 1849: <b>match_encoded_map_stripped_size</b>(_,[],_) -&gt; fail.
<a name="1850"/> 1850: 
<a name="1851"/> 1851: 
<a name="t_bif_map_to_list-1"/><a name="1852"/> 1852: <b>t_bif_map_to_list</b>(Config) when is_list(Config) -&gt;
<a name="1853"/> 1853:     [] = maps:to_list(#{}),
<a name="1854"/> 1854:     [{a,1},{b,2}] = lists:sort(maps:to_list(#{a=&gt;1,b=&gt;2})),
<a name="1855"/> 1855:     [{a,1},{b,2},{c,3}] = lists:sort(maps:to_list(#{c=&gt;3,a=&gt;1,b=&gt;2})),
<a name="1856"/> 1856:     [{a,1},{b,2},{g,3}] = lists:sort(maps:to_list(#{g=&gt;3,a=&gt;1,b=&gt;2})),
<a name="1857"/> 1857:     [{a,1},{b,2},{g,3},{&quot;c&quot;,4}] = lists:sort(maps:to_list(#{g=&gt;3,a=&gt;1,b=&gt;2,&quot;c&quot;=&gt;4})),
<a name="1858"/> 1858:     [{3,v2},{hi,v4},{{hi,3},v5},{&quot;hi&quot;,v3},{&lt;&lt;&quot;hi&quot;&gt;&gt;,v1}] =
<a name="1859"/> 1859: 	lists:sort(maps:to_list(#{&lt;&lt;&quot;hi&quot;&gt;&gt;=&gt;v1,3=&gt;v2,&quot;hi&quot;=&gt;v3,hi=&gt;v4,{hi,3}=&gt;v5})),
<a name="1860"/> 1860: 
<a name="1861"/> 1861:     [{3,v7},{hi,v9},{{hi,3},v10},{&quot;hi&quot;,v8},{&lt;&lt;&quot;hi&quot;&gt;&gt;,v6}] =
<a name="1862"/> 1862: 	lists:sort(maps:to_list(#{&lt;&lt;&quot;hi&quot;&gt;&gt;=&gt;v1,3=&gt;v2,&quot;hi&quot;=&gt;v3,hi=&gt;v4,{hi,3}=&gt;v5,
<a name="1863"/> 1863: 				  &lt;&lt;&quot;hi&quot;&gt;&gt;=&gt;v6,3=&gt;v7,&quot;hi&quot;=&gt;v8,hi=&gt;v9,{hi,3}=&gt;v10})),
<a name="1864"/> 1864: 
<a name="1865"/> 1865:     %% error cases
<a name="1866"/> 1866:     {'EXIT', {{badmap,a},_}} = (catch maps:to_list(id(a))),
<a name="1867"/> 1867:     {'EXIT', {{badmap,42},_}} = (catch maps:to_list(id(42))),
<a name="t_bif_map_to_list-last_expr"/><a name="1868"/> 1868:     ok.
<a name="1869"/> 1869: 
<a name="1870"/> 1870: 
<a name="t_bif_map_from_list-1"/><a name="1871"/> 1871: <b>t_bif_map_from_list</b>(Config) when is_list(Config) -&gt;
<a name="1872"/> 1872:     #{} = maps:from_list([]),
<a name="1873"/> 1873:     A   = maps:from_list([]),
<a name="1874"/> 1874:     0   = erlang:map_size(A),
<a name="1875"/> 1875: 
<a name="1876"/> 1876:     #{a:=1,b:=2}  = maps:from_list([{a,1},{b,2}]),
<a name="1877"/> 1877:     #{c:=3,a:=1,b:=2} = maps:from_list([{a,1},{b,2},{c,3}]),
<a name="1878"/> 1878:     #{g:=3,a:=1,b:=2} = maps:from_list([{a,1},{b,2},{g,3}]),
<a name="1879"/> 1879: 
<a name="1880"/> 1880:     #{a:=2} = maps:from_list([{a,1},{a,3},{a,2}]),
<a name="1881"/> 1881: 
<a name="1882"/> 1882:     #{ &lt;&lt;&quot;hi&quot;&gt;&gt;:=v1,3:=v3,&quot;hi&quot;:=v6,hi:=v4,{hi,3}:=v5} =
<a name="1883"/> 1883: 	maps:from_list([{3,v3},{&quot;hi&quot;,v6},{hi,v4},{{hi,3},v5},{&lt;&lt;&quot;hi&quot;&gt;&gt;,v1}]),
<a name="1884"/> 1884: 
<a name="1885"/> 1885:     #{&lt;&lt;&quot;hi&quot;&gt;&gt;:=v6,3:=v8,&quot;hi&quot;:=v11,hi:=v9,{hi,3}:=v10} =
<a name="1886"/> 1886: 	maps:from_list([ {{hi,3},v3}, {&quot;hi&quot;,v0},{3,v1}, {&lt;&lt;&quot;hi&quot;&gt;&gt;,v4}, {hi,v2},
<a name="1887"/> 1887: 	    {&lt;&lt;&quot;hi&quot;&gt;&gt;,v6}, {{hi,3},v10},{&quot;hi&quot;,v11}, {hi,v9}, {3,v8}]),
<a name="1888"/> 1888: 
<a name="1889"/> 1889:     %% error cases
<a name="1890"/> 1890:     {'EXIT', {badarg,_}} = (catch maps:from_list(id([{a,b},b]))),
<a name="1891"/> 1891:     {'EXIT', {badarg,_}} = (catch maps:from_list(id([{a,b},{b,b,3}]))),
<a name="1892"/> 1892:     {'EXIT', {badarg,_}} = (catch maps:from_list(id([{a,b},&lt;&lt;&gt;&gt;]))),
<a name="1893"/> 1893:     {'EXIT', {badarg,_}} = (catch maps:from_list(id([{a,b}|{b,a}]))),
<a name="1894"/> 1894:     {'EXIT', {badarg,_}} = (catch maps:from_list(id(a))),
<a name="1895"/> 1895:     {'EXIT', {badarg,_}} = (catch maps:from_list(id(42))),
<a name="t_bif_map_from_list-last_expr"/><a name="1896"/> 1896:     ok.
<a name="1897"/> 1897: 
<a name="1898"/> 1898: <i>%% Maps module, not BIFs</i>
<a name="t_maps_fold-1"/><a name="1899"/> 1899: <b>t_maps_fold</b>(_Config) -&gt;
<a name="1900"/> 1900:     Vs = lists:seq(1,100),
<a name="1901"/> 1901:     M  = maps:from_list([{{k,I},{v,I}}||I&lt;-Vs]),
<a name="1902"/> 1902: 
<a name="1903"/> 1903:     %% fold
<a name="1904"/> 1904:     5050 = maps:fold(fun({k,_},{v,V},A) -&gt; V + A end, 0, M),
<a name="1905"/> 1905: 
<a name="t_maps_fold-last_expr"/><a name="1906"/> 1906:     ok.
<a name="1907"/> 1907: 
<a name="t_maps_map-1"/><a name="1908"/> 1908: <b>t_maps_map</b>(_Config) -&gt;
<a name="1909"/> 1909:     Vs = lists:seq(1,100),
<a name="1910"/> 1910:     M1 = maps:from_list([{I,I}||I&lt;-Vs]),
<a name="1911"/> 1911:     M2 = maps:from_list([{I,{token,I}}||I&lt;-Vs]),
<a name="1912"/> 1912: 
<a name="1913"/> 1913:     M2 = maps:map(fun(_K,V) -&gt; {token,V} end, M1),
<a name="t_maps_map-last_expr"/><a name="1914"/> 1914:     ok.
<a name="1915"/> 1915: 
<a name="t_maps_size-1"/><a name="1916"/> 1916: <b>t_maps_size</b>(_Config) -&gt;
<a name="1917"/> 1917:     Vs = lists:seq(1,100),
<a name="1918"/> 1918:     lists:foldl(fun(I,M) -&gt;
<a name="1919"/> 1919: 		M1 = maps:put(I,I,M),
<a name="1920"/> 1920: 		I  = maps:size(M1),
<a name="1921"/> 1921: 		M1
<a name="1922"/> 1922: 	end, #{}, Vs),
<a name="t_maps_size-last_expr"/><a name="1923"/> 1923:     ok.
<a name="1924"/> 1924: 
<a name="1925"/> 1925: 
<a name="t_maps_without-1"/><a name="1926"/> 1926: <b>t_maps_without</b>(_Config) -&gt;
<a name="1927"/> 1927:     Ki = [11,22,33,44,55,66,77,88,99],
<a name="1928"/> 1928:     M0 = maps:from_list([{{k,I},{v,I}}||I&lt;-lists:seq(1,100)]),
<a name="1929"/> 1929:     M1 = maps:from_list([{{k,I},{v,I}}||I&lt;-lists:seq(1,100) -- Ki]),
<a name="1930"/> 1930:     M1 = maps:without([{k,I}||I &lt;- Ki],M0),
<a name="t_maps_without-last_expr"/><a name="1931"/> 1931:     ok.
<a name="1932"/> 1932: 
<a name="1933"/> 1933: 
<a name="1934"/> 1934: <i>%% MISC</i>
<a name="t_pdict-1"/><a name="1935"/> 1935: <b>t_pdict</b>(_Config) -&gt;
<a name="1936"/> 1936: 
<a name="1937"/> 1937:     put(#{ a =&gt; b, b =&gt; a},#{ c =&gt; d}),
<a name="1938"/> 1938:     put(get(#{ a =&gt; b, b =&gt; a}),1),
<a name="1939"/> 1939:     1 = get(#{ c =&gt; d}),
<a name="t_pdict-last_expr"/><a name="1940"/> 1940: <b>    #{ c := d } = get</b>(#{ a =&gt; b, b =&gt; a}).
<a name="1941"/> 1941: 
<a name="t_ets-1"/><a name="1942"/> 1942: <b>t_ets</b>(_Config) -&gt;
<a name="1943"/> 1943: 
<a name="1944"/> 1944:     Tid = ets:new(map_table,[]),
<a name="1945"/> 1945: 
<a name="1946"/> 1946:     [ets:insert(Tid,{maps:from_list([{I,-I}]),I}) || I &lt;- lists:seq(1,100)],
<a name="1947"/> 1947: 
<a name="1948"/> 1948: 
<a name="1949"/> 1949:     [{#{ 2 := -2},2}] = ets:lookup(Tid,#{ 2 =&gt; -2 }),
<a name="1950"/> 1950: 
<a name="1951"/> 1951:     %% Test equal
<a name="1952"/> 1952:     [3,4] = lists:sort(
<a name="1953"/> 1953: 	      ets:select(Tid,[{{'$1','$2'},
<a name="1954"/> 1954: 			       [{'or',{'==','$1',#{ 3 =&gt; -3 }},
<a name="1955"/> 1955: 				 {'==','$1',#{ 4 =&gt; -4 }}}],
<a name="1956"/> 1956: 			       ['$2']}])),
<a name="1957"/> 1957:     %% Test match
<a name="1958"/> 1958:     [30,50] = lists:sort(
<a name="1959"/> 1959: 		ets:select(Tid,
<a name="1960"/> 1960: 			   [{{#{ 30 =&gt; -30}, '$1'},[],['$1']},
<a name="1961"/> 1961: 			    {{#{ 50 =&gt; -50}, '$1'},[],['$1']}]
<a name="1962"/> 1962: 			  )),
<a name="1963"/> 1963: 
<a name="1964"/> 1964:     ets:insert(Tid,{#{ a =&gt; b, b =&gt; c, c =&gt; a},transitivity}),
<a name="1965"/> 1965: 
<a name="1966"/> 1966:     %% Test equal with map of different size
<a name="1967"/> 1967:     [] = ets:select(Tid,[{{'$1','_'},[{'==','$1',#{ b =&gt; c }}],['$_']}]),
<a name="1968"/> 1968: 
<a name="1969"/> 1969:     %% Test match with map of different size
<a name="1970"/> 1970:     %%[{#{ a := b },_}] = ets:select(Tid,[{{#{ b =&gt; c },'_'},[],['$_']}]),
<a name="1971"/> 1971: 
<a name="1972"/> 1972:     %%% Test match with don't care value
<a name="1973"/> 1973:     %%[{#{ a := b },_}] = ets:select(Tid,[{{#{ b =&gt; '_' },'_'},[],['$_']}]),
<a name="1974"/> 1974: 
<a name="1975"/> 1975:     %% Test is_map bif
<a name="1976"/> 1976:     101 = length(ets:select(Tid,[{'$1',[{is_map,{element,1,'$1'}}],['$1']}])),
<a name="1977"/> 1977:     ets:insert(Tid,{not_a_map,2}),
<a name="1978"/> 1978:     101 = length(ets:select(Tid,[{'$1',[{is_map,{element,1,'$1'}}],['$1']}])),
<a name="1979"/> 1979:     ets:insert(Tid,{{nope,a,tuple},2}),
<a name="1980"/> 1980:     101 = length(ets:select(Tid,[{'$1',[{is_map,{element,1,'$1'}}],['$1']}])),
<a name="1981"/> 1981: 
<a name="1982"/> 1982:     %% Test map_size bif
<a name="1983"/> 1983:     [3] = ets:select(Tid,[{{'$1','_'},[{'==',{map_size,'$1'},3}],
<a name="1984"/> 1984: 			   [{map_size,'$1'}]}]),
<a name="1985"/> 1985: 
<a name="1986"/> 1986:     true = ets:delete(Tid,#{50 =&gt; -50}),
<a name="1987"/> 1987:     [] = ets:lookup(Tid,#{50 =&gt; -50}),
<a name="1988"/> 1988: 
<a name="1989"/> 1989:     ets:delete(Tid),
<a name="t_ets-last_expr"/><a name="1990"/> 1990:     ok.
<a name="1991"/> 1991: 
<a name="t_build_and_match_aliasing-1"/><a name="1992"/> 1992: <b>t_build_and_match_aliasing</b>(Config) when is_list(Config) -&gt;
<a name="1993"/> 1993:     M1 = id(#{a=&gt;1,b=&gt;2,c=&gt;3,d=&gt;4}),
<a name="1994"/> 1994:     #{c:=C1=_=_=C2} = M1,
<a name="1995"/> 1995:     true = C1 =:= C2,
<a name="1996"/> 1996:     #{a:=A,a:=A,a:=A,b:=B,b:=B} = M1,
<a name="1997"/> 1997:     #{a:=A,a:=A,a:=A,b:=B,b:=B,b:=2} = M1,
<a name="1998"/> 1998:     #{a:=A=1,a:=A,a:=A,b:=B=2,b:=B,b:=2} = M1,
<a name="1999"/> 1999:     #{c:=C1, c:=_, c:=3, c:=_, c:=C2} = M1,
<a name="2000"/> 2000:     #{c:=C=_=3=_=C} = M1,
<a name="2001"/> 2001: 
<a name="2002"/> 2002:     M2 = id(#{&quot;a&quot;=&gt;1,&quot;b&quot;=&gt;2,&quot;c&quot;=&gt;3,&quot;d&quot;=&gt;4}),
<a name="2003"/> 2003:     #{&quot;a&quot;:=A2,&quot;a&quot;:=A2,&quot;a&quot;:=A2,&quot;b&quot;:=B2,&quot;b&quot;:=B2,&quot;b&quot;:=2} = M2,
<a name="2004"/> 2004:     #{&quot;a&quot;:=_,&quot;a&quot;:=_,&quot;a&quot;:=_,&quot;b&quot;:=_,&quot;b&quot;:=_,&quot;b&quot;:=2} = M2,
<a name="t_build_and_match_aliasing-last_expr"/><a name="2005"/> 2005:     ok.
<a name="2006"/> 2006: 
<a name="2007"/> 2007: <i>%% simple build and match variables</i>
<a name="t_build_and_match_variables-1"/><a name="2008"/> 2008: <b>t_build_and_match_variables</b>(Config) when is_list(Config) -&gt;
<a name="2009"/> 2009:     K0 = id(#{}),
<a name="2010"/> 2010:     K1 = id(1),       V1 = id(a),
<a name="2011"/> 2011:     K2 = id(2),       V2 = id(b),
<a name="2012"/> 2012:     K3 = id(3),       V3 = id(&quot;c&quot;),
<a name="2013"/> 2013:     K4 = id(&quot;4&quot;),     V4 = id(&quot;d&quot;),
<a name="2014"/> 2014:     K5 = id(&lt;&lt;&quot;5&quot;&gt;&gt;), V5 = id(&lt;&lt;&quot;e&quot;&gt;&gt;),
<a name="2015"/> 2015:     K6 = id({&quot;6&quot;,7}), V6 = id(&quot;f&quot;),
<a name="2016"/> 2016:     K7 = id(#{ &quot;a&quot; =&gt; 3 }),
<a name="2017"/> 2017:     #{K1:=V1} = id(#{K1=&gt;V1}),
<a name="2018"/> 2018:     #{K1:=V1,K2:=V2} = id(#{K1=&gt;V1,K2=&gt;V2}),
<a name="2019"/> 2019:     #{K1:=V1,K2:=V2,K3:=V3} = id(#{K1=&gt;V1,K2=&gt;V2,K3=&gt;V3}),
<a name="2020"/> 2020:     #{K1:=V1,K2:=V2,K3:=V3,K4:=V4} = id(#{K1=&gt;V1,K2=&gt;V2,K3=&gt;V3,K4=&gt;V4}),
<a name="2021"/> 2021:     #{K1:=V1,K2:=V2,K3:=V3,K4:=V4,K5:=V5} = id(#{K1=&gt;V1,K2=&gt;V2,K3=&gt;V3,K4=&gt;V4,K5=&gt;V5}),
<a name="2022"/> 2022:     #{K1:=V1,K2:=V2,K3:=V3,K4:=V4,K5:=V5,K6:=V6} = id(#{K1=&gt;V1,K2=&gt;V2,K3=&gt;V3,K4=&gt;V4,K5=&gt;V5,K6=&gt;V6}),
<a name="2023"/> 2023: 
<a name="2024"/> 2024:     #{K5:=X,K5:=X=3,K4:=4} = id(#{K5=&gt;3,K4=&gt;4}),
<a name="2025"/> 2025:     #{K5:=X,&lt;&lt;&quot;5&quot;&gt;&gt;:=X=3,K4:=4} = id(#{K5=&gt;3,K4=&gt;4}),
<a name="2026"/> 2026:     #{K5:=X,&lt;&lt;&quot;5&quot;&gt;&gt;:=X=3,K4:=4} = id(#{&lt;&lt;&quot;5&quot;&gt;&gt;=&gt;3,K4=&gt;4}),
<a name="2027"/> 2027: 
<a name="2028"/> 2028:     #{ K4:=#{ K3:=#{K1:=V1, K2:=V2}}, K5:=V5} =
<a name="2029"/> 2029: 	id(#{ K5=&gt;V5, K4=&gt;#{ K3=&gt;#{K2 =&gt; V2, K1 =&gt; V1}}}),
<a name="2030"/> 2030:     #{ K4 := #{ K5 := Res }, K6 := Res} = id(#{K4=&gt;#{K5 =&gt; 99}, K6 =&gt; 99}),
<a name="2031"/> 2031: 
<a name="2032"/> 2032:     %% has keys
<a name="2033"/> 2033:     #{a :=_,b :=_,K1:=_,K2:=_,K3:=V3,K4:=ResKey,K4:=ResKey,&quot;4&quot;:=ResKey,&quot;4&quot;:=&quot;ok&quot;} =
<a name="2034"/> 2034: 	id(#{ a=&gt;1, b=&gt;1, K1=&gt;V1, K2=&gt;V2, K3=&gt;V3, K4=&gt;&quot;nope&quot;, &quot;4&quot;=&gt;&quot;ok&quot; }),
<a name="2035"/> 2035: 
<a name="2036"/> 2036:     %% function
<a name="2037"/> 2037:     ok = match_function_map_neg_keys(#{ -1 =&gt; a, -2 =&gt; b, -3 =&gt; c }),
<a name="2038"/> 2038: 
<a name="2039"/> 2039:     %% map key
<a name="2040"/> 2040:     #{ K0 := 42 } = id(#{ K0 =&gt; 42 }),
<a name="2041"/> 2041:     #{ K7 := 42 } = id(#{ K7 =&gt; 42 }),
<a name="2042"/> 2042: 
<a name="2043"/> 2043:     %% nil key
<a name="2044"/> 2044:     KNIL = id([]),
<a name="2045"/> 2045:     #{KNIL:=ok,1:=2} = id(#{KNIL=&gt;ok,1=&gt;2}),
<a name="2046"/> 2046: 
<a name="2047"/> 2047:     Bin = &lt;&lt;0:258&gt;&gt;,
<a name="2048"/> 2048:     #{ Bin := &quot;three&quot; } = id(#{&lt;&lt;0:258&gt;&gt; =&gt;&quot;three&quot;}),
<a name="2049"/> 2049: 
<a name="2050"/> 2050:     %% error case
<a name="2051"/> 2051:     {'EXIT',{{badmatch,_},_}} = (catch (#{K5:=3,x:=2} = id(#{K5=&gt;3}))),
<a name="2052"/> 2052:     {'EXIT',{{badmatch,_},_}} = (catch (#{K5:=2} = id(#{K5=&gt;3}))),
<a name="2053"/> 2053:     {'EXIT',{{badmatch,_},_}} = (catch (#{K5:=3} = id({a,b,c}))),
<a name="2054"/> 2054:     {'EXIT',{{badmatch,_},_}} = (catch (#{K5:=3} = id(#{K6=&gt;3}))),
<a name="2055"/> 2055:     {'EXIT',{{badmatch,_},_}} = (catch (#{K5:=3} = id(K7))),
<a name="2056"/> 2056:     {'EXIT',{{badmatch,_},_}} = (catch (#{K7:=3} = id(#{K7=&gt;42}))),
<a name="t_build_and_match_variables-last_expr"/><a name="2057"/> 2057:     ok.
<a name="2058"/> 2058: 
<a name="2059"/> 2059: 
<a name="match_function_map_neg_keys-1"/><a name="match_function_map_neg_keys-last_expr"/><a name="2060"/> 2060: <b>match_function_map_neg_keys</b>(#{ -1 := a, -2 := b, -3 := c }) -&gt; ok.
<a name="2061"/> 2061: 
<a name="t_update_assoc_variables-1"/><a name="2062"/> 2062: <b>t_update_assoc_variables</b>(Config) when is_list(Config) -&gt;
<a name="2063"/> 2063:     K1 = id(1),
<a name="2064"/> 2064:     K2 = id(2),
<a name="2065"/> 2065:     K3 = id(3.0),
<a name="2066"/> 2066:     K4 = id(4),
<a name="2067"/> 2067:     K5 = id(5),
<a name="2068"/> 2068:     K6 = id(2.0),
<a name="2069"/> 2069: 
<a name="2070"/> 2070:     M0 = #{K1=&gt;a,K2=&gt;b,K3=&gt;c,K4=&gt;d,K5=&gt;e},
<a name="2071"/> 2071: 
<a name="2072"/> 2072:     M1 = M0#{K1=&gt;42,K2=&gt;100,K4=&gt;[a,b,c]},
<a name="2073"/> 2073:     #{1:=42,2:=100,3.0:=c,4:=[a,b,c],5:=e} = M1,
<a name="2074"/> 2074:     #{1:=42,2:=b,4:=d,5:=e,2.0:=100,K3:=c,4.0:=[a,b,c]} = M0#{1.0=&gt;float,1:=42,2.0=&gt;wrong,K6=&gt;100,4.0=&gt;[a,b,c]},
<a name="2075"/> 2075: 
<a name="2076"/> 2076:     M2 = M0#{K3=&gt;new},
<a name="2077"/> 2077:     #{1:=a,2:=b,K3:=new,4:=d,5:=e} = M2,
<a name="2078"/> 2078:     M2 = M0#{3.0:=wrong,K3=&gt;new},
<a name="2079"/> 2079: 
<a name="2080"/> 2080:     #{ &lt;&lt;0:258&gt;&gt; := val } = id(M0#{&lt;&lt;0:258&gt;&gt; =&gt; val}), %% binary limitation
<a name="2081"/> 2081: 
<a name="2082"/> 2082:     %% Errors cases.
<a name="2083"/> 2083:     BadMap = id(a_bad_map),
<a name="2084"/> 2084:     {'EXIT',{{badmap,BadMap},_}} = (catch BadMap#{nonexisting=&gt;val}),
<a name="2085"/> 2085:     {'EXIT',{{badmap,&lt;&lt;&gt;&gt;},_}} = (catch &lt;&lt;&gt;&gt;#{nonexisting=&gt;val}),
<a name="t_update_assoc_variables-last_expr"/><a name="2086"/> 2086:     ok.
<a name="2087"/> 2087: 
<a name="t_update_exact_variables-1"/><a name="2088"/> 2088: <b>t_update_exact_variables</b>(Config) when is_list(Config) -&gt;
<a name="2089"/> 2089:     K1 = id(1),
<a name="2090"/> 2090:     K2 = id(2),
<a name="2091"/> 2091:     K3 = id(3.0),
<a name="2092"/> 2092:     K4 = id(4),
<a name="2093"/> 2093: 
<a name="2094"/> 2094:     M0 = id(#{1=&gt;a,2=&gt;b,3.0=&gt;c,4=&gt;d,5=&gt;e}),
<a name="2095"/> 2095: 
<a name="2096"/> 2096:     M1 = M0#{K1:=42,K2:=100,K4:=[a,b,c]},
<a name="2097"/> 2097:     #{1:=42,2:=100,3.0:=c,K4:=[a,b,c],5:=e} = M1,
<a name="2098"/> 2098:     M1 = M0#{K1:=wrong,1:=also_wrong,K1=&gt;42,2=&gt;wrong,K2:=100,4:=[a,b,c]},
<a name="2099"/> 2099: 
<a name="2100"/> 2100:     M2 = M0#{K3:=new},
<a name="2101"/> 2101:     #{1:=a,K2:=b,3.0:=new,K4:=d,5:=e} = M2,
<a name="2102"/> 2102:     M2 = M0#{3.0=&gt;wrong,K3:=new},
<a name="2103"/> 2103:     true = M2 =/= M0#{3=&gt;right,3.0:=new},
<a name="2104"/> 2104:     #{ 3 := right, 3.0 := new } = M0#{3=&gt;right,K3:=new},
<a name="2105"/> 2105: 
<a name="2106"/> 2106:     M3 = id(#{ 1 =&gt; val}),
<a name="2107"/> 2107:     #{1 := update2,1.0 := new_val4} = M3#{
<a name="2108"/> 2108: 	1.0 =&gt; new_val1, K1 := update, K1=&gt; update3,
<a name="2109"/> 2109: 	K1 := update2, 1.0 := new_val2, 1.0 =&gt; new_val3,
<a name="2110"/> 2110: 	1.0 =&gt; new_val4 },
<a name="2111"/> 2111: 
<a name="2112"/> 2112:     %% Errors cases.
<a name="2113"/> 2113:     {'EXIT',{{badmap,_},_}} = (catch ((id(nil))#{ a := b })),
<a name="2114"/> 2114:     {'EXIT',{{badmap,_},_}} = (catch &lt;&lt;&gt;&gt;#{nonexisting:=val}),
<a name="2115"/> 2115: 
<a name="2116"/> 2116:     {'EXIT',{{badkey,nonexisting},_}} = (catch M0#{nonexisting:=val}),
<a name="2117"/> 2117:     {'EXIT',{{badkey,1.0},_}} = (catch M0#{1.0:=v,1.0=&gt;v2}),
<a name="2118"/> 2118:     {'EXIT',{{badkey,_},_}} = (catch M0#{42.0:=v,42:=v2}),
<a name="2119"/> 2119:     {'EXIT',{{badkey,_},_}} = (catch M0#{42=&gt;v1,42.0:=v2,42:=v3}),
<a name="2120"/> 2120:     {'EXIT',{{badkey,_},_}} = (catch M0#{&lt;&lt;0:257&gt;&gt; := val}), %% limitation
<a name="t_update_exact_variables-last_expr"/><a name="2121"/> 2121:     ok.
<a name="2122"/> 2122: 
<a name="t_nested_pattern_expressions-1"/><a name="2123"/> 2123: <b>t_nested_pattern_expressions</b>(Config) when is_list(Config) -&gt;
<a name="2124"/> 2124:     K1 = id(&quot;hello&quot;),
<a name="2125"/> 2125:     %% K2 = id({ok}),
<a name="2126"/> 2126:     [_,_,#{ &lt;&lt;&quot;hi&quot;&gt;&gt; := wat, K1 := 42 }|_] = id([k,k,#{&lt;&lt;&quot;hi&quot;&gt;&gt; =&gt; wat, K1 =&gt; 42}]),
<a name="2127"/> 2127:     [_,_,#{ -1 := wat, K1 := 42 }|_] = id([k,k,#{-1 =&gt; wat, K1 =&gt; 42}]),
<a name="2128"/> 2128:     [_,_,{#{ -1 := #{ {-3,&lt;&lt;0:300&gt;&gt;} := V1 }, K1 := 42 },3}|_] = id([k,k,{#{-1 =&gt; #{{-3,&lt;&lt;0:300&gt;&gt;}=&gt;&quot;hi&quot;}, K1 =&gt; 42},3}]),
<a name="2129"/> 2129:     &quot;hi&quot; = V1,
<a name="2130"/> 2130:     %%[k,#{ {-1,K1,[]} := {wat,K1}, K2 := 42 }|_] = id([k,#{{-1,K1,[]} =&gt; {wat,K1}, K2 =&gt; 42}]),
<a name="2131"/> 2131:     %%[k,#{ [-1,K2,[]] := {wat,K1}, K1 := 42 }|_] = id([k,#{[-1,K2,[]] =&gt; {wat,K1}, K1 =&gt; 42}]),
<a name="t_nested_pattern_expressions-last_expr"/><a name="2132"/> 2132:     ok.
<a name="2133"/> 2133: 
<a name="t_guard_update_variables-1"/><a name="2134"/> 2134: <b>t_guard_update_variables</b>(Config) when is_list(Config) -&gt;
<a name="2135"/> 2135:     error  = map_guard_update_variables(n,#{},#{}),
<a name="2136"/> 2136:     first  = map_guard_update_variables(x,#{}, #{x=&gt;first}),
<a name="2137"/> 2137:     second = map_guard_update_variables(x,#{y=&gt;old}, #{x=&gt;second,y=&gt;old}),
<a name="2138"/> 2138:     third  = map_guard_update_variables(x,#{x=&gt;old,y=&gt;old}, #{x=&gt;third,y=&gt;old}),
<a name="2139"/> 2139:     fourth = map_guard_update_variables(x,#{x=&gt;old,y=&gt;old}, #{x=&gt;4,y=&gt;new}),
<a name="t_guard_update_variables-last_expr"/><a name="2140"/> 2140:     ok.
<a name="2141"/> 2141: 
<a name="map_guard_update_variables-3"/><a name="2142"/> 2142: <b>map_guard_update_variables</b>(K,M1,M2) when M1#{K=&gt;first}    =:= M2 -&gt; first;
<a name="2143"/> 2143: <b>map_guard_update_variables</b>(K,M1,M2) when M1#{K=&gt;second}   =:= M2 -&gt; second;
<a name="2144"/> 2144: <b>map_guard_update_variables</b>(K,M1,M2) when M1#{K:=third}    =:= M2 -&gt; third;
<a name="2145"/> 2145: <b>map_guard_update_variables</b>(K,M1,M2) when M1#{K:=4,y=&gt;new} =:= M2 -&gt; fourth;
<a name="map_guard_update_variables-last_expr"/><a name="2146"/> 2146: <b>map_guard_update_variables</b>(_,_,_) -&gt; error.
<a name="2147"/> 2147: 
<a name="t_guard_sequence_variables-1"/><a name="2148"/> 2148: <b>t_guard_sequence_variables</b>(Config) when is_list(Config) -&gt;
<a name="2149"/> 2149:     {1,&quot;a&quot;} = map_guard_sequence_var_1(a,#{seq=&gt;1,a=&gt;id(&quot;a&quot;),b=&gt;no}),
<a name="2150"/> 2150:     {2,&quot;b&quot;} = map_guard_sequence_var_1(b,#{seq=&gt;2,b=&gt;id(&quot;b&quot;),a=&gt;no}),
<a name="2151"/> 2151:     {3,&quot;c&quot;} = map_guard_sequence_var_1(a,#{seq=&gt;3,a=&gt;id(&quot;c&quot;),b=&gt;no}),
<a name="2152"/> 2152:     {4,&quot;d&quot;} = map_guard_sequence_var_1(b,#{seq=&gt;4,b=&gt;id(&quot;d&quot;),a=&gt;no}),
<a name="2153"/> 2153:     {4,4}   = map_guard_sequence_var_1(seq,#{seq=&gt;4}),
<a name="2154"/> 2154:     {4,4,y} = map_guard_sequence_var_1(seq,#{seq=&gt;4,b=&gt;id(&quot;d&quot;),a=&gt;y}),
<a name="2155"/> 2155:     {5,&quot;d&quot;} = map_guard_sequence_var_1(b,#{seq=&gt;5,b=&gt;id(&quot;d&quot;),a=&gt;y}),
<a name="2156"/> 2156: 
<a name="2157"/> 2157:     %% error case
<a name="2158"/> 2158:     {'EXIT',{{case_clause,_},_}} = (catch map_guard_sequence_var_1(&quot;a&quot;,#{seq=&gt;4,val=&gt;id(&quot;e&quot;)})),
<a name="t_guard_sequence_variables-last_expr"/><a name="2159"/> 2159:     ok.
<a name="2160"/> 2160: 
<a name="2161"/> 2161: 
<a name="map_guard_sequence_var_1-2"/><a name="2162"/> 2162: <b>map_guard_sequence_var_1</b>(K,M) -&gt;
<a name="map_guard_sequence_var_1-last_expr"/><a name="2163"/> 2163:     case M of
<a name="2164"/> 2164: 	#{seq:=1=Seq, K:=Val} -&gt; {Seq,Val};
<a name="2165"/> 2165: 	#{seq:=2=Seq, K:=Val} -&gt; {Seq,Val};
<a name="2166"/> 2166: 	#{seq:=3=Seq, K:=Val} -&gt; {Seq,Val};
<a name="2167"/> 2167: 	#{K:=4=Seq,   K:=Val1,a:=Val2} -&gt; {Seq,Val1,Val2};
<a name="2168"/> 2168: 	#{seq:=4=Seq, K:=Val} -&gt; {Seq,Val};
<a name="2169"/> 2169: 	#{K:=4=Seq,   K:=Val} -&gt; {Seq,Val};
<a name="2170"/> 2170: 	#{seq:=5=Seq, K:=Val} -&gt; {Seq,Val}
<a name="2171"/> 2171:     end.
<a name="2172"/> 2172: 
<a name="2173"/> 2173: 
<a name="t_guard_sequence_mixed-1"/><a name="2174"/> 2174: <b>t_guard_sequence_mixed</b>(Config) when is_list(Config) -&gt;
<a name="2175"/> 2175:     M0 = id(#{ a=&gt;1, b=&gt;1, c=&gt;1, d=&gt;1, e=&gt;1, f=&gt;1, g=&gt;1, h=&gt;1 }),
<a name="2176"/> 2176:     M1 = id(M0#{ d := 3 }),
<a name="2177"/> 2177:     1 = map_guard_sequence_mixed(a,d,M1),
<a name="2178"/> 2178:     M2 = id(M1#{ b := 2, d := 4, h := 2 }),
<a name="2179"/> 2179:     2 = map_guard_sequence_mixed(a,d,M2),
<a name="2180"/> 2180:     M3 = id(M2#{ b := 3, e := 5, g := 3 }),
<a name="2181"/> 2181:     3 = map_guard_sequence_mixed(a,e,M3),
<a name="2182"/> 2182:     M4 = id(M3#{ c := 4, e := 6, h := 1 }),
<a name="2183"/> 2183:     4 = map_guard_sequence_mixed(a,e,M4),
<a name="2184"/> 2184:     M5 = id(M4#{ c := 5, f := 7, g := 2 }),
<a name="2185"/> 2185:     5 = map_guard_sequence_mixed(a,f,M5),
<a name="2186"/> 2186:     M6 = id(M5#{ c := 6, f := 8, h := 3 }),
<a name="2187"/> 2187:     6 = map_guard_sequence_mixed(a,f,M6),
<a name="2188"/> 2188: 
<a name="2189"/> 2189:     %% error case
<a name="2190"/> 2190:     {'EXIT',{{case_clause,_},_}} = (catch map_guard_sequence_mixed(a,b,M0)),
<a name="t_guard_sequence_mixed-last_expr"/><a name="2191"/> 2191:     ok.
<a name="2192"/> 2192: 
<a name="map_guard_sequence_mixed-3"/><a name="2193"/> 2193: <b>map_guard_sequence_mixed</b>(K1,K2,M) -&gt;
<a name="map_guard_sequence_mixed-last_expr"/><a name="2194"/> 2194:     case M of
<a name="2195"/> 2195: 	#{ K1 := 1, b := 1, K2 := 3, g := 1} -&gt; 1;
<a name="2196"/> 2196: 	#{ K1 := 1, b := 2, K2 := 4, h := 2} -&gt; 2;
<a name="2197"/> 2197: 	#{ K1 := 1, b := 3, K2 := 5, g := 3} -&gt; 3;
<a name="2198"/> 2198: 	#{ K1 := 1, c := 4, K2 := 6, h := 1} -&gt; 4;
<a name="2199"/> 2199: 	#{ K1 := 1, c := 5, K2 := 7, g := 2} -&gt; 5;
<a name="2200"/> 2200: 	#{ K1 := 1, c := 6, K2 := 8, h := 3} -&gt; 6
<a name="2201"/> 2201:     end.
<a name="2202"/> 2202: 
<a name="2203"/> 2203: 
<a name="2204"/> 2204: 
<a name="t_frequency_table-1"/><a name="2205"/> 2205: <b>t_frequency_table</b>(Config) when is_list(Config) -&gt;
<a name="2206"/> 2206:     rand:seed(exsplus, {13,1337,54}),		% pseudo random
<a name="2207"/> 2207:     N = 1000,
<a name="2208"/> 2208:     Ts = rand_terms(N),
<a name="2209"/> 2209:     #{ n:=N, tf := Tf } = frequency_table(Ts,#{ n=&gt;0, tf =&gt; #{}}),
<a name="2210"/> 2210:     ok = check_frequency(Ts,Tf),
<a name="t_frequency_table-last_expr"/><a name="2211"/> 2211:     ok.
<a name="2212"/> 2212: 
<a name="2213"/> 2213: 
<a name="frequency_table-2"/><a name="2214"/> 2214: <b>frequency_table</b>([T|Ts], M) -&gt;
<a name="2215"/> 2215:     case M of
<a name="2216"/> 2216: 	#{ n := N, tf := #{ T := C } = F } -&gt;
<a name="2217"/> 2217: 	    frequency_table(Ts,M#{ n := N + 1, tf := F#{ T := C + 1 }});
<a name="2218"/> 2218: 	#{ n := N, tf := F } -&gt;
<a name="2219"/> 2219: 	    frequency_table(Ts,M#{ n := N + 1, tf := F#{ T =&gt; 1 }})
<a name="2220"/> 2220:     end;
<a name="frequency_table-last_expr"/><a name="2221"/> 2221: <b>frequency_table</b>([], M) -&gt; M.
<a name="2222"/> 2222: 
<a name="2223"/> 2223: 
<a name="check_frequency-2"/><a name="2224"/> 2224: <b>check_frequency</b>(Ts,Tf) -&gt;
<a name="check_frequency-last_expr"/><a name="2225"/> 2225: <b>    check_frequency</b>(Ts,Tf,dict:new()).
<a name="2226"/> 2226: 
<a name="check_frequency-3"/><a name="2227"/> 2227: <b>check_frequency</b>([T|Ts],Tf,D) -&gt;
<a name="2228"/> 2228:     case dict:find(T,D) of
<a name="2229"/> 2229: 	error  -&gt; check_frequency(Ts,Tf,dict:store(T,1,D));
<a name="2230"/> 2230: 	{ok,C} -&gt; check_frequency(Ts,Tf,dict:store(T,C+1,D))
<a name="2231"/> 2231:     end;
<a name="2232"/> 2232: <b>check_frequency</b>([],Tf,D) -&gt;
<a name="check_frequency-last_expr"/><a name="2233"/> 2233: <b>    validate_frequency</b>(dict:to_list(D),Tf).
<a name="2234"/> 2234: 
<a name="validate_frequency-2"/><a name="2235"/> 2235: <b>validate_frequency</b>([{T,C}|Fs],Tf) -&gt;
<a name="2236"/> 2236:     case Tf of
<a name="2237"/> 2237: 	#{ T := C } -&gt; validate_frequency(Fs,Tf);
<a name="2238"/> 2238: 	_ -&gt; error
<a name="2239"/> 2239:     end;
<a name="validate_frequency-last_expr"/><a name="2240"/> 2240: <b>validate_frequency</b>([], _) -&gt; ok.
<a name="2241"/> 2241: 
<a name="t_key_expressions-1"/><a name="2242"/> 2242: <b>t_key_expressions</b>(_Config) -&gt;
<a name="2243"/> 2243:     Int = id(42),
<a name="2244"/> 2244:     #{{tag,Int} := 42} = id(#{{tag,Int} =&gt; 42}),
<a name="2245"/> 2245:     #{{tag,Int+1} := 42} = id(#{{tag,Int+1} =&gt; 42}),
<a name="2246"/> 2246:     #{{a,b} := x, {tag,Int} := 42, Int := 0} =
<a name="2247"/> 2247:         id(#{{a,b} =&gt; x, {tag,Int} =&gt; 42, Int =&gt; 0}),
<a name="2248"/> 2248: 
<a name="2249"/> 2249:     F1 = fun(#{Int + 1 := Val}) -&gt; Val end,
<a name="2250"/> 2250:     val = F1(#{43 =&gt; val}),
<a name="2251"/> 2251:     {'EXIT',_} = (catch F1(a)),
<a name="2252"/> 2252: 
<a name="2253"/> 2253:     F2 = fun(M, X, Y) -&gt;
<a name="2254"/> 2254:                  case M of
<a name="2255"/> 2255:                      #{element(X, Y) := &lt;&lt;Sz:16,Bin:Sz/binary&gt;&gt;} -&gt;
<a name="2256"/> 2256:                          Bin;
<a name="2257"/> 2257:                      #{} -&gt;
<a name="2258"/> 2258:                          not_found;
<a name="2259"/> 2259:                      {A,B} -&gt;
<a name="2260"/> 2260:                          A + B
<a name="2261"/> 2261:                  end
<a name="2262"/> 2262:          end,
<a name="2263"/> 2263:     &lt;&lt;&quot;xyz&quot;&gt;&gt; = F2(#{b =&gt; &lt;&lt;3:16,&quot;xyz&quot;&gt;&gt;}, 2, {a,b,c}),
<a name="2264"/> 2264:     not_found = F2(#{b =&gt; &lt;&lt;3:16,&quot;xyz&quot;&gt;&gt;}, 999, {a,b,c}),
<a name="2265"/> 2265:     13 = F2({6,7}, 1, 2),
<a name="2266"/> 2266: 
<a name="2267"/> 2267:     #{&lt;&lt;&quot;Спутник&quot;/utf8&gt;&gt; := 1} = id(#{&lt;&lt;&quot;Спутник&quot;/utf8&gt;&gt; =&gt; 1}),
<a name="2268"/> 2268: 
<a name="2269"/> 2269:     F3 = fun(Arg) -&gt;
<a name="2270"/> 2270:                  erase(once),
<a name="2271"/> 2271:                  RunOnce = fun(I) -&gt;
<a name="2272"/> 2272:                                    undefined = put(once, twice),
<a name="2273"/> 2273:                                    id(I)
<a name="2274"/> 2274:                            end,
<a name="2275"/> 2275:                  case RunOnce(Arg) of
<a name="2276"/> 2276:                      #{{tag,&lt;&lt;Int:42&gt;&gt;} := Value} -&gt; Value;
<a name="2277"/> 2277:                      {X,Y} -&gt; X + Y
<a name="2278"/> 2278:                  end
<a name="2279"/> 2279:          end,
<a name="2280"/> 2280:     10 = F3({7,3}),
<a name="2281"/> 2281:     whatever = F3(#{{tag,&lt;&lt;Int:42&gt;&gt;} =&gt; whatever}),
<a name="2282"/> 2282: 
<a name="t_key_expressions-last_expr"/><a name="2283"/> 2283:     ok.
<a name="2284"/> 2284: 
<a name="2285"/> 2285: <i>%% aux</i>
<a name="2286"/> 2286: 
<a name="rand_terms-1"/><a name="2287"/> 2287: <b>rand_terms</b>(0) -&gt; [];
<a name="rand_terms-last_expr"/><a name="2288"/> 2288: <b>rand_terms</b>(N) -&gt; [rand_term()|rand_terms(N-1)].
<a name="2289"/> 2289: 
<a name="rand_term-0"/><a name="2290"/> 2290: <b>rand_term</b>() -&gt;
<a name="rand_term-last_expr"/><a name="2291"/> 2291: <b>    case rand:uniform</b>(6) of
<a name="2292"/> 2292: 	1 -&gt; rand_binary();
<a name="2293"/> 2293: 	2 -&gt; rand_number();
<a name="2294"/> 2294: 	3 -&gt; rand_atom();
<a name="2295"/> 2295: 	4 -&gt; rand_tuple();
<a name="2296"/> 2296: 	5 -&gt; rand_list();
<a name="2297"/> 2297: 	6 -&gt; rand_map()
<a name="2298"/> 2298:     end.
<a name="2299"/> 2299: 
<a name="rand_binary-0"/><a name="2300"/> 2300: <b>rand_binary</b>() -&gt;
<a name="rand_binary-last_expr"/><a name="2301"/> 2301: <b>    case rand:uniform</b>(3) of
<a name="2302"/> 2302: 	1 -&gt; &lt;&lt;&gt;&gt;;
<a name="2303"/> 2303: 	2 -&gt; &lt;&lt;&quot;hi&quot;&gt;&gt;;
<a name="2304"/> 2304: 	3 -&gt; &lt;&lt;&quot;message text larger than 64 bytes. yep, message text larger than 64 bytes.&quot;&gt;&gt;
<a name="2305"/> 2305:     end.
<a name="2306"/> 2306: 
<a name="rand_number-0"/><a name="2307"/> 2307: <b>rand_number</b>() -&gt;
<a name="rand_number-last_expr"/><a name="2308"/> 2308: <b>    case rand:uniform</b>(3) of
<a name="2309"/> 2309: 	1 -&gt; rand:uniform(5);
<a name="2310"/> 2310: 	2 -&gt; float(rand:uniform(5));
<a name="2311"/> 2311: 	3 -&gt; 1 bsl (63 + rand:uniform(3))
<a name="2312"/> 2312:     end.
<a name="2313"/> 2313: 
<a name="rand_atom-0"/><a name="2314"/> 2314: <b>rand_atom</b>() -&gt;
<a name="rand_atom-last_expr"/><a name="2315"/> 2315: <b>    case rand:uniform</b>(3) of
<a name="2316"/> 2316: 	1 -&gt; hi;
<a name="2317"/> 2317: 	2 -&gt; some_atom;
<a name="2318"/> 2318: 	3 -&gt; some_other_atom
<a name="2319"/> 2319:     end.
<a name="2320"/> 2320: 
<a name="2321"/> 2321: 
<a name="rand_tuple-0"/><a name="2322"/> 2322: <b>rand_tuple</b>() -&gt;
<a name="rand_tuple-last_expr"/><a name="2323"/> 2323: <b>    case rand:uniform</b>(3) of
<a name="2324"/> 2324: 	1 -&gt; {ok, rand_term()}; % careful
<a name="2325"/> 2325: 	2 -&gt; {1, 2, 3};
<a name="2326"/> 2326: 	3 -&gt; {&lt;&lt;&quot;yep&quot;&gt;&gt;, 1337}
<a name="2327"/> 2327:     end.
<a name="2328"/> 2328: 
<a name="rand_list-0"/><a name="2329"/> 2329: <b>rand_list</b>() -&gt;
<a name="rand_list-last_expr"/><a name="2330"/> 2330: <b>    case rand:uniform</b>(3) of
<a name="2331"/> 2331: 	1 -&gt; &quot;hi&quot;;
<a name="2332"/> 2332: 	2 -&gt; [1,rand_term()]; % careful
<a name="2333"/> 2333: 	3 -&gt; [improper|list]
<a name="2334"/> 2334:     end.
<a name="2335"/> 2335: 
<a name="rand_map-0"/><a name="2336"/> 2336: <b>rand_map</b>() -&gt;
<a name="rand_map-last_expr"/><a name="2337"/> 2337: <b>    case rand:uniform</b>(3) of
<a name="2338"/> 2338: 	1 -&gt; #{ hi =&gt; 3 };
<a name="2339"/> 2339: 	2 -&gt; #{ wat =&gt; rand_term(), other =&gt; 3 };  % careful
<a name="2340"/> 2340: 	3 -&gt; #{ hi =&gt; 42, other =&gt; 42, yet_anoter =&gt; 1337 }
<a name="2341"/> 2341:     end.
<a name="2342"/> 2342: 
<a name="2343"/> 2343: 
<a name="t_build_and_match_over_alloc-1"/><a name="2344"/> 2344: <b>t_build_and_match_over_alloc</b>(Config) when is_list(Config) -&gt;
<a name="2345"/> 2345:     Ls = id([1,2,3]),
<a name="2346"/> 2346:     V0 = [a|Ls],
<a name="2347"/> 2347:     M0 = id(#{ &quot;a&quot; =&gt; V0 }),
<a name="2348"/> 2348:     #{ &quot;a&quot; := V1 } = M0,
<a name="2349"/> 2349:     V2 = id([c|Ls]),
<a name="2350"/> 2350:     M2 = id(#{ &quot;a&quot; =&gt; V2 }),
<a name="2351"/> 2351:     #{ &quot;a&quot; := V3 } = M2,
<a name="2352"/> 2352:     {[a,1,2,3],[c,1,2,3]} = id({V1,V3}),
<a name="t_build_and_match_over_alloc-last_expr"/><a name="2353"/> 2353:     ok.
<a name="2354"/> 2354: 
<a name="t_build_and_match_empty_val-1"/><a name="2355"/> 2355: <b>t_build_and_match_empty_val</b>(Config) when is_list(Config) -&gt;
<a name="2356"/> 2356:     F = fun(#{ &quot;hi&quot;:=_,{1,2}:=_,1337:=_}) -&gt; ok end,
<a name="2357"/> 2357:     ok = F(id(#{&quot;hi&quot;=&gt;ok,{1,2}=&gt;ok,1337=&gt;ok})),
<a name="2358"/> 2358: 
<a name="2359"/> 2359:     %% error case
<a name="t_build_and_match_empty_val-last_expr"/><a name="2360"/> 2360: <b>    case </b>(catch (F(id(#{&quot;hi&quot;=&gt;ok})))) of
<a name="2361"/> 2361: 	{'EXIT',{function_clause,_}} -&gt; ok;
<a name="2362"/> 2362: 	{'EXIT', {{case_clause,_},_}} -&gt; {comment,inlined};
<a name="2363"/> 2363: 	Other -&gt;
<a name="2364"/> 2364: 	    ct:fail({no_match, Other})
<a name="2365"/> 2365:     end.
<a name="2366"/> 2366: 
<a name="t_build_and_match_val-1"/><a name="2367"/> 2367: <b>t_build_and_match_val</b>(Config) when is_list(Config) -&gt;
<a name="2368"/> 2368:     F = fun
<a name="2369"/> 2369: 	(#{ &quot;hi&quot; := first,  v := V}) -&gt; {1,V};
<a name="2370"/> 2370: 	(#{ &quot;hi&quot; := second, v := V}) -&gt; {2,V}
<a name="2371"/> 2371:     end,
<a name="2372"/> 2372: 
<a name="2373"/> 2373: 
<a name="2374"/> 2374:     {1,&quot;hello&quot;}  = F(id(#{&quot;hi&quot;=&gt;first,v=&gt;&quot;hello&quot;})),
<a name="2375"/> 2375:     {2,&quot;second&quot;} = F(id(#{&quot;hi&quot;=&gt;second,v=&gt;&quot;second&quot;})),
<a name="2376"/> 2376: 
<a name="2377"/> 2377:     %% error case
<a name="t_build_and_match_val-last_expr"/><a name="2378"/> 2378: <b>    case </b>(catch (F(id(#{&quot;hi&quot;=&gt;ok})))) of
<a name="2379"/> 2379: 	{'EXIT',{function_clause,_}} -&gt; ok;
<a name="2380"/> 2380: 	{'EXIT', {{case_clause,_},_}} -&gt; {comment,inlined};
<a name="2381"/> 2381: 	Other -&gt;
<a name="2382"/> 2382: 	    ct:fail({no_match, Other})
<a name="2383"/> 2383:     end.
<a name="2384"/> 2384: 
<a name="t_build_and_match_nil-1"/><a name="2385"/> 2385: <b>t_build_and_match_nil</b>(Config) when is_list(Config) -&gt;
<a name="2386"/> 2386:     %% literals removed the coverage
<a name="2387"/> 2387:     V1 = id(cookie),
<a name="2388"/> 2388:     V2 = id(cake),
<a name="2389"/> 2389:     V3 = id(crisps),
<a name="2390"/> 2390: 
<a name="2391"/> 2391:     #{ [] := V1, &quot;treat&quot; := V2, {your,treat} := V3 } = id(#{
<a name="2392"/> 2392: 	    {your,treat} =&gt; V3,
<a name="2393"/> 2393: 	    &quot;treat&quot; =&gt; V2, 
<a name="2394"/> 2394: 	    [] =&gt; V1 }),
<a name="2395"/> 2395:     #{ [] := V3, [] := V3 } = id(#{ [] =&gt; V1, [] =&gt; V3 }),
<a name="t_build_and_match_nil-last_expr"/><a name="2396"/> 2396:     ok.
<a name="2397"/> 2397: 
<a name="t_build_and_match_structure-1"/><a name="2398"/> 2398: <b>t_build_and_match_structure</b>(Config) when is_list(Config) -&gt;
<a name="2399"/> 2399:     V2 = id(&quot;it&quot;),
<a name="2400"/> 2400:     S = id([42,{&quot;hi&quot;, &quot;=)&quot;, #{ &quot;a&quot; =&gt; 42, any =&gt; any, val =&gt; &quot;get_&quot; ++ V2}}]),
<a name="2401"/> 2401: 
<a name="2402"/> 2402:     %% match deep map values
<a name="2403"/> 2403:     V2 = case S of
<a name="2404"/> 2404: 	[42,{&quot;hi&quot;,_, #{ &quot;a&quot; := 42, val := &quot;get_&quot; ++ V1, any := _ }}] -&gt; V1
<a name="2405"/> 2405:     end,
<a name="2406"/> 2406:     %% match deep map
<a name="2407"/> 2407:     ok = case S of
<a name="2408"/> 2408: 	[42,{&quot;hi&quot;,_, #{ }}] -&gt; ok
<a name="2409"/> 2409:     end,
<a name="t_build_and_match_structure-last_expr"/><a name="2410"/> 2410:     ok.
<a name="2411"/> 2411: 
<a name="2412"/> 2412: 
<a name="do_badmap-1"/><a name="2413"/> 2413: <b>do_badmap</b>(Test) -&gt;
<a name="2414"/> 2414:     Terms = [Test,fun erlang:abs/1,make_ref(),self(),0.0/id(-1),
<a name="2415"/> 2415: 	     &lt;&lt;1:1&gt;&gt;,&lt;&lt;&gt;&gt;,&lt;&lt;1,2,3&gt;&gt;,
<a name="2416"/> 2416: 	     [],{a,b,c},[a,b],atom,10.0,42,(1 bsl 65) + 3],
<a name="do_badmap-last_expr"/><a name="2417"/> 2417: <b>    [Test</b>(T) || T &lt;- Terms].
<a name="2418"/> 2418: 
<a name="2419"/> 2419: <i>%% Use this function to avoid compile-time evaluation of an expression.</i>
<a name="id-1"/><a name="id-last_expr"/><a name="2420"/> 2420: <b>id</b>(I) -&gt; I.
</pre>
</body>
</html>
