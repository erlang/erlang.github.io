<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/erts/emulator/make_test_dir/emulator_test/exception_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%%</i>
<a name="2"/>    2: <i>%% %CopyrightBegin%</i>
<a name="3"/>    3: <i>%% </i>
<a name="4"/>    4: <i>%% Copyright Ericsson AB 1997-2024. All Rights Reserved.</i>
<a name="5"/>    5: <i>%% </i>
<a name="6"/>    6: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="7"/>    7: <i>%% you may not use this file except in compliance with the License.</i>
<a name="8"/>    8: <i>%% You may obtain a copy of the License at</i>
<a name="9"/>    9: <i>%%</i>
<a name="10"/>   10: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="11"/>   11: <i>%%</i>
<a name="12"/>   12: <i>%% Unless required by applicable law or agreed to in writing, software</i>
<a name="13"/>   13: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="14"/>   14: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="15"/>   15: <i>%% See the License for the specific language governing permissions and</i>
<a name="16"/>   16: <i>%% limitations under the License.</i>
<a name="17"/>   17: <i>%% </i>
<a name="18"/>   18: <i>%% %CopyrightEnd%</i>
<a name="19"/>   19: <i>%%</i>
<a name="20"/>   20: 
<a name="21"/>   21: <b>-module</b>(exception_SUITE).
<a name="22"/>   22: 
<a name="23"/>   23: <b>-export</b>([all/0, suite/0,
<a name="24"/>   24:          init_per_testcase/2, end_per_testcase/2,
<a name="25"/>   25:          badmatch/1, pending_errors/1, nil_arith/1, top_of_stacktrace/1,
<a name="26"/>   26:          stacktrace/1, nested_stacktrace/1, raise/1, gunilla/1, per/1,
<a name="27"/>   27:          change_exception_class/1,
<a name="28"/>   28:          exception_with_heap_frag/1, backtrace_depth/1,
<a name="29"/>   29:          error_3/1, error_info/1,
<a name="30"/>   30:          no_line_numbers/1, line_numbers/1]).
<a name="31"/>   31: 
<a name="32"/>   32: <b>-export</b>([bad_guy/2]).
<a name="33"/>   33: <b>-export</b>([crash/1]).
<a name="34"/>   34: 
<a name="35"/>   35: <b>-include_lib</b>(&quot;common_test/include/ct.hrl&quot;).
<a name="36"/>   36: <b>-import</b>(lists, [foreach/2]).
<a name="37"/>   37: 
<a name="38"/>   38: <i>%% Module-level type optimization propagates the constants used when testing</i>
<a name="39"/>   39: <i>%% increment1/1 and increment2/1, which makes it test something completely</i>
<a name="40"/>   40: <i>%% different, so we're turning it off.</i>
<a name="41"/>   41: <b>-compile</b>(no_module_opt).
<a name="42"/>   42: 
<a name="suite-0"/><a name="43"/>   43: <b>suite</b>() -&gt;
<a name="suite-last_expr"/><a name="44"/>   44:     [{ct_hooks,[ts_install_cth]},
<a name="45"/>   45:      {timetrap, {minutes, 1}}].
<a name="46"/>   46: 
<a name="all-0"/><a name="47"/>   47: <b>all</b>() -&gt; 
<a name="all-last_expr"/><a name="48"/>   48:     [badmatch, pending_errors, nil_arith, top_of_stacktrace,
<a name="49"/>   49:      stacktrace, nested_stacktrace, raise, gunilla, per,
<a name="50"/>   50:      change_exception_class,
<a name="51"/>   51:      exception_with_heap_frag, backtrace_depth,
<a name="52"/>   52:      error_3, error_info,
<a name="53"/>   53:      no_line_numbers, line_numbers].
<a name="54"/>   54: 
<a name="init_per_testcase-2"/><a name="55"/>   55: <b>init_per_testcase</b>(_TestCase, Config) -&gt;
<a name="init_per_testcase-last_expr"/><a name="56"/>   56:     Config.
<a name="end_per_testcase-2"/><a name="57"/>   57: <b>end_per_testcase</b>(_TestCase, Config) -&gt;
<a name="end_per_testcase-last_expr"/><a name="58"/>   58: <b>    erts_test_utils:ept_check_leaked_nodes</b>(Config).
<a name="59"/>   59: 
<a name="60"/>   60: <b>-define</b>(try_match(E),
<a name="61"/>   61:         catch ?MODULE:bar(),
<a name="62"/>   62:         {'EXIT', {{badmatch, nomatch}, _}} = (catch E = id(nomatch))).
<a name="63"/>   63: 
<a name="64"/>   64: <i>%% Test that deliberately bad matches are reported correctly.</i>
<a name="65"/>   65: 
<a name="badmatch-1"/><a name="66"/>   66: <b>badmatch</b>(Config) when is_list(Config) -&gt;
<a name="67"/>   67:     ?try_match(a),
<a name="68"/>   68:     ?try_match(42),
<a name="69"/>   69:     ?try_match({a, b, c}),
<a name="70"/>   70:     ?try_match([]),
<a name="71"/>   71:     ?try_match(1.0),
<a name="badmatch-last_expr"/><a name="72"/>   72:     ok.
<a name="73"/>   73: 
<a name="74"/>   74: <i>%% Test various exceptions, in the presence of a previous error suppressed</i>
<a name="75"/>   75: <i>%% in a guard.</i>
<a name="pending_errors-1"/><a name="76"/>   76: <b>pending_errors</b>(Config) when is_list(Config) -&gt;
<a name="77"/>   77:     pending(e_badmatch, {badmatch, b}),
<a name="78"/>   78:     pending(x, function_clause),
<a name="79"/>   79:     pending(e_case, {case_clause, xxx}),
<a name="80"/>   80:     pending(e_if, if_clause),
<a name="81"/>   81:     pending(e_badarith, badarith),
<a name="82"/>   82:     pending(e_undef, undef),
<a name="83"/>   83:     pending(e_timeoutval, timeout_value),
<a name="84"/>   84:     pending(e_badarg, badarg),
<a name="85"/>   85:     pending(e_badarg_spawn, badarg),
<a name="pending_errors-last_expr"/><a name="86"/>   86:     ok.
<a name="87"/>   87: 
<a name="bad_guy-2"/><a name="88"/>   88: <b>bad_guy</b>(pe_badarith, Other) when Other+1 == 0 -&gt; % badarith (suppressed)
<a name="89"/>   89:     ok;
<a name="90"/>   90: <b>bad_guy</b>(pe_badarg, Other) when length(Other) &gt; 0 -&gt; % badarg (suppressed)
<a name="91"/>   91:     ok;
<a name="92"/>   92: <b>bad_guy</b>(_, e_case) -&gt;
<a name="93"/>   93:     case id(xxx) of
<a name="94"/>   94:         ok -&gt; ok
<a name="95"/>   95:     end;					% case_clause
<a name="96"/>   96: <b>bad_guy</b>(_, e_if) -&gt;
<a name="97"/>   97:     if
<a name="98"/>   98:         a == b -&gt; ok
<a name="99"/>   99:     end;					% if_clause
<a name="100"/>  100: <b>bad_guy</b>(_, e_badarith) -&gt;
<a name="101"/>  101:     1+b;					% badarith
<a name="102"/>  102: <b>bad_guy</b>(_, e_undef) -&gt;
<a name="103"/>  103:     non_existing_module:foo();			% undef
<a name="104"/>  104: <b>bad_guy</b>(_, e_timeoutval) -&gt;
<a name="105"/>  105:     receive
<a name="106"/>  106:     after arne -&gt;				% timeout_value
<a name="107"/>  107:               ok
<a name="108"/>  108:     end;
<a name="109"/>  109: <b>bad_guy</b>(_, e_badarg) -&gt;
<a name="110"/>  110:     node(xxx);					% badarg
<a name="111"/>  111: <b>bad_guy</b>(_, e_badarg_spawn) -&gt;
<a name="112"/>  112:     spawn({}, {}, {});				% badarg
<a name="113"/>  113: <b>bad_guy</b>(_, e_badmatch) -&gt;
<a name="bad_guy-last_expr"/><a name="114"/>  114: <b>    a = id</b>(b).					% badmatch
<a name="115"/>  115: 
<a name="pending-2"/><a name="116"/>  116: <b>pending</b>(Arg, Expected) -&gt;
<a name="117"/>  117:     pending(pe_badarith, Arg, Expected),
<a name="pending-last_expr"/><a name="118"/>  118: <b>    pending</b>(pe_badarg, Arg, Expected).
<a name="119"/>  119: 
<a name="pending-3"/><a name="120"/>  120: <b>pending</b>(First, Second, Expected) -&gt;
<a name="121"/>  121:     pending_catched(First, Second, Expected),
<a name="pending-last_expr"/><a name="122"/>  122: <b>    pending_exit_message</b>([First, Second], Expected).
<a name="123"/>  123: 
<a name="pending_catched-3"/><a name="124"/>  124: <b>pending_catched</b>(First, Second, Expected) -&gt;
<a name="125"/>  125:     ok = io:format(&quot;Catching bad_guy(~p, ~p)&quot;, [First, Second]),
<a name="pending_catched-last_expr"/><a name="126"/>  126: <b>    case catch bad_guy</b>(First, Second) of
<a name="127"/>  127:         {'EXIT', Reason} -&gt;
<a name="128"/>  128:             pending(Reason, bad_guy, [First, Second], Expected);
<a name="129"/>  129:         Other -&gt;
<a name="130"/>  130:             ct:fail({not_exit, Other})
<a name="131"/>  131:     end.
<a name="132"/>  132: 
<a name="pending_exit_message-2"/><a name="133"/>  133: <b>pending_exit_message</b>(Args, Expected) -&gt;
<a name="134"/>  134:     ok = io:format(&quot;Trapping EXITs from spawn_link(~p, ~p, ~p)&quot;,
<a name="135"/>  135:                    [?MODULE, bad_guy, Args]),
<a name="136"/>  136:     process_flag(trap_exit, true),
<a name="137"/>  137:     Pid = spawn_link(?MODULE, bad_guy, Args),
<a name="138"/>  138:     receive
<a name="139"/>  139:         {'EXIT', Pid, Reason} -&gt;
<a name="140"/>  140:             pending(Reason, bad_guy, Args, Expected);
<a name="141"/>  141:         Other -&gt;
<a name="142"/>  142:             ct:fail({unexpected_message, Other})
<a name="143"/>  143:     after 10000 -&gt;
<a name="144"/>  144:               ct:fail(timeout)
<a name="145"/>  145:     end,
<a name="pending_exit_message-last_expr"/><a name="146"/>  146: <b>    process_flag</b>(trap_exit, false).
<a name="147"/>  147: 
<a name="pending-4"/><a name="148"/>  148: <b>pending</b>({badarg,[{erlang,Bif,BifArgs,Loc1},
<a name="149"/>  149:                  {?MODULE,Func,Arity,Loc2}|_]},
<a name="150"/>  150:         Func, Args, _Code)
<a name="151"/>  151:   when is_atom(Bif), is_list(BifArgs), length(Args) =:= Arity,
<a name="152"/>  152:        is_list(Loc1), is_list(Loc2) -&gt;
<a name="153"/>  153:     ok;
<a name="154"/>  154: <b>pending</b>({badarith,[{erlang,Bif,BifArgs,Loc1},
<a name="155"/>  155:                    {?MODULE,Func,Arity,Loc2}|_]},
<a name="156"/>  156:         Func, Args, _Code)
<a name="157"/>  157:   when is_atom(Bif), is_list(BifArgs), length(Args) =:= Arity,
<a name="158"/>  158:        is_list(Loc1), is_list(Loc2) -&gt;
<a name="159"/>  159:     ok;
<a name="160"/>  160: <b>pending</b>({undef,[{non_existing_module,foo,[],Loc}|_]}, _, _, _)
<a name="161"/>  161:   when is_list(Loc) -&gt;
<a name="162"/>  162:     ok;
<a name="163"/>  163: <b>pending</b>({function_clause,[{?MODULE,Func,Args,Loc}|_]}, Func, Args, _Code)
<a name="164"/>  164:   when is_list(Loc) -&gt;
<a name="165"/>  165:     ok;
<a name="166"/>  166: <b>pending</b>({Code,[{?MODULE,Func,Arity,Loc}|_]}, Func, Args, Code)
<a name="167"/>  167:   when length(Args) =:= Arity, is_list(Loc) -&gt;
<a name="168"/>  168:     ok;
<a name="169"/>  169: <b>pending</b>(Reason, _Function, _Args, _Code) -&gt;
<a name="pending-last_expr"/><a name="170"/>  170: <b>    ct:fail</b>({bad_exit_reason,Reason}).
<a name="171"/>  171: 
<a name="172"/>  172: <i>%% Test that doing arithmetic on [] gives a badarith EXIT and not a crash.</i>
<a name="173"/>  173: 
<a name="nil_arith-1"/><a name="174"/>  174: <b>nil_arith</b>(Config) when is_list(Config) -&gt;
<a name="175"/>  175:     ba_plus_minus_times([], []),
<a name="176"/>  176: 
<a name="177"/>  177:     ba_plus_minus_times([], 0),
<a name="178"/>  178:     ba_plus_minus_times([], 42),
<a name="179"/>  179:     ba_plus_minus_times([], 38724978123478923784),
<a name="180"/>  180:     ba_plus_minus_times([], 38.72),
<a name="181"/>  181: 
<a name="182"/>  182:     ba_plus_minus_times(0, []),
<a name="183"/>  183:     ba_plus_minus_times(334, []),
<a name="184"/>  184:     ba_plus_minus_times(387249797813478923784, []),
<a name="185"/>  185:     ba_plus_minus_times(344.22, []),
<a name="186"/>  186: 
<a name="187"/>  187:     ba_div_rem([], []),
<a name="188"/>  188: 
<a name="189"/>  189:     ba_div_rem([], 0),
<a name="190"/>  190:     ba_div_rem([], 1),
<a name="191"/>  191:     ba_div_rem([], 42),
<a name="192"/>  192:     ba_div_rem([], 38724978123478923784),
<a name="193"/>  193:     ba_div_rem(344.22, []),
<a name="194"/>  194: 
<a name="195"/>  195:     ba_div_rem(0, []),
<a name="196"/>  196:     ba_div_rem(1, []),
<a name="197"/>  197:     ba_div_rem(334, []),
<a name="198"/>  198:     ba_div_rem(387249797813478923784, []),
<a name="199"/>  199:     ba_div_rem(344.22, []),
<a name="200"/>  200: 
<a name="201"/>  201:     ba_div_rem(344.22, 0.0),
<a name="202"/>  202:     ba_div_rem(1, 0.0),
<a name="203"/>  203:     ba_div_rem(392873498733971, 0.0),
<a name="204"/>  204: 
<a name="205"/>  205:     ba_bop([], []),
<a name="206"/>  206:     ba_bop(0, []),
<a name="207"/>  207:     ba_bop(42, []),
<a name="208"/>  208:     ba_bop(-42342742987343, []),
<a name="209"/>  209:     ba_bop(238.342, []),
<a name="210"/>  210:     ba_bop([], 0),
<a name="211"/>  211:     ba_bop([], -243),
<a name="212"/>  212:     ba_bop([], 243),
<a name="213"/>  213:     ba_bop([], 2438724982478933),
<a name="214"/>  214:     ba_bop([], 3987.37),
<a name="215"/>  215: 
<a name="216"/>  216:     ba_bnot([]),
<a name="217"/>  217:     ba_bnot(23.33),
<a name="218"/>  218: 
<a name="219"/>  219:     ba_shift([], []),
<a name="220"/>  220:     ba_shift([], 0),
<a name="221"/>  221:     ba_shift([], 4),
<a name="222"/>  222:     ba_shift([], -4),
<a name="223"/>  223:     ba_shift([], 2343333333333),
<a name="224"/>  224:     ba_shift([], -333333333),
<a name="225"/>  225:     ba_shift([], 234.00),
<a name="226"/>  226:     ba_shift(23, []),
<a name="227"/>  227:     ba_shift(0, []),
<a name="228"/>  228:     ba_shift(-3433443433433323, []),
<a name="229"/>  229:     ba_shift(433443433433323, []),
<a name="230"/>  230:     ba_shift(343.93, []),
<a name="nil_arith-last_expr"/><a name="231"/>  231:     ok.
<a name="232"/>  232: 
<a name="ba_plus_minus_times-2"/><a name="233"/>  233: <b>ba_plus_minus_times</b>(A, B) -&gt;
<a name="234"/>  234:     io:format(&quot;~p + ~p&quot;, [A, B]),
<a name="235"/>  235:     {'EXIT', {badarith, _}} = (catch A + B),
<a name="236"/>  236:     io:format(&quot;~p - ~p&quot;, [A, B]),
<a name="237"/>  237:     {'EXIT', {badarith, _}} = (catch A - B),
<a name="238"/>  238:     io:format(&quot;~p * ~p&quot;, [A, B]),
<a name="ba_plus_minus_times-last_expr"/><a name="239"/>  239: <b>    {'EXIT', {badarith, _}} = </b>(catch A * B).
<a name="240"/>  240: 
<a name="ba_div_rem-2"/><a name="241"/>  241: <b>ba_div_rem</b>(A, B) -&gt;
<a name="242"/>  242:     io:format(&quot;~p / ~p&quot;, [A, B]),
<a name="243"/>  243:     {'EXIT', {badarith, _}} = (catch A / B),
<a name="244"/>  244:     io:format(&quot;~p div ~p&quot;, [A, B]),
<a name="245"/>  245:     {'EXIT', {badarith, _}} = (catch A div B),
<a name="246"/>  246:     io:format(&quot;~p rem ~p&quot;, [A, B]),
<a name="ba_div_rem-last_expr"/><a name="247"/>  247: <b>    {'EXIT', {badarith, _}} = </b>(catch A rem B).
<a name="248"/>  248: 
<a name="ba_bop-2"/><a name="249"/>  249: <b>ba_bop</b>(A, B) -&gt;
<a name="250"/>  250:     io:format(&quot;~p band ~p&quot;, [A, B]),
<a name="251"/>  251:     {'EXIT', {badarith, _}} = (catch A band B),
<a name="252"/>  252:     io:format(&quot;~p bor ~p&quot;, [A, B]),
<a name="253"/>  253:     {'EXIT', {badarith, _}} = (catch A bor B),
<a name="254"/>  254:     io:format(&quot;~p bxor ~p&quot;, [A, B]),
<a name="ba_bop-last_expr"/><a name="255"/>  255: <b>    {'EXIT', {badarith, _}} = </b>(catch A bxor B).
<a name="256"/>  256: 
<a name="ba_shift-2"/><a name="257"/>  257: <b>ba_shift</b>(A, B) -&gt;
<a name="258"/>  258:     io:format(&quot;~p bsl ~p&quot;, [A, B]),
<a name="259"/>  259:     {'EXIT', {badarith, _}} = (catch A bsl B),
<a name="260"/>  260:     io:format(&quot;~p bsr ~p&quot;, [A, B]),
<a name="ba_shift-last_expr"/><a name="261"/>  261: <b>    {'EXIT', {badarith, _}} = </b>(catch A bsr B).
<a name="262"/>  262: 
<a name="ba_bnot-1"/><a name="263"/>  263: <b>ba_bnot</b>(A) -&gt;
<a name="264"/>  264:     io:format(&quot;bnot ~p&quot;, [A]),
<a name="ba_bnot-last_expr"/><a name="265"/>  265: <b>    {'EXIT', {badarith, _}} = </b>(catch bnot A).
<a name="266"/>  266: 
<a name="267"/>  267: <i>%% Test that BIFs are added to the top of the stacktrace.</i>
<a name="268"/>  268: 
<a name="top_of_stacktrace-1"/><a name="269"/>  269: <b>top_of_stacktrace</b>(Conf) when is_list(Conf) -&gt;
<a name="270"/>  270:     %% Arithmetic operators
<a name="271"/>  271:     {'EXIT', {badarith, [{erlang, '+', [1, ok], _} | _]}} = (catch my_add(1, ok)),
<a name="272"/>  272:     {'EXIT', {badarith, [{erlang, '-', [1, ok], _} | _]}} = (catch my_minus(1, ok)),
<a name="273"/>  273:     {'EXIT', {badarith, [{erlang, '*', [1, ok], _} | _]}} = (catch my_times(1, ok)),
<a name="274"/>  274:     {'EXIT', {badarith, [{erlang, 'div', [1, ok], _} | _]}} = (catch my_div(1, ok)),
<a name="275"/>  275:     {'EXIT', {badarith, [{erlang, 'div', [1, 0], _} | _]}} = (catch my_div(1, 0)),
<a name="276"/>  276:     {'EXIT', {badarith, [{erlang, 'rem', [1, ok], _} | _]}} = (catch my_rem(1, ok)),
<a name="277"/>  277:     {'EXIT', {badarith, [{erlang, 'rem', [1, 0], _} | _]}} = (catch my_rem(1, 0)),
<a name="278"/>  278: 
<a name="279"/>  279:     %% Bit operators
<a name="280"/>  280:     {'EXIT', {badarith, [{erlang, 'band', [1, ok], _} | _]}} = (catch my_band(1, ok)),
<a name="281"/>  281:     {'EXIT', {badarith, [{erlang, 'bor', [1, ok], _} | _]}} = (catch my_bor(1, ok)),
<a name="282"/>  282:     {'EXIT', {badarith, [{erlang, 'bsl', [1, ok], _} | _]}} = (catch my_bsl(1, ok)),
<a name="283"/>  283:     {'EXIT', {badarith, [{erlang, 'bsr', [1, ok], _} | _]}} = (catch my_bsr(1, ok)),
<a name="284"/>  284:     {'EXIT', {badarith, [{erlang, 'bxor', [1, ok], _} | _]}} = (catch my_bxor(1, ok)),
<a name="285"/>  285:     {'EXIT', {badarith, [{erlang, 'bnot', [ok], _} | _]}} = (catch my_bnot(ok)),
<a name="286"/>  286: 
<a name="287"/>  287:     %% element/2
<a name="288"/>  288:     {'EXIT', {badarg, [{erlang, element, [1, ok], _} | _]}} = (catch my_element(1, ok)),
<a name="289"/>  289:     {'EXIT', {badarg, [{erlang, element, [ok, {}], _} | _]}} = (catch my_element(ok, {})),
<a name="290"/>  290:     {'EXIT', {badarg, [{erlang, element, [1, {}], _} | _]}} = (catch my_element(1, {})),
<a name="291"/>  291:     {'EXIT', {badarg, [{erlang, element, [0, {a}], _} | _]}} = (catch my_element(0, {a})),
<a name="292"/>  292:     {'EXIT', {badarg, [{erlang, element, [-1, {z}], _} | _]}} = (catch my_element(-1, {z})),
<a name="293"/>  293:     {'EXIT', {badarg, [{erlang, element, [1, {}], _} | _]}} = (catch element(1, erlang:make_tuple(0, ok))),
<a name="294"/>  294: 
<a name="295"/>  295:     %% tuple_size/1
<a name="296"/>  296:     {'EXIT', {badarg, [{erlang, tuple_size, [ok], _} | _]}} = (catch my_tuple_size(ok)),
<a name="297"/>  297:     {'EXIT', {badarg, [{erlang, tuple_size, [[a,b,c]], _} | _]}} = (catch my_tuple_size([a,b,c])),
<a name="298"/>  298: 
<a name="299"/>  299:     %% Lists
<a name="300"/>  300:     {'EXIT', {badarg, [{erlang, hd, [[]], _} | _]}} = (catch my_hd([])),
<a name="301"/>  301:     {'EXIT', {badarg, [{erlang, hd, [42], _} | _]}} = (catch my_hd(42)),
<a name="302"/>  302:     {'EXIT', {badarg, [{erlang, tl, [[]], _} | _]}} = (catch my_tl([])),
<a name="303"/>  303:     {'EXIT', {badarg, [{erlang, tl, [a], _} | _]}} = (catch my_tl(a)),
<a name="304"/>  304: 
<a name="305"/>  305:     %% System limits
<a name="306"/>  306:     Maxbig = maxbig(),
<a name="307"/>  307:     MinusMaxbig = -Maxbig,
<a name="308"/>  308:     {'EXIT', {system_limit, [{erlang, '+', [Maxbig, 1], _} | _]}} = (catch my_add(Maxbig, 1)),
<a name="309"/>  309:     {'EXIT', {system_limit, [{erlang, '+', [Maxbig, 1], _} | _]}} = (catch my_add(maxbig_gc(), 1)),
<a name="310"/>  310:     {'EXIT', {system_limit, [{erlang, '-', [MinusMaxbig, 1], _} | _]}} = (catch my_minus(-Maxbig, 1)),
<a name="311"/>  311:     {'EXIT', {system_limit, [{erlang, '-', [MinusMaxbig, 1], _} | _]}} = (catch my_minus(-maxbig_gc(), 1)),
<a name="312"/>  312:     {'EXIT', {system_limit, [{erlang, '*', [Maxbig, 2], _} | _]}} = (catch my_times(Maxbig, 2)),
<a name="313"/>  313:     {'EXIT', {system_limit, [{erlang, '*', [Maxbig, 2], _} | _]}} = (catch my_times(maxbig_gc(), 2)),
<a name="314"/>  314:     {'EXIT', {system_limit, [{erlang, 'bnot', [Maxbig], _} | _]}} = (catch my_bnot(Maxbig)),
<a name="315"/>  315:     {'EXIT', {system_limit, [{erlang, 'bnot', [Maxbig], _} | _]}} = (catch my_bnot(maxbig_gc())),
<a name="top_of_stacktrace-last_expr"/><a name="316"/>  316:     ok.
<a name="317"/>  317: 
<a name="maxbig-0"/><a name="318"/>  318: <b>maxbig</b>() -&gt;
<a name="maxbig-last_expr"/><a name="319"/>  319: <b>    erlang:system_info</b>(max_integer).
<a name="320"/>  320: 
<a name="maxbig_gc-0"/><a name="321"/>  321: <b>maxbig_gc</b>() -&gt;
<a name="322"/>  322:     Maxbig = maxbig(),
<a name="323"/>  323:     erlang:garbage_collect(),
<a name="maxbig_gc-last_expr"/><a name="324"/>  324:     Maxbig.
<a name="325"/>  325: 
<a name="stacktrace-1"/><a name="326"/>  326: <b>stacktrace</b>(Conf) when is_list(Conf) -&gt;
<a name="327"/>  327:     V = [make_ref()|self()],
<a name="328"/>  328:     {value2,{caught1,badarg,[{erlang,abs,[V],_}|_]}} =
<a name="329"/>  329:         stacktrace_1({'abs',V}, error, {value,V}),
<a name="330"/>  330:     {caught2,{error,badarith},[{erlang,'+',[0,a],_},{?MODULE,my_add,2,_}|_]} =
<a name="331"/>  331:         stacktrace_1({'div',{1,0}}, error, {'add',{0,a}}),
<a name="332"/>  332:     {caught2,{error,{try_clause,V}},[{?MODULE,stacktrace_1,3,_}|_]} =
<a name="333"/>  333:         stacktrace_1({value,V}, error, {value,V}),
<a name="334"/>  334:     {caught2,{throw,V},[{?MODULE,foo,1,_}|_]} =
<a name="335"/>  335:         stacktrace_1({value,V}, error, {throw,V}),
<a name="336"/>  336:     {caught2,{error,V},[{?MODULE,foo,[a],_}|_]} =
<a name="337"/>  337:         stacktrace_1({value,V}, error, {error,{V,[a]}}),
<a name="338"/>  338:     {caught2,{error,V},[{?MODULE,foo,1,_}|_]} =
<a name="339"/>  339:         stacktrace_1({value,V}, error, {error,{V,none}}),
<a name="340"/>  340: 
<a name="stacktrace-last_expr"/><a name="341"/>  341:     try
<a name="342"/>  342:         stacktrace_2()
<a name="343"/>  343:     catch
<a name="344"/>  344:         error:{badmatch,_}:Stk -&gt;
<a name="345"/>  345:             [{?MODULE,stacktrace_2,0,_},
<a name="346"/>  346:              {?MODULE,stacktrace,1,_}|_] = Stk,
<a name="347"/>  347:             ok
<a name="348"/>  348:     end.
<a name="349"/>  349: 
<a name="stacktrace_1-3"/><a name="350"/>  350: <b>stacktrace_1</b>(X, C1, Y) -&gt;
<a name="stacktrace_1-last_expr"/><a name="351"/>  351: <b>    try try foo</b>(X) of
<a name="352"/>  352:             C1 -&gt; value1
<a name="353"/>  353:         catch
<a name="354"/>  354:             C1:D1:Stk1 -&gt;
<a name="355"/>  355:                 {caught1,D1,Stk1}
<a name="356"/>  356:         after
<a name="357"/>  357:             foo(Y)
<a name="358"/>  358:         end of
<a name="359"/>  359:         V2 -&gt; {value2,V2}
<a name="360"/>  360:     catch
<a name="361"/>  361:         C2:D2:Stk2 -&gt;
<a name="362"/>  362:             {caught2,{C2,D2},Stk2}
<a name="363"/>  363:     after
<a name="364"/>  364:         ok
<a name="365"/>  365:     end.
<a name="366"/>  366: 
<a name="stacktrace_2-0"/><a name="367"/>  367: <b>stacktrace_2</b>() -&gt;
<a name="368"/>  368:     ok = erlang:process_info(self(), current_function),
<a name="stacktrace_2-last_expr"/><a name="369"/>  369:     ok.
<a name="370"/>  370: 
<a name="371"/>  371: 
<a name="nested_stacktrace-1"/><a name="372"/>  372: <b>nested_stacktrace</b>(Conf) when is_list(Conf) -&gt;
<a name="373"/>  373:     V = [{make_ref()}|[self()]],
<a name="374"/>  374:     value1 =
<a name="375"/>  375:         nested_stacktrace_1({{value,{V,x1}},void,{V,x1}},
<a name="376"/>  376:                             {void,void,void}),
<a name="377"/>  377:     {caught1,
<a name="378"/>  378:      [{erlang,'+',[V,x1],_},{?MODULE,my_add,2,_}|_],
<a name="379"/>  379:      value2} =
<a name="380"/>  380:         nested_stacktrace_1({{'add',{V,x1}},error,badarith},
<a name="381"/>  381:                             {{value,{V,x2}},void,{V,x2}}),
<a name="382"/>  382:     {caught1,
<a name="383"/>  383:      [{erlang,'+',[V,x1],_},{?MODULE,my_add,2,_}|_],
<a name="384"/>  384:      {caught2,[{erlang,abs,[V],_}|_]}} =
<a name="385"/>  385:         nested_stacktrace_1({{'add',{V,x1}},error,badarith},
<a name="386"/>  386:                             {{'abs',V},error,badarg}),
<a name="nested_stacktrace-last_expr"/><a name="387"/>  387:     ok.
<a name="388"/>  388: 
<a name="nested_stacktrace_1-2"/><a name="389"/>  389: <b>nested_stacktrace_1</b>({X1,C1,V1}, {X2,C2,V2}) -&gt;
<a name="nested_stacktrace_1-last_expr"/><a name="390"/>  390: <b>    try foo</b>(X1) of
<a name="391"/>  391:         V1 -&gt; value1
<a name="392"/>  392:     catch
<a name="393"/>  393:         C1:V1:S1 -&gt;
<a name="394"/>  394:             T2 = try foo(X2) of
<a name="395"/>  395:                      V2 -&gt; value2
<a name="396"/>  396:                  catch
<a name="397"/>  397:                      C2:V2:S2 -&gt; {caught2,S2}
<a name="398"/>  398:             end,
<a name="399"/>  399:             {caught1,S1,T2}
<a name="400"/>  400:     end.
<a name="401"/>  401: 
<a name="402"/>  402: 
<a name="403"/>  403: 
<a name="raise-1"/><a name="404"/>  404: <b>raise</b>(Conf) when is_list(Conf) -&gt;
<a name="405"/>  405:     erase(raise),
<a name="406"/>  406:     A =
<a name="407"/>  407:         try
<a name="408"/>  408:             try foo({'div',{1,0}})
<a name="409"/>  409:             catch
<a name="410"/>  410:                 error:badarith:A0 -&gt;
<a name="411"/>  411:                     put(raise, A0),
<a name="412"/>  412:                     erlang:raise(error, badarith, A0)
<a name="413"/>  413:             end
<a name="414"/>  414:         catch
<a name="415"/>  415:             error:badarith:A1 -&gt;
<a name="416"/>  416:                 A1 = get(raise)
<a name="417"/>  417:         end,
<a name="418"/>  418:     A = get(raise),
<a name="419"/>  419:     [{erlang,'div',[1, 0], _},{?MODULE,my_div,2,_}|_] = A,
<a name="420"/>  420:     %%
<a name="421"/>  421:     N = 8, % Must be even
<a name="422"/>  422:     N = erlang:system_flag(backtrace_depth, N),
<a name="423"/>  423:     try
<a name="424"/>  424:         even(N)
<a name="425"/>  425:     catch
<a name="426"/>  426:         error:function_clause -&gt; ok
<a name="427"/>  427:     end,
<a name="428"/>  428:     %%
<a name="429"/>  429:     C = odd_even(N+1, []),
<a name="430"/>  430:     try
<a name="431"/>  431:         odd(N+1)
<a name="432"/>  432:     catch
<a name="433"/>  433:         error:function_clause -&gt; ok
<a name="434"/>  434:     end,
<a name="435"/>  435:     try
<a name="436"/>  436:         erlang:raise(error, function_clause, C)
<a name="437"/>  437:     catch
<a name="438"/>  438:         error:function_clause -&gt; ok
<a name="439"/>  439:     end,
<a name="raise-last_expr"/><a name="440"/>  440:     ok.
<a name="441"/>  441: 
<a name="odd_even-2"/><a name="442"/>  442: <b>odd_even</b>(N, R) when is_integer(N), N &gt; 1 -&gt;
<a name="443"/>  443:     odd_even(N-1, 
<a name="444"/>  444:              [if (N rem 2) == 0 -&gt;
<a name="445"/>  445:                      {?MODULE,even,1,[{file,&quot;odd_even.erl&quot;},{line,3}]};
<a name="446"/>  446:                  true -&gt;
<a name="447"/>  447:                      {?MODULE,odd,1,[{file,&quot;odd_even.erl&quot;},{line,6}]}
<a name="448"/>  448:               end|R]);
<a name="449"/>  449: <b>odd_even</b>(1, R) -&gt;
<a name="odd_even-last_expr"/><a name="450"/>  450:     [{?MODULE,odd,[1],[{file,&quot;odd_even.erl&quot;},{line,5}]}|R].
<a name="451"/>  451: 
<a name="foo-1"/><a name="452"/>  452: <b>foo</b>({value,Value}) -&gt; Value;
<a name="453"/>  453: <b>foo</b>({'div',{A,B}}) -&gt;
<a name="454"/>  454:     my_div(A, B);
<a name="455"/>  455: <b>foo</b>({'add',{A,B}}) -&gt;
<a name="456"/>  456:     my_add(A, B);
<a name="457"/>  457: <b>foo</b>({'abs',X}) -&gt;
<a name="458"/>  458:     my_abs(X);
<a name="459"/>  459: <b>foo</b>({error,{Error, Args}}) -&gt;
<a name="460"/>  460:     erlang:error(Error, Args);
<a name="461"/>  461: <b>foo</b>({error,Error}) -&gt;
<a name="462"/>  462:     erlang:error(Error);
<a name="463"/>  463: <b>foo</b>({throw,Throw}) -&gt;
<a name="464"/>  464:     erlang:throw(Throw);
<a name="465"/>  465: <b>foo</b>({exit,Exit}) -&gt;
<a name="466"/>  466:     erlang:exit(Exit);
<a name="467"/>  467: <b>foo</b>({raise,{Class,Reason,Stacktrace}}) -&gt;
<a name="foo-last_expr"/><a name="468"/>  468: <b>    erlang:raise</b>(Class, Reason, Stacktrace).
<a name="469"/>  469: <i>%%foo(function_clause) -&gt; % must not be defined!</i>
<a name="470"/>  470: 
<a name="my_add-2"/><a name="my_add-last_expr"/><a name="471"/>  471: <b>my_add</b>(A, B) -&gt; A + B.
<a name="my_minus-2"/><a name="my_minus-last_expr"/><a name="472"/>  472: <b>my_minus</b>(A, B) -&gt; A - B.
<a name="my_times-2"/><a name="my_times-last_expr"/><a name="473"/>  473: <b>my_times</b>(A, B) -&gt; A * B.
<a name="my_div-2"/><a name="my_div-last_expr"/><a name="474"/>  474: <b>my_div</b>(A, B) -&gt; A div B.
<a name="my_rem-2"/><a name="my_rem-last_expr"/><a name="475"/>  475: <b>my_rem</b>(A, B) -&gt; A rem B.
<a name="476"/>  476: 
<a name="my_band-2"/><a name="my_band-last_expr"/><a name="477"/>  477: <b>my_band</b>(A, B) -&gt; A band B.
<a name="my_bor-2"/><a name="my_bor-last_expr"/><a name="478"/>  478: <b>my_bor</b>(A, B) -&gt; A bor B.
<a name="my_bsl-2"/><a name="my_bsl-last_expr"/><a name="479"/>  479: <b>my_bsl</b>(A, B) -&gt; A bsl B.
<a name="my_bsr-2"/><a name="my_bsr-last_expr"/><a name="480"/>  480: <b>my_bsr</b>(A, B) -&gt; A bsr B.
<a name="my_bxor-2"/><a name="my_bxor-last_expr"/><a name="481"/>  481: <b>my_bxor</b>(A, B) -&gt; A bxor B.
<a name="my_bnot-1"/><a name="my_bnot-last_expr"/><a name="482"/>  482: <b>my_bnot</b>(A) -&gt; bnot A.
<a name="483"/>  483: 
<a name="my_element-2"/><a name="my_element-last_expr"/><a name="484"/>  484: <b>my_element</b>(A, B) -&gt; element(A, B).
<a name="485"/>  485: 
<a name="my_tuple_size-1"/><a name="my_tuple_size-last_expr"/><a name="486"/>  486: <b>my_tuple_size</b>(A) -&gt; tuple_size(A).
<a name="487"/>  487: 
<a name="my_abs-1"/><a name="my_abs-last_expr"/><a name="488"/>  488: <b>my_abs</b>(X) -&gt; abs(X).
<a name="489"/>  489: 
<a name="my_hd-1"/><a name="my_hd-last_expr"/><a name="490"/>  490: <b>my_hd</b>(L) -&gt; hd(L).
<a name="my_tl-1"/><a name="my_tl-last_expr"/><a name="491"/>  491: <b>my_tl</b>(L) -&gt; tl(L).
<a name="492"/>  492: 
<a name="gunilla-1"/><a name="493"/>  493: <b>gunilla</b>(Config) when is_list(Config) -&gt;
<a name="494"/>  494:     {throw,kalle} = gunilla_1(),
<a name="gunilla-last_expr"/><a name="495"/>  495:     ok.
<a name="496"/>  496: 
<a name="gunilla_1-0"/><a name="497"/>  497: <b>gunilla_1</b>() -&gt;
<a name="gunilla_1-last_expr"/><a name="498"/>  498: <b>    try try arne</b>()
<a name="499"/>  499:         after
<a name="500"/>  500:             pelle
<a name="501"/>  501:         end
<a name="502"/>  502:     catch
<a name="503"/>  503:         C:R -&gt;
<a name="504"/>  504:             {C,R}
<a name="505"/>  505:     end.
<a name="506"/>  506: 
<a name="arne-0"/><a name="507"/>  507: <b>arne</b>() -&gt;
<a name="508"/>  508:     %% Empty stack trace used to cause change the error class to 'error'.
<a name="arne-last_expr"/><a name="509"/>  509: <b>    erlang:raise</b>(throw, kalle, []).
<a name="510"/>  510: 
<a name="per-1"/><a name="511"/>  511: <b>per</b>(Config) when is_list(Config) -&gt;
<a name="per-last_expr"/><a name="512"/>  512:     try 
<a name="513"/>  513:         t1(0,pad,0),
<a name="514"/>  514:         t2(0,pad,0)
<a name="515"/>  515:     catch
<a name="516"/>  516:         error:badarith -&gt;
<a name="517"/>  517:             ok
<a name="518"/>  518:     end.
<a name="519"/>  519: 
<a name="t1-3"/><a name="520"/>  520: <b>t1</b>(_,X,_) -&gt;
<a name="t1-last_expr"/><a name="521"/>  521: <b>    </b>(1 bsl X) + 1.
<a name="522"/>  522: 
<a name="t2-3"/><a name="523"/>  523: <b>t2</b>(_,X,_) -&gt;
<a name="t2-last_expr"/><a name="524"/>  524: <b>    </b>(X bsl 1) + 1.
<a name="525"/>  525: 
<a name="change_exception_class-1"/><a name="526"/>  526: <b>change_exception_class</b>(_Config) -&gt;
<a name="change_exception_class-last_expr"/><a name="527"/>  527:     try
<a name="528"/>  528:         change_exception_class_1(fun() -&gt; throw(arne) end)
<a name="529"/>  529:     catch
<a name="530"/>  530:         error:arne -&gt;
<a name="531"/>  531:             ok;
<a name="532"/>  532:         Class:arne -&gt;
<a name="533"/>  533:             ct:fail({wrong_exception_class,Class})
<a name="534"/>  534:     end.
<a name="535"/>  535: 
<a name="change_exception_class_1-1"/><a name="536"/>  536: <b>change_exception_class_1</b>(F) -&gt;
<a name="change_exception_class_1-last_expr"/><a name="537"/>  537:     try
<a name="538"/>  538:         change_exception_class_2(F)
<a name="539"/>  539:     after
<a name="540"/>  540:         %% The exception would be caught and rethrown using
<a name="541"/>  541:         %% an i_raise instruction. Before the correction
<a name="542"/>  542:         %% of the raw_raise instruction, the change of class
<a name="543"/>  543:         %% would not stick.
<a name="544"/>  544:         io:put_chars(&quot;Exception automatically rethrown here\n&quot;)
<a name="545"/>  545:     end.
<a name="546"/>  546: 
<a name="change_exception_class_2-1"/><a name="547"/>  547: <b>change_exception_class_2</b>(F) -&gt;
<a name="change_exception_class_2-last_expr"/><a name="548"/>  548:     try
<a name="549"/>  549:         F()
<a name="550"/>  550:     catch
<a name="551"/>  551:         throw:Reason:Stack -&gt;
<a name="552"/>  552:             %% Translated to a raw_raise instruction.
<a name="553"/>  553:             %% The change of exception class would not stick
<a name="554"/>  554:             %% if the i_raise instruction was later executed.
<a name="555"/>  555:             erlang:raise(error, Reason, Stack)
<a name="556"/>  556:     end.
<a name="557"/>  557: 
<a name="558"/>  558: <i>%%</i>
<a name="559"/>  559: <i>%% Make sure that even if a BIF builds an heap fragment, then causes an exception,</i>
<a name="560"/>  560: <i>%% the stacktrace term will still be OK (specifically, that it does not contain</i>
<a name="561"/>  561: <i>%% stale pointers to the arguments).</i>
<a name="562"/>  562: <i>%%</i>
<a name="exception_with_heap_frag-1"/><a name="563"/>  563: <b>exception_with_heap_frag</b>(Config) when is_list(Config) -&gt;
<a name="564"/>  564:     Sizes = lists:seq(0, 512),
<a name="565"/>  565: 
<a name="566"/>  566:     %% Floats are only validated when the heap fragment has been allocated.
<a name="567"/>  567:     BadFloat = &lt;&lt;131,99,53,46,48,$X,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,101,45,48,49,0,0,0,0,0&gt;&gt;,
<a name="568"/>  568:     do_exception_with_heap_frag(BadFloat, Sizes),
<a name="569"/>  569: 
<a name="570"/>  570:     %% {Binary,BadFloat}: When the error in float is discovered, a refc-binary
<a name="571"/>  571:     %% has been allocated and the list of refc-binaries goes through the
<a name="572"/>  572:     %% heap fragment.
<a name="573"/>  573:     BinAndFloat = 
<a name="574"/>  574:     &lt;&lt;131,104,2,109,0,0,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,
<a name="575"/>  575:       21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,
<a name="576"/>  576:       46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,
<a name="577"/>  577:       71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,
<a name="578"/>  578:       96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,
<a name="579"/>  579:       116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,
<a name="580"/>  580:       135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,
<a name="581"/>  581:       154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,
<a name="582"/>  582:       173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,
<a name="583"/>  583:       192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,
<a name="584"/>  584:       211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,
<a name="585"/>  585:       230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,
<a name="586"/>  586:       249,250,251,252,253,254,255,99,51,46,49,52,$B,$l,$u,$r,$f,48,48,48,48,48,48,
<a name="587"/>  587:       48,48,49,50,52,51,52,101,43,48,48,0,0,0,0,0&gt;&gt;,
<a name="588"/>  588:     do_exception_with_heap_frag(BinAndFloat, Sizes),
<a name="589"/>  589: 
<a name="590"/>  590:     %% {Fun,BadFloat}
<a name="591"/>  591:     FunAndFloat =
<a name="592"/>  592:     &lt;&lt;131,104,2,112,0,0,0,66,0,238,239,135,138,137,216,89,57,22,111,52,126,16,84,
<a name="593"/>  593:       71,8,0,0,0,0,0,0,0,0,100,0,1,116,97,0,98,5,175,169,123,103,100,0,13,110,111,
<a name="594"/>  594:       110,111,100,101,64,110,111,104,111,115,116,0,0,0,41,0,0,0,0,0,99,50,46,55,48,
<a name="595"/>  595:       $Y,57,57,57,57,57,57,57,57,57,57,57,57,57,54,52,52,55,101,43,48,48,0,0,0,0,0&gt;&gt;,
<a name="596"/>  596:     do_exception_with_heap_frag(FunAndFloat, Sizes),
<a name="597"/>  597: 
<a name="598"/>  598:     %% [ExternalPid|BadFloat]
<a name="599"/>  599:     ExtPidAndFloat =
<a name="600"/>  600:     &lt;&lt;131,108,0,0,0,1,103,100,0,13,107,97,108,108,101,64,115,116,114,105,100,101,
<a name="601"/>  601:       114,0,0,0,36,0,0,0,0,2,99,48,46,$@,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
<a name="602"/>  602:       48,48,48,48,48,101,43,48,48,0,0,0,0,0&gt;&gt;,
<a name="603"/>  603:     do_exception_with_heap_frag(ExtPidAndFloat, Sizes),
<a name="604"/>  604: 
<a name="exception_with_heap_frag-last_expr"/><a name="605"/>  605:     ok.
<a name="606"/>  606: 
<a name="do_exception_with_heap_frag-2"/><a name="607"/>  607: <b>do_exception_with_heap_frag</b>(Bin, [Sz|Sizes]) -&gt;
<a name="608"/>  608:     Filler = erlang:make_tuple(Sz, a),
<a name="609"/>  609:     spawn(fun() -&gt;
<a name="610"/>  610:                   try
<a name="611"/>  611:                       binary_to_term(Bin)
<a name="612"/>  612:                   catch
<a name="613"/>  613:                       _:_:Stk -&gt;
<a name="614"/>  614:                           %% term_to_binary/1 is an easy way to traverse the
<a name="615"/>  615:                           %% entire stacktrace term to make sure that every part
<a name="616"/>  616:                           %% of it is OK.
<a name="617"/>  617:                           term_to_binary(Stk)
<a name="618"/>  618:                   end,
<a name="619"/>  619:                   id(Filler)
<a name="620"/>  620:           end),
<a name="621"/>  621:     do_exception_with_heap_frag(Bin, Sizes);
<a name="do_exception_with_heap_frag-last_expr"/><a name="622"/>  622: <b>do_exception_with_heap_frag</b>(_, []) -&gt; ok.
<a name="623"/>  623: 
<a name="backtrace_depth-1"/><a name="624"/>  624: <b>backtrace_depth</b>(Config) when is_list(Config) -&gt;
<a name="625"/>  625:     _ = [do_backtrace_depth(D) || D &lt;- lists:seq(0, 8)],
<a name="backtrace_depth-last_expr"/><a name="626"/>  626:     ok.
<a name="627"/>  627: 
<a name="do_backtrace_depth-1"/><a name="628"/>  628: <b>do_backtrace_depth</b>(D) -&gt;
<a name="629"/>  629:     Old = erlang:system_flag(backtrace_depth, D),
<a name="do_backtrace_depth-last_expr"/><a name="630"/>  630:     try
<a name="631"/>  631:         Expected = max(1, D),
<a name="632"/>  632:         do_backtrace_depth_1(Expected)
<a name="633"/>  633:     after
<a name="634"/>  634:         _ = erlang:system_flag(backtrace_depth, Old)
<a name="635"/>  635:     end.
<a name="636"/>  636: 
<a name="do_backtrace_depth_1-1"/><a name="637"/>  637: <b>do_backtrace_depth_1</b>(D) -&gt;
<a name="638"/>  638:     Exit = fun() -&gt;
<a name="639"/>  639:                    error(reason)
<a name="640"/>  640:            end,
<a name="641"/>  641:     HandCrafted = fun() -&gt;
<a name="642"/>  642:                           {'EXIT',{_,Stk0}} = (catch error(get_stacktrace)),
<a name="643"/>  643:                           %% Fool the compiler to force a hand-crafted
<a name="644"/>  644:                           %% stacktrace.
<a name="645"/>  645:                           Stk = [hd(Stk0)|tl(Stk0)],
<a name="646"/>  646:                           erlang:raise(error, reason, Stk)
<a name="647"/>  647:                   end,
<a name="648"/>  648:     PassedOn = fun() -&gt;
<a name="649"/>  649:                        try error(get_stacktrace)
<a name="650"/>  650:                        catch error:_:Stk -&gt;
<a name="651"/>  651:                                %% Just pass on the given stacktrace.
<a name="652"/>  652:                                erlang:raise(error, reason, Stk)
<a name="653"/>  653:                        end
<a name="654"/>  654:                end,
<a name="655"/>  655:     do_backtrace_depth_2(D, Exit),
<a name="656"/>  656:     do_backtrace_depth_2(D, HandCrafted),
<a name="657"/>  657:     do_backtrace_depth_2(D, PassedOn),
<a name="do_backtrace_depth_1-last_expr"/><a name="658"/>  658:     ok.
<a name="659"/>  659: 
<a name="do_backtrace_depth_2-2"/><a name="660"/>  660: <b>do_backtrace_depth_2</b>(D, Exc) -&gt;
<a name="do_backtrace_depth_2-last_expr"/><a name="661"/>  661:     try
<a name="662"/>  662:         Exc()
<a name="663"/>  663:     catch
<a name="664"/>  664:         error:reason:Stk -&gt;
<a name="665"/>  665:             if
<a name="666"/>  666:                 length(Stk) =/= D -&gt;
<a name="667"/>  667:                     io:format(&quot;Expected depth: ~p\n&quot;, [D]),
<a name="668"/>  668:                     io:format(&quot;~p\n&quot;, [Stk]),
<a name="669"/>  669:                     error(bad_depth);
<a name="670"/>  670:                 true -&gt;
<a name="671"/>  671:                     ok
<a name="672"/>  672:             end
<a name="673"/>  673:     end.
<a name="674"/>  674: 
<a name="error_3-1"/><a name="675"/>  675: <b>error_3</b>(Config) -&gt;
<a name="676"/>  676:     {error_info,#{}} = do_error_3({some,reason}, [Config], [{error_info,#{}}]),
<a name="677"/>  677:     {error_info,#{cause:=whatever}} = do_error_3({some,reason}, [Config],
<a name="678"/>  678:                                                  [{error_info,#{cause=&gt;whatever}}]),
<a name="679"/>  679: 
<a name="680"/>  680:     false = do_error_3({some,reason}, [Config], []),
<a name="681"/>  681:     false = do_error_3({some,reason}, [Config], [{error_info,not_map}]),
<a name="682"/>  682:     false = do_error_3({some,reason}, [Config], [{bad,tuple}]),
<a name="683"/>  683:     false = do_error_3({some,reason}, [Config], [bad]),
<a name="684"/>  684: 
<a name="error_3-last_expr"/><a name="685"/>  685:     ok.
<a name="686"/>  686: 
<a name="do_error_3-3"/><a name="687"/>  687: <b>do_error_3</b>(Reason, Args, Options) -&gt;
<a name="688"/>  688:     {'EXIT',{Reason,[{?MODULE,?FUNCTION_NAME,Args,ExtraInfo}|_]}} = catch error(Reason, Args, Options),
<a name="do_error_3-last_expr"/><a name="689"/>  689: <b>    lists:keyfind</b>(error_info, 1, ExtraInfo).
<a name="690"/>  690: 
<a name="error_info-1"/><a name="691"/>  691: <b>error_info</b>(_Config) -&gt;
<a name="692"/>  692:     DeadProcess = dead_process(),
<a name="693"/>  693:     {NewAtom,NewAtomExt} = non_existing_atom(),
<a name="694"/>  694:     Eons = 1 bsl 50,
<a name="695"/>  695: 
<a name="696"/>  696:     %% We'll need an incorrect memory type for erlang:memory/1. We want to test an
<a name="697"/>  697:     %% incorrect atom if our own allocators are enabled, but if they are disabled,
<a name="698"/>  698:     %% we'll make do with a term that is obviously incorrect.
<a name="699"/>  699:     BadMemoryType = try erlang:memory() of
<a name="700"/>  700:                         _ -&gt; whatever
<a name="701"/>  701:                     catch
<a name="702"/>  702:                         error:notsup -&gt; 999
<a name="703"/>  703:                     end,
<a name="704"/>  704: 
<a name="705"/>  705:     %% Pick up external pid and port.
<a name="706"/>  706:     {ok, Peer, ExternalNode} = ?CT_PEER(),
<a name="707"/>  707:     ExternalPid = rpc:call(ExternalNode, erlang, whereis, [code_server]),
<a name="708"/>  708:     ExternalPort = hd(rpc:call(ExternalNode, erlang, ports, [])),
<a name="709"/>  709: 
<a name="710"/>  710:     L = [{abs, [abc]},
<a name="711"/>  711:          {adler32, [{bad,data}]},
<a name="712"/>  712:          {adler32, [old, new]},
<a name="713"/>  713:          {adler32, [1 bsl 48, new]},
<a name="714"/>  714:          {adler32_combine, [a, b, c]},
<a name="715"/>  715:          {adler32_combine, [1 bsl 48, 1 bsl 48, bad_size]},
<a name="716"/>  716:          {adler32_combine, [1 bsl 48, 1 bsl 48, -1]},
<a name="717"/>  717: 
<a name="718"/>  718:          {alias, [bad_options]},
<a name="719"/>  719: 
<a name="720"/>  720:          {alloc_info, 1},                       %Internal BIF.
<a name="721"/>  721:          {alloc_sizes, 1},                      %Internal BIF.
<a name="722"/>  722: 
<a name="723"/>  723:          {append, [a, b]},
<a name="724"/>  724:          {append_element, [no_tuple, any]},
<a name="725"/>  725: 
<a name="726"/>  726:          %% apply/2 and apply/3 are magic.
<a name="727"/>  727:          {apply, 2},
<a name="728"/>  728:          {apply, 3},
<a name="729"/>  729: 
<a name="730"/>  730:          {atom_to_binary, [&quot;abc&quot;]},
<a name="731"/>  731:          {atom_to_binary, [&quot;abc&quot;,latin1]},
<a name="732"/>  732:          {atom_to_binary, ['земля',latin1]},
<a name="733"/>  733:          {atom_to_binary, [xyz,utf42]},
<a name="734"/>  734: 
<a name="735"/>  735:          {atom_to_list, [{a,b,c}]},
<a name="736"/>  736: 
<a name="737"/>  737:          {binary_part, [&lt;&lt;&gt;&gt;, bad]},
<a name="738"/>  738:          {binary_part, [bad, bad]},
<a name="739"/>  739:          {binary_part, [&lt;&lt;1,2,3&gt;&gt;, {3,4}]},
<a name="740"/>  740:          {binary_part, [&lt;&lt;1,2,3&gt;&gt;, {3,4,5}]},
<a name="741"/>  741:          {binary_part, [bad, 3, 4]},
<a name="742"/>  742:          {binary_part, [&lt;&lt;1,2,3&gt;&gt;, 4, 4]},
<a name="743"/>  743: 
<a name="744"/>  744:          {binary_to_atom, [abc]},
<a name="745"/>  745:          {binary_to_atom, [&lt;&lt;128,128,255&gt;&gt;]},
<a name="746"/>  746: 
<a name="747"/>  747:          {binary_to_atom, [&lt;&lt;0:512/unit:8&gt;&gt;, latin1]},
<a name="748"/>  748:          {binary_to_atom, [abc, latin1]},
<a name="749"/>  749:          {binary_to_atom, [&lt;&lt;128,128,255&gt;&gt;, utf8]},
<a name="750"/>  750:          {binary_to_atom, [&lt;&lt;&quot;abc&quot;&gt;&gt;, utf42]},
<a name="751"/>  751: 
<a name="752"/>  752:          {binary_to_existing_atom, [abc]},
<a name="753"/>  753:          {binary_to_existing_atom, [&lt;&lt;128,128,255&gt;&gt;]},
<a name="754"/>  754:          {binary_to_existing_atom, [abc, latin1]},
<a name="755"/>  755:          {binary_to_existing_atom, [&lt;&lt;128,128,255&gt;&gt;,utf8]},
<a name="756"/>  756:          {binary_to_existing_atom, [list_to_binary(NewAtom), latin1]},
<a name="757"/>  757:          {binary_to_existing_atom, [list_to_binary(NewAtom), utf8]},
<a name="758"/>  758:          {binary_to_existing_atom, [list_to_binary(NewAtom), utf42]},
<a name="759"/>  759:          {binary_to_existing_atom, [[&lt;&lt;&quot;abc&quot;&gt;&gt;], utf8]},
<a name="760"/>  760:          {binary_to_existing_atom, [&lt;&lt;0:512/unit:8&gt;&gt;, latin1]},
<a name="761"/>  761: 
<a name="762"/>  762:          {binary_to_float, [abc]},
<a name="763"/>  763:          {binary_to_float, [&lt;&lt;&quot;0&quot;&gt;&gt;]},
<a name="764"/>  764:          {binary_to_float, [&lt;&lt;&quot;abc&quot;&gt;&gt;]},
<a name="765"/>  765:          {binary_to_integer, [abc]},
<a name="766"/>  766:          {binary_to_integer, [&lt;&lt;&quot;abc&quot;&gt;&gt;]},
<a name="767"/>  767: 
<a name="768"/>  768:          {binary_to_integer, [abc, 100]},
<a name="769"/>  769:          {binary_to_integer, [&lt;&lt;&quot;abc&quot;&gt;&gt;, 100]},
<a name="770"/>  770: 
<a name="771"/>  771:          {binary_to_list, [&lt;&lt;0:4&gt;&gt;]},
<a name="772"/>  772:          {binary_to_list, [abc]},
<a name="773"/>  773: 
<a name="774"/>  774:          {binary_to_list, [abc, x, y]},
<a name="775"/>  775:          {binary_to_list, [&lt;&lt;1,2,3&gt;&gt;, 3, 2]},
<a name="776"/>  776:          {binary_to_list, [&lt;&lt;1,2,3&gt;&gt;, 1, 4]},
<a name="777"/>  777:          {binary_to_list, [&lt;&lt;1,2,3&gt;&gt;, 4, 5]},
<a name="778"/>  778: 
<a name="779"/>  779:          {binary_to_term, [abc]},
<a name="780"/>  780:          {binary_to_term, [&lt;&lt;&quot;bad&quot;&gt;&gt;]},
<a name="781"/>  781: 
<a name="782"/>  782:          {binary_to_term, [term_to_binary(a), abc]},
<a name="783"/>  783:          {binary_to_term, [&lt;&lt;&quot;bad&quot;&gt;&gt;, abc]},
<a name="784"/>  784:          {binary_to_term, [&lt;&lt;&quot;bad&quot;&gt;&gt;, [bad]]},
<a name="785"/>  785:          {binary_to_term, [&lt;&lt;&quot;bad&quot;&gt;&gt;, []]},
<a name="786"/>  786:          {binary_to_term, [&lt;&lt;&quot;bad&quot;&gt;&gt;, [safe]]},
<a name="787"/>  787:          {binary_to_term, [NewAtomExt, [safe]]},
<a name="788"/>  788: 
<a name="789"/>  789:          {bit_size, [abc]},
<a name="790"/>  790:          {bitstring_to_list, [abc]},
<a name="791"/>  791:          {bump_reductions, [abc]},
<a name="792"/>  792:          {bump_reductions, [-1]},
<a name="793"/>  793:          {byte_size, [abc]},
<a name="794"/>  794:          {call_on_load_function, 1},
<a name="795"/>  795: 
<a name="796"/>  796:          {cancel_timer, [abc]},
<a name="797"/>  797:          {cancel_timer, [abc, bad]},
<a name="798"/>  798:          {cancel_timer, [abc, [bad]]},
<a name="799"/>  799:          {cancel_timer, [make_ref(), [bad]]},
<a name="800"/>  800: 
<a name="801"/>  801:          {ceil, [abc]},
<a name="802"/>  802: 
<a name="803"/>  803:          {check_old_code, [{a,b,c}]},
<a name="804"/>  804: 
<a name="805"/>  805:          {check_process_code, [self(), {no,module}]},
<a name="806"/>  806:          {check_process_code, [ExternalPid, code_server]},
<a name="807"/>  807:          {check_process_code, [no_pid, {no,module}]},
<a name="808"/>  808:          {check_process_code, [self(), abc, bad_option_list]},
<a name="809"/>  809:          {check_process_code, [self(), abc, [abc]]},
<a name="810"/>  810:          {check_process_code, [a, self(), [abc]]},
<a name="811"/>  811: 
<a name="812"/>  812:          {convert_time_unit, [a, b, c]},
<a name="813"/>  813: 
<a name="814"/>  814:          {crc32, [{bad,data}]},
<a name="815"/>  815:          {crc32, [old, new]},
<a name="816"/>  816:          {crc32, [1 bsl 48, new]},
<a name="817"/>  817:          {crc32_combine, [a, b, c]},
<a name="818"/>  818:          {crc32_combine, [1 bsl 48, 1 bsl 48, bad_size]},
<a name="819"/>  819:          {crc32_combine, [1 bsl 48, 1 bsl 48, -1]},
<a name="820"/>  820: 
<a name="821"/>  821:          {decode_packet, [xyz, not_binary, not_list]},
<a name="822"/>  822:          {decode_packet, [xyz, &lt;&lt;&gt;&gt;, []]},
<a name="823"/>  823:          {decode_packet, [xyz, not_binary, [bad_option]]},
<a name="824"/>  824:          {decode_packet, [asn1, &lt;&lt;&quot;abc&quot;&gt;&gt;, [bad_option]]},
<a name="825"/>  825: 
<a name="826"/>  826:          {delay_trap, 2},                       %Internal BIF.
<a name="827"/>  827: 
<a name="828"/>  828:          {delete_element, [0,{a,b,c}]},
<a name="829"/>  829:          {delete_element, [99,{a,b,c}]},
<a name="830"/>  830:          {delete_element, [not_integer,{a,b,c}]},
<a name="831"/>  831:          {delete_element, [1,not_tuple]},
<a name="832"/>  832:          {delete_element, [a,b]},
<a name="833"/>  833: 
<a name="834"/>  834:          {delete_module, [{a,b,c}]},
<a name="835"/>  835: 
<a name="836"/>  836:          {dmonitor_node, 3},                    %Internal BIF.
<a name="837"/>  837: 
<a name="838"/>  838:          {demonitor, [abc]},
<a name="839"/>  839:          {demonitor, [abc, bad]},
<a name="840"/>  840:          {demonitor, [abc, [bad]]},
<a name="841"/>  841:          {demonitor, [make_ref(), [bad]]},
<a name="842"/>  842: 
<a name="843"/>  843:          {disconnect_node, 1},                  %Never fails.
<a name="844"/>  844: 
<a name="845"/>  845:          {display, [&quot;test erlang:display/1&quot;], [no_fail]},
<a name="846"/>  846:          {display_string, [{a,b,c}]},
<a name="847"/>  847:          {display_string, [standard_out,&quot;test erlang:display/2&quot;]},
<a name="848"/>  848:          {display_string, [stdout,{a,b,c}]},
<a name="849"/>  849: 
<a name="850"/>  850:          %% Internal undcoumented BIFs.
<a name="851"/>  851:          {dist_ctrl_get_data, 1},
<a name="852"/>  852:          {dist_ctrl_get_data_notification, 1},
<a name="853"/>  853:          {dist_ctrl_get_opt, 2},
<a name="854"/>  854:          {dist_ctrl_input_handler, 2},
<a name="855"/>  855:          {dist_ctrl_put_data, 2},
<a name="856"/>  856:          {dist_ctrl_set_opt, 3},
<a name="857"/>  857:          {dist_get_stat, 1},
<a name="858"/>  858:          {dt_append_vm_tag_data, 1},
<a name="859"/>  859:          {dt_prepend_vm_tag_data, 1},
<a name="860"/>  860:          {dt_put_tag, 1},
<a name="861"/>  861:          {dt_restore_tag, 1},
<a name="862"/>  862:          {dt_spread_tag, 1},
<a name="863"/>  863: 
<a name="864"/>  864:          {element, [0,{a,b,c}]},
<a name="865"/>  865:          {element, [99,{a,b,c}]},
<a name="866"/>  866:          {element, [not_integer,{a,b,c}]},
<a name="867"/>  867:          {element, [1,not_tuple]},
<a name="868"/>  868:          {element, [a,b]},
<a name="869"/>  869: 
<a name="870"/>  870:          {erase, [abc], [no_fail]},
<a name="871"/>  871:          {error, 1},
<a name="872"/>  872:          {error, 2},
<a name="873"/>  873:          {error, 3},
<a name="874"/>  874:          {exit, 1},
<a name="875"/>  875: 
<a name="876"/>  876:          {exit, [a, b]},
<a name="877"/>  877:          {exit_signal, [a, b]},
<a name="878"/>  878: 
<a name="879"/>  879:          {external_size, [a], [no_fail]},
<a name="880"/>  880:          {external_size, [abc, xyz]},
<a name="881"/>  881: 
<a name="882"/>  882:          %% Internal undocumented BIF.
<a name="883"/>  883:          {finish_after_on_load, 2},
<a name="884"/>  884:          {finish_loading, 1},
<a name="885"/>  885: 
<a name="886"/>  886:          {float, [abc]},
<a name="887"/>  887:          {float_to_binary, [abc]},
<a name="888"/>  888:          {float_to_binary, [abc, bad_options]},
<a name="889"/>  889:          {float_to_list, [abc]},
<a name="890"/>  890:          {float_to_list, [abc, bad_options]},
<a name="891"/>  891:          {floor, [abc]},
<a name="892"/>  892: 
<a name="893"/>  893:          {format_cpu_topology, 1},              %Internal BIF.
<a name="894"/>  894: 
<a name="895"/>  895:          {fun_info, [abc]},
<a name="896"/>  896:          {fun_info, [abc, {bad,item}]},
<a name="897"/>  897:          {fun_info_mfa, [abc]},
<a name="898"/>  898:          {fun_to_list, [abc]},
<a name="899"/>  899:          {function_exported, [1,2,abc]},
<a name="900"/>  900: 
<a name="901"/>  901:          {garbage_collect, [not_a_pid]},
<a name="902"/>  902:          {garbage_collect, [ExternalPid]},
<a name="903"/>  903:          {garbage_collect, [not_a_pid, bad_option_list]},
<a name="904"/>  904:          {garbage_collect, [ExternalPid, bad_option_list]},
<a name="905"/>  905: 
<a name="906"/>  906:          {gather_gc_info_result, 1},            %Internal BIF.
<a name="907"/>  907: 
<a name="908"/>  908:          {get_cookie, [{not_node}]},
<a name="909"/>  909:          {get_keys, [value], [no_fail]},
<a name="910"/>  910:          {get_module_info, 1},
<a name="911"/>  911:          {get_module_info, 2},
<a name="912"/>  912: 
<a name="913"/>  913:          {group_leader, [not_pid, self()]},
<a name="914"/>  914:          {group_leader, [self(), not_pid]},
<a name="915"/>  915: 
<a name="916"/>  916:          {halt, [{bad,exit,status}]},
<a name="917"/>  917:          {halt, [a, []]},
<a name="918"/>  918:          {halt, [a, b]},
<a name="919"/>  919:          {halt, [1, [bad_option]]},
<a name="920"/>  920: 
<a name="921"/>  921:          {has_prepared_code_on_load, 1},
<a name="922"/>  922:          {hd, [abc]},
<a name="923"/>  923:          {hibernate, [1,2,a]},
<a name="924"/>  924:          {insert_element, [a, b, c]},
<a name="925"/>  925:          {insert_element, [0, b, c]},
<a name="926"/>  926:          {integer_to_binary, [42.0]},
<a name="927"/>  927:          {integer_to_binary, [42, 100]},
<a name="928"/>  928:          {integer_to_binary, [42.0, 100]},
<a name="929"/>  929:          {integer_to_list, [abc]},
<a name="930"/>  930:          {integer_to_list, [abc, 100]},
<a name="931"/>  931:          {iolist_size, [abc]},
<a name="932"/>  932:          {iolist_to_binary, [abc]},
<a name="933"/>  933:          {iolist_to_iovec, [abc]},
<a name="934"/>  934:          {is_builtin, [1, 2, a]},
<a name="935"/>  935:          {is_function, [abc, bad_arity]},
<a name="936"/>  936:          {is_function, [abc, -1]},
<a name="937"/>  937:          {is_map_key, [key, not_map]},
<a name="938"/>  938:          {is_process_alive, [abc]},
<a name="939"/>  939:          {is_record, [not_tuple,42]},
<a name="940"/>  940:          {is_record, [not_tuple,42,bad_size]},
<a name="941"/>  941:          {length, [abc]},
<a name="942"/>  942:          {link, [42]},
<a name="943"/>  943:          {link, [DeadProcess]},
<a name="944"/>  944:          {list_to_atom, [42]},
<a name="945"/>  945:          {list_to_atom, [lists:duplicate(1024, $a)]},
<a name="946"/>  946:          {list_to_binary, [42]},
<a name="947"/>  947:          {list_to_bitstring, [[a,b,c]]},
<a name="948"/>  948: 
<a name="949"/>  949:          {list_to_existing_atom, [abc]},
<a name="950"/>  950:          {list_to_existing_atom, [[a,b,c]]},
<a name="951"/>  951:          {list_to_existing_atom, [[[&quot;abc&quot;]]]},
<a name="952"/>  952:          {list_to_existing_atom, [NewAtom]},
<a name="953"/>  953:          {list_to_existing_atom, [[a|b]]},
<a name="954"/>  954: 
<a name="955"/>  955:          {list_to_float, [&quot;abc&quot;]},
<a name="956"/>  956:          {list_to_float, [abc]},
<a name="957"/>  957: 
<a name="958"/>  958:          {list_to_integer, [&quot;abc&quot;]},
<a name="959"/>  959:          {list_to_integer, [[a,b,c]]},
<a name="960"/>  960:          {list_to_integer, [[a|b]]},
<a name="961"/>  961:          {list_to_integer, [abc]},
<a name="962"/>  962: 
<a name="963"/>  963:          {list_to_integer, [&quot;abc&quot;,10]},
<a name="964"/>  964:          {list_to_integer, [[a,b,c],10]},
<a name="965"/>  965:          {list_to_integer, [[a|b],abc]},
<a name="966"/>  966:          {list_to_integer, [abc,10]},
<a name="967"/>  967:          {list_to_integer, [&quot;42&quot;,abc]},
<a name="968"/>  968: 
<a name="969"/>  969:          {list_to_pid, [&quot;pid&quot;]},
<a name="970"/>  970:          {list_to_pid, [42]},
<a name="971"/>  971: 
<a name="972"/>  972:          {list_to_port, [&quot;port&quot;]},
<a name="973"/>  973:          {list_to_port, [port]},
<a name="974"/>  974: 
<a name="975"/>  975:          {list_to_ref, [&quot;ref&quot;]},
<a name="976"/>  976:          {list_to_ref, [ref]},
<a name="977"/>  977: 
<a name="978"/>  978:          {list_to_tuple, [abc]},
<a name="979"/>  979: 
<a name="980"/>  980:          {load_module, [{no,module}, &lt;&lt;1,2,3&gt;&gt;]},
<a name="981"/>  981:          {load_module, [good_module_name, not_binary]},
<a name="982"/>  982: 
<a name="983"/>  983:          {load_nif, [{bad,path}, any]},
<a name="984"/>  984: 
<a name="985"/>  985:          {localtime_to_universaltime, [bad_date]},
<a name="986"/>  986:          {localtime_to_universaltime, [{{2020, 3, 12}, {12, 0, 0}}, not_boolean]},
<a name="987"/>  987:          {localtime_to_universaltime, [bad_date, not_boolean]},
<a name="988"/>  988: 
<a name="989"/>  989:          {make_fun, [0,1,-1]},
<a name="990"/>  990:          {make_fun, [0,1,abc]},
<a name="991"/>  991: 
<a name="992"/>  992:          {make_tuple, [a, element]},
<a name="993"/>  993:          {make_tuple, [10, element, abc]},
<a name="994"/>  994:          {make_tuple, [xyz, element, [abc]]},
<a name="995"/>  995: 
<a name="996"/>  996:          {map_get, [a, #{}]},
<a name="997"/>  997:          {map_get, [a, b]},
<a name="998"/>  998:          {map_size, [[a,b,c]]},
<a name="999"/>  999: 
<a name="1000"/> 1000:          {match_spec_test, [abc, match_spec, bad_type]},
<a name="1001"/> 1001:          {match_spec_test, [abc, match_spec, trace]},
<a name="1002"/> 1002:          {match_spec_test, [abc, [{{'$1','$2','$3'},[],['$$']}], table], [no_fail]},
<a name="1003"/> 1003: 
<a name="1004"/> 1004:          {md5, [abc]},
<a name="1005"/> 1005:          {md5_final, [abc]},
<a name="1006"/> 1006:          {md5_update, [abc, xyz]},
<a name="1007"/> 1007:          {md5_update, [&lt;&lt;&quot;bad context&quot;&gt;&gt;, &quot;data&quot;]},
<a name="1008"/> 1008: 
<a name="1009"/> 1009:          {memory, [BadMemoryType]},             %An atom if our own allocators are enabled.
<a name="1010"/> 1010:          {memory, [{always,wrong}]},
<a name="1011"/> 1011: 
<a name="1012"/> 1012:          %% Not a BIF.
<a name="1013"/> 1013:          {module_info, 1},
<a name="1014"/> 1014: 
<a name="1015"/> 1015:          {module_loaded, [42]},
<a name="1016"/> 1016: 
<a name="1017"/> 1017:          {monitor, [moon, whatever]},
<a name="1018"/> 1018:          {monitor, [port, self()]},
<a name="1019"/> 1019:          {monitor, [port, ExternalPort]},
<a name="1020"/> 1020: 
<a name="1021"/> 1021:          {monitor, [moon, whatever, []]},
<a name="1022"/> 1022:          {monitor, [port, self(), []]},
<a name="1023"/> 1023:          {monitor, [port, ExternalPort, []]},
<a name="1024"/> 1024:          {monitor, [port, ExternalPort, [bad_option]]},
<a name="1025"/> 1025:          {monitor, [process, self(), [bad_option]]},
<a name="1026"/> 1026:          {monitor, [process, self(), not_a_list]},
<a name="1027"/> 1027: 
<a name="1028"/> 1028:          {monitor_node, [{a,b,c}, bad]},
<a name="1029"/> 1029:          {monitor_node, [{a,b,c}, bad, bad]},
<a name="1030"/> 1030:          {monitor_node, [{a,b,c}, bad, [bad]]},
<a name="1031"/> 1031: 
<a name="1032"/> 1032:          {monotonic_time, [fortnight]},
<a name="1033"/> 1033: 
<a name="1034"/> 1034:          {nif_error, 1},
<a name="1035"/> 1035:          {nif_error, 2},
<a name="1036"/> 1036:          {node, [abc]},
<a name="1037"/> 1037:          {nodes, [abc], [{1, &quot;.*not a valid node type.*&quot;}]},
<a name="1038"/> 1038:          {nodes, [[abc]], [{1, &quot;.*not a list of.*&quot;}]},
<a name="1039"/> 1039:          {nodes, [DeadProcess], [{1, &quot;.*not a valid node type or list of valid node types.*&quot;}]},
<a name="1040"/> 1040:          {nodes, [abc, 17], [{1, &quot;.*not a valid node type.*&quot;},{2, &quot;.*not a map.*&quot;}]},
<a name="1041"/> 1041:          {nodes, [hidden, 17], [{2, &quot;.*not a map.*&quot;}]},
<a name="1042"/> 1042:          {nodes, [hidden, #{ 17 =&gt; true }], [{2, &quot;.*invalid options in map.*&quot;}]},
<a name="1043"/> 1043:          {nodes, [hidden, #{ connection_id =&gt; 17 }], [{2, &quot;.*invalid options in map.*&quot;}]},
<a name="1044"/> 1044:          {nodes, [hidden, #{ node_type =&gt; 17 }], [{2, &quot;.*invalid options in map.*&quot;}]},
<a name="1045"/> 1045:          {nodes, [abc, #{}], [{1, &quot;.*not a valid node type.*&quot;}]},
<a name="1046"/> 1046:          {nodes, [DeadProcess,#{node_type=&gt;true}], [{1, &quot;.*not a valid node type or list of valid node types.*&quot;}]},
<a name="1047"/> 1047:          {nodes, [visible, 17], [{2,&quot;.*not a map.*&quot;}]},
<a name="1048"/> 1048:          {nodes, [visible, #{connection_id=&gt;blapp}], [{2,&quot;.*invalid options in map.*&quot;}]},
<a name="1049"/> 1049:          {nodes, [visible, 17], [{2,&quot;.*not a map.*&quot;}]},
<a name="1050"/> 1050:          {nodes, [known, #{connection_id=&gt;true,node_type=&gt;true}], [no_fail]},
<a name="1051"/> 1051:          {nodes, [[this,connected], #{connection_id=&gt;true,node_type=&gt;true}], [no_fail]},
<a name="1052"/> 1052:          {phash, [any, -1]},
<a name="1053"/> 1053:          {phash, [any, not_integer]},
<a name="1054"/> 1054:          {phash2, [any], [no_fail]},
<a name="1055"/> 1055:          {phash2, [any, not_integer]},
<a name="1056"/> 1056:          {pid_to_list, [abc]},
<a name="1057"/> 1057: 
<a name="1058"/> 1058:          {open_port, [{bad,name}, []]},
<a name="1059"/> 1059:          {open_port, [{spawn, &quot;no_command&quot;}, bad_option_list]},
<a name="1060"/> 1060:          {open_port, [{spawn, &quot;no_command&quot;}, [xyz]]},
<a name="1061"/> 1061:          {open_port, [{spawn, &quot;no_command&quot;}, [{args,[]}]],[{1,&quot;.*spawn_executable.*&quot;}]},
<a name="1062"/> 1062: 
<a name="1063"/> 1063:          {port_call, 2},                        %Internal BIF.
<a name="1064"/> 1064: 
<a name="1065"/> 1065:          {port_call, [{no,port}, b, data]},
<a name="1066"/> 1066:          {port_call, [{no,port}, -1, data]},
<a name="1067"/> 1067:          {port_call, [{no,port}, 1 bsl 32, data]},
<a name="1068"/> 1068:          {port_call, [ExternalPort, b, data]},
<a name="1069"/> 1069: 
<a name="1070"/> 1070:          {port_close, [{no,port}]},
<a name="1071"/> 1071:          {port_close, [ExternalPort]},
<a name="1072"/> 1072: 
<a name="1073"/> 1073:          {port_command, [{no,port}, [a|b]]},
<a name="1074"/> 1074: 
<a name="1075"/> 1075:          {port_command, [{no,port}, [command], [whatever]]},
<a name="1076"/> 1076:          {port_command, [{no,port}, [command], whatever]},
<a name="1077"/> 1077:          {port_command, [ExternalPort, [command], whatever]},
<a name="1078"/> 1078: 
<a name="1079"/> 1079:          {port_connect, [{no,port}, whatever]},
<a name="1080"/> 1080:          {port_connect, [{no,port}, self()]},
<a name="1081"/> 1081:          {port_connect, [{no,port}, ExternalPid]},
<a name="1082"/> 1082:          {port_connect, [ExternalPort, self()]},
<a name="1083"/> 1083: 
<a name="1084"/> 1084:          {port_control, [{no,port}, -1, {a,b,c}]},
<a name="1085"/> 1085:          {port_control, [ExternalPort, -1, {a,b,c}]},
<a name="1086"/> 1086: 
<a name="1087"/> 1087:          {port_info, [{no,port}]},
<a name="1088"/> 1088:          {port_info, [ExternalPort]},
<a name="1089"/> 1089: 
<a name="1090"/> 1090:          {port_info, [{no,port}, bad_info]},
<a name="1091"/> 1091:          {port_info, [ExternalPort, name]},
<a name="1092"/> 1092:          {port_info, [ExternalPort, bad_info]},
<a name="1093"/> 1093: 
<a name="1094"/> 1094:          %% Internal undocumented BIFs.
<a name="1095"/> 1095:          {port_get_data, 1},
<a name="1096"/> 1096:          {port_set_data, 2},
<a name="1097"/> 1097: 
<a name="1098"/> 1098:          {port_to_list, [abc]},
<a name="1099"/> 1099:          {posixtime_to_universaltime, [abc]},
<a name="1100"/> 1100: 
<a name="1101"/> 1101:          {prepare_loading, [{no,module}, &lt;&lt;1,2,3&gt;&gt;]},
<a name="1102"/> 1102:          {prepare_loading, [good_module_name, not_binary]},
<a name="1103"/> 1103:          {prepare_loading, [&lt;&lt;1,2,3&gt;&gt;, not_binary]},
<a name="1104"/> 1104: 
<a name="1105"/> 1105:          {process_display, [bad_pid, whatever]},
<a name="1106"/> 1106:          {process_display, [self(), whatever]},
<a name="1107"/> 1107:          {process_display, [ExternalPid, backtrace]},
<a name="1108"/> 1108:          {process_display, [ExternalPid, whatever]},
<a name="1109"/> 1109:          {process_display, [DeadProcess, backtrace]},
<a name="1110"/> 1110: 
<a name="1111"/> 1111:          {processes_next, [{a, []}]},
<a name="1112"/> 1112:          {processes_next, [{-1, []}]},
<a name="1113"/> 1113:          {processes_next, [a]},
<a name="1114"/> 1114: 
<a name="1115"/> 1115:          {process_flag, [trap_exit, some_value]},
<a name="1116"/> 1116:          {process_flag, [bad_flag, some_value]},
<a name="1117"/> 1117: 
<a name="1118"/> 1118:          {process_flag, [self(), bad_flag, some_value]},
<a name="1119"/> 1119:          {process_flag, [self(), save_calls, not_integer]},
<a name="1120"/> 1120:          {process_flag, [self(), save_calls, 1 bsl 64]},
<a name="1121"/> 1121:          {process_flag, [ExternalPid, save_calls, 20]},
<a name="1122"/> 1122:          {process_flag, [ExternalPid, save_calls, not_integer]},
<a name="1123"/> 1123:          {process_flag, [ExternalPid, bad_flag, some_value]},
<a name="1124"/> 1124:          {process_flag, [DeadProcess, save_calls, 20]},
<a name="1125"/> 1125:          {process_flag, [DeadProcess, not_save_save_calls, 20]},
<a name="1126"/> 1126: 
<a name="1127"/> 1127:          {process_info, [42]},
<a name="1128"/> 1128:          {process_info, [ExternalPid]},
<a name="1129"/> 1129: 
<a name="1130"/> 1130:          {process_info, [self(), {a,b,c}]},
<a name="1131"/> 1131:          {process_info, [ExternalPid, current_function]},
<a name="1132"/> 1132: 
<a name="1133"/> 1133:          {purge_module, [{no,module}]},
<a name="1134"/> 1134: 
<a name="1135"/> 1135:          {put, [key_never_read, value], [no_fail]},
<a name="1136"/> 1136: 
<a name="1137"/> 1137:          {raise, 3},
<a name="1138"/> 1138:          {read_timer, [bad_timer]},
<a name="1139"/> 1139:          {read_timer, [bad_time, bad_options]},
<a name="1140"/> 1140:          {ref_to_list, [abc]},
<a name="1141"/> 1141: 
<a name="1142"/> 1142:          {register, [&lt;&lt;&quot;name&quot;&gt;&gt;, abc]},
<a name="1143"/> 1143:          {register, [&lt;&lt;&quot;name&quot;&gt;&gt;, self()]},
<a name="1144"/> 1144:          {register, [my_registered_name, abc]},
<a name="1145"/> 1145:          {register, [undefined, self()]},
<a name="1146"/> 1146:          {register, [code_server, self()]},
<a name="1147"/> 1147:          {register, [my_registered_name, whereis(code_server)]},
<a name="1148"/> 1148:          {register, [my_registered_name, DeadProcess]},
<a name="1149"/> 1149:          {register, [my_registered_name, ExternalPid]},
<a name="1150"/> 1150:          {register, [my_registered_name, ExternalPort]},
<a name="1151"/> 1151: 
<a name="1152"/> 1152:          {resume_process, [abc]},
<a name="1153"/> 1153:          {resume_process, [self()]},
<a name="1154"/> 1154:          {resume_process, [DeadProcess]},
<a name="1155"/> 1155:          {resume_process, [ExternalPid]},
<a name="1156"/> 1156: 
<a name="1157"/> 1157:          {round, [abc]},
<a name="1158"/> 1158: 
<a name="1159"/> 1159:          {send, [[bad,dest], message]},
<a name="1160"/> 1160:          {send, [[bad,dest], message, bad]},
<a name="1161"/> 1161: 
<a name="1162"/> 1162:          {send_after, [Eons, self(), message]},
<a name="1163"/> 1163:          {send_after, [Eons, {bad,dest}, message]},
<a name="1164"/> 1164:          {send_after, [bad_time, {bad,dest}, message]},
<a name="1165"/> 1165:          {send_after, [20, ExternalPid, message]},
<a name="1166"/> 1166: 
<a name="1167"/> 1167:          {send_after, [Eons, self(), message, bad_options]},
<a name="1168"/> 1168:          {send_after, [Eons, {bad,dest}, message, bad_options]},
<a name="1169"/> 1169:          {send_after, [bad_time, {bad,dest}, message, bad_options]},
<a name="1170"/> 1170:          {send_after, [20, self(), message, [bad]]},
<a name="1171"/> 1171:          {send_after, [20, ExternalPid, message, []]},
<a name="1172"/> 1172: 
<a name="1173"/> 1173:          {send_nosuspend, [bad_pid, message]},
<a name="1174"/> 1174:          {send_nosuspend, [bad_pid, message, []]},
<a name="1175"/> 1175:          {send_nosuspend, [self(), message, [bad_option]]},
<a name="1176"/> 1176:          {send_nosuspend, [self(), message, bad_options]},
<a name="1177"/> 1177: 
<a name="1178"/> 1178:          %% Internal undocumented BIFs.
<a name="1179"/> 1179:          {seq_trace, 2},
<a name="1180"/> 1180:          {seq_trace_info, 1},
<a name="1181"/> 1181:          {seq_trace_print, 1},
<a name="1182"/> 1182:          {seq_trace_print, 2},
<a name="1183"/> 1183:          {set_cookie, [{not_cookie}]},
<a name="1184"/> 1184:          {set_cookie, [{not_node}, {not_cookie}]},
<a name="1185"/> 1185:          {set_cookie, [nonode@nohost, {not_cookie}]},
<a name="1186"/> 1186:          {set_cpu_topology, 1},
<a name="1187"/> 1187: 
<a name="1188"/> 1188:          {setelement, [a, b, c]},
<a name="1189"/> 1189:          {setnode, 2},                          %Internal und undocumented BIF.
<a name="1190"/> 1190:          {setnode, 3},                          %Internal und undocumented BIF.
<a name="1191"/> 1191:          {size, [abc]},
<a name="1192"/> 1192: 
<a name="1193"/> 1193:          {spawn, [not_fun]},
<a name="1194"/> 1194:          {spawn, [[bad_node], not_fun]},
<a name="1195"/> 1195:          {spawn, [0, 1, 2]},
<a name="1196"/> 1196:          {spawn, [0, 1, [a|b]]},
<a name="1197"/> 1197:          {spawn, [[bad_node], 0, 1, a]},
<a name="1198"/> 1198: 
<a name="1199"/> 1199:          {spawn_link, [not_fun]},
<a name="1200"/> 1200:          {spawn_link, [[bad_node], not_fun]},
<a name="1201"/> 1201:          {spawn_link, [0, 1, 2]},
<a name="1202"/> 1202:          {spawn_link, [[bad_node], 0, 1, a]},
<a name="1203"/> 1203: 
<a name="1204"/> 1204:          {spawn_monitor, [not_fun]},
<a name="1205"/> 1205:          {spawn_monitor, [[bad_node], not_fun]},
<a name="1206"/> 1206:          {spawn_monitor, [0, 1, a]},
<a name="1207"/> 1207:          {spawn_monitor, [[bad_node], 0, 1, a]},
<a name="1208"/> 1208: 
<a name="1209"/> 1209:          {spawn_opt, [bad_fun, []]},
<a name="1210"/> 1210:          {spawn_opt, [bad_fun, [a|b]]},
<a name="1211"/> 1211:          {spawn_opt, [bad_fun, [bad_option]]},
<a name="1212"/> 1212:          {spawn_opt, [fun() -&gt; ok end, [bad_option]]},
<a name="1213"/> 1213: 
<a name="1214"/> 1214:          {spawn_opt, [node(), bad_fun, []]},
<a name="1215"/> 1215:          {spawn_opt, [[bad_node], fun() -&gt; ok end, []]},
<a name="1216"/> 1216:          {spawn_opt, [[bad_node], bad_fun, bad_options]},
<a name="1217"/> 1217: 
<a name="1218"/> 1218:          {spawn_opt, [0, 1, 2, bad_options]},
<a name="1219"/> 1219:          {spawn_opt, [0, 1, 2, bad_options]},
<a name="1220"/> 1220:          {spawn_opt, [0, 1, 2, [bad_option]]},
<a name="1221"/> 1221:          {spawn_opt, [[bad_node], 0, 1, 1 bsl 64, [bad_option]]},
<a name="1222"/> 1222: 
<a name="1223"/> 1223:          {spawn_request, [not_a_fun]},
<a name="1224"/> 1224: 
<a name="1225"/> 1225:          {spawn_request, [a, b]},
<a name="1226"/> 1226:          {spawn_request, [42, 43]},
<a name="1227"/> 1227:          {spawn_request, [[bad_node], bad_fun]},
<a name="1228"/> 1228:          {spawn_request, [fun() -&gt; ok end, [a|b]]},
<a name="1229"/> 1229:          {spawn_request, [[bad_node], fun() -&gt; ok end]},
<a name="1230"/> 1230: 
<a name="1231"/> 1231:          {spawn_request, [[bad_node], fun() -&gt; ok end, []]},
<a name="1232"/> 1232:          {spawn_request, [[bad_node], fun() -&gt; ok end, bad_options]},
<a name="1233"/> 1233:          {spawn_request, [node, fun() -&gt; ok end, bad_options]},
<a name="1234"/> 1234:          {spawn_request, [0, 1, a]},
<a name="1235"/> 1235: 
<a name="1236"/> 1236:          {spawn_request, [0, 1, a, []]},
<a name="1237"/> 1237:          {spawn_request, [m, f, [a], [a|b]]},
<a name="1238"/> 1238: 
<a name="1239"/> 1239:          {spawn_request, [node(), m, f, [a], bad_option_list]},
<a name="1240"/> 1240:          {spawn_request, [[bad_node], 0, 1, a, []]},
<a name="1241"/> 1241:          {spawn_request, [[bad_node], 0, 1, a, [a|b]]},
<a name="1242"/> 1242: 
<a name="1243"/> 1243:          {spawn_request_abandon, [abc]},
<a name="1244"/> 1244: 
<a name="1245"/> 1245:          {split_binary, [a, b]},
<a name="1246"/> 1246:          {split_binary, [a, -1]},
<a name="1247"/> 1247:          {split_binary, [&lt;&lt;&gt;&gt;, 1]},
<a name="1248"/> 1248: 
<a name="1249"/> 1249:          {start_timer, [Eons, self(), message]},
<a name="1250"/> 1250:          {start_timer, [Eons, {bad,dest}, message]},
<a name="1251"/> 1251:          {start_timer, [bad_time, {bad,dest}, message]},
<a name="1252"/> 1252: 
<a name="1253"/> 1253:          {start_timer, [Eons, self(), message, []]},
<a name="1254"/> 1254:          {start_timer, [Eons, {bad,dest}, message, [bad]]},
<a name="1255"/> 1255:          {start_timer, [bad_time, {bad,dest}, message, bad_options]},
<a name="1256"/> 1256:          {start_timer, [20, self(), message, [bad]]},
<a name="1257"/> 1257:          {start_timer, [20, ExternalPid, message, []]},
<a name="1258"/> 1258: 
<a name="1259"/> 1259:          {statistics, [abc]},
<a name="1260"/> 1260:          {statistics, [{a,b,c}]},
<a name="1261"/> 1261:          {subtract, [a,b]},
<a name="1262"/> 1262: 
<a name="1263"/> 1263:          {suspend_process, [self()]},
<a name="1264"/> 1264:          {suspend_process, [ExternalPid]},
<a name="1265"/> 1265:          {suspend_process, [not_a_pid]},
<a name="1266"/> 1266: 
<a name="1267"/> 1267:          {suspend_process, [self(), []]},
<a name="1268"/> 1268:          {suspend_process, [ExternalPid, []]},
<a name="1269"/> 1269:          {suspend_process, [not_a_pid, []]},
<a name="1270"/> 1270:          {suspend_process, [not_a_pid, [bad_option]]},
<a name="1271"/> 1271: 
<a name="1272"/> 1272:          {system_flag, [bad_flag, whatever]},
<a name="1273"/> 1273:          {system_flag, [{bad,flag}, whatever]},
<a name="1274"/> 1274:          {system_flag, [backtrace_depth, bad_depth]},
<a name="1275"/> 1275:          {system_info, [{bad,item}]},
<a name="1276"/> 1276:          {system_info, [bad_item]},
<a name="1277"/> 1277: 
<a name="1278"/> 1278:          {system_monitor, [whatever]},
<a name="1279"/> 1279:          {system_monitor, [ExternalPid]},
<a name="1280"/> 1280: 
<a name="1281"/> 1281:          {system_monitor, [not_pid, bad_list]},
<a name="1282"/> 1282:          {system_monitor, [self(), bad_list]},
<a name="1283"/> 1283:          {system_monitor, [self(), [bad]]},
<a name="1284"/> 1284:          {system_monitor, [ExternalPid, [busy_port]]},
<a name="1285"/> 1285:          {system_monitor, [ExternalPid, [bad]]},
<a name="1286"/> 1286:          {system_monitor, [self(), [bad]]},
<a name="1287"/> 1287: 
<a name="1288"/> 1288:          %% Complex error reasons. Ignore for now.
<a name="1289"/> 1289:          {system_profile, 2},
<a name="1290"/> 1290: 
<a name="1291"/> 1291:          {system_time, [fortnight]},
<a name="1292"/> 1292: 
<a name="1293"/> 1293:          {term_to_binary, [any, bad_options]},
<a name="1294"/> 1294:          {term_to_binary, [any, [bad]]},
<a name="1295"/> 1295: 
<a name="1296"/> 1296:          {term_to_iovec, [any], [no_fail]},
<a name="1297"/> 1297:          {term_to_iovec, [any, bad_options]},
<a name="1298"/> 1298:          {term_to_iovec, [any, [bad]]},
<a name="1299"/> 1299: 
<a name="1300"/> 1300:          {throw, 1},
<a name="1301"/> 1301:          {time_offset, [fortnight]},
<a name="1302"/> 1302:          {tl, [abc]},
<a name="1303"/> 1303: 
<a name="1304"/> 1304:          {trace, [ExternalPid, true, all]},
<a name="1305"/> 1305:          {trace, [ExternalPid, not_boolean, bad_flags]},
<a name="1306"/> 1306:          {trace, [ExternalPort, true, all]},
<a name="1307"/> 1307:          {trace, [a, not_boolean, bad_flags]},
<a name="1308"/> 1308:          {trace, [a, not_boolean, [bad_flag]]},
<a name="1309"/> 1309:          {trace, [a, true, [a|b]]},
<a name="1310"/> 1310: 
<a name="1311"/> 1311:          {trace_pattern, [a, b]},
<a name="1312"/> 1312:          {trace_pattern, [a, b, c]},
<a name="1313"/> 1313:          {trace_pattern, [{?MODULE,'_','_'}, [{[self(), '_'],[],[]}], [call_count]]},
<a name="1314"/> 1314: 
<a name="1315"/> 1315:          {trace_delivered, [ExternalPid]},
<a name="1316"/> 1316:          {trace_delivered, [abc]},
<a name="1317"/> 1317: 
<a name="1318"/> 1318:          {trace_info, [ExternalPid, flags]},
<a name="1319"/> 1319:          {trace_info, [ExternalPid, bad_item]},
<a name="1320"/> 1320:          {trace_info, [ExternalPort, flags]},
<a name="1321"/> 1321:          {trace_info, [ExternalPort, bad_item]},
<a name="1322"/> 1322:          {trace_info, [self(), bad_item]},
<a name="1323"/> 1323:          {trace_info, [bad_tracee_spec, flags]},
<a name="1324"/> 1324: 
<a name="1325"/> 1325:          {trunc, [abc]},
<a name="1326"/> 1326:          {tuple_size, [&lt;&lt;&quot;abc&quot;&gt;&gt;]},
<a name="1327"/> 1327:          {tuple_to_list, [&lt;&lt;&quot;abc&quot;&gt;&gt;]},
<a name="1328"/> 1328:          {unalias,[not_a_ref]},
<a name="1329"/> 1329:          {unique_integer, [[a|b]]},
<a name="1330"/> 1330:          {unique_integer, [[a,b]]},
<a name="1331"/> 1331:          {unique_integer, [abc]},
<a name="1332"/> 1332:          {universaltime_to_localtime, [bad_time]},
<a name="1333"/> 1333:          {universaltime_to_posixtime, [bad_time]},
<a name="1334"/> 1334:          {unlink, [42]},
<a name="1335"/> 1335:          {unregister, [{a,b,c}]},
<a name="1336"/> 1336:          {whereis, [self()]}
<a name="1337"/> 1337:         ],
<a name="error_info-last_expr"/><a name="1338"/> 1338:     try
<a name="1339"/> 1339:         do_error_info(L)
<a name="1340"/> 1340:     after
<a name="1341"/> 1341:         peer:stop(Peer)
<a name="1342"/> 1342:     end.
<a name="1343"/> 1343: 
<a name="dead_process-0"/><a name="1344"/> 1344: <b>dead_process</b>() -&gt;
<a name="1345"/> 1345:     {Pid,Ref} = spawn_monitor(fun() -&gt; ok end),
<a name="dead_process-last_expr"/><a name="1346"/> 1346:     receive
<a name="1347"/> 1347:         {'DOWN',Ref,process,Pid,normal} -&gt;
<a name="1348"/> 1348:             Pid
<a name="1349"/> 1349:     end.
<a name="1350"/> 1350: 
<a name="non_existing_atom-0"/><a name="1351"/> 1351: <b>non_existing_atom</b>() -&gt;
<a name="non_existing_atom-last_expr"/><a name="1352"/> 1352: <b>    non_existing_atom</b>([]).
<a name="1353"/> 1353: 
<a name="non_existing_atom-1"/><a name="1354"/> 1354: <b>non_existing_atom</b>(Atom) -&gt;
<a name="non_existing_atom-last_expr"/><a name="1355"/> 1355: <b>    try list_to_existing_atom</b>(Atom) of
<a name="1356"/> 1356:         _ -&gt;
<a name="1357"/> 1357:             Char = rand:uniform($Z - $A + 1) + $A - 1,
<a name="1358"/> 1358:             non_existing_atom([Char|Atom])
<a name="1359"/> 1359:     catch
<a name="1360"/> 1360:         error:badarg -&gt;
<a name="1361"/> 1361:             AtomBin = list_to_binary(Atom),
<a name="1362"/> 1362:             AtomExt = &lt;&lt;131,100,(byte_size(AtomBin)):16,AtomBin/binary&gt;&gt;,
<a name="1363"/> 1363:             {Atom,AtomExt}
<a name="1364"/> 1364:     end.
<a name="1365"/> 1365: 
<a name="do_error_info-1"/><a name="1366"/> 1366: <b>do_error_info</b>(L0) -&gt;
<a name="1367"/> 1367:     L1 = lists:foldl(fun({_,A}, Acc) when is_integer(A) -&gt; Acc;
<a name="1368"/> 1368:                         ({F,A}, Acc) -&gt; [{F,A,[]}|Acc];
<a name="1369"/> 1369:                         ({F,A,Opts}, Acc) -&gt; [{F,A,Opts}|Acc]
<a name="1370"/> 1370:                      end, [], L0),
<a name="1371"/> 1371:     Tests = ordsets:from_list([{F,length(A)} || {F,A,_} &lt;- L1] ++
<a name="1372"/> 1372:                                   [{F,A} || {F,A} &lt;- L0, is_integer(A)]),
<a name="1373"/> 1373:     Bifs0 = [{F,A} || {F,A} &lt;- erlang:module_info(exports),
<a name="1374"/> 1374:                       A =/= 0,
<a name="1375"/> 1375:                       not erl_bifs:is_safe(erlang, F, A),
<a name="1376"/> 1376:                       not erl_internal:arith_op(F, A),
<a name="1377"/> 1377:                       not erl_internal:bool_op(F, A),
<a name="1378"/> 1378:                       not erl_internal:list_op(F, A),
<a name="1379"/> 1379:                       not erl_internal:send_op(F, A)],
<a name="1380"/> 1380:     Bifs = ordsets:from_list(Bifs0),
<a name="1381"/> 1381:     NYI = [{F,lists:duplicate(A, '*'),nyi} || {F,A} &lt;- Bifs -- Tests],
<a name="1382"/> 1382:     L = lists:sort(NYI ++ L1),
<a name="do_error_info-last_expr"/><a name="1383"/> 1383: <b>    do_error_info</b>(L, []).
<a name="1384"/> 1384: 
<a name="do_error_info-2"/><a name="1385"/> 1385: <b>do_error_info</b>([{_,Args,nyi}=H|T], Errors) -&gt;
<a name="1386"/> 1386:     case lists:all(fun(A) -&gt; A =:= '*' end, Args) of
<a name="1387"/> 1387:         true -&gt;
<a name="1388"/> 1388:             do_error_info(T, [{nyi,H}|Errors]);
<a name="1389"/> 1389:         false -&gt;
<a name="1390"/> 1390:             do_error_info(T, [{bad_nyi,H}|Errors])
<a name="1391"/> 1391:     end;
<a name="1392"/> 1392: <b>do_error_info</b>([{F,Args,Opts}|T], Errors) -&gt;
<a name="1393"/> 1393:     eval_bif_error(F, Args, Opts, T, Errors);
<a name="1394"/> 1394: <b>do_error_info</b>([], Errors0) -&gt;
<a name="do_error_info-last_expr"/><a name="1395"/> 1395: <b>    case lists:sort</b>(Errors0) of
<a name="1396"/> 1396:         [] -&gt;
<a name="1397"/> 1397:             ok;
<a name="1398"/> 1398:         [_|_]=Errors -&gt;
<a name="1399"/> 1399:             io:format(&quot;\n~p\n&quot;, [Errors]),
<a name="1400"/> 1400:             ct:fail({length(Errors),errors})
<a name="1401"/> 1401:     end.
<a name="1402"/> 1402: 
<a name="eval_bif_error-5"/><a name="1403"/> 1403: <b>eval_bif_error</b>(F, Args, Opts, T, Errors0) -&gt;
<a name="eval_bif_error-last_expr"/><a name="1404"/> 1404: <b>    try eval_do_apply</b>(erlang, F, Args) of
<a name="1405"/> 1405:         Result -&gt;
<a name="1406"/> 1406:             case lists:member(no_fail, Opts) of
<a name="1407"/> 1407:                 true -&gt;
<a name="1408"/> 1408:                     do_error_info(T, Errors0);
<a name="1409"/> 1409:                 false -&gt;
<a name="1410"/> 1410:                     do_error_info(T, [{should_fail,{F,Args},Result}|Errors0])
<a name="1411"/> 1411:             end
<a name="1412"/> 1412:     catch
<a name="1413"/> 1413:         error:Reason:Stk -&gt;
<a name="1414"/> 1414:             SF = fun(Mod, _, _) -&gt; Mod =:= test_server end,
<a name="1415"/> 1415:             Str = erl_error:format_exception(error, Reason, Stk, #{stack_trim_fun =&gt; SF}),
<a name="1416"/> 1416:             BinStr = iolist_to_binary(Str),
<a name="1417"/> 1417:             ArgStr = lists:join(&quot;, &quot;, [io_lib:format(&quot;~p&quot;, [A]) || A &lt;- Args]),
<a name="1418"/> 1418:             io:format(&quot;\nerlang:~p(~s)\n~ts&quot;, [F,ArgStr,BinStr]),
<a name="1419"/> 1419: 
<a name="1420"/> 1420:             {erlang,ActualF,ActualArgs,Info} = hd(Stk),
<a name="1421"/> 1421: 
<a name="1422"/> 1422:             RE = &lt;&lt;&quot;[*][*][*] argument \\d+:&quot;&gt;&gt;,
<a name="1423"/> 1423:             Errors1 = case re:run(BinStr, RE, [{capture, none}]) of
<a name="1424"/> 1424:                           match -&gt;
<a name="1425"/> 1425:                               Errors0;
<a name="1426"/> 1426:                           nomatch when Reason =:= system_limit -&gt;
<a name="1427"/> 1427:                               Errors0;
<a name="1428"/> 1428:                           nomatch -&gt;
<a name="1429"/> 1429:                               [{no_explanation,{F,Args},Info}|Errors0]
<a name="1430"/> 1430:                       end,
<a name="1431"/> 1431: 
<a name="1432"/> 1432:             Errors = case {ActualF,ActualArgs} of
<a name="1433"/> 1433:                          {F,Args} -&gt;
<a name="1434"/> 1434:                              Errors1;
<a name="1435"/> 1435:                          _ -&gt;
<a name="1436"/> 1436:                              [{renamed,{F,length(Args)},{ActualF,ActualArgs}}|Errors1]
<a name="1437"/> 1437:                      end,
<a name="1438"/> 1438: 
<a name="1439"/> 1439:             do_error_info(T, Errors)
<a name="1440"/> 1440:     end.
<a name="1441"/> 1441: 
<a name="eval_do_apply-3"/><a name="1442"/> 1442: <b>eval_do_apply</b>(erlang, load_nif, [Path]) -&gt;
<a name="1443"/> 1443:     erlang:load_nif(Path);
<a name="1444"/> 1444: <b>eval_do_apply</b>(erlang, load_nif, [Path,LoadInfo]) -&gt;
<a name="1445"/> 1445:     erlang:load_nif(Path, LoadInfo);
<a name="1446"/> 1446: <b>eval_do_apply</b>(Mod, Name, Args) -&gt;
<a name="eval_do_apply-last_expr"/><a name="1447"/> 1447: <b>    apply</b>(Mod, Name, Args).
<a name="1448"/> 1448: 
<a name="no_line_numbers-1"/><a name="1449"/> 1449: <b>no_line_numbers</b>(Config) -&gt;
<a name="1450"/> 1450:     DataDir = proplists:get_value(data_dir, Config),
<a name="1451"/> 1451:     Src = filename:join(DataDir, atom_to_list(?FUNCTION_NAME) ++ &quot;.erl&quot;),
<a name="1452"/> 1452:     {ok,Mod,Code} = compile:file(Src, [no_line_info,binary,report]),
<a name="1453"/> 1453:     {module,Mod} = code:load_binary(Mod, &quot;&quot;, Code),
<a name="1454"/> 1454: 
<a name="1455"/> 1455:     %% Make sure that the correct function is returned in the stacktrace
<a name="1456"/> 1456:     %% even if the compiled code has no `line` instructions.
<a name="1457"/> 1457:     {'EXIT',{badarith,[{erlang,'*',_,_},{Mod,a,_,_}|_]}} = (catch Mod:a(aa)),
<a name="1458"/> 1458:     {'EXIT',{badarith,[{erlang,'*',_,_},{Mod,b,_,_}|_]}} = (catch Mod:b(bb)),
<a name="1459"/> 1459:     {'EXIT',{badarith,[{erlang,'*',_,_},{Mod,c,_,_}|_]}} = (catch Mod:c(cc)),
<a name="1460"/> 1460:     {'EXIT',{badarith,[{erlang,'*',_,_},{Mod,d,_,_}|_]}} = (catch Mod:d(dd)),
<a name="1461"/> 1461:     {'EXIT',{badarith,[{erlang,'*',_,_},{Mod,e,_,_}|_]}} = (catch Mod:e(ee)),
<a name="no_line_numbers-last_expr"/><a name="1462"/> 1462:     ok.
<a name="1463"/> 1463: 
<a name="line_numbers-1"/><a name="1464"/> 1464: <b>line_numbers</b>(Config) when is_list(Config) -&gt;
<a name="1465"/> 1465:     {'EXIT',{{case_clause,bad_tag},
<a name="1466"/> 1466:              [{?MODULE,line1,2,
<a name="1467"/> 1467:                [{file,&quot;fake_file.erl&quot;},{line,3}]},
<a name="1468"/> 1468:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1469"/> 1469:     (catch line1(bad_tag, 0)),
<a name="1470"/> 1470: 
<a name="1471"/> 1471:     %% The stacktrace for operators such a '+' can vary depending on
<a name="1472"/> 1472:     %% whether the JIT is used or not.
<a name="1473"/> 1473:     case catch line1(a, not_an_integer) of
<a name="1474"/> 1474:         {'EXIT',{badarith,
<a name="1475"/> 1475:                  [{erlang,'+',[not_an_integer,1],_},
<a name="1476"/> 1476:                   {?MODULE,line1,2,
<a name="1477"/> 1477:                    [{file,&quot;fake_file.erl&quot;},{line,5}]},
<a name="1478"/> 1478:                   {?MODULE,line_numbers,1,_}|_]}} -&gt;
<a name="1479"/> 1479:             ok;
<a name="1480"/> 1480:         {'EXIT',{badarith,
<a name="1481"/> 1481:                  [{?MODULE,line1,2,
<a name="1482"/> 1482:                    [{file,&quot;fake_file.erl&quot;},{line,5}]},
<a name="1483"/> 1483:                   {?MODULE,line_numbers,1,_}|_]}} -&gt;
<a name="1484"/> 1484:             ok
<a name="1485"/> 1485:     end,
<a name="1486"/> 1486: 
<a name="1487"/> 1487:     {'EXIT',{{badmatch,{ok,1}},
<a name="1488"/> 1488:              [{?MODULE,line1,2,
<a name="1489"/> 1489:                [{file,&quot;fake_file.erl&quot;},{line,7}]},
<a name="1490"/> 1490:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1491"/> 1491:     (catch line1(a, 0)),
<a name="1492"/> 1492:     {'EXIT',{crash,
<a name="1493"/> 1493:              [{?MODULE,crash,1,
<a name="1494"/> 1494:                [{file,&quot;fake_file.erl&quot;},{line,14}]},
<a name="1495"/> 1495:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1496"/> 1496:     (catch line1(a, 41)),
<a name="1497"/> 1497: 
<a name="1498"/> 1498:     ModFile = ?MODULE_STRING++&quot;.erl&quot;,
<a name="1499"/> 1499:     [{?MODULE,maybe_crash,1,[{file,&quot;call.erl&quot;},{line,28}]},
<a name="1500"/> 1500:      {?MODULE,call1,0,[{file,&quot;call.erl&quot;},{line,14}]},
<a name="1501"/> 1501:      {?MODULE,close_calls,1,[{file,&quot;call.erl&quot;},{line,5}]},
<a name="1502"/> 1502:      {?MODULE,line_numbers,1,[{file,ModFile},{line,_}]}|_] =
<a name="1503"/> 1503:     close_calls(call1),
<a name="1504"/> 1504:     [{?MODULE,maybe_crash,1,[{file,&quot;call.erl&quot;},{line,28}]},
<a name="1505"/> 1505:      {?MODULE,call2,0,[{file,&quot;call.erl&quot;},{line,18}]},
<a name="1506"/> 1506:      {?MODULE,close_calls,1,[{file,&quot;call.erl&quot;},{line,6}]},
<a name="1507"/> 1507:      {?MODULE,line_numbers,1,[{file,ModFile},{line,_}]}|_] =
<a name="1508"/> 1508:     close_calls(call2),
<a name="1509"/> 1509:     [{?MODULE,maybe_crash,1,[{file,&quot;call.erl&quot;},{line,28}]},
<a name="1510"/> 1510:      {?MODULE,call3,0,[{file,&quot;call.erl&quot;},{line,22}]},
<a name="1511"/> 1511:      {?MODULE,close_calls,1,[{file,&quot;call.erl&quot;},{line,7}]},
<a name="1512"/> 1512:      {?MODULE,line_numbers,1,[{file,ModFile},{line,_}]}|_] =
<a name="1513"/> 1513:     close_calls(call3),
<a name="1514"/> 1514:     no_crash = close_calls(other),
<a name="1515"/> 1515: 
<a name="1516"/> 1516:     &lt;&lt;0,0&gt;&gt; = build_binary1(16),
<a name="1517"/> 1517:     {'EXIT',{badarg,
<a name="1518"/> 1518:              [{?MODULE,build_binary1,1,
<a name="1519"/> 1519:                [{file,&quot;bit_syntax.erl&quot;},{line,72503},{error_info,_}]},
<a name="1520"/> 1520:               {?MODULE,line_numbers,1,
<a name="1521"/> 1521:                [{file,ModFile},{line,_}]}|_]}} =
<a name="1522"/> 1522:     (catch build_binary1(bad_size)),
<a name="1523"/> 1523: 
<a name="1524"/> 1524:     &lt;&lt;7,1,2,3&gt;&gt; = build_binary2(8, &lt;&lt;1,2,3&gt;&gt;),
<a name="1525"/> 1525:     {'EXIT',{badarg,
<a name="1526"/> 1526:              [{?MODULE,build_binary2,2,
<a name="1527"/> 1527:                [{file,&quot;bit_syntax.erl&quot;},{line,72507},{error_info,_}]},
<a name="1528"/> 1528:               {?MODULE,line_numbers,1,
<a name="1529"/> 1529:                [{file,ModFile},{line,_}]}|_]}} =
<a name="1530"/> 1530:     (catch build_binary2(bad_size, &lt;&lt;&gt;&gt;)),
<a name="1531"/> 1531:     {'EXIT',{badarg,
<a name="1532"/> 1532:              [{?MODULE,build_binary2,2,
<a name="1533"/> 1533:                [{file,&quot;bit_syntax.erl&quot;},{line,72507},{error_info,_}]},
<a name="1534"/> 1534:               {?MODULE,line_numbers,1,
<a name="1535"/> 1535:                [{file,ModFile},{line,_}]}|_]}} =
<a name="1536"/> 1536:     (catch build_binary2(8, bad_binary)),
<a name="1537"/> 1537: 
<a name="1538"/> 1538:     &lt;&lt;&quot;abc&quot;,357:16&gt;&gt; = build_binary3(&lt;&lt;&quot;abc&quot;&gt;&gt;),
<a name="1539"/> 1539:     {'EXIT',{badarg,[{?MODULE,build_binary3,1,
<a name="1540"/> 1540:                       [{file,&quot;bit_syntax.erl&quot;},{line,72511},{error_info,_}]},
<a name="1541"/> 1541:                      {?MODULE,line_numbers,1,
<a name="1542"/> 1542:                       [{file,ModFile},{line,_}]}|_]}} =
<a name="1543"/> 1543:     (catch build_binary3(no_binary)),
<a name="1544"/> 1544: 
<a name="1545"/> 1545:     {'EXIT',{function_clause,
<a name="1546"/> 1546:              [{?MODULE,do_call_abs,[y,y],
<a name="1547"/> 1547:                [{file,&quot;gc_bif.erl&quot;},{line,18}]},
<a name="1548"/> 1548:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1549"/> 1549:     (catch do_call_abs(y, y)),
<a name="1550"/> 1550:     {'EXIT',{badarg,
<a name="1551"/> 1551:              [{erlang,abs,[[]],[{error_info,_}]},
<a name="1552"/> 1552:               {?MODULE,do_call_abs,2,
<a name="1553"/> 1553:                [{file,&quot;gc_bif.erl&quot;},{line,19}]},
<a name="1554"/> 1554:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1555"/> 1555:     (catch do_call_abs(x, [])),
<a name="1556"/> 1556: 
<a name="1557"/> 1557:     {'EXIT',{{badmatch,&quot;42&quot;},
<a name="1558"/> 1558:              [{MODULE,applied_bif_1,1,[{file,&quot;applied_bif.erl&quot;},{line,5}]},
<a name="1559"/> 1559:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1560"/> 1560:     (catch applied_bif_1(42)),
<a name="1561"/> 1561: 
<a name="1562"/> 1562:     {'EXIT',{{badmatch,{current_location,
<a name="1563"/> 1563:                         {?MODULE,applied_bif_2,0,
<a name="1564"/> 1564:                          [{file,&quot;applied_bif.erl&quot;},{line,9}]}}},
<a name="1565"/> 1565:              [{MODULE,applied_bif_2,0,[{file,&quot;applied_bif.erl&quot;},{line,10}]},
<a name="1566"/> 1566:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1567"/> 1567:     (catch applied_bif_2()),
<a name="1568"/> 1568: 
<a name="1569"/> 1569:     case catch increment1(x) of
<a name="1570"/> 1570:         {'EXIT',{badarith,
<a name="1571"/> 1571:                  [{erlang,'+',[x,1],_},
<a name="1572"/> 1572:                   {?MODULE,increment1,1,[{file,&quot;increment.erl&quot;},{line,45}]},
<a name="1573"/> 1573:                   {?MODULE,line_numbers,1,_}|_]}} -&gt;
<a name="1574"/> 1574:             ok;
<a name="1575"/> 1575:         {'EXIT',{badarith,
<a name="1576"/> 1576:                  [{?MODULE,increment1,1,[{file,&quot;increment.erl&quot;},{line,45}]},
<a name="1577"/> 1577:                   {?MODULE,line_numbers,1,_}|_]}} -&gt;
<a name="1578"/> 1578:             ok
<a name="1579"/> 1579:     end,
<a name="1580"/> 1580: 
<a name="1581"/> 1581:     case catch increment2(x) of
<a name="1582"/> 1582:         {'EXIT',{badarith,
<a name="1583"/> 1583:                  [{erlang,'+',[x,1],_},
<a name="1584"/> 1584:                   {?MODULE,increment2,1,[{file,&quot;increment.erl&quot;},{line,48}]},
<a name="1585"/> 1585:                   {?MODULE,line_numbers,1,_}|_]}} -&gt;
<a name="1586"/> 1586:             ok;
<a name="1587"/> 1587:         {'EXIT',{badarith,
<a name="1588"/> 1588:                  [{?MODULE,increment2,1,[{file,&quot;increment.erl&quot;},{line,48}]},
<a name="1589"/> 1589:                   {?MODULE,line_numbers,1,_}|_]}} -&gt;
<a name="1590"/> 1590:             ok
<a name="1591"/> 1591:     end,
<a name="1592"/> 1592: 
<a name="1593"/> 1593:     {'EXIT',{{badmap,not_a_map},
<a name="1594"/> 1594:              [{?MODULE,update_map,1,[{file,&quot;map.erl&quot;},{line,3}]}|_]}} =
<a name="1595"/> 1595:         (catch update_map(not_a_map)),
<a name="1596"/> 1596:     {'EXIT',{{badkey,a},
<a name="1597"/> 1597:              [{?MODULE,update_map,1,[{file,&quot;map.erl&quot;},{line,4}]}|_]}} =
<a name="1598"/> 1598:         (catch update_map(#{})),
<a name="1599"/> 1599: 
<a name="1600"/> 1600:     {'EXIT',{badarg,
<a name="1601"/> 1601:              [{erlang,hd,[x],[{error_info,_}]},
<a name="1602"/> 1602:               {?MODULE,test_hd,1,[{file,&quot;list_bifs.erl&quot;},{line,101}]}|_]}} =
<a name="1603"/> 1603:         (catch test_hd(x)),
<a name="1604"/> 1604:     {'EXIT',{badarg,
<a name="1605"/> 1605:              [{erlang,tl,[y],[{error_info,_}]},
<a name="1606"/> 1606:               {?MODULE,test_tl,1,[{file,&quot;list_bifs.erl&quot;},{line,102}]}|_]}} =
<a name="1607"/> 1607:         (catch test_tl(y)),
<a name="1608"/> 1608: 
<a name="1609"/> 1609:     %% This line number is too large to be represented and will be silently
<a name="1610"/> 1610:     %% ignored by the emulator.
<a name="1611"/> 1611:     {'EXIT',{crash,
<a name="1612"/> 1612:              [{?MODULE,crash_huge_line,1,[]},
<a name="1613"/> 1613:               {?MODULE,line_numbers,1,_}|_]}} =
<a name="1614"/> 1614:         (catch crash_huge_line(gurka)),
<a name="1615"/> 1615: 
<a name="1616"/> 1616:     {'EXIT',{{badrecord,[1,2,3]},
<a name="1617"/> 1617:              [{?MODULE,bad_record,1,[{file,&quot;bad_records.erl&quot;},{line,4}]}|_]}} =
<a name="1618"/> 1618:         catch bad_record([1,2,3]),
<a name="1619"/> 1619: 
<a name="1620"/> 1620:     %% GH-5960: When an instruction raised an exception at the very end of the
<a name="1621"/> 1621:     %% instruction (e.g. badmatch), and was directly followed by a line
<a name="1622"/> 1622:     %% instruction, the exception was raised for the wrong line.
<a name="1623"/> 1623:     ok = ambiguous_line(0),
<a name="1624"/> 1624:     {'EXIT',{{badmatch,_},
<a name="1625"/> 1625:         [{?MODULE,ambiguous_line,1,[{file,&quot;ambiguous_line.erl&quot;},
<a name="1626"/> 1626:                                     {line,3}]}|_]}} = catch ambiguous_line(1),
<a name="1627"/> 1627:     {'EXIT',{{badmatch,_},
<a name="1628"/> 1628:         [{?MODULE,ambiguous_line,1,[{file,&quot;ambiguous_line.erl&quot;},
<a name="1629"/> 1629:                                     {line,4}]}|_]}} = catch ambiguous_line(2),
<a name="1630"/> 1630: 
<a name="line_numbers-last_expr"/><a name="1631"/> 1631:     ok.
<a name="1632"/> 1632: 
<a name="id-1"/><a name="id-last_expr"/><a name="1633"/> 1633: <b>id</b>(I) -&gt; I.
<a name="1634"/> 1634: 
<a name="1635"/> 1635: <b>-file</b>(&quot;odd_even.erl&quot;, 1).			%Line 1
<a name="1636"/> 1636: even(N) when is_integer(N), N &gt; 1, (N rem 2) == 0 -&gt;
<a name="1637"/> 1637:     odd(N-1)++[N].				%Line 3
<a name="1638"/> 1638: 
<a name="1639"/> 1639: odd(N) when is_integer(N), N &gt; 1, (N rem 2) == 1 -&gt;
<a name="1640"/> 1640:     even(N-1)++[N].				%Line 6
<a name="1641"/> 1641: 
<a name="1642"/> 1642: <i>%%</i>
<a name="1643"/> 1643: <i>%% If the compiler removes redundant line instructions (any</i>
<a name="1644"/> 1644: <i>%% line instruction with the same location as the previous),</i>
<a name="1645"/> 1645: <i>%% and the loader also removes line instructions before</i>
<a name="1646"/> 1646: <i>%% tail-recursive calls to external functions, then the</i>
<a name="1647"/> 1647: <i>%% badmatch exception in line 7 below will be reported as</i>
<a name="1648"/> 1648: <i>%% occurring in line 6.</i>
<a name="1649"/> 1649: <i>%%</i>
<a name="1650"/> 1650: <i>%% That means that any removal of redundant line instructions</i>
<a name="1651"/> 1651: <i>%% must all be done in the compiler OR in the loader.</i>
<a name="1652"/> 1652: <i>%%</i>
<a name="1653"/> 1653: <b>-file</b>(&quot;fake_file.erl&quot;, 1).			%Line 1
<a name="1654"/> 1654: line1(Tag, X) -&gt;				%Line 2
<a name="1655"/> 1655:     case Tag of					%Line 3
<a name="1656"/> 1656:         a -&gt;
<a name="1657"/> 1657:             Y = X + 1,				%Line 5
<a name="1658"/> 1658:             Res = id({ok,Y}),			%Line 6
<a name="1659"/> 1659:             ?MODULE:crash({ok,42} = Res);	%Line 7
<a name="1660"/> 1660:         b -&gt;
<a name="1661"/> 1661:             x = id(x),				%Line 9
<a name="1662"/> 1662:             ok					%Line 10
<a name="1663"/> 1663:     end.					%Line 11
<a name="1664"/> 1664: 
<a name="1665"/> 1665: crash(_) -&gt;					%Line 13
<a name="1666"/> 1666:     erlang:error(crash).			%Line 14
<a name="1667"/> 1667: 
<a name="1668"/> 1668: <b>-file</b>(&quot;call.erl&quot;, 1).				%Line 1
<a name="1669"/> 1669: close_calls(Where) -&gt;				%Line 2
<a name="1670"/> 1670:     put(where_to_crash, Where),			%Line 3
<a name="1671"/> 1671:     try
<a name="1672"/> 1672:         call1(),				%Line 5
<a name="1673"/> 1673:         call2(),				%Line 6
<a name="1674"/> 1674:         call3(),				%Line 7
<a name="1675"/> 1675:         no_crash				%Line 8
<a name="1676"/> 1676:     catch error:crash:Stk -&gt;
<a name="1677"/> 1677:             Stk                                 %Line 10
<a name="1678"/> 1678:     end.					%Line 11
<a name="1679"/> 1679: 
<a name="1680"/> 1680: call1() -&gt;					%Line 13
<a name="1681"/> 1681:     maybe_crash(call1),				%Line 14
<a name="1682"/> 1682:     ok.						%Line 15
<a name="1683"/> 1683: 
<a name="1684"/> 1684: call2() -&gt;					%Line 17
<a name="1685"/> 1685:     maybe_crash(call2),				%Line 18
<a name="1686"/> 1686:     ok.						%Line 19
<a name="1687"/> 1687: 
<a name="1688"/> 1688: call3() -&gt;					%Line 21
<a name="1689"/> 1689:     maybe_crash(call3),				%Line 22
<a name="1690"/> 1690:     ok.						%Line 23
<a name="1691"/> 1691: 
<a name="1692"/> 1692: maybe_crash(Name) -&gt;				%Line 25
<a name="1693"/> 1693:     case get(where_to_crash) of			%Line 26
<a name="1694"/> 1694:         Name -&gt;
<a name="1695"/> 1695:             erlang:error(crash);		%Line 28
<a name="1696"/> 1696:         _ -&gt;
<a name="1697"/> 1697:             ok					%Line 30
<a name="1698"/> 1698:     end.
<a name="1699"/> 1699: 
<a name="1700"/> 1700: <b>-file</b>(&quot;bit_syntax.erl&quot;, 72500).			%Line 72500
<a name="1701"/> 1701: build_binary1(Size) -&gt;				%Line 72501
<a name="1702"/> 1702:     id(42),					%Line 72502
<a name="1703"/> 1703:     &lt;&lt;0:Size&gt;&gt;.					%Line 72503
<a name="1704"/> 1704: 
<a name="1705"/> 1705: build_binary2(Size, Bin) -&gt;			%Line 72505
<a name="1706"/> 1706:     id(0),					%Line 72506
<a name="1707"/> 1707:     &lt;&lt;7:Size,Bin/binary&gt;&gt;.			%Line 72507
<a name="1708"/> 1708: 
<a name="1709"/> 1709: build_binary3(Bin) -&gt;			        %Line 72509
<a name="1710"/> 1710:     id(0),					%Line 72510
<a name="1711"/> 1711:     &lt;&lt;Bin/binary,357:16&gt;&gt;.			%Line 72511
<a name="1712"/> 1712: 
<a name="1713"/> 1713: <b>-file</b>(&quot;gc_bif.erl&quot;, 17).
<a name="1714"/> 1714: do_call_abs(x, Arg) -&gt;				%Line 18
<a name="1715"/> 1715:     abs(Arg).					%Line 19
<a name="1716"/> 1716: 
<a name="1717"/> 1717: <i>%% Make sure a BIF that is applied does not leave the p-&gt;cp</i>
<a name="1718"/> 1718: <i>%% set (and thus generating an extra entry on the stack).</i>
<a name="1719"/> 1719: 
<a name="1720"/> 1720: <b>-file</b>(&quot;applied_bif.erl&quot;, 1).
<a name="1721"/> 1721: <i>%% Explicit apply.</i>
<a name="1722"/> 1722: applied_bif_1(I) -&gt;				%Line 3
<a name="1723"/> 1723:     L = apply(erlang, integer_to_list, [I]),	%Line 4
<a name="1724"/> 1724:     fail = L,					%Line 5
<a name="1725"/> 1725:     ok.						%Line 6
<a name="1726"/> 1726: <i>%% Implicit apply.</i>
<a name="1727"/> 1727: applied_bif_2() -&gt;				%Line 8
<a name="1728"/> 1728:     R = process_info(self(), current_location),	%Line 9
<a name="1729"/> 1729:     fail = R,					%Line 10
<a name="1730"/> 1730:     ok.						%Line 11
<a name="1731"/> 1731: 
<a name="1732"/> 1732: <i>%% The increment instruction used to decrement the instruction</i>
<a name="1733"/> 1733: <i>%% pointer, which would cause the line number in a stack trace to</i>
<a name="1734"/> 1734: <i>%% be the previous line number.</i>
<a name="1735"/> 1735: 
<a name="1736"/> 1736: <b>-file</b>(&quot;increment.erl&quot;, 42).
<a name="1737"/> 1737: increment1(Arg) -&gt;                              %Line 43
<a name="1738"/> 1738:     Res = id(Arg),                              %Line 44
<a name="1739"/> 1739:     Res + 1.                                    %Line 45
<a name="1740"/> 1740: increment2(Arg) -&gt;                              %Line 46
<a name="1741"/> 1741:     _ = id(Arg),                                %Line 47
<a name="1742"/> 1742:     Arg + 1.                                    %Line 48
<a name="1743"/> 1743: 
<a name="1744"/> 1744: <b>-file</b>(&quot;map.erl&quot;, 1).
<a name="1745"/> 1745: update_map(M0) -&gt;                               %Line 2
<a name="1746"/> 1746:     M = M0#{new =&gt; value},                      %Line 3
<a name="1747"/> 1747:     M#{a := b}.                                 %Line 4
<a name="1748"/> 1748: 
<a name="1749"/> 1749: <b>-file</b>(&quot;list_bifs.erl&quot;, 100).
<a name="1750"/> 1750: test_hd(X) -&gt; foo(), hd(X).                     %Line 101
<a name="1751"/> 1751: test_tl(X) -&gt; foo(), tl(X).                     %Line 102
<a name="1752"/> 1752: foo() -&gt; id(100).
<a name="1753"/> 1753: 
<a name="1754"/> 1754: <b>-file</b>(&quot;huge_lines.erl&quot;, 100000000).             %Line 100000000
<a name="1755"/> 1755: 
<a name="1756"/> 1756: crash_huge_line(_) -&gt;                           %Line 100000002
<a name="1757"/> 1757:     erlang:error(crash).                        %Line 100000003
<a name="1758"/> 1758: 
<a name="1759"/> 1759: <b>-file</b>(&quot;bad_records.erl&quot;, 1).
<a name="1760"/> 1760: <b>-record</b>(foobar, {a,b,c,d}).                     %Line 2.
<a name="1761"/> 1761: bad_record(R) -&gt;                                %Line 3.
<a name="1762"/> 1762:     R#foobar.a.                                 %Line 4.
<a name="1763"/> 1763: 
<a name="1764"/> 1764: <b>-file</b>(&quot;ambiguous_line.erl&quot;, 1).
<a name="1765"/> 1765: ambiguous_line(A) -&gt;                            %Line 2.
<a name="1766"/> 1766:     true = A =/= 1,                             %Line 3.
<a name="1767"/> 1767:     true = A =/= 2,                             %Line 4.
<a name="1768"/> 1768:     ok.
</pre>
<script>
var hash = window.location.hash.substring(1);
var anchor = document.getElementsByName(hash);
anchor[0].style.backgroundColor="orange";
</script>
</body>
</html>
