<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/lib/compiler/make_test_dir/compiler_test/guard_no_ssa_opt_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%%</i>
<a name="2"/>    2: <i>%% %CopyrightBegin%</i>
<a name="3"/>    3: <i>%%</i>
<a name="4"/>    4: <i>%% Copyright Ericsson AB 2001-2024. All Rights Reserved.</i>
<a name="5"/>    5: <i>%%</i>
<a name="6"/>    6: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="7"/>    7: <i>%% you may not use this file except in compliance with the License.</i>
<a name="8"/>    8: <i>%% You may obtain a copy of the License at</i>
<a name="9"/>    9: <i>%%</i>
<a name="10"/>   10: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="11"/>   11: <i>%%</i>
<a name="12"/>   12: <i>%% Unless required by applicable law or agreed to in writing, software</i>
<a name="13"/>   13: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="14"/>   14: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="15"/>   15: <i>%% See the License for the specific language governing permissions and</i>
<a name="16"/>   16: <i>%% limitations under the License.</i>
<a name="17"/>   17: <i>%%</i>
<a name="18"/>   18: <i>%% %CopyrightEnd%</i>
<a name="19"/>   19: <i>%%</i>
<a name="20"/>   20: <b>-module</b>(guard_no_ssa_opt_SUITE).
<a name="21"/>   21: 
<a name="22"/>   22: <i>%% Warnings for obsolete guards are generated by erl_lint, so we will not</i>
<a name="23"/>   23: <i>%% any less testing of the compiler by suppressing them.</i>
<a name="24"/>   24: <b>-compile</b>([nowarn_obsolete_guard]).
<a name="25"/>   25: 
<a name="26"/>   26: <b>-include_lib</b>(&quot;syntax_tools/include/merl.hrl&quot;).
<a name="27"/>   27: 
<a name="28"/>   28: <b>-export</b>([all/0, suite/0,groups/0,init_per_suite/1, end_per_suite/1, 
<a name="29"/>   29: 	 init_per_group/2,end_per_group/2,
<a name="30"/>   30: 	 misc/1,const_cond/1,basic_not/1,complex_not/1,nested_nots/1,
<a name="31"/>   31: 	 semicolon/1,complex_semicolon/1,comma/1,
<a name="32"/>   32: 	 or_guard/1,more_or_guards/1,
<a name="33"/>   33: 	 complex_or_guards/1,and_guard/1,
<a name="34"/>   34: 	 xor_guard/1,more_xor_guards/1,
<a name="35"/>   35: 	 old_guard_tests/1,complex_guard/1,
<a name="36"/>   36: 	 build_in_guard/1,gbif/1,
<a name="37"/>   37: 	 t_is_boolean/1,is_function_2/1,
<a name="38"/>   38: 	 tricky/1,rel_ops/1,rel_op_combinations/1,
<a name="39"/>   39:          generated_combinations/1,literal_type_tests/1,
<a name="40"/>   40: 	 basic_andalso_orelse/1,traverse_dcd/1,
<a name="41"/>   41: 	 check_qlc_hrl/1,andalso_semi/1,t_tuple_size/1,binary_part/1,
<a name="42"/>   42: 	 bad_constants/1,bad_guards/1,
<a name="43"/>   43:          guard_in_catch/1,beam_bool_SUITE/1,
<a name="44"/>   44:          repeated_type_tests/1,use_after_branch/1]).
<a name="45"/>   45: 
<a name="suite-0"/><a name="suite-last_expr"/><a name="46"/>   46: <b>suite</b>() -&gt; [{ct_hooks,[ts_install_cth]}].
<a name="47"/>   47: 
<a name="all-0"/><a name="48"/>   48: <b>all</b>() -&gt; 
<a name="all-last_expr"/><a name="49"/>   49: <b>    slow_group</b>() ++ [{group,p}].
<a name="50"/>   50: 
<a name="groups-0"/><a name="51"/>   51: <b>groups</b>() -&gt; 
<a name="groups-last_expr"/><a name="52"/>   52:     [{p,[parallel],
<a name="53"/>   53:       [misc,const_cond,basic_not,complex_not,nested_nots,
<a name="54"/>   54:        semicolon,complex_semicolon,comma,or_guard,
<a name="55"/>   55:        more_or_guards,complex_or_guards,and_guard,xor_guard,
<a name="56"/>   56:        more_xor_guards,build_in_guard,
<a name="57"/>   57:        old_guard_tests,complex_guard,gbif,
<a name="58"/>   58:        t_is_boolean,is_function_2,tricky,
<a name="59"/>   59:        rel_ops,rel_op_combinations,
<a name="60"/>   60:        basic_andalso_orelse,traverse_dcd,
<a name="61"/>   61:        check_qlc_hrl,andalso_semi,t_tuple_size,binary_part,
<a name="62"/>   62:        bad_constants,bad_guards,guard_in_catch,beam_bool_SUITE,
<a name="63"/>   63:        repeated_type_tests,use_after_branch]},
<a name="64"/>   64:      {slow,[],[literal_type_tests,generated_combinations]}].
<a name="65"/>   65: 
<a name="init_per_suite-1"/><a name="66"/>   66: <b>init_per_suite</b>(Config) -&gt;
<a name="67"/>   67:     test_lib:recompile(?MODULE),
<a name="init_per_suite-last_expr"/><a name="68"/>   68:     Config.
<a name="69"/>   69: 
<a name="end_per_suite-1"/><a name="70"/>   70: <b>end_per_suite</b>(_Config) -&gt;
<a name="end_per_suite-last_expr"/><a name="71"/>   71:     ok.
<a name="72"/>   72: 
<a name="init_per_group-2"/><a name="73"/>   73: <b>init_per_group</b>(_GroupName, Config) -&gt;
<a name="init_per_group-last_expr"/><a name="74"/>   74:     Config.
<a name="75"/>   75: 
<a name="end_per_group-2"/><a name="76"/>   76: <b>end_per_group</b>(_GroupName, Config) -&gt;
<a name="end_per_group-last_expr"/><a name="77"/>   77:     Config.
<a name="78"/>   78: 
<a name="slow_group-0"/><a name="79"/>   79: <b>slow_group</b>() -&gt;
<a name="slow_group-last_expr"/><a name="80"/>   80:     case ?MODULE of
<a name="81"/>   81: 	guard_SUITE -&gt;
<a name="82"/>   82:             %% Canononical module name. Run slow cases.
<a name="83"/>   83:             [{group,slow}];
<a name="84"/>   84:         _ -&gt;
<a name="85"/>   85:             %% Cloned module. Don't run.
<a name="86"/>   86:             []
<a name="87"/>   87:     end.
<a name="88"/>   88: 
<a name="misc-1"/><a name="89"/>   89: <b>misc</b>(Config) when is_list(Config) -&gt;
<a name="90"/>   90:     42 = case id(42) of
<a name="91"/>   91: 	     X when -X -&gt; ok;
<a name="92"/>   92: 	     X -&gt; X
<a name="93"/>   93: 	 end,
<a name="94"/>   94:     {a,b,c} = misc_1([{{a,b,c}},{[4]},{[3]},{-2}]),
<a name="95"/>   95:     none = misc_1([{{a,b,c}},{[4]},{[3]},{-3}]),
<a name="96"/>   96:     none = misc_1([{{a,b,c}},{[4]},{[7]},{-2}]),
<a name="97"/>   97:     none = misc_1([{{a,b,c}},{[4]},{[3]},{[1,2,3]}]),
<a name="98"/>   98: 
<a name="99"/>   99:     {ok,buf,&lt;&lt;&gt;&gt;} = get_data({o,true,raw}, 0, buf),
<a name="100"/>  100:     {ok,buf,&lt;&lt;&gt;&gt;} = get_data({o,true,raw}, 42, buf),
<a name="101"/>  101:     {ok,buf,&lt;&lt;&gt;&gt;} = get_data({o,false,raw}, 0, buf),
<a name="102"/>  102:     error = get_data({o,false,raw}, 42, buf),
<a name="103"/>  103:     {ok,buf,&lt;&lt;&gt;&gt;} = get_data({o,true,0}, 0, buf),
<a name="104"/>  104:     {ok,buf,&lt;&lt;&gt;&gt;} = get_data({o,true,0}, 42, buf),
<a name="105"/>  105:     {ok,buf,&lt;&lt;&gt;&gt;} = get_data({o,false,0}, 0, buf),
<a name="106"/>  106:     error = get_data({o,false,0}, 42, buf),
<a name="107"/>  107: 
<a name="108"/>  108:     relief = misc_2(0),
<a name="109"/>  109:     error = misc_2(1),
<a name="110"/>  110:     error = misc_2(true),
<a name="111"/>  111: 
<a name="112"/>  112:     if
<a name="113"/>  113: 	is_integer(Config) =/= true -&gt;
<a name="114"/>  114: 	    ok
<a name="115"/>  115:     end,
<a name="116"/>  116: 
<a name="117"/>  117:     true = misc_3(1, 0),
<a name="118"/>  118:     true = misc_3(0, 0),
<a name="119"/>  119:     false = misc_3(0, 2),
<a name="120"/>  120: 
<a name="121"/>  121:     %% Abuse of boolean values.
<a name="122"/>  122: 
<a name="123"/>  123:     Zero = id(0),
<a name="124"/>  124:     One = id(1),
<a name="125"/>  125:     ok = if (Zero == 0) &gt; false -&gt; ok end,
<a name="126"/>  126:     ok = if (Zero == 0) =:= (One == 1) -&gt; ok end,
<a name="127"/>  127:     ok = if (Zero == 0) =:= (One == 1) -&gt; ok end,
<a name="128"/>  128:     ok = if is_atom(Zero &gt; One) -&gt; ok end,
<a name="129"/>  129:     error = if abs(Zero &gt; One) -&gt; ok; true -&gt; error end,
<a name="130"/>  130:     ok = if is_integer(Zero) &gt;= is_integer(One) -&gt; ok end,
<a name="131"/>  131: 
<a name="132"/>  132:     {'EXIT',{function_clause,_}} = catch misc_4(),
<a name="133"/>  133: 
<a name="misc-last_expr"/><a name="134"/>  134:     ok.
<a name="135"/>  135: 
<a name="misc_1-1"/><a name="136"/>  136: <b>misc_1</b>([{W},{X},{Y},{Z}]) -&gt;
<a name="misc_1-last_expr"/><a name="137"/>  137: 	      if
<a name="138"/>  138: 	X &gt; Y andalso abs(Z) =:= 2 -&gt;
<a name="139"/>  139: 	    id(W);
<a name="140"/>  140: 	true -&gt;
<a name="141"/>  141: 	    none
<a name="142"/>  142:     end.
<a name="143"/>  143: 
<a name="misc_2-1"/><a name="144"/>  144: <b>misc_2</b>(0) -&gt; relief;
<a name="145"/>  145: <b>misc_2</b>(Adapter = 1) when Adapter -&gt; franklin;
<a name="misc_2-last_expr"/><a name="146"/>  146: <b>misc_2</b>(_) -&gt; error.
<a name="147"/>  147: 
<a name="misc_3-2"/><a name="148"/>  148: <b>misc_3</b>(LenUp, LenDw) -&gt;
<a name="misc_3-last_expr"/><a name="149"/>  149:     if
<a name="150"/>  150: 	%% Cover handling of #k_alt{}.
<a name="151"/>  151: 	LenUp &gt;= 1 orelse ((LenDw &gt;= 2) xor true) -&gt; true;
<a name="152"/>  152: 	true -&gt; false
<a name="153"/>  153:     end.
<a name="154"/>  154: 
<a name="misc_4-0"/><a name="155"/>  155: <b>misc_4</b>() when &lt;&lt;(is_atom((#{} #{ ok := ok })) orelse &lt;&lt;&gt;&gt;)/bytes&gt;&gt; &gt;= ok -&gt;
<a name="misc_4-last_expr"/><a name="156"/>  156:     ok.
<a name="157"/>  157: 
<a name="get_data-3"/><a name="158"/>  158: <b>get_data</b>({o,Active,Raw}, BytesToRead, Buffer) 
<a name="159"/>  159:   when Raw =:= raw; Raw =:= 0 -&gt;
<a name="get_data-last_expr"/><a name="160"/>  160:     if 
<a name="161"/>  161: 	Active =/= false orelse BytesToRead =:= 0  -&gt;
<a name="162"/>  162: 	    {ok,Buffer,&lt;&lt;&gt;&gt;};
<a name="163"/>  163: 	true -&gt;
<a name="164"/>  164: 	    error
<a name="165"/>  165:     end.
<a name="166"/>  166: 
<a name="const_cond-1"/><a name="167"/>  167: <b>const_cond</b>(Config) when is_list(Config) -&gt;
<a name="168"/>  168:     ok = const_cond({}, 0),
<a name="169"/>  169:     ok = const_cond({a}, 1),
<a name="170"/>  170:     error = const_cond({a,b}, 3),
<a name="171"/>  171:     error = const_cond({a}, 0),
<a name="172"/>  172:     error = const_cond({a,b}, 1),
<a name="const_cond-last_expr"/><a name="173"/>  173:     ok.
<a name="174"/>  174: 
<a name="const_cond-2"/><a name="175"/>  175: <b>const_cond</b>(T, Sz) -&gt;
<a name="const_cond-last_expr"/><a name="176"/>  176:     case T of
<a name="177"/>  177: 	_X when false -&gt; never;
<a name="178"/>  178: 	_X when is_tuple(T), eq == eq, tuple_size(T) == Sz -&gt; ok;
<a name="179"/>  179: 	_X when is_tuple(T), eq == leq, tuple_size(T) =&lt; Sz -&gt; ok;
<a name="180"/>  180: 	_X -&gt; error
<a name="181"/>  181:     end.
<a name="182"/>  182: 
<a name="basic_not-1"/><a name="183"/>  183: <b>basic_not</b>(Config) when is_list(Config) -&gt;
<a name="184"/>  184:     True = id(true),
<a name="185"/>  185:     False = id(false),
<a name="186"/>  186:     Glurf = id(glurf),
<a name="187"/>  187:     A = id(5),
<a name="188"/>  188:     B = id(37.5),
<a name="189"/>  189:     C = id(-1),
<a name="190"/>  190:     D = id(5),
<a name="191"/>  191:     ATuple = {False,True,Glurf},
<a name="192"/>  192: 
<a name="193"/>  193:     check(fun() -&gt; if not false -&gt; ok; true -&gt; error end end, ok),
<a name="194"/>  194:     check(fun() -&gt; if not true -&gt; ok; true -&gt; error end end, error),
<a name="195"/>  195:     check(fun() -&gt; if not False -&gt; ok; true -&gt; error end end, ok),
<a name="196"/>  196:     check(fun() -&gt; if not True -&gt; ok; true -&gt; error end end, error),
<a name="197"/>  197: 
<a name="198"/>  198:     check(fun() -&gt; if A &gt; B -&gt; gt; A &lt; B -&gt; lt; A == B -&gt; eq end end, lt),
<a name="199"/>  199:     check(fun() -&gt; if A &gt; C -&gt; gt; A &lt; C -&gt; lt; A == C -&gt; eq end end, gt),
<a name="200"/>  200:     check(fun() -&gt; if A &gt; D -&gt; gt; A &lt; D -&gt; lt; A == D -&gt; eq end end, eq),
<a name="201"/>  201: 
<a name="202"/>  202:     check(fun() -&gt; if not (7 &gt; 453) -&gt; le; not (7 &lt; 453) -&gt; ge;
<a name="203"/>  203: 		      not (7 == 453) -&gt; ne; true -&gt; eq end end, le),
<a name="204"/>  204:     check(fun() -&gt; if not (7 &gt; -8) -&gt; le; not (7 &lt; -8) -&gt; ge;
<a name="205"/>  205: 		      not (7 == -8) -&gt; ne; true -&gt; eq end end, ge),
<a name="206"/>  206:     check(fun() -&gt; if not (7 &gt; 7) -&gt; le; not (7 &lt; 7) -&gt; ge;
<a name="207"/>  207: 		      not (7 == 7) -&gt; ne; true -&gt; eq end end, le),
<a name="208"/>  208: 
<a name="209"/>  209:     check(fun() -&gt; if not (A &gt; B) -&gt; le; not (A &lt; B) -&gt; ge;
<a name="210"/>  210: 		      not (A == B) -&gt; ne; true -&gt; eq end end, le),
<a name="211"/>  211:     check(fun() -&gt; if not (A &gt; C) -&gt; le; not (A &lt; C) -&gt; ge;
<a name="212"/>  212: 		      not (A == C) -&gt; ne; true -&gt; eq end end, ge),
<a name="213"/>  213:     check(fun() -&gt; if not (A &gt; D) -&gt; le; not (A &lt; D) -&gt; ge;
<a name="214"/>  214: 		      not (A == D) -&gt; ne; true -&gt; eq end end, le),
<a name="215"/>  215: 
<a name="216"/>  216:     check(fun() -&gt; if not element(1, ATuple) -&gt; ok; true -&gt; error end end, ok),
<a name="217"/>  217:     check(fun() -&gt; if not element(2, ATuple) -&gt; ok; true -&gt; error end end, error),
<a name="218"/>  218:     check(fun() -&gt; if not element(3, ATuple) -&gt; ok; true -&gt; error end end, error),
<a name="219"/>  219: 
<a name="220"/>  220:     check(fun() -&gt; if not glurf -&gt; ok; true -&gt; error end end, error),
<a name="221"/>  221:     check(fun() -&gt; if not Glurf -&gt; ok; true -&gt; error end end, error),
<a name="222"/>  222: 
<a name="223"/>  223:     check(fun() -&gt; if not (not true) -&gt; broken end end, broken),
<a name="224"/>  224: 
<a name="225"/>  225:     check(fun() -&gt; if not (True xor True) -&gt; ok end end, ok),
<a name="226"/>  226:     check(fun() -&gt; if not (True xor False) -&gt; ok;
<a name="227"/>  227: 		      true -&gt; error end end, error),
<a name="228"/>  228: 
<a name="229"/>  229:     check(fun() -&gt; if not (True =:= true) -&gt; ok; true -&gt; error end end, error),
<a name="230"/>  230:     check(fun() -&gt; if not (False =:= true) -&gt; ok; true -&gt; error end end, ok),
<a name="231"/>  231:     check(fun() -&gt; if not (Glurf =:= true) -&gt; ok; true -&gt; error end end, ok),
<a name="232"/>  232: 
<a name="basic_not-last_expr"/><a name="233"/>  233:     ok.
<a name="234"/>  234: 
<a name="complex_not-1"/><a name="235"/>  235: <b>complex_not</b>(Config) when is_list(Config) -&gt;
<a name="236"/>  236:     ATuple = id({false,true,gurka}),
<a name="237"/>  237:     check(fun() -&gt; if not(element(1, ATuple)) -&gt; ok; true -&gt; error end end, ok),
<a name="238"/>  238:     check(fun() -&gt; if not(element(2, ATuple)) -&gt; ok; true -&gt; error end end, error),
<a name="239"/>  239: 
<a name="240"/>  240:     check(fun() -&gt; if not(element(3, ATuple) == gurka) -&gt; ok;
<a name="241"/>  241: 		      true -&gt; error end end, error),
<a name="242"/>  242:     check(fun() -&gt; if not(element(3, ATuple) =/= gurka) -&gt; ok;
<a name="243"/>  243: 		      true -&gt; error end end, ok),
<a name="244"/>  244: 
<a name="245"/>  245:     check(fun() -&gt; if {a,not(element(2, ATuple))} == {a,false} -&gt; ok;
<a name="246"/>  246: 		      true -&gt; error end end, ok),
<a name="247"/>  247:     check(fun() -&gt; if {a,not(element(1, ATuple))} == {a,false} -&gt; ok;
<a name="248"/>  248: 		      true -&gt; error end end, error),
<a name="249"/>  249: 
<a name="250"/>  250:     check(fun() -&gt; if not(element(1, ATuple) or element(3, ATuple)) -&gt; ok;
<a name="251"/>  251: 		      true -&gt; error end end, error),
<a name="252"/>  252: 
<a name="253"/>  253:     %% orelse
<a name="254"/>  254:     check(fun() -&gt; if not(element(1, ATuple) orelse element(3, ATuple)) -&gt; ok;
<a name="255"/>  255: 		      true -&gt; error end end, error),
<a name="256"/>  256: 
<a name="257"/>  257:     %% complex_not_1/4
<a name="258"/>  258:     ok = complex_not_1(1, 1, 1, a),
<a name="259"/>  259:     error = complex_not_1(1, 1, 1, []),
<a name="260"/>  260:     error = complex_not_1(1, 1, 3, a),
<a name="261"/>  261:     error = complex_not_1(1, 1, 3, []),
<a name="262"/>  262:     error = complex_not_1(1, 2, 1, a),
<a name="263"/>  263:     error = complex_not_1(1, 2, 1, []),
<a name="264"/>  264:     error = complex_not_1(1, 2, 3, a),
<a name="265"/>  265:     error = complex_not_1(1, 2, 3, []),
<a name="266"/>  266: 
<a name="267"/>  267:     %% complex_not_2/4
<a name="268"/>  268:     ok = complex_not_2(1, 2, 0, x),
<a name="269"/>  269:     error = complex_not_2(1, 2, 0, []),
<a name="270"/>  270:     error = complex_not_2(1, 2, 3, x),
<a name="271"/>  271:     error = complex_not_2(1, 2, 3, []),
<a name="272"/>  272:     error = complex_not_2(1, 1, 0, x),
<a name="273"/>  273:     error = complex_not_2(1, 1, 0, []),
<a name="274"/>  274:     error = complex_not_2(1, 1, 3, x),
<a name="275"/>  275:     error = complex_not_2(1, 1, 3, []),
<a name="276"/>  276: 
<a name="complex_not-last_expr"/><a name="277"/>  277:     ok.
<a name="278"/>  278: 
<a name="complex_not_1-4"/><a name="279"/>  279: <b>complex_not_1</b>(A, B, C, D) -&gt;
<a name="280"/>  280:     Res = complex_not_1a(A, B, C, D),
<a name="complex_not_1-last_expr"/><a name="281"/>  281: <b>    Res = complex_not_1b</b>(A, B, C, D).
<a name="282"/>  282: 
<a name="complex_not_1a-4"/><a name="283"/>  283: <b>complex_not_1a</b>(A, B, C, D)
<a name="284"/>  284:   when (not (A &lt; B)) andalso (not (B &lt; C)) andalso (not is_list(D)) -&gt;
<a name="285"/>  285:     ok;
<a name="286"/>  286: <b>complex_not_1a</b>(_, _, _, _) -&gt;
<a name="complex_not_1a-last_expr"/><a name="287"/>  287:     error.
<a name="288"/>  288: 
<a name="complex_not_1b-4"/><a name="289"/>  289: <b>complex_not_1b</b>(A, B, C, D)
<a name="290"/>  290:   when (not (A &lt; B)) and (not (B &lt; C)) and (not is_list(D)) -&gt;
<a name="291"/>  291:     ok;
<a name="292"/>  292: <b>complex_not_1b</b>(_, _, _, _) -&gt;
<a name="complex_not_1b-last_expr"/><a name="293"/>  293:     error.
<a name="294"/>  294: 
<a name="complex_not_2-4"/><a name="295"/>  295: <b>complex_not_2</b>(A, B, C, D) -&gt;
<a name="296"/>  296:     Res = complex_not_2a(A, B, C, D),
<a name="complex_not_2-last_expr"/><a name="297"/>  297: <b>    Res = complex_not_2b</b>(A, B, C, D).
<a name="298"/>  298: 
<a name="complex_not_2a-4"/><a name="299"/>  299: <b>complex_not_2a</b>(A, B, C, D)
<a name="300"/>  300:   when A &lt; B andalso not (B &lt; C) andalso not is_list(D) -&gt;
<a name="301"/>  301:     ok;
<a name="302"/>  302: <b>complex_not_2a</b>(_, _, _, _) -&gt;
<a name="complex_not_2a-last_expr"/><a name="303"/>  303:     error.
<a name="304"/>  304: 
<a name="complex_not_2b-4"/><a name="305"/>  305: <b>complex_not_2b</b>(A, B, C, D)
<a name="306"/>  306:   when A &lt; B, not (B &lt; C), not is_list(D) -&gt;
<a name="307"/>  307:     ok;
<a name="308"/>  308: <b>complex_not_2b</b>(_, _, _, _) -&gt;
<a name="complex_not_2b-last_expr"/><a name="309"/>  309:     error.
<a name="310"/>  310: 
<a name="nested_nots-1"/><a name="311"/>  311: <b>nested_nots</b>(Config) when is_list(Config) -&gt;
<a name="312"/>  312:     true = nested_not_1(0, 0),
<a name="313"/>  313:     true = nested_not_1(0, 1),
<a name="314"/>  314:     true = nested_not_1(a, b),
<a name="315"/>  315:     true = nested_not_1(10, 0),
<a name="316"/>  316:     false = nested_not_1(z, a),
<a name="317"/>  317:     false = nested_not_1(3.4, {anything,goes}),
<a name="318"/>  318:     false = nested_not_1(3.4, atom),
<a name="319"/>  319:     true = nested_not_1(3.0, [list]),
<a name="320"/>  320: 
<a name="321"/>  321:     true = nested_not_2(false, false, 42),
<a name="322"/>  322:     true = nested_not_2(false, true, 42),
<a name="323"/>  323:     true = nested_not_2(true, false, 42),
<a name="324"/>  324:     true = nested_not_2(true, true, 42),
<a name="325"/>  325:     true = nested_not_2(false, false, atom),
<a name="326"/>  326:     false = nested_not_2(false, true, atom),
<a name="327"/>  327:     false = nested_not_2(true, false, atom),
<a name="328"/>  328:     false = nested_not_2(true, true, atom),
<a name="nested_nots-last_expr"/><a name="329"/>  329:     ok.
<a name="330"/>  330: 
<a name="nested_not_1-2"/><a name="331"/>  331: <b>nested_not_1</b>(X, Y) -&gt;
<a name="332"/>  332:     Res = nested_not_1a(X, Y),
<a name="nested_not_1-last_expr"/><a name="333"/>  333: <b>    Res = nested_not_1b</b>(X, Y).
<a name="334"/>  334: 
<a name="nested_not_1a-2"/><a name="335"/>  335: <b>nested_not_1a</b>(X, Y) when not (((X&gt;Y) or not(is_atom(X))) and
<a name="336"/>  336: 			     (is_atom(Y) or (X==3.4))) -&gt;
<a name="337"/>  337:     true;
<a name="338"/>  338: <b>nested_not_1a</b>(_, _) -&gt;
<a name="nested_not_1a-last_expr"/><a name="339"/>  339:     false.
<a name="340"/>  340: 
<a name="nested_not_1b-2"/><a name="341"/>  341: <b>nested_not_1b</b>(X, Y) when not (((X&gt;Y) orelse not(is_atom(X))) andalso
<a name="342"/>  342: 			     (is_atom(Y) orelse (X==3.4))) -&gt;
<a name="343"/>  343:     true;
<a name="344"/>  344: <b>nested_not_1b</b>(_, _) -&gt;
<a name="nested_not_1b-last_expr"/><a name="345"/>  345:     false.
<a name="346"/>  346: 
<a name="nested_not_2-3"/><a name="347"/>  347: <b>nested_not_2</b>(X, Y, Z) -&gt;
<a name="348"/>  348:     Res = nested_not_2a(X, Y, Z, true),
<a name="nested_not_2-last_expr"/><a name="349"/>  349: <b>    Res = nested_not_2b</b>(X, Y, Z, true).
<a name="350"/>  350: 
<a name="nested_not_2a-4"/><a name="351"/>  351: <b>nested_not_2a</b>(X, Y, Z, True)
<a name="352"/>  352:   when not(True and not((not(X) and not(Y)) or not(is_atom(Z)))) -&gt;
<a name="353"/>  353:     true;
<a name="354"/>  354: <b>nested_not_2a</b>(_, _, _, _) -&gt;
<a name="nested_not_2a-last_expr"/><a name="355"/>  355:     false.
<a name="356"/>  356: 
<a name="nested_not_2b-4"/><a name="357"/>  357: <b>nested_not_2b</b>(X, Y, Z, True)
<a name="358"/>  358:   when not(True andalso not((not(X) andalso not(Y)) orelse not(is_atom(Z)))) -&gt;
<a name="359"/>  359:     true;
<a name="360"/>  360: <b>nested_not_2b</b>(_, _, _, _) -&gt;
<a name="nested_not_2b-last_expr"/><a name="361"/>  361:     false.
<a name="362"/>  362: 
<a name="semicolon-1"/><a name="363"/>  363: <b>semicolon</b>(Config) when is_list(Config) -&gt;
<a name="364"/>  364: 
<a name="365"/>  365:     %% True/false combined using ';' (literal atoms).
<a name="366"/>  366: 
<a name="367"/>  367:     check(fun() -&gt; if true; false -&gt; ok end end, ok),
<a name="368"/>  368:     check(fun() -&gt; if false; true -&gt; ok end end, ok),
<a name="369"/>  369:     check(fun() -&gt; if true; true -&gt; ok end end, ok),
<a name="370"/>  370:     check(fun() -&gt; if false; false -&gt; ok; true -&gt; error end end, error),
<a name="371"/>  371:     check(fun() -&gt;
<a name="372"/>  372: 		  {'EXIT',{if_clause,_}} = (catch if false; false -&gt; ok end),
<a name="373"/>  373: 		  exit
<a name="374"/>  374: 	  end, exit),
<a name="375"/>  375: 
<a name="376"/>  376:     %% True/false combined used ';'.
<a name="377"/>  377: 
<a name="378"/>  378:     True = id(true),
<a name="379"/>  379:     False = id(false),
<a name="380"/>  380: 
<a name="381"/>  381:     check(fun() -&gt; if True; False -&gt; ok end end, ok),
<a name="382"/>  382:     check(fun() -&gt; if False; True -&gt; ok end end, ok),
<a name="383"/>  383:     check(fun() -&gt; if True; True -&gt; ok end end, ok),
<a name="384"/>  384:     check(fun() -&gt; if False; False -&gt; ok; true -&gt; error end end, error),
<a name="385"/>  385:     check(fun() -&gt;
<a name="386"/>  386: 		  {'EXIT',{if_clause,_}} = (catch if False; False -&gt; ok end),
<a name="387"/>  387: 		  exit
<a name="388"/>  388: 	  end, exit),
<a name="389"/>  389: 
<a name="390"/>  390:     %% Combine true/false with a non-boolean value.
<a name="391"/>  391:     Glurf = id(glurf),
<a name="392"/>  392: 
<a name="393"/>  393: 
<a name="394"/>  394:     check(fun() -&gt; if True; Glurf -&gt; ok end end, ok),
<a name="395"/>  395:     check(fun() -&gt; if Glurf; True -&gt; ok end end, ok),
<a name="396"/>  396:     check(fun() -&gt; if Glurf; Glurf -&gt; ok; true -&gt; error end end, error),
<a name="397"/>  397:     check(fun() -&gt; if False; Glurf -&gt; ok; true -&gt; error end end, error),
<a name="398"/>  398:     check(fun() -&gt; if Glurf; False -&gt; ok; true -&gt; error end end, error),
<a name="399"/>  399:     check(fun() -&gt;
<a name="400"/>  400: 		  {'EXIT',{if_clause,_}} = (catch if Glurf; Glurf -&gt; ok end),
<a name="401"/>  401: 		  exit
<a name="402"/>  402: 	  end, exit),
<a name="403"/>  403: 
<a name="404"/>  404:     %% Combine true/false with errors.
<a name="405"/>  405: 
<a name="406"/>  406:     ATuple = id({false,true,gurka}),
<a name="407"/>  407: 
<a name="408"/>  408:     check(fun() -&gt; if True; element(42, ATuple) -&gt; ok end end, ok),
<a name="409"/>  409:     check(fun() -&gt; if element(42, ATuple); True -&gt; ok end end, ok),
<a name="410"/>  410:     check(fun() -&gt; if element(42, ATuple); element(42, ATuple) -&gt; ok;
<a name="411"/>  411: 		      true -&gt; error end end, error),
<a name="412"/>  412:     check(fun() -&gt; if False; element(42, ATuple) -&gt; ok;
<a name="413"/>  413: 		      true -&gt; error end end, error),
<a name="414"/>  414:     check(fun() -&gt; if element(42, ATuple);
<a name="415"/>  415: 		      False -&gt; ok; true -&gt; error end end, error),
<a name="416"/>  416:     check(fun() -&gt;
<a name="417"/>  417: 		  {'EXIT',{if_clause,_}} =
<a name="418"/>  418: 		      (catch if element(42, ATuple);
<a name="419"/>  419: 				element(42, ATuple) -&gt; ok end),
<a name="420"/>  420: 		  exit
<a name="421"/>  421: 	  end, exit),
<a name="422"/>  422: 
<a name="semicolon-last_expr"/><a name="423"/>  423:     ok.
<a name="424"/>  424: 
<a name="complex_semicolon-1"/><a name="425"/>  425: <b>complex_semicolon</b>(Config) when is_list(Config) -&gt;
<a name="426"/>  426:     ok = csemi1(int, {blurf}),
<a name="427"/>  427:     ok = csemi1(string, {blurf}),
<a name="428"/>  428:     ok = csemi1(float, [a]),
<a name="429"/>  429:     error = csemi1(35, 42),
<a name="430"/>  430: 
<a name="431"/>  431:     %% 2
<a name="432"/>  432:     ok = csemi2({}, {a,b,c}),
<a name="433"/>  433:     ok = csemi2({1,3.5}, {a,b,c}),
<a name="434"/>  434:     ok = csemi2(dum, {a,b,c}),
<a name="435"/>  435: 
<a name="436"/>  436:     ok = csemi2({45,-19.3}, {}),
<a name="437"/>  437:     ok = csemi2({45,-19.3}, {dum}),
<a name="438"/>  438:     ok = csemi2({45,-19.3}, {dum,dum}),
<a name="439"/>  439: 
<a name="440"/>  440:     error = csemi2({45}, {dum}),
<a name="441"/>  441:     error = csemi2([], {dum}),
<a name="442"/>  442:     error = csemi2({dum}, []),
<a name="443"/>  443:     error = csemi2([], []),
<a name="444"/>  444: 
<a name="445"/>  445:     %% 3
<a name="446"/>  446:     csemi3(fun csemi3a/4),
<a name="447"/>  447:     csemi3(fun csemi3b/4),
<a name="448"/>  448:     csemi3(fun csemi3c/4),
<a name="449"/>  449: 
<a name="450"/>  450:     %% 4
<a name="451"/>  451:     csemi4(fun csemi4a/4),
<a name="452"/>  452:     csemi4(fun csemi4b/4),
<a name="453"/>  453:     csemi4(fun csemi4c/4),
<a name="454"/>  454:     csemi4(fun csemi4d/4),
<a name="455"/>  455: 
<a name="456"/>  456:     %% 4, 'orelse' instead of 'or'
<a name="457"/>  457:     csemi4_orelse(fun csemi4_orelse_a/4),
<a name="458"/>  458:     csemi4_orelse(fun csemi4_orelse_b/4),
<a name="459"/>  459:     csemi4_orelse(fun csemi4_orelse_c/4),
<a name="460"/>  460:     csemi4_orelse(fun csemi4_orelse_d/4),
<a name="461"/>  461: 
<a name="462"/>  462:     %% 5
<a name="463"/>  463:     error = csemi5(0, 0),
<a name="464"/>  464:     ok = csemi5(5, 0),
<a name="465"/>  465:     ok = csemi5(4, -4),
<a name="466"/>  466:     ok = csemi5(10, -4),
<a name="467"/>  467: 
<a name="468"/>  468:     %% 6
<a name="469"/>  469:     error = csemi6({a}, 0),
<a name="470"/>  470:     ok = csemi6({a,b}, 0),
<a name="471"/>  471:     ok = csemi6({}, 3),
<a name="472"/>  472:     ok = csemi6({a,b,c}, 3),
<a name="473"/>  473: 
<a name="474"/>  474:     %% 7
<a name="475"/>  475:     error = csemi7(#{a=&gt;1}, 1, 0),
<a name="476"/>  476:     error = csemi7(&lt;&lt;&gt;&gt;, 1, 0),
<a name="477"/>  477:     ok = csemi7(#{a=&gt;1}, 3, 0),
<a name="478"/>  478:     ok = csemi7(#{a=&gt;1}, 0, 3),
<a name="479"/>  479:     ok = csemi7(#{a=&gt;1}, 3, 3),
<a name="480"/>  480:     ok = csemi7(#{a=&gt;1, b=&gt;3}, 0, 0),
<a name="481"/>  481: 
<a name="482"/>  482:     %% 8: Make sure that funs cannot be copied into guards.
<a name="483"/>  483:     ok = csemi8(true),
<a name="484"/>  484:     error = csemi8(false),
<a name="485"/>  485:     error = csemi8(42),
<a name="486"/>  486: 
<a name="complex_semicolon-last_expr"/><a name="487"/>  487:     ok.
<a name="488"/>  488: 
<a name="csemi1-2"/><a name="489"/>  489: <b>csemi1</b>(Type, Val) when is_list(Val), Type == float;
<a name="490"/>  490: 		       Type == int; Type == string -&gt; ok;
<a name="csemi1-last_expr"/><a name="491"/>  491: <b>csemi1</b>(_, _) -&gt; error.
<a name="492"/>  492: 
<a name="csemi2-2"/><a name="493"/>  493: <b>csemi2</b>(A, B) when tuple_size(A) &gt; 1; tuple_size(B) &gt; 2 -&gt; ok;
<a name="csemi2-last_expr"/><a name="494"/>  494: <b>csemi2</b>(_, _) -&gt; error.
<a name="495"/>  495: 
<a name="csemi3-1"/><a name="496"/>  496: <b>csemi3</b>(Csemi3) -&gt;
<a name="497"/>  497:     ok = Csemi3({}, {a,b,c}, [0], [0]),
<a name="498"/>  498:     ok = Csemi3({1,3.5}, {a,b,c}, -1, -1),
<a name="499"/>  499:     ok = Csemi3(dum, {a,b,c}, 0.0, 0.0),
<a name="500"/>  500:     ok = Csemi3(dum, {c}, b, a),
<a name="501"/>  501:     ok = Csemi3(dum, &lt;&lt;1,2,3&gt;&gt;, 0.0, 0.0),
<a name="502"/>  502:     ok = Csemi3(&lt;&lt;3.5/float&gt;&gt;, {a,b,c}, -1, -1),
<a name="503"/>  503: 
<a name="504"/>  504:     ok = Csemi3({45,-19.3}, {}, [], []),
<a name="505"/>  505:     ok = Csemi3({45,-19.3}, {dum}, 42, 42),
<a name="506"/>  506:     ok = Csemi3({45,-19.3}, {dum,dum}, 33, 33),
<a name="507"/>  507: 
<a name="508"/>  508:     ok = Csemi3({45}, {dum}, 1.0, 0),
<a name="509"/>  509:     ok = Csemi3([a], {dum}, 1.0, 0),
<a name="510"/>  510:     ok = Csemi3({dum}, [], 1.0, 0),
<a name="511"/>  511:     ok = Csemi3([], [], 1.0, 0),
<a name="512"/>  512:     ok = Csemi3(blurf, {dum}, 1.0, 0),
<a name="513"/>  513:     ok = Csemi3({a}, blurf, 1.0, 0),
<a name="514"/>  514:     ok = Csemi3([a], [dum], 1.0, 0),
<a name="515"/>  515:     ok = Csemi3({dum}, [], 1.0, 0),
<a name="516"/>  516:     ok = Csemi3([], [], 1.0, 0),
<a name="517"/>  517: 
<a name="518"/>  518:     error = Csemi3({45}, {dum}, 0, 0),
<a name="519"/>  519:     error = Csemi3([a], {dum}, 0, 0),
<a name="520"/>  520:     error = Csemi3({dum}, [], 0, 0),
<a name="521"/>  521:     error = Csemi3([], [], 0, 0),
<a name="522"/>  522: 
<a name="csemi3-last_expr"/><a name="523"/>  523:     ok.
<a name="524"/>  524: 
<a name="csemi3a-4"/><a name="525"/>  525: <b>csemi3a</b>(A, B, X, Y) when X &gt; Y; size(A) &gt; 1; size(B) &gt; 2 -&gt; ok;
<a name="csemi3a-last_expr"/><a name="526"/>  526: <b>csemi3a</b>(_, _, _, _) -&gt; error.
<a name="527"/>  527: 
<a name="csemi3b-4"/><a name="528"/>  528: <b>csemi3b</b>(A, B, X, Y) when size(A) &gt; 1; X &gt; Y; size(B) &gt; 2 -&gt; ok;
<a name="csemi3b-last_expr"/><a name="529"/>  529: <b>csemi3b</b>(_, _, _, _) -&gt; error.
<a name="530"/>  530: 
<a name="csemi3c-4"/><a name="531"/>  531: <b>csemi3c</b>(A, B, X, Y) when size(A) &gt; 1; size(B) &gt; 2; X &gt; Y -&gt; ok;
<a name="csemi3c-last_expr"/><a name="532"/>  532: <b>csemi3c</b>(_, _, _, _) -&gt; error.
<a name="533"/>  533: 
<a name="534"/>  534: 
<a name="csemi4-1"/><a name="535"/>  535: <b>csemi4</b>(Test) -&gt;
<a name="536"/>  536:     ok = Test({a,b}, 2, {c,d}, 2),
<a name="537"/>  537:     ok = Test({1,2,3}, 0, [], 0),
<a name="538"/>  538:     ok = Test({}, 2, blurf, 0),
<a name="539"/>  539:     ok = Test({}, 2, {1}, 2),
<a name="540"/>  540: 
<a name="541"/>  541:     error = Test([], 4, {}, 0),
<a name="542"/>  542:     error = Test({}, 0, [a,b], 4),
<a name="543"/>  543:     error = Test({}, 0, [a,b], 0),
<a name="544"/>  544:     error = Test([], 0, {}, 0),
<a name="545"/>  545:     error = Test({}, 0, {}, 0),
<a name="546"/>  546: 
<a name="csemi4-last_expr"/><a name="547"/>  547:     ok.
<a name="548"/>  548: 
<a name="csemi4a-4"/><a name="549"/>  549: <b>csemi4a</b>(A, X, B, Y) when (tuple_size(A) &gt; 1) or (X &gt; 1);
<a name="550"/>  550: 			 (tuple_size(B) &gt; 1) or (Y &gt; 1) -&gt; ok;
<a name="csemi4a-last_expr"/><a name="551"/>  551: <b>csemi4a</b>(_, _, _, _) -&gt; error.
<a name="552"/>  552: 
<a name="csemi4b-4"/><a name="553"/>  553: <b>csemi4b</b>(A, X, B, Y) when (X &gt; 1) or (tuple_size(A) &gt; 1);
<a name="554"/>  554: 			 (tuple_size(B) &gt; 1) or (Y &gt; 1) -&gt; ok;
<a name="csemi4b-last_expr"/><a name="555"/>  555: <b>csemi4b</b>(_, _, _, _) -&gt; error.
<a name="556"/>  556: 
<a name="csemi4c-4"/><a name="557"/>  557: <b>csemi4c</b>(A, X, B, Y) when (tuple_size(A) &gt; 1) or (X &gt; 1);
<a name="558"/>  558: 			 (Y &gt; 1) or (tuple_size(B) &gt; 1) -&gt; ok;
<a name="csemi4c-last_expr"/><a name="559"/>  559: <b>csemi4c</b>(_, _, _, _) -&gt; error.
<a name="560"/>  560:     
<a name="csemi4d-4"/><a name="561"/>  561: <b>csemi4d</b>(A, X, B, Y) when (X &gt; 1) or (tuple_size(A) &gt; 1);
<a name="562"/>  562: 			 (Y &gt; 1) or (tuple_size(B) &gt; 1) -&gt; ok;
<a name="csemi4d-last_expr"/><a name="563"/>  563: <b>csemi4d</b>(_, _, _, _) -&gt; error.
<a name="564"/>  564: 
<a name="565"/>  565: 
<a name="csemi4_orelse-1"/><a name="566"/>  566: <b>csemi4_orelse</b>(Test) -&gt;
<a name="567"/>  567:     ok = Test({a,b}, 2, {c,d}, 2),
<a name="568"/>  568:     ok = Test({1,2,3}, 0, [], 0),
<a name="569"/>  569:     ok = Test({}, 2, blurf, 0),
<a name="570"/>  570:     ok = Test({}, 2, {1}, 2),
<a name="571"/>  571: 
<a name="572"/>  572:     error = Test([], 1, {}, 0),
<a name="573"/>  573: 
<a name="csemi4_orelse-last_expr"/><a name="574"/>  574:     ok.
<a name="575"/>  575: 
<a name="csemi4_orelse_a-4"/><a name="576"/>  576: <b>csemi4_orelse_a</b>(A, X, B, Y) when (tuple_size(A) &gt; 1) orelse (X &gt; 1);
<a name="577"/>  577: 			 (tuple_size(B) &gt; 1) orelse (Y &gt; 1) -&gt; ok;
<a name="csemi4_orelse_a-last_expr"/><a name="578"/>  578: <b>csemi4_orelse_a</b>(_, _, _, _) -&gt; error.
<a name="579"/>  579: 
<a name="csemi4_orelse_b-4"/><a name="580"/>  580: <b>csemi4_orelse_b</b>(A, X, B, Y) when (X &gt; 1) orelse (tuple_size(A) &gt; 1);
<a name="581"/>  581: 			 (tuple_size(B) &gt; 1) orelse (Y &gt; 1) -&gt; ok;
<a name="csemi4_orelse_b-last_expr"/><a name="582"/>  582: <b>csemi4_orelse_b</b>(_, _, _, _) -&gt; error.
<a name="583"/>  583: 
<a name="csemi4_orelse_c-4"/><a name="584"/>  584: <b>csemi4_orelse_c</b>(A, X, B, Y) when (tuple_size(A) &gt; 1) orelse (X &gt; 1);
<a name="585"/>  585:                            (Y &gt; 1) orelse (tuple_size(B) &gt; 1) -&gt; ok;
<a name="csemi4_orelse_c-last_expr"/><a name="586"/>  586: <b>csemi4_orelse_c</b>(_, _, _, _) -&gt; error.
<a name="587"/>  587:     
<a name="csemi4_orelse_d-4"/><a name="588"/>  588: <b>csemi4_orelse_d</b>(A, X, B, Y) when (X &gt; 1) or (tuple_size(A) &gt; 1);
<a name="589"/>  589: 			 (Y &gt; 1) or (tuple_size(B) &gt; 1) -&gt; ok;
<a name="csemi4_orelse_d-last_expr"/><a name="590"/>  590: <b>csemi4_orelse_d</b>(_, _, _, _) -&gt; error.
<a name="591"/>  591: 
<a name="csemi5-2"/><a name="592"/>  592: <b>csemi5</b>(A, B) when hd([A+B]) &gt; 1; abs(B) &gt; 2 -&gt; ok;
<a name="csemi5-last_expr"/><a name="593"/>  593: <b>csemi5</b>(_, _) -&gt; error.
<a name="594"/>  594: 
<a name="csemi6-2"/><a name="595"/>  595: <b>csemi6</b>(A, B) when hd([tuple_size(A)]) &gt; 1; abs(B) &gt; 2 -&gt; ok;
<a name="csemi6-last_expr"/><a name="596"/>  596: <b>csemi6</b>(_, _) -&gt; error.
<a name="597"/>  597:     
<a name="csemi7-3"/><a name="598"/>  598: <b>csemi7</b>(A, B, C) when A#{a:=B} &gt; #{a=&gt;1}; abs(C) &gt; 2 -&gt; ok;
<a name="csemi7-last_expr"/><a name="599"/>  599: <b>csemi7</b>(_, _, _) -&gt; error.
<a name="600"/>  600: 
<a name="csemi8-1"/><a name="601"/>  601: <b>csemi8</b>(Together) -&gt;
<a name="csemi8-last_expr"/><a name="602"/>  602:   case fun csemi8/1 of
<a name="603"/>  603:       Typically when Together; Typically, Together -&gt; ok;
<a name="604"/>  604:       _ -&gt; error
<a name="605"/>  605:   end.
<a name="606"/>  606: 
<a name="607"/>  607: 
<a name="comma-1"/><a name="608"/>  608: <b>comma</b>(Config) when is_list(Config) -&gt;
<a name="609"/>  609: 
<a name="610"/>  610:     %% ',' combinations of literal true/false.
<a name="611"/>  611: 
<a name="612"/>  612:     check(fun() -&gt; if true, false -&gt; ok; true -&gt; error end end, error),
<a name="613"/>  613:     check(fun() -&gt; if false, true -&gt; ok; true -&gt; error end end, error),
<a name="614"/>  614:     check(fun() -&gt; if true, true -&gt; ok end end, ok),
<a name="615"/>  615:     check(fun() -&gt; if false, false -&gt; ok; true -&gt; error end end, error),
<a name="616"/>  616:     check(fun() -&gt;
<a name="617"/>  617: 		  {'EXIT',{if_clause,_}} =
<a name="618"/>  618: 		      (catch if true, false -&gt; ok;
<a name="619"/>  619: 				false, true -&gt; ok;
<a name="620"/>  620: 				false, false -&gt; ok
<a name="621"/>  621: 			     end),
<a name="622"/>  622: 		  exit
<a name="623"/>  623: 	  end, exit),
<a name="624"/>  624: 
<a name="625"/>  625:     %% ',' combinations of true/false in variables.
<a name="626"/>  626: 
<a name="627"/>  627:     True = id(true),
<a name="628"/>  628:     False = id(false),
<a name="629"/>  629: 
<a name="630"/>  630:     check(fun() -&gt; if True, False -&gt; ok; true -&gt; error end end, error),
<a name="631"/>  631:     check(fun() -&gt; if False, True -&gt; ok; true -&gt; error end end, error),
<a name="632"/>  632:     check(fun() -&gt; if True, True -&gt; ok end end, ok),
<a name="633"/>  633:     check(fun() -&gt; if False, False -&gt; ok; true -&gt; error end end, error),
<a name="634"/>  634:     check(fun() -&gt;
<a name="635"/>  635: 		  {'EXIT',{if_clause,_}} =
<a name="636"/>  636: 		      (catch if True, False -&gt; ok;
<a name="637"/>  637: 				False, True -&gt; ok;
<a name="638"/>  638: 				False, False -&gt; ok
<a name="639"/>  639: 			     end),
<a name="640"/>  640: 		  exit
<a name="641"/>  641: 	  end, exit),
<a name="642"/>  642: 
<a name="643"/>  643:     %% ',' combinations of true/false, and non-boolean in variables.
<a name="644"/>  644: 
<a name="645"/>  645:     Glurf = id(glurf),
<a name="646"/>  646: 
<a name="647"/>  647:     check(fun() -&gt; if True, Glurf -&gt; ok; true -&gt; error end end, error),
<a name="648"/>  648:     check(fun() -&gt; if Glurf, True -&gt; ok; true -&gt; error end end, error),
<a name="649"/>  649:     check(fun() -&gt; if True, True -&gt; ok end end, ok),
<a name="650"/>  650:     check(fun() -&gt; if Glurf, Glurf -&gt; ok; true -&gt; error end end, error),
<a name="651"/>  651:     check(fun() -&gt;
<a name="652"/>  652: 		  {'EXIT',{if_clause,_}} =
<a name="653"/>  653: 		      (catch if True, Glurf -&gt; ok;
<a name="654"/>  654: 				Glurf, True -&gt; ok;
<a name="655"/>  655: 				Glurf, Glurf -&gt; ok
<a name="656"/>  656: 			     end),
<a name="657"/>  657: 		  exit
<a name="658"/>  658: 	  end, exit),
<a name="659"/>  659: 
<a name="660"/>  660:     %% ',' combinations of true/false with errors.
<a name="661"/>  661:     ATuple = id({a,b,c}),
<a name="662"/>  662: 
<a name="663"/>  663:     check(fun() -&gt; if True, element(42, ATuple) -&gt; ok;
<a name="664"/>  664: 		      true -&gt; error end end, error),
<a name="665"/>  665:     check(fun() -&gt; if element(42, ATuple), True -&gt; ok;
<a name="666"/>  666: 		      true -&gt; error end end, error),
<a name="667"/>  667:     check(fun() -&gt; if True, True -&gt; ok end end, ok),
<a name="668"/>  668:     check(fun() -&gt; if element(42, ATuple), element(42, ATuple) -&gt; ok;
<a name="669"/>  669: 		      true -&gt; error end end, error),
<a name="670"/>  670:     check(fun() -&gt;
<a name="671"/>  671: 		  {'EXIT',{if_clause,_}} =
<a name="672"/>  672: 		      (catch if True, element(42, ATuple) -&gt; ok;
<a name="673"/>  673: 				element(42, ATuple), True -&gt; ok;
<a name="674"/>  674: 				element(42, ATuple), element(42, ATuple) -&gt; ok
<a name="675"/>  675: 			     end),
<a name="676"/>  676: 		  exit
<a name="677"/>  677: 	  end, exit),
<a name="678"/>  678:     
<a name="comma-last_expr"/><a name="679"/>  679:     ok.
<a name="680"/>  680: 
<a name="or_guard-1"/><a name="681"/>  681: <b>or_guard</b>(Config) when is_list(Config) -&gt;
<a name="682"/>  682:     True = id(true),
<a name="683"/>  683:     False = id(false),
<a name="684"/>  684:     Glurf = id(glurf),
<a name="685"/>  685: 
<a name="686"/>  686:     %% 'or' combinations of literal true/false.
<a name="687"/>  687:     check(fun() -&gt; if true or false -&gt; ok end end, ok),
<a name="688"/>  688:     check(fun() -&gt; if false or true -&gt; ok end end, ok),
<a name="689"/>  689:     check(fun() -&gt; if true or true -&gt; ok end end, ok),
<a name="690"/>  690:     check(fun() -&gt; if false or false -&gt; ok; true -&gt; error end end, error),
<a name="691"/>  691: 
<a name="692"/>  692:     check(fun() -&gt; if glurf or true -&gt; ok; true -&gt; error end end, error),
<a name="693"/>  693:     check(fun() -&gt; if true or glurf -&gt; ok; true -&gt; error end end, error),
<a name="694"/>  694:     check(fun() -&gt; if glurf or glurf -&gt; ok; true -&gt; error end end, error),
<a name="695"/>  695: 
<a name="696"/>  696:     check(fun() -&gt;
<a name="697"/>  697: 		  {'EXIT',{if_clause,_}} = (catch if false or false -&gt; ok end),
<a name="698"/>  698: 		  exit
<a name="699"/>  699: 	  end, exit),
<a name="700"/>  700: 
<a name="701"/>  701: 
<a name="702"/>  702:     %% 'or' combinations using variables containing true/false.
<a name="703"/>  703:     check(fun() -&gt; if True or False -&gt; ok end end, ok),
<a name="704"/>  704:     check(fun() -&gt; if False or True -&gt; ok end end, ok),
<a name="705"/>  705:     check(fun() -&gt; if True or True -&gt; ok end end, ok),
<a name="706"/>  706:     check(fun() -&gt; if False or False -&gt; ok; true -&gt; error end end, error),
<a name="707"/>  707: 
<a name="708"/>  708:     check(fun() -&gt; if True or Glurf -&gt; ok; true -&gt; error end end, error),
<a name="709"/>  709:     check(fun() -&gt; if Glurf or True -&gt; ok; true -&gt; error end end, error),
<a name="710"/>  710:     check(fun() -&gt; if Glurf or Glurf -&gt; ok; true -&gt; error end end, error),
<a name="711"/>  711: 
<a name="712"/>  712:     check(fun() -&gt;
<a name="713"/>  713: 		  {'EXIT',{if_clause,_}} = (catch if False or False -&gt; ok end),
<a name="714"/>  714: 		  exit
<a name="715"/>  715: 	  end, exit),
<a name="716"/>  716: 
<a name="or_guard-last_expr"/><a name="717"/>  717:     ok.
<a name="718"/>  718: 
<a name="more_or_guards-1"/><a name="719"/>  719: <b>more_or_guards</b>(Config) when is_list(Config) -&gt;
<a name="720"/>  720:     True = id(true),
<a name="721"/>  721:     False = id(false),
<a name="722"/>  722:     ATuple = id({false,true,gurka}),
<a name="723"/>  723: 
<a name="724"/>  724:     check(fun() -&gt;
<a name="725"/>  725: 		  if element(42, ATuple) or False -&gt; ok;
<a name="726"/>  726: 		     true -&gt; error end
<a name="727"/>  727: 	  end, error),
<a name="728"/>  728: 
<a name="729"/>  729:     check(fun() -&gt;
<a name="730"/>  730: 		  if False or element(42, ATuple) -&gt; ok;
<a name="731"/>  731: 		     true -&gt; error end
<a name="732"/>  732: 	  end, error),
<a name="733"/>  733: 
<a name="734"/>  734:     check(fun() -&gt;
<a name="735"/>  735: 		  if element(18, ATuple) or element(42, ATuple) -&gt; ok;
<a name="736"/>  736: 		     true -&gt; error end
<a name="737"/>  737: 	  end, error),
<a name="738"/>  738: 
<a name="739"/>  739:     check(fun() -&gt;
<a name="740"/>  740: 		  if True or element(42, ATuple) -&gt; ok;
<a name="741"/>  741: 		     true -&gt; error end
<a name="742"/>  742: 	  end, error),
<a name="743"/>  743: 
<a name="744"/>  744:     check(fun() -&gt;
<a name="745"/>  745: 		  if element(42, ATuple) or True -&gt; ok;
<a name="746"/>  746: 		     true -&gt; error end
<a name="747"/>  747: 	  end, error),
<a name="748"/>  748: 
<a name="749"/>  749:     check(fun() -&gt;
<a name="750"/>  750: 		  if element(1, ATuple) or element(42, ATuple) or True -&gt; ok;
<a name="751"/>  751: 		     true -&gt; error end
<a name="752"/>  752: 	  end, error),
<a name="753"/>  753: 
<a name="754"/>  754:     check(fun() -&gt;
<a name="755"/>  755: 		  if element(1, ATuple) or True or element(42, ATuple) -&gt; ok;
<a name="756"/>  756: 		     true -&gt; error end
<a name="757"/>  757: 	  end, error),
<a name="758"/>  758: 
<a name="759"/>  759:     check(fun() -&gt;
<a name="760"/>  760: 		  if
<a name="761"/>  761: 		      (&lt;&lt;False:8&gt;&gt; == &lt;&lt;0&gt;&gt;) or element(2, ATuple) -&gt; ok;
<a name="762"/>  762: 		      true -&gt; error end
<a name="763"/>  763: 	  end, error),
<a name="764"/>  764: 
<a name="765"/>  765:     check(fun() -&gt;
<a name="766"/>  766: 		  if
<a name="767"/>  767: 		      element(2, ATuple) or (&lt;&lt;True:8&gt;&gt; == &lt;&lt;1&gt;&gt;) -&gt; ok;
<a name="768"/>  768: 		      true -&gt; error end
<a name="769"/>  769: 	  end, error),
<a name="770"/>  770: 
<a name="771"/>  771:     check(fun() -&gt;
<a name="772"/>  772: 		  if element(2, ATuple) or element(42, ATuple) -&gt; ok;
<a name="773"/>  773: 		     true -&gt; error end
<a name="774"/>  774: 	  end, error),
<a name="775"/>  775: 
<a name="776"/>  776:     check(fun() -&gt;
<a name="777"/>  777: 		  if
<a name="778"/>  778: 		      element(1, ATuple) or
<a name="779"/>  779: 		      element(2, ATuple) or
<a name="780"/>  780: 		      element(19, ATuple) -&gt; ok;
<a name="781"/>  781: 		      true -&gt; error end
<a name="782"/>  782: 	  end, error),
<a name="more_or_guards-last_expr"/><a name="783"/>  783:     ok.
<a name="784"/>  784: 
<a name="complex_or_guards-1"/><a name="785"/>  785: <b>complex_or_guards</b>(Config) when is_list(Config) -&gt;
<a name="786"/>  786:     %% complex_or_1/2
<a name="787"/>  787:     ok = complex_or_1({a,b,c,d}, {1,2,3}),
<a name="788"/>  788:     ok = complex_or_1({a,b,c,d}, {1}),
<a name="789"/>  789:     ok = complex_or_1({a}, {1,2,3}),
<a name="790"/>  790:     error = complex_or_1({a}, {1}),
<a name="791"/>  791: 
<a name="792"/>  792:     error = complex_or_1(1, 2),
<a name="793"/>  793:     error = complex_or_1([], {a,b,c,d}),
<a name="794"/>  794:     error = complex_or_1({a,b,c,d}, []),
<a name="795"/>  795: 
<a name="796"/>  796: 
<a name="797"/>  797:     %% complex_or_2/1
<a name="798"/>  798:     ok = complex_or_2({true,{}}),
<a name="799"/>  799:     ok = complex_or_2({false,{a}}),
<a name="800"/>  800:     ok = complex_or_2({false,{a,b,c}}),
<a name="801"/>  801:     ok = complex_or_2({true,{a,b,c,d}}),
<a name="802"/>  802: 
<a name="803"/>  803:     error = complex_or_2({blurf,{a,b,c}}),
<a name="804"/>  804:     
<a name="805"/>  805:     error = complex_or_2({true}),
<a name="806"/>  806:     error = complex_or_2({true,no_tuple}),
<a name="807"/>  807:     error = complex_or_2({true,[]}),
<a name="808"/>  808: 
<a name="809"/>  809:     %% complex_or_3/2
<a name="810"/>  810:     ok = complex_or_3({true}, {}),
<a name="811"/>  811:     ok = complex_or_3({false}, {a}),
<a name="812"/>  812:     ok = complex_or_3({false}, {a,b,c}),
<a name="813"/>  813:     ok = complex_or_3({true}, {a,b,c,d}),
<a name="814"/>  814:     ok = complex_or_3({false}, &lt;&lt;1,2,3&gt;&gt;),
<a name="815"/>  815:     ok = complex_or_3({true}, &lt;&lt;1,2,3,4&gt;&gt;),
<a name="816"/>  816: 
<a name="817"/>  817:     error = complex_or_3(blurf, {a,b,c}),
<a name="818"/>  818: 
<a name="819"/>  819:     error = complex_or_3({false}, &lt;&lt;1,2,3,4&gt;&gt;),
<a name="820"/>  820:     error = complex_or_3([], &lt;&lt;1,2&gt;&gt;),
<a name="821"/>  821:     error = complex_or_3({true}, 45),
<a name="822"/>  822:     error = complex_or_3(&lt;&lt;&gt;&gt;, &lt;&lt;&gt;&gt;),
<a name="823"/>  823: 
<a name="824"/>  824:     %% complex_or_4/2
<a name="825"/>  825:     ok = complex_or_4(&lt;&lt;1,2,3&gt;&gt;, {true}),
<a name="826"/>  826:     ok = complex_or_4(&lt;&lt;1,2,3&gt;&gt;, {false}),
<a name="827"/>  827:     ok = complex_or_4(&lt;&lt;1,2,3&gt;&gt;, {true}),
<a name="828"/>  828:     ok = complex_or_4({1,2,3}, {true}),
<a name="829"/>  829:     error = complex_or_4({1,2,3,4}, {false}),
<a name="830"/>  830: 
<a name="831"/>  831:     error = complex_or_4(&lt;&lt;1,2,3,4&gt;&gt;, []),
<a name="832"/>  832:     error = complex_or_4([], {true}),
<a name="833"/>  833: 
<a name="834"/>  834:     %% complex_or_5/2
<a name="835"/>  835:     ok = complex_or_5(&lt;&lt;1&gt;&gt;, {false}),
<a name="836"/>  836:     ok = complex_or_5(&lt;&lt;1,2,3&gt;&gt;, {true}),
<a name="837"/>  837:     ok = complex_or_5(&lt;&lt;1,2,3,4&gt;&gt;, {false}),
<a name="838"/>  838:     ok = complex_or_5({1,2,3}, {false}),
<a name="839"/>  839:     ok = complex_or_5({1,2,3,4}, {false}),
<a name="840"/>  840: 
<a name="841"/>  841:     error = complex_or_5(blurf, {false}),
<a name="842"/>  842:     error = complex_or_5(&lt;&lt;1&gt;&gt;, klarf),
<a name="843"/>  843:     error = complex_or_5(blurf, klarf),
<a name="844"/>  844: 
<a name="845"/>  845:     %% complex_or_6/2
<a name="846"/>  846:     ok = complex_or_6({true,true}, {1,2,3,4}),
<a name="847"/>  847:     ok = complex_or_6({true,true}, &lt;&lt;1,2,3,4&gt;&gt;),
<a name="848"/>  848:     ok = complex_or_6({false,false}, &lt;&lt;1,2,3,4&gt;&gt;),
<a name="849"/>  849:     ok = complex_or_6({false,true}, &lt;&lt;1&gt;&gt;),
<a name="850"/>  850:     ok = complex_or_6({true,false}, {1}),
<a name="851"/>  851:     ok = complex_or_6({true,true}, {1}),
<a name="852"/>  852: 
<a name="853"/>  853:     error = complex_or_6({false,false}, {1}),
<a name="854"/>  854: 
<a name="855"/>  855:     error = complex_or_6({true}, {1,2,3,4}),
<a name="856"/>  856:     error = complex_or_6({}, {1,2,3,4}),
<a name="857"/>  857:     error = complex_or_6([], {1,2,3,4}),
<a name="858"/>  858:     error = complex_or_6([], {1,2,3,4}),
<a name="859"/>  859:     error = complex_or_6({true,false}, klurf),
<a name="860"/>  860: 
<a name="complex_or_guards-last_expr"/><a name="861"/>  861:     ok.
<a name="862"/>  862: 
<a name="complex_or_1-2"/><a name="863"/>  863: <b>complex_or_1</b>(A, B) -&gt;
<a name="complex_or_1-last_expr"/><a name="864"/>  864:     if
<a name="865"/>  865: 	((3 &lt; tuple_size(A)) and (tuple_size(A) &lt; 9)) or
<a name="866"/>  866: 	((2 &lt; tuple_size(B)) and (tuple_size(B) &lt; 7)) -&gt; ok;
<a name="867"/>  867: 	true -&gt; error
<a name="868"/>  868:     end.
<a name="869"/>  869: 
<a name="complex_or_2-1"/><a name="870"/>  870: <b>complex_or_2</b>(Tuple) -&gt;
<a name="complex_or_2-last_expr"/><a name="871"/>  871:     if
<a name="872"/>  872: 	element(1, Tuple) or not (tuple_size(element(2, Tuple)) &gt; 3) -&gt; ok;
<a name="873"/>  873: 	true -&gt; error
<a name="874"/>  874:     end.
<a name="875"/>  875: 
<a name="complex_or_3-2"/><a name="876"/>  876: <b>complex_or_3</b>(A, B) -&gt;
<a name="complex_or_3-last_expr"/><a name="877"/>  877:     if
<a name="878"/>  878: 	not (size(B) &gt; 3) or element(1, A) -&gt; ok;
<a name="879"/>  879: 	true -&gt; error
<a name="880"/>  880:     end.
<a name="881"/>  881: 
<a name="complex_or_4-2"/><a name="882"/>  882: <b>complex_or_4</b>(A, B) -&gt;
<a name="complex_or_4-last_expr"/><a name="883"/>  883:     if
<a name="884"/>  884: 	not (is_tuple(A) and (size(A) &gt; 3)) or element(1, B) -&gt; ok;
<a name="885"/>  885: 	true -&gt; error
<a name="886"/>  886:     end.
<a name="887"/>  887: 
<a name="complex_or_5-2"/><a name="888"/>  888: <b>complex_or_5</b>(A, B) -&gt;
<a name="complex_or_5-last_expr"/><a name="889"/>  889:     if
<a name="890"/>  890: 	not (is_tuple(A) or (size(A) &gt; 3)) or not element(1, B) -&gt; ok;
<a name="891"/>  891: 	true -&gt; error
<a name="892"/>  892:     end.
<a name="893"/>  893: 
<a name="complex_or_6-2"/><a name="894"/>  894: <b>complex_or_6</b>(A, B) -&gt;
<a name="complex_or_6-last_expr"/><a name="895"/>  895:     if
<a name="896"/>  896: 	not (not element(1, A) and not element(2, A)) or
<a name="897"/>  897: 	not (not (size(B) &gt; 3)) -&gt; ok;
<a name="898"/>  898: 	true -&gt; error
<a name="899"/>  899:     end.
<a name="900"/>  900: 
<a name="and_guard-1"/><a name="901"/>  901: <b>and_guard</b>(Config) when is_list(Config) -&gt;
<a name="902"/>  902: 
<a name="903"/>  903:     %% 'and' combinations of literal true/false.
<a name="904"/>  904: 
<a name="905"/>  905:     check(fun() -&gt; if true and false -&gt; ok; true -&gt; error end end, error),
<a name="906"/>  906:     check(fun() -&gt; if false and true -&gt; ok; true -&gt; error end end, error),
<a name="907"/>  907:     check(fun() -&gt; if true and true -&gt; ok end end, ok),
<a name="908"/>  908:     check(fun() -&gt; if false and false -&gt; ok; true -&gt; error end end, error),
<a name="909"/>  909: 
<a name="910"/>  910:     check(fun() -&gt; if glurf and true -&gt; ok; true -&gt; error end end, error),
<a name="911"/>  911:     check(fun() -&gt; if true and glurf -&gt; ok; true -&gt; error end end, error),
<a name="912"/>  912:     check(fun() -&gt; if glurf and glurf -&gt; ok; true -&gt; error end end, error),
<a name="913"/>  913: 
<a name="914"/>  914:     check(fun() -&gt;
<a name="915"/>  915: 		  {'EXIT',{if_clause,_}} =
<a name="916"/>  916: 		      (catch if true and false -&gt; ok;
<a name="917"/>  917: 				false and true -&gt; ok;
<a name="918"/>  918: 				false and false -&gt; ok
<a name="919"/>  919: 			     end),
<a name="920"/>  920: 		  exit
<a name="921"/>  921: 	  end, exit),
<a name="922"/>  922: 
<a name="923"/>  923:     %% 'and' combinations of true/false in variables.
<a name="924"/>  924: 
<a name="925"/>  925:     True = id(true),
<a name="926"/>  926:     False = id(false),
<a name="927"/>  927: 
<a name="928"/>  928:     check(fun() -&gt; if True and False -&gt; ok; true -&gt; error end end, error),
<a name="929"/>  929:     check(fun() -&gt; if False and True -&gt; ok; true -&gt; error end end, error),
<a name="930"/>  930:     check(fun() -&gt; if True and True -&gt; ok end end, ok),
<a name="931"/>  931:     check(fun() -&gt; if False and False -&gt; ok; true -&gt; error end end, error),
<a name="932"/>  932:     check(fun() -&gt;
<a name="933"/>  933: 		  {'EXIT',{if_clause,_}} =
<a name="934"/>  934: 		      (catch if True and False -&gt; ok;
<a name="935"/>  935: 				False and True -&gt; ok;
<a name="936"/>  936: 				False and False -&gt; ok
<a name="937"/>  937: 			     end),
<a name="938"/>  938: 		  exit
<a name="939"/>  939: 	  end, exit),
<a name="940"/>  940: 
<a name="941"/>  941:     %% 'and' combinations of true/false and a non-boolean in variables.
<a name="942"/>  942: 
<a name="943"/>  943:     Glurf = id(glurf),
<a name="944"/>  944: 
<a name="945"/>  945:     check(fun() -&gt; if True and Glurf -&gt; ok; true -&gt; error end end, error),
<a name="946"/>  946:     check(fun() -&gt; if Glurf and True -&gt; ok; true -&gt; error end end, error),
<a name="947"/>  947:     check(fun() -&gt; if True and True -&gt; ok end end, ok),
<a name="948"/>  948:     check(fun() -&gt; if Glurf and Glurf -&gt; ok; true -&gt; error end end, error),
<a name="949"/>  949:     check(fun() -&gt;
<a name="950"/>  950: 		  {'EXIT',{if_clause,_}} =
<a name="951"/>  951: 		      (catch if True and Glurf -&gt; ok;
<a name="952"/>  952: 				Glurf and True -&gt; ok;
<a name="953"/>  953: 				Glurf and Glurf -&gt; ok
<a name="954"/>  954: 			     end),
<a name="955"/>  955: 		  exit
<a name="956"/>  956: 	  end, exit),
<a name="957"/>  957: 
<a name="958"/>  958:     %% 'and' combinations of true/false with errors.
<a name="959"/>  959:     ATuple = id({a,b,c}),
<a name="960"/>  960: 
<a name="961"/>  961:     check(fun() -&gt; if True and element(42, ATuple) -&gt; ok;
<a name="962"/>  962: 		      true -&gt; error end end, error),
<a name="963"/>  963:     check(fun() -&gt; if element(42, ATuple) and True -&gt; ok;
<a name="964"/>  964: 		      true -&gt; error end end, error),
<a name="965"/>  965:     check(fun() -&gt; if True and True -&gt; ok end end, ok),
<a name="966"/>  966:     check(fun() -&gt; if element(42, ATuple) and element(42, ATuple) -&gt; ok;
<a name="967"/>  967: 		      true -&gt; error end end, error),
<a name="968"/>  968:     check(fun() -&gt;
<a name="969"/>  969: 		  {'EXIT',{if_clause,_}} =
<a name="970"/>  970: 		      (catch if True and element(42, ATuple) -&gt; ok;
<a name="971"/>  971: 				element(42, ATuple) and True -&gt; ok;
<a name="972"/>  972: 				element(42, ATuple) and element(42, ATuple) -&gt; ok
<a name="973"/>  973: 			     end),
<a name="974"/>  974: 			exit
<a name="975"/>  975: 		end, exit),
<a name="976"/>  976: 
<a name="977"/>  977:     ok = relprod({'Set',a,b}, {'Set',a,b}),
<a name="978"/>  978:     
<a name="979"/>  979:     ok = and_same_var(42),
<a name="980"/>  980:     {'EXIT',{if_clause,_}} = (catch and_same_var(x)),
<a name="and_guard-last_expr"/><a name="981"/>  981:     ok.
<a name="982"/>  982: 
<a name="and_same_var-1"/><a name="983"/>  983: <b>and_same_var</b>(V) -&gt;
<a name="984"/>  984:     B = is_integer(V),
<a name="and_same_var-last_expr"/><a name="985"/>  985:     if
<a name="986"/>  986: 	B or B -&gt; ok
<a name="987"/>  987:     end.
<a name="988"/>  988: 
<a name="relprod-2"/><a name="989"/>  989: <b>relprod</b>(R1, R2) when (erlang:size(R1) =:= 3) and (erlang:element(1,R1) =:= 'Set'), (erlang:size(R2) =:= 3) and (erlang:element(1,R2) =:= 'Set') -&gt;
<a name="relprod-last_expr"/><a name="990"/>  990:     ok.
<a name="991"/>  991: 
<a name="992"/>  992: 
<a name="xor_guard-1"/><a name="993"/>  993: <b>xor_guard</b>(Config) when is_list(Config) -&gt;
<a name="994"/>  994: 
<a name="995"/>  995:     %% 'xor' combinations of literal true/false.
<a name="996"/>  996:     check(fun() -&gt; if true xor false -&gt; ok end end, ok),
<a name="997"/>  997:     check(fun() -&gt; if false xor true -&gt; ok end end, ok),
<a name="998"/>  998:     check(fun() -&gt; if true xor true -&gt; ok; true -&gt; error end end, error),
<a name="999"/>  999:     check(fun() -&gt; if false xor false -&gt; ok; true -&gt; error end end, error),
<a name="1000"/> 1000:     check(fun() -&gt;
<a name="1001"/> 1001: 		  {'EXIT',{if_clause,_}} = (catch if false xor false -&gt; ok end),
<a name="1002"/> 1002: 		  exit
<a name="1003"/> 1003: 	  end, exit),
<a name="1004"/> 1004:     check(fun() -&gt;
<a name="1005"/> 1005: 		  {'EXIT',{if_clause,_}} = (catch if true xor true -&gt; ok end),
<a name="1006"/> 1006: 		  exit
<a name="1007"/> 1007: 	  end, exit),
<a name="1008"/> 1008: 
<a name="1009"/> 1009: 
<a name="1010"/> 1010:     %% 'xor' combinations using variables containing true/false.
<a name="1011"/> 1011: 
<a name="1012"/> 1012:     True = id(true),
<a name="1013"/> 1013:     False = id(false),
<a name="1014"/> 1014: 
<a name="1015"/> 1015:     check(fun() -&gt; if True xor False -&gt; ok end end, ok),
<a name="1016"/> 1016:     check(fun() -&gt; if False xor True -&gt; ok end end, ok),
<a name="1017"/> 1017:     check(fun() -&gt; if True xor True -&gt; ok; true -&gt; error end end, error),
<a name="1018"/> 1018:     check(fun() -&gt; if False xor False -&gt; ok; true -&gt; error end end, error),
<a name="1019"/> 1019:     check(fun() -&gt;
<a name="1020"/> 1020: 		  {'EXIT',{if_clause,_}} = (catch if False xor False -&gt; ok end),
<a name="1021"/> 1021: 		  exit
<a name="1022"/> 1022: 	  end, exit),
<a name="1023"/> 1023:     check(fun() -&gt;
<a name="1024"/> 1024: 		  {'EXIT',{if_clause,_}} = (catch if True xor True -&gt; ok end),
<a name="1025"/> 1025: 		  exit
<a name="1026"/> 1026: 	  end, exit),
<a name="1027"/> 1027: 
<a name="xor_guard-last_expr"/><a name="1028"/> 1028:     ok.
<a name="1029"/> 1029: 
<a name="more_xor_guards-1"/><a name="1030"/> 1030: <b>more_xor_guards</b>(Config) when is_list(Config) -&gt;
<a name="1031"/> 1031:     True = id(true),
<a name="1032"/> 1032:     False = id(false),
<a name="1033"/> 1033:     ATuple = id({false,true,gurka}),
<a name="1034"/> 1034: 
<a name="1035"/> 1035:     check(fun() -&gt;
<a name="1036"/> 1036: 		  if element(42, ATuple) xor False -&gt; ok;
<a name="1037"/> 1037: 		     true -&gt; error end
<a name="1038"/> 1038: 	  end, error),
<a name="1039"/> 1039: 
<a name="1040"/> 1040:     check(fun() -&gt;
<a name="1041"/> 1041: 		  if False xor element(42, ATuple) xor False -&gt; ok;
<a name="1042"/> 1042: 		     true -&gt; error end
<a name="1043"/> 1043: 	  end, error),
<a name="1044"/> 1044: 
<a name="1045"/> 1045:     check(fun() -&gt;
<a name="1046"/> 1046: 		  if element(18, ATuple) xor element(42, ATuple) -&gt; ok;
<a name="1047"/> 1047: 		     true -&gt; error end
<a name="1048"/> 1048: 	  end, error),
<a name="1049"/> 1049: 
<a name="1050"/> 1050:     check(fun() -&gt;
<a name="1051"/> 1051: 		  if True xor element(42, ATuple) -&gt; ok;
<a name="1052"/> 1052: 		     true -&gt; error end
<a name="1053"/> 1053: 	  end, error),
<a name="1054"/> 1054: 
<a name="1055"/> 1055:     check(fun() -&gt;
<a name="1056"/> 1056: 		  if element(42, ATuple) xor True -&gt; ok;
<a name="1057"/> 1057: 		     true -&gt; error end
<a name="1058"/> 1058: 	  end, error),
<a name="more_xor_guards-last_expr"/><a name="1059"/> 1059:     ok.
<a name="1060"/> 1060: 
<a name="build_in_guard-1"/><a name="1061"/> 1061: <b>build_in_guard</b>(Config) when is_list(Config) -&gt;
<a name="1062"/> 1062:     SubBin = &lt;&lt;5.0/float&gt;&gt;,
<a name="1063"/> 1063:     B = &lt;&lt;1,SubBin/binary,3.5/float&gt;&gt;,
<a name="build_in_guard-last_expr"/><a name="1064"/> 1064:     if
<a name="1065"/> 1065: 	B =:= &lt;&lt;1,SubBin/binary,3.5/float&gt;&gt; -&gt; ok
<a name="1066"/> 1066:     end.
<a name="1067"/> 1067: 
<a name="old_guard_tests-1"/><a name="1068"/> 1068: <b>old_guard_tests</b>(Config) when list(Config) -&gt;
<a name="1069"/> 1069:     %% Check that all the old guard tests are still recognized.
<a name="1070"/> 1070:     list = og(Config),
<a name="1071"/> 1071:     atom = og(an_atom),
<a name="1072"/> 1072:     binary = og(&lt;&lt;1,2&gt;&gt;),
<a name="1073"/> 1073:     float = og(3.14),
<a name="1074"/> 1074:     integer = og(43),
<a name="1075"/> 1075:     a_function = og(fun() -&gt; ok end),
<a name="1076"/> 1076:     pid = og(self()),
<a name="1077"/> 1077:     reference = og(make_ref()),
<a name="1078"/> 1078:     tuple = og({}),
<a name="1079"/> 1079: 
<a name="1080"/> 1080:     number = on(45.333),
<a name="1081"/> 1081:     number = on(-19),
<a name="old_guard_tests-last_expr"/><a name="1082"/> 1082:     ok.
<a name="1083"/> 1083: 
<a name="og-1"/><a name="1084"/> 1084: <b>og</b>(V) when atom(V) -&gt; atom;
<a name="1085"/> 1085: <b>og</b>(V) when binary(V) -&gt; binary;
<a name="1086"/> 1086: <b>og</b>(V) when float(V) -&gt; float;
<a name="1087"/> 1087: <b>og</b>(V) when integer(V) -&gt; integer;
<a name="1088"/> 1088: <b>og</b>(V) when function(V) -&gt; a_function;
<a name="1089"/> 1089: <b>og</b>(V) when list(V) -&gt; list;
<a name="1090"/> 1090: <b>og</b>(V) when pid(V) -&gt; pid;
<a name="1091"/> 1091: <b>og</b>(V) when port(V) -&gt; port;
<a name="1092"/> 1092: <b>og</b>(V) when reference(V) -&gt; reference;
<a name="1093"/> 1093: <b>og</b>(V) when tuple(V) -&gt; tuple;
<a name="og-last_expr"/><a name="1094"/> 1094: <b>og</b>(_) -&gt; what.
<a name="1095"/> 1095: 
<a name="on-1"/><a name="1096"/> 1096: <b>on</b>(V) when number(V) -&gt; number;
<a name="on-last_expr"/><a name="1097"/> 1097: <b>on</b>(_) -&gt; not_number.
<a name="1098"/> 1098: 
<a name="complex_guard-1"/><a name="1099"/> 1099: <b>complex_guard</b>(_Config) -&gt;
<a name="1100"/> 1100:     _ = [true = do_complex_guard_1(X, Y, Z) ||
<a name="1101"/> 1101: 	    X &lt;- [4,5], Y &lt;- [4,5], Z &lt;- [4,5]],
<a name="1102"/> 1102:     _ = [true = do_complex_guard_1(X, Y, Z) ||
<a name="1103"/> 1103: 	    X &lt;- [1,2,3], Y &lt;- [1,2,3], Z &lt;- [1,2,3]],
<a name="1104"/> 1104:     _ = [catch do_complex_guard_1(X, Y, Z) ||
<a name="1105"/> 1105: 	    X &lt;- [1,2,3,4,5], Y &lt;- [0,6], Z &lt;- [1,2,3,4,5]],
<a name="1106"/> 1106: 
<a name="1107"/> 1107:     b = do_complex_guard_2(false, false, true),
<a name="1108"/> 1108:     c = do_complex_guard_2(false, false, false),
<a name="1109"/> 1109:     c = do_complex_guard_2(false, true,  true),
<a name="1110"/> 1110:     a = do_complex_guard_2(false, true,  false),
<a name="1111"/> 1111: 
<a name="1112"/> 1112:     c = do_complex_guard_2(true,  false, true),
<a name="1113"/> 1113:     a = do_complex_guard_2(true,  false, false),
<a name="1114"/> 1114:     c = do_complex_guard_2(true,  true,  true),
<a name="1115"/> 1115:     a = do_complex_guard_2(true,  true,  false),
<a name="1116"/> 1116: 
<a name="1117"/> 1117:     c = do_complex_guard_2(other, false, true),
<a name="1118"/> 1118:     c = do_complex_guard_2(other, false, false),
<a name="1119"/> 1119:     c = do_complex_guard_2(other, true,  true),
<a name="1120"/> 1120:     c = do_complex_guard_2(other, true,  false),
<a name="1121"/> 1121: 
<a name="1122"/> 1122:     c = do_complex_guard_2(false, other, true),
<a name="1123"/> 1123:     c = do_complex_guard_2(false, other, false),
<a name="1124"/> 1124:     c = do_complex_guard_2(true,  other, true),
<a name="1125"/> 1125:     a = do_complex_guard_2(true,  other, false),
<a name="1126"/> 1126: 
<a name="1127"/> 1127:     c = do_complex_guard_2(false, false, other),
<a name="1128"/> 1128:     c = do_complex_guard_2(false, true,  other),
<a name="1129"/> 1129:     c = do_complex_guard_2(true,  false, other),
<a name="1130"/> 1130:     c = do_complex_guard_2(true,  true,  other),
<a name="1131"/> 1131: 
<a name="1132"/> 1132:     c = do_complex_guard_2(false, other, other),
<a name="1133"/> 1133:     c = do_complex_guard_2(true,  other, other),
<a name="1134"/> 1134:     c = do_complex_guard_2(other, other, true),
<a name="1135"/> 1135:     c = do_complex_guard_2(other, other, false),
<a name="1136"/> 1136:     c = do_complex_guard_2(other, false, other),
<a name="1137"/> 1137:     c = do_complex_guard_2(other, true,  other),
<a name="1138"/> 1138: 
<a name="1139"/> 1139:     c = do_complex_guard_2(other, other, other),
<a name="1140"/> 1140: 
<a name="complex_guard-last_expr"/><a name="1141"/> 1141:     ok.
<a name="1142"/> 1142: 
<a name="do_complex_guard_1-3"/><a name="1143"/> 1143: <b>do_complex_guard_1</b>(X1, Y1, Z1) -&gt;
<a name="do_complex_guard_1-last_expr"/><a name="1144"/> 1144:     if
<a name="1145"/> 1145: 	((X1 =:= 4) or (X1 =:= 5)) and
<a name="1146"/> 1146: 	((Y1 =:= 4) or (Y1 =:= 5)) and
<a name="1147"/> 1147: 	((Z1 =:= 4) or (Z1 =:= 5)) or
<a name="1148"/> 1148: 	((X1 =:= 1) or (X1 =:= 2) or (X1 =:= 3)) and
<a name="1149"/> 1149: 	((Y1 =:= 1) or (Y1 =:= 2) or (Y1 =:= 3)) and
<a name="1150"/> 1150: 	((Z1 =:= 1) or (Z1 =:= 2) or (Z1 =:= 3)) -&gt;
<a name="1151"/> 1151: 	    true
<a name="1152"/> 1152:     end.
<a name="1153"/> 1153: 
<a name="do_complex_guard_2-3"/><a name="1154"/> 1154: <b>do_complex_guard_2</b>(X, Y, Z) -&gt;
<a name="do_complex_guard_2-last_expr"/><a name="1155"/> 1155:   if
<a name="1156"/> 1156:       (X orelse Y) andalso (not Z) -&gt; a;
<a name="1157"/> 1157:       Z andalso (not (X orelse Y)) -&gt; b;
<a name="1158"/> 1158:       true                         -&gt; c
<a name="1159"/> 1159:   end.
<a name="1160"/> 1160: 
<a name="gbif-1"/><a name="1161"/> 1161: <b>gbif</b>(Config) when is_list(Config) -&gt;
<a name="1162"/> 1162:     error = gbif_1(1, {false,true}),
<a name="1163"/> 1163:     ok = gbif_1(2, {false,true}),
<a name="1164"/> 1164: 
<a name="1165"/> 1165:     error = gbif_2(id(0)),
<a name="1166"/> 1166:     error = gbif_2(id(&lt;&lt;&gt;&gt;)),
<a name="1167"/> 1167: 
<a name="gbif-last_expr"/><a name="1168"/> 1168:     ok.
<a name="1169"/> 1169: 
<a name="gbif_1-2"/><a name="1170"/> 1170: <b>gbif_1</b>(P, T) when element(P, T) -&gt; ok;
<a name="gbif_1-last_expr"/><a name="1171"/> 1171: <b>gbif_1</b>(_, _) -&gt; error.
<a name="1172"/> 1172: 
<a name="gbif_2-1"/><a name="1173"/> 1173: <b>gbif_2</b>(A) when bnot trunc((&lt;&lt;(true orelse ok)&gt;&gt; =/= A orelse 0) + 1) =:= A -&gt;
<a name="1174"/> 1174:     ok;
<a name="1175"/> 1175: <b>gbif_2</b>(_) -&gt;
<a name="gbif_2-last_expr"/><a name="1176"/> 1176:     error.
<a name="1177"/> 1177: 
<a name="t_is_boolean-1"/><a name="1178"/> 1178: <b>t_is_boolean</b>(Config) when is_list(Config) -&gt;
<a name="1179"/> 1179:     true = is_boolean(true),
<a name="1180"/> 1180:     true = is_boolean(false),
<a name="1181"/> 1181:     true = is_boolean(id(true)),
<a name="1182"/> 1182:     true = is_boolean(id(false)),
<a name="1183"/> 1183: 
<a name="1184"/> 1184:     false = is_boolean(glurf),
<a name="1185"/> 1185:     false = is_boolean(id(glurf)),
<a name="1186"/> 1186: 
<a name="1187"/> 1187:     false = is_boolean([]),
<a name="1188"/> 1188:     false = is_boolean(id([])),
<a name="1189"/> 1189:     false = is_boolean(42),
<a name="1190"/> 1190:     false = is_boolean(id(-42)),
<a name="1191"/> 1191: 
<a name="1192"/> 1192:     false = is_boolean(math:pi()),
<a name="1193"/> 1193:     false = is_boolean(384793478934378924978439789873478934897),
<a name="1194"/> 1194: 
<a name="1195"/> 1195:     false = is_boolean(id(self())),
<a name="1196"/> 1196:     false = is_boolean(id({x,y,z})),
<a name="1197"/> 1197:     false = is_boolean(id([a,b,c])),
<a name="1198"/> 1198:     false = is_boolean(id(make_ref())),
<a name="1199"/> 1199:     false = is_boolean(id(&lt;&lt;1,2,3&gt;&gt;)),
<a name="1200"/> 1200:     false = is_boolean({id(x),y,z}),
<a name="1201"/> 1201:     false = is_boolean([id(a),b,c]),
<a name="1202"/> 1202: 
<a name="1203"/> 1203:     ok = bool(true),
<a name="1204"/> 1204:     ok = bool(false),
<a name="1205"/> 1205:     ok = bool(id(true)),
<a name="1206"/> 1206:     ok = bool(id(false)),
<a name="1207"/> 1207: 
<a name="1208"/> 1208:     error = bool(glurf),
<a name="1209"/> 1209:     error = bool(id(glurf)),
<a name="1210"/> 1210: 
<a name="1211"/> 1211:     error = bool([]),
<a name="1212"/> 1212:     error = bool(id([])),
<a name="1213"/> 1213:     error = bool(42),
<a name="1214"/> 1214:     error = bool(id(-42)),
<a name="1215"/> 1215: 
<a name="1216"/> 1216:     error = bool(math:pi()),
<a name="1217"/> 1217:     error = bool(384793478934378924978439789873478934897),
<a name="1218"/> 1218: 
<a name="1219"/> 1219:     error = bool(id(self())),
<a name="1220"/> 1220:     error = bool(id({x,y,z})),
<a name="1221"/> 1221:     error = bool(id([a,b,c])),
<a name="1222"/> 1222:     error = bool(id(make_ref())),
<a name="1223"/> 1223:     error = bool(id(&lt;&lt;1,2,3&gt;&gt;)),
<a name="1224"/> 1224: 
<a name="1225"/> 1225:     true = my_is_bool(true),
<a name="1226"/> 1226:     true = my_is_bool(false),
<a name="1227"/> 1227:     false = my_is_bool([]),
<a name="1228"/> 1228:     false = my_is_bool([1,2,3,4]),
<a name="1229"/> 1229:     false = my_is_bool({a,b,c}),
<a name="1230"/> 1230: 
<a name="1231"/> 1231:     %% Cover code in beam_ssa_dead.
<a name="1232"/> 1232:     ok = bool_semi(true),
<a name="1233"/> 1233:     ok = bool_semi(false),
<a name="1234"/> 1234:     error = bool_semi(a),
<a name="1235"/> 1235: 
<a name="t_is_boolean-last_expr"/><a name="1236"/> 1236:     ok.
<a name="1237"/> 1237: 
<a name="bool-1"/><a name="1238"/> 1238: <b>bool</b>(X) when is_boolean(X) -&gt; ok;
<a name="bool-last_expr"/><a name="1239"/> 1239: <b>bool</b>(_) -&gt; error.
<a name="1240"/> 1240: 
<a name="my_is_bool-1"/><a name="1241"/> 1241: <b>my_is_bool</b>(V) -&gt;
<a name="1242"/> 1242:     Res = my_is_bool_a(V),
<a name="my_is_bool-last_expr"/><a name="1243"/> 1243: <b>    Res = my_is_bool_b</b>(V).
<a name="1244"/> 1244: 
<a name="my_is_bool_a-1"/><a name="1245"/> 1245: <b>my_is_bool_a</b>(V) -&gt;
<a name="my_is_bool_a-last_expr"/><a name="1246"/> 1246:     case V of
<a name="1247"/> 1247: 	true -&gt; true;
<a name="1248"/> 1248: 	false -&gt; true;
<a name="1249"/> 1249: 	_ -&gt; false
<a name="1250"/> 1250:     end.
<a name="1251"/> 1251: 
<a name="my_is_bool_b-1"/><a name="1252"/> 1252: <b>my_is_bool_b</b>(V) -&gt;
<a name="my_is_bool_b-last_expr"/><a name="1253"/> 1253:     case V of
<a name="1254"/> 1254: 	false -&gt; true;
<a name="1255"/> 1255: 	true -&gt; true;
<a name="1256"/> 1256: 	_ -&gt; false
<a name="1257"/> 1257:     end.
<a name="1258"/> 1258: 
<a name="bool_semi-1"/><a name="1259"/> 1259: <b>bool_semi</b>(V) when is_boolean(V); is_atom(not V) -&gt; ok;
<a name="bool_semi-last_expr"/><a name="1260"/> 1260: <b>bool_semi</b>(_) -&gt; error.
<a name="1261"/> 1261: 
<a name="is_function_2-1"/><a name="1262"/> 1262: <b>is_function_2</b>(Config) when is_list(Config) -&gt;
<a name="1263"/> 1263:     true = is_function(id(fun ?MODULE:all/1), 1),
<a name="1264"/> 1264:     true = is_function(id(fun() -&gt; ok end), 0),
<a name="1265"/> 1265:     false = is_function(id(fun ?MODULE:all/1), 0),
<a name="1266"/> 1266:     false = is_function(id(fun() -&gt; ok end), 1),
<a name="1267"/> 1267:     {'EXIT',{badarg,_}} =
<a name="1268"/> 1268:         (catch is_function(id(fun() -&gt; ok end), -1) orelse error),
<a name="1269"/> 1269:     {'EXIT',{badarg,_}} =
<a name="1270"/> 1270:         (catch is_function(id(fun() -&gt; ok end), '') orelse error),
<a name="1271"/> 1271: 
<a name="1272"/> 1272:     F = fun(_) -&gt; ok end,
<a name="1273"/> 1273:     if
<a name="1274"/> 1274:         is_function(F, 1) -&gt; ok
<a name="1275"/> 1275:     end,
<a name="1276"/> 1276: 
<a name="1277"/> 1277:     variable_is_function_2(),
<a name="1278"/> 1278: 
<a name="is_function_2-last_expr"/><a name="1279"/> 1279:     ok.
<a name="1280"/> 1280: 
<a name="variable_is_function_2-0"/><a name="1281"/> 1281: <b>variable_is_function_2</b>() -&gt;
<a name="1282"/> 1282:     F = fun() -&gt; ok end,
<a name="1283"/> 1283:     [F] = vif_1([id(F)], id(0), []),
<a name="1284"/> 1284:     [F] = vif_2([id(F)], id(0) band 15, []),
<a name="variable_is_function_2-last_expr"/><a name="1285"/> 1285:     ok.
<a name="1286"/> 1286: 
<a name="1287"/> 1287: <i>%% Completely unknown arity</i>
<a name="vif_1-3"/><a name="1288"/> 1288: <b>vif_1</b>([F | Fs], Arity, Acc) when is_function(F, Arity) -&gt;
<a name="1289"/> 1289:     vif_1(Fs, Arity, [F | Acc]);
<a name="1290"/> 1290: <b>vif_1</b>([], _Arity, Acc) -&gt;
<a name="vif_1-last_expr"/><a name="1291"/> 1291:     Acc.
<a name="1292"/> 1292: 
<a name="1293"/> 1293: <i>%% Arity known to be between 0 and 15</i>
<a name="vif_2-3"/><a name="1294"/> 1294: <b>vif_2</b>([F | Fs], Arity, Acc) when is_function(F, Arity) -&gt;
<a name="1295"/> 1295:     vif_2(Fs, Arity, [F | Acc]);
<a name="1296"/> 1296: <b>vif_2</b>([], _Arity, Acc) -&gt;
<a name="vif_2-last_expr"/><a name="1297"/> 1297:     Acc.
<a name="1298"/> 1298: 
<a name="tricky-1"/><a name="1299"/> 1299: <b>tricky</b>(Config) when is_list(Config) -&gt;
<a name="1300"/> 1300:     not_ok = tricky_1(1, 2),
<a name="1301"/> 1301:     not_ok = tricky_1(1, blurf),
<a name="1302"/> 1302:     not_ok = tricky_1(foo, 2),
<a name="1303"/> 1303:     not_ok = tricky_1(a, b),
<a name="1304"/> 1304: 
<a name="1305"/> 1305:     error = tricky_2(0.5),
<a name="1306"/> 1306:     error = tricky_2(a),
<a name="1307"/> 1307:     error = tricky_2({a,b,c}),
<a name="1308"/> 1308: 
<a name="1309"/> 1309:     false = rb(100000, [1], 42),
<a name="1310"/> 1310:     true = rb(100000, [], 42),
<a name="1311"/> 1311:     true = rb(555, [a,b,c], 19),
<a name="1312"/> 1312: 
<a name="1313"/> 1313:     error = tricky_3(42),
<a name="1314"/> 1314:     error = tricky_3(42.0),
<a name="1315"/> 1315:     error = tricky_3(&lt;&lt;&gt;&gt;),
<a name="1316"/> 1316:     error = tricky_3(#{}),
<a name="1317"/> 1317:     error = tricky_3({a,b}),
<a name="1318"/> 1318: 
<a name="1319"/> 1319:     {'EXIT',_} = (catch tricky_4(x)),
<a name="1320"/> 1320:     {'EXIT',_} = (catch tricky_4(42)),
<a name="1321"/> 1321:     {'EXIT',_} = (catch tricky_4(true)),
<a name="1322"/> 1322: 
<a name="tricky-last_expr"/><a name="1323"/> 1323:     ok.
<a name="1324"/> 1324: 
<a name="tricky_1-2"/><a name="1325"/> 1325: <b>tricky_1</b>(X, Y) when abs((X == 1) or (Y == 2)) -&gt; ok;
<a name="tricky_1-last_expr"/><a name="1326"/> 1326: <b>tricky_1</b>(_, _) -&gt; not_ok.
<a name="1327"/> 1327: 
<a name="tricky_2-1"/><a name="1328"/> 1328: <b>tricky_2</b>(X) when float(X) or float(X) -&gt; ok;
<a name="tricky_2-last_expr"/><a name="1329"/> 1329: <b>tricky_2</b>(_) -&gt; error.
<a name="1330"/> 1330: 
<a name="tricky_3-1"/><a name="1331"/> 1331: <b>tricky_3</b>(X)
<a name="1332"/> 1332:   when abs(X) or bit_size(X) or byte_size(X) or ceil(X) or
<a name="1333"/> 1333:        float(X) or floor(X) or length(X) or
<a name="1334"/> 1334:        map_size(X) or node() or node(X) or round(X) or
<a name="1335"/> 1335:        self() or size(X) or tl(X) or trunc(X) or tuple_size(X) -&gt;
<a name="1336"/> 1336:     ok;
<a name="1337"/> 1337: <b>tricky_3</b>(_) -&gt;
<a name="tricky_3-last_expr"/><a name="1338"/> 1338:     error.
<a name="1339"/> 1339: 
<a name="tricky_4-1"/><a name="1340"/> 1340: <b>tricky_4</b>(X) -&gt;
<a name="1341"/> 1341:     B = (abs(X) or abs(X)) =:= true,
<a name="tricky_4-last_expr"/><a name="1342"/> 1342:     case B of
<a name="1343"/> 1343:         true -&gt; ok;
<a name="1344"/> 1344:         false -&gt; error
<a name="1345"/> 1345:     end.
<a name="1346"/> 1346: 
<a name="1347"/> 1347: <i>%% From dets_v9:read_buckets/11, simplified.</i>
<a name="1348"/> 1348: 
<a name="rb-3"/><a name="1349"/> 1349: <b>rb</b>(Size, ToRead, SoFar) when SoFar + Size &lt; 81920; ToRead == [] -&gt; true;
<a name="rb-last_expr"/><a name="1350"/> 1350: <b>rb</b>(_, _, _) -&gt; false.
<a name="1351"/> 1351: 
<a name="1352"/> 1352: 
<a name="1353"/> 1353: <b>-define</b>(T(Op,A,B),
<a name="1354"/> 1354: 	ok = if A Op B -&gt; ok; true -&gt; error end,
<a name="1355"/> 1355: 	ok = if not (A Op B) -&gt; error; true -&gt; ok end,
<a name="1356"/> 1356: 	(fun(X, Y, True, False) -&gt; 
<a name="1357"/> 1357: 		 ok = if X Op Y -&gt; ok; true -&gt; error end,
<a name="1358"/> 1358: 		 ok = if False; X Op Y; False -&gt; ok; true -&gt; error end,
<a name="1359"/> 1359: 		 ok = if X Op Y, True -&gt; ok; true -&gt; error end,
<a name="1360"/> 1360: 		 ok = if not (X Op Y) -&gt; error; true -&gt; ok end,
<a name="1361"/> 1361: 		 ok = if False; not (X Op Y); False -&gt; error; true -&gt; ok end
<a name="1362"/> 1362: 	 end)(id(A), id(B), id(true), id(false))).
<a name="1363"/> 1363: 
<a name="1364"/> 1364: <b>-define</b>(F(Op,A,B),
<a name="1365"/> 1365: 	ok = if A Op B -&gt; error; true -&gt; ok end,
<a name="1366"/> 1366: 	ok = if not (A Op B) -&gt; ok; true -&gt; error end,
<a name="1367"/> 1367: 	(fun(X, Y, True, False) -&gt;
<a name="1368"/> 1368: 		 ok = if X Op Y -&gt; error; true -&gt; ok end,
<a name="1369"/> 1369: 		 ok = if False; X Op Y; False -&gt; error; true -&gt; ok end,
<a name="1370"/> 1370: 		 ok = if not (X Op Y); False -&gt; ok; true -&gt; error end,
<a name="1371"/> 1371: 		 ok = if not (X Op Y), True -&gt; ok; true -&gt; error end
<a name="1372"/> 1372: 	 end)(id(A), id(B), id(true), id(false))).
<a name="1373"/> 1373: 
<a name="1374"/> 1374: 
<a name="rel_ops-1"/><a name="1375"/> 1375: <b>rel_ops</b>(Config) when is_list(Config) -&gt;
<a name="1376"/> 1376:     TupleUnion = case id(2) of
<a name="1377"/> 1377:                      2 -&gt; {a,id(b)};
<a name="1378"/> 1378:                      3 -&gt; {b,id(b),c}
<a name="1379"/> 1379:                  end,
<a name="1380"/> 1380:     Float = float(id(42)),
<a name="1381"/> 1381:     Int = trunc(id(42.0)),
<a name="1382"/> 1382: 
<a name="1383"/> 1383:     IntFunFloat = make_fun(Float),
<a name="1384"/> 1384:     IntFunInt = make_fun(Int),
<a name="1385"/> 1385: 
<a name="1386"/> 1386:     FloatFun = make_fun(Float, Float),
<a name="1387"/> 1387:     IntFun = make_fun(Int, Int),
<a name="1388"/> 1388:     MixedFun = make_fun(42, 42.0),
<a name="1389"/> 1389: 
<a name="1390"/> 1390:     MixedFun14 = make_fun(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13.0, 14.0),
<a name="1391"/> 1391:     IntFun14 = make_fun(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14),
<a name="1392"/> 1392: 
<a name="1393"/> 1393:     ?T(=/=, 1, 1.0),
<a name="1394"/> 1394:     ?F(=/=, 2, 2),
<a name="1395"/> 1395:     ?F(=/=, {a}, {a}),
<a name="1396"/> 1396: 
<a name="1397"/> 1397:     ?F(/=, a, a),
<a name="1398"/> 1398:     ?F(/=, 0, 0.0),
<a name="1399"/> 1399:     ?T(/=, 0, 1),
<a name="1400"/> 1400:     ?F(/=, {a}, {a}),
<a name="1401"/> 1401:     ?F(/=, {a,b}, TupleUnion),
<a name="1402"/> 1402:     ?T(/=, {x,y}, TupleUnion),
<a name="1403"/> 1403:     ?T(/=, TupleUnion, {x,y}),
<a name="1404"/> 1404:     ?F(/=, #{key =&gt; Int}, #{key =&gt; Float}),
<a name="1405"/> 1405: 
<a name="1406"/> 1406:     ?F(/=, #{key =&gt; Int}, #{key =&gt; Float}),
<a name="1407"/> 1407:     ?F(/=, #{40 =&gt; Int}, #{40 =&gt; Int}),
<a name="1408"/> 1408:     ?F(/=, #{42 =&gt; Float}, #{42 =&gt; Int}),
<a name="1409"/> 1409:     ?T(/=, #{100.0 =&gt; Float}, #{100 =&gt; Float}),
<a name="1410"/> 1410: 
<a name="1411"/> 1411:     ?F(/=, FloatFun, FloatFun),
<a name="1412"/> 1412:     ?T(/=, FloatFun, MixedFun14),
<a name="1413"/> 1413: 
<a name="1414"/> 1414:     ?T(==, Int, 42.0),
<a name="1415"/> 1415:     ?T(==, Float, 42),
<a name="1416"/> 1416:     ?T(==, 1, 1.0),
<a name="1417"/> 1417:     ?T(==, 1.0, 1),
<a name="1418"/> 1418:     ?F(==, Float, a),
<a name="1419"/> 1419:     ?T(==, Float, Float),
<a name="1420"/> 1420:     ?F(==, a, {}),
<a name="1421"/> 1421:     ?T(==, TupleUnion, {a,b}),
<a name="1422"/> 1422:     ?F(==, {x,y}, TupleUnion),
<a name="1423"/> 1423:     ?F(==, {a,Float}, TupleUnion),
<a name="1424"/> 1424: 
<a name="1425"/> 1425:     ?T(==, #{key =&gt; Float}, #{key =&gt; Int}),
<a name="1426"/> 1426:     ?T(==, #{40 =&gt; Int}, #{40 =&gt; Int}),
<a name="1427"/> 1427:     ?T(==, #{42 =&gt; Int}, #{42 =&gt; Float}),
<a name="1428"/> 1428:     ?F(==, #{100 =&gt; Float}, #{100.0 =&gt; Float}),
<a name="1429"/> 1429: 
<a name="1430"/> 1430:     case ?MODULE of
<a name="1431"/> 1431:         guard_inline_SUITE -&gt;
<a name="1432"/> 1432:             %% Inlining will inline the fun environment into the fun bodies,
<a name="1433"/> 1433:             %% creating funs having no enviroment and different bodies.
<a name="1434"/> 1434:             ok;
<a name="1435"/> 1435:         _ -&gt;
<a name="1436"/> 1436:             ?T(==, IntFunInt, IntFunFloat),
<a name="1437"/> 1437:             ?T(==, FloatFun, FloatFun),
<a name="1438"/> 1438:             ?T(==, FloatFun, IntFun),
<a name="1439"/> 1439:             ?T(==, MixedFun, IntFun),
<a name="1440"/> 1440:             ?T(==, MixedFun, FloatFun),
<a name="1441"/> 1441:             ?T(==, IntFun14, MixedFun14),
<a name="1442"/> 1442:             ?T(==, MixedFun14, IntFun14),
<a name="1443"/> 1443:             ?F(==, IntFun14, IntFun)
<a name="1444"/> 1444:     end,
<a name="1445"/> 1445: 
<a name="1446"/> 1446:     ?F(=:=, 1, 1.0),
<a name="1447"/> 1447:     ?T(=:=, 42.0, 42.0),
<a name="1448"/> 1448: 
<a name="1449"/> 1449:     ?F(&gt;, a, b),
<a name="1450"/> 1450:     ?T(&gt;, 42, 1.0),
<a name="1451"/> 1451:     ?F(&gt;, 42, 42.0),
<a name="1452"/> 1452: 
<a name="1453"/> 1453:     ?T(&lt;, a, b),
<a name="1454"/> 1454:     ?F(&lt;, 42, 1.0),
<a name="1455"/> 1455:     ?F(&lt;, 42, 42.0),
<a name="1456"/> 1456: 
<a name="1457"/> 1457:     ?T(=&lt;, 1.5, 5),
<a name="1458"/> 1458:     ?F(=&lt;, -9, -100.344),
<a name="1459"/> 1459:     ?T(=&lt;, 42, 42.0),
<a name="1460"/> 1460: 
<a name="1461"/> 1461:     ?T(&gt;=, 42, 42.0),
<a name="1462"/> 1462:     ?F(&gt;=, a, b),
<a name="1463"/> 1463:     ?T(&gt;=, 1.0, 0),
<a name="1464"/> 1464: 
<a name="1465"/> 1465:     %% Coverage of beam_block:is_exact_eq_ok/1 and collect/1.
<a name="1466"/> 1466:     true = any_atom /= id(42),
<a name="1467"/> 1467:     true = [] /= id(42),
<a name="1468"/> 1468: 
<a name="1469"/> 1469:     %% Coverage of beam_utils:bif_to_test/3
<a name="1470"/> 1470:     Empty = id([]),
<a name="1471"/> 1471:     ?T(==, [], Empty),
<a name="1472"/> 1472: 
<a name="1473"/> 1473:     %% Cover beam_ssa_dead:turn_op('/=').
<a name="1474"/> 1474:     ok = (fun(A, B) when is_atom(A) -&gt;
<a name="1475"/> 1475:                   X = id(A /= B),
<a name="1476"/> 1476:                   if
<a name="1477"/> 1477:                       X -&gt; ok;
<a name="1478"/> 1478:                       true -&gt; error
<a name="1479"/> 1479:                   end
<a name="1480"/> 1480:           end)(a, b),
<a name="1481"/> 1481:     ok = (fun(A, B) when is_atom(A) -&gt;
<a name="1482"/> 1482:                   X = id(B /= A),
<a name="1483"/> 1483:                   if
<a name="1484"/> 1484:                         X -&gt; ok;
<a name="1485"/> 1485:                         true -&gt; error
<a name="1486"/> 1486:                     end
<a name="1487"/> 1487:             end)(a, b),
<a name="1488"/> 1488: 
<a name="1489"/> 1489:     %% Cover beam_ssa_dead.
<a name="1490"/> 1490:     Arrow = fun([T1,T2]) when T1 == $&gt;, T2 == $&gt;;
<a name="1491"/> 1491:                               T1 == $&lt;, T2 == $| -&gt;  true;
<a name="1492"/> 1492:                (_) -&gt; false
<a name="1493"/> 1493:             end,
<a name="1494"/> 1494:     true = Arrow(&quot;&gt;&gt;&quot;),
<a name="1495"/> 1495:     true = Arrow(&quot;&lt;|&quot;),
<a name="1496"/> 1496:     false = Arrow(&quot;&gt;&lt;&quot;),
<a name="1497"/> 1497:     false = Arrow(&quot;&quot;),
<a name="1498"/> 1498: 
<a name="rel_ops-last_expr"/><a name="1499"/> 1499:     ok.
<a name="1500"/> 1500: 
<a name="make_fun-1"/><a name="1501"/> 1501: <b>make_fun</b>(N) -&gt;
<a name="make_fun-last_expr"/><a name="1502"/> 1502: <b>    fun</b>() -&gt; round(N + 0.5) end.
<a name="1503"/> 1503: 
<a name="make_fun-2"/><a name="1504"/> 1504: <b>make_fun</b>(A, B) -&gt;
<a name="make_fun-last_expr"/><a name="1505"/> 1505: <b>    fun</b>() -&gt; {A,B} end.
<a name="1506"/> 1506: 
<a name="make_fun-14"/><a name="1507"/> 1507: <b>make_fun</b>(A, B, C, D, E, F, G, H, I, J, K, L, M, N) -&gt;
<a name="make_fun-last_expr"/><a name="1508"/> 1508: <b>    fun</b>() -&gt;
<a name="1509"/> 1509:             {A, B, C, D, E, F, G, H, I, J, K, L, M, N}
<a name="1510"/> 1510:     end.
<a name="1511"/> 1511: 
<a name="1512"/> 1512: <b>-undef</b>(TestOp).
<a name="1513"/> 1513: 
<a name="rel_op_combinations-1"/><a name="1514"/> 1514: <b>rel_op_combinations</b>(Config) when is_list(Config) -&gt;
<a name="1515"/> 1515:     Digits0 = lists:seq(16#0030, 16#0039) ++
<a name="1516"/> 1516: 	lists:seq(16#0660, 16#0669) ++
<a name="1517"/> 1517: 	lists:seq(16#06F0, 16#06F9),
<a name="1518"/> 1518:     Digits = gb_sets:from_list(Digits0),
<a name="1519"/> 1519:     rel_op_combinations_1(16#0700, Digits),
<a name="1520"/> 1520:     false = is_digit(-1 bsl 59),
<a name="1521"/> 1521:     false = is_digit(-1 bsl 64),
<a name="1522"/> 1522:     false = is_digit((1 bsl 59) - 1),
<a name="1523"/> 1523:     false = is_digit(1 bsl 64),
<a name="1524"/> 1524: 
<a name="1525"/> 1525:     BrokenRange0 = lists:seq(3, 5) ++
<a name="1526"/> 1526: 	lists:seq(10, 12) ++ lists:seq(14, 20),
<a name="1527"/> 1527:     BrokenRange = gb_sets:from_list(BrokenRange0),
<a name="1528"/> 1528:     rel_op_combinations_2(30, BrokenRange),
<a name="1529"/> 1529:     false = broken_range(-1 bsl 64),
<a name="1530"/> 1530:     false = broken_range(1 bsl 64),
<a name="1531"/> 1531: 
<a name="1532"/> 1532:     Red0 = [{I,2*I} || I &lt;- lists:seq(0, 50)] ++
<a name="1533"/> 1533: 	[{I,5*I} || I &lt;- lists:seq(51, 80)],
<a name="1534"/> 1534:     Red = gb_trees:from_orddict(Red0),
<a name="1535"/> 1535:     rel_op_combinations_3(100, Red),
<a name="1536"/> 1536:     2 * (-1 bsl 64) = redundant(-1 bsl 64),
<a name="1537"/> 1537:     none = redundant(1 bsl 64),
<a name="1538"/> 1538: 
<a name="1539"/> 1539:     rel_op_combinations_4(),
<a name="1540"/> 1540: 
<a name="rel_op_combinations-last_expr"/><a name="1541"/> 1541: <b>    rel_op_combinations_5</b>().
<a name="1542"/> 1542: 
<a name="rel_op_combinations_1-2"/><a name="1543"/> 1543: <b>rel_op_combinations_1</b>(0, _) -&gt;
<a name="1544"/> 1544:     ok;
<a name="1545"/> 1545: <b>rel_op_combinations_1</b>(N, Digits) -&gt;
<a name="1546"/> 1546:     Bool = gb_sets:is_member(N, Digits),
<a name="1547"/> 1547:     Bool = is_digit(N),
<a name="rel_op_combinations_1-last_expr"/><a name="1548"/> 1548: <b>    rel_op_combinations_1</b>(N-1, Digits).
<a name="1549"/> 1549: 
<a name="is_digit-1"/><a name="1550"/> 1550: <b>is_digit</b>(N) -&gt;
<a name="1551"/> 1551:     Bool = is_digit_1(N),
<a name="1552"/> 1552:     Bool = is_digit_2(N),
<a name="1553"/> 1553:     Bool = is_digit_3(N),
<a name="1554"/> 1554:     Bool = is_digit_4(N),
<a name="1555"/> 1555:     Bool = is_digit_5(N),
<a name="1556"/> 1556:     Bool = is_digit_6(N),
<a name="1557"/> 1557:     Bool = is_digit_7(N),
<a name="1558"/> 1558:     Bool = is_digit_8(N),
<a name="1559"/> 1559:     Bool = is_digit_9(42, N),
<a name="1560"/> 1560:     Bool = is_digit_10(N, 0),
<a name="is_digit-last_expr"/><a name="1561"/> 1561: <b>    Bool = is_digit_11</b>(N, 0).
<a name="1562"/> 1562: 
<a name="is_digit_1-1"/><a name="1563"/> 1563: <b>is_digit_1</b>(X) when 16#0660 =&lt; X, X =&lt; 16#0669 -&gt; true;
<a name="1564"/> 1564: <b>is_digit_1</b>(X) when 16#0030 =&lt; X, X =&lt; 16#0039 -&gt; true;
<a name="1565"/> 1565: <b>is_digit_1</b>(X) when 16#06F0 =&lt; X, X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_1-last_expr"/><a name="1566"/> 1566: <b>is_digit_1</b>(_) -&gt; false.
<a name="1567"/> 1567: 
<a name="is_digit_2-1"/><a name="1568"/> 1568: <b>is_digit_2</b>(X) when (16#0030-1) &lt; X, X =&lt; 16#0039 -&gt; true;
<a name="1569"/> 1569: <b>is_digit_2</b>(X) when (16#0660-1) &lt; X, X =&lt; 16#0669 -&gt; true;
<a name="1570"/> 1570: <b>is_digit_2</b>(X) when (16#06F0-1) &lt; X, X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_2-last_expr"/><a name="1571"/> 1571: <b>is_digit_2</b>(_) -&gt; false.
<a name="1572"/> 1572: 
<a name="is_digit_3-1"/><a name="1573"/> 1573: <b>is_digit_3</b>(X) when 16#0660 =&lt; X, X &lt; (16#0669+1) -&gt; true;
<a name="1574"/> 1574: <b>is_digit_3</b>(X) when 16#0030 =&lt; X, X &lt; (16#0039+1) -&gt; true;
<a name="1575"/> 1575: <b>is_digit_3</b>(X) when 16#06F0 =&lt; X, X &lt; (16#06F9+1) -&gt; true;
<a name="is_digit_3-last_expr"/><a name="1576"/> 1576: <b>is_digit_3</b>(_) -&gt; false.
<a name="1577"/> 1577: 
<a name="is_digit_4-1"/><a name="1578"/> 1578: <b>is_digit_4</b>(X) when (16#0660-1) &lt; X, X &lt; (16#0669+1) -&gt; true;
<a name="1579"/> 1579: <b>is_digit_4</b>(X) when (16#0030-1) &lt; X, X &lt; (16#0039+1) -&gt; true;
<a name="1580"/> 1580: <b>is_digit_4</b>(X) when (16#06F0-1) &lt; X, X &lt; (16#06F9+1) -&gt; true;
<a name="is_digit_4-last_expr"/><a name="1581"/> 1581: <b>is_digit_4</b>(_) -&gt; false.
<a name="1582"/> 1582: 
<a name="is_digit_5-1"/><a name="1583"/> 1583: <b>is_digit_5</b>(X) when X &gt;= 16#0660, X =&lt; 16#0669 -&gt; true;
<a name="1584"/> 1584: <b>is_digit_5</b>(X) when X &gt;= 16#0030, X =&lt; 16#0039 -&gt; true;
<a name="1585"/> 1585: <b>is_digit_5</b>(X) when X &gt;= 16#06F0, X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_5-last_expr"/><a name="1586"/> 1586: <b>is_digit_5</b>(_) -&gt; false.
<a name="1587"/> 1587: 
<a name="is_digit_6-1"/><a name="1588"/> 1588: <b>is_digit_6</b>(X) when X &gt; (16#0660-1), X =&lt; 16#0669 -&gt; true;
<a name="1589"/> 1589: <b>is_digit_6</b>(X) when X &gt; (16#0030-1), X =&lt; 16#0039 -&gt; true;
<a name="1590"/> 1590: <b>is_digit_6</b>(X) when X &gt; (16#06F0-1), X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_6-last_expr"/><a name="1591"/> 1591: <b>is_digit_6</b>(_) -&gt; false.
<a name="1592"/> 1592: 
<a name="is_digit_7-1"/><a name="1593"/> 1593: <b>is_digit_7</b>(X) when 16#0660 =&lt; X, X =&lt; 16#0669 -&gt; true;
<a name="1594"/> 1594: <b>is_digit_7</b>(X) when 16#0030 =&lt; X, X =&lt; 16#003A, X =/= 16#003A -&gt; true;
<a name="1595"/> 1595: <b>is_digit_7</b>(X) when 16#06F0 =&lt; X, X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_7-last_expr"/><a name="1596"/> 1596: <b>is_digit_7</b>(_) -&gt; false.
<a name="1597"/> 1597: 
<a name="is_digit_8-1"/><a name="1598"/> 1598: <b>is_digit_8</b>(X) when X =&lt; 16#0039, X &gt; (16#0030-1) -&gt; true;
<a name="1599"/> 1599: <b>is_digit_8</b>(X) when X =&lt; 16#06F9, X &gt; (16#06F0-1) -&gt; true;
<a name="1600"/> 1600: <b>is_digit_8</b>(X) when X =&lt; 16#0669, X &gt; (16#0660-1) -&gt; true;
<a name="1601"/> 1601: <b>is_digit_8</b>(16#0670) -&gt; false;
<a name="is_digit_8-last_expr"/><a name="1602"/> 1602: <b>is_digit_8</b>(_) -&gt; false.
<a name="1603"/> 1603: 
<a name="is_digit_9-2"/><a name="1604"/> 1604: <b>is_digit_9</b>(A, 0) when A =:= 42 -&gt; false;
<a name="1605"/> 1605: <b>is_digit_9</b>(_, X) when X &gt; 16#065F, X &lt; 16#066A -&gt; true;
<a name="1606"/> 1606: <b>is_digit_9</b>(_, X) when 16#0030 =&lt; X, X =&lt; 16#0039 -&gt; true;
<a name="1607"/> 1607: <b>is_digit_9</b>(_, X) when 16#06F0 =&lt; X, X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_9-last_expr"/><a name="1608"/> 1608: <b>is_digit_9</b>(_, _) -&gt; false.
<a name="1609"/> 1609: 
<a name="is_digit_10-2"/><a name="1610"/> 1610: <b>is_digit_10</b>(0, 0) -&gt; false;
<a name="1611"/> 1611: <b>is_digit_10</b>(X, _) when X &lt; 16#066A, 16#0660 =&lt; X -&gt; true;
<a name="1612"/> 1612: <b>is_digit_10</b>(X, _) when 16#0030 =&lt; X, X =&lt; 16#0039 -&gt; true;
<a name="1613"/> 1613: <b>is_digit_10</b>(X, _) when 16#06F0 =&lt; X, X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_10-last_expr"/><a name="1614"/> 1614: <b>is_digit_10</b>(_, _) -&gt; false.
<a name="1615"/> 1615: 
<a name="is_digit_11-2"/><a name="1616"/> 1616: <b>is_digit_11</b>(0, 0) -&gt; false;
<a name="1617"/> 1617: <b>is_digit_11</b>(X, _) when X =&lt; 16#0669, 16#0660 =&lt; X -&gt; true;
<a name="1618"/> 1618: <b>is_digit_11</b>(X, _) when 16#0030 =&lt; X, X =&lt; 16#0039 -&gt; true;
<a name="1619"/> 1619: <b>is_digit_11</b>(X, _) when 16#06F0 =&lt; X, X =&lt; 16#06F9 -&gt; true;
<a name="is_digit_11-last_expr"/><a name="1620"/> 1620: <b>is_digit_11</b>(_, _) -&gt; false.
<a name="1621"/> 1621: 
<a name="rel_op_combinations_2-2"/><a name="1622"/> 1622: <b>rel_op_combinations_2</b>(0, _) -&gt;
<a name="1623"/> 1623:     ok;
<a name="1624"/> 1624: <b>rel_op_combinations_2</b>(N, Range) -&gt;
<a name="1625"/> 1625:     Bool = gb_sets:is_member(N, Range),
<a name="1626"/> 1626:     Bool = broken_range(N),
<a name="rel_op_combinations_2-last_expr"/><a name="1627"/> 1627: <b>    rel_op_combinations_2</b>(N-1, Range).
<a name="1628"/> 1628: 
<a name="broken_range-1"/><a name="1629"/> 1629: <b>broken_range</b>(N) -&gt;
<a name="1630"/> 1630:     Bool = broken_range_1(N),
<a name="1631"/> 1631:     Bool = broken_range_2(N),
<a name="1632"/> 1632:     Bool = broken_range_3(N),
<a name="1633"/> 1633:     Bool = broken_range_4(N),
<a name="1634"/> 1634:     Bool = broken_range_5(N),
<a name="1635"/> 1635:     Bool = broken_range_6(N),
<a name="1636"/> 1636:     Bool = broken_range_7(N),
<a name="1637"/> 1637:     Bool = broken_range_8(N),
<a name="1638"/> 1638:     Bool = broken_range_9(N),
<a name="1639"/> 1639:     Bool = broken_range_10(N),
<a name="1640"/> 1640:     Bool = broken_range_11(N),
<a name="1641"/> 1641:     Bool = broken_range_12(N),
<a name="broken_range-last_expr"/><a name="1642"/> 1642: <b>    Bool = broken_range_13</b>(N).
<a name="1643"/> 1643: 
<a name="broken_range_1-1"/><a name="1644"/> 1644: <b>broken_range_1</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1645"/> 1645: <b>broken_range_1</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="broken_range_1-last_expr"/><a name="1646"/> 1646: <b>broken_range_1</b>(_) -&gt; false.
<a name="1647"/> 1647: 
<a name="broken_range_2-1"/><a name="1648"/> 1648: <b>broken_range_2</b>(X) when X &gt;= 10, X =&lt; 12 -&gt; true;
<a name="1649"/> 1649: <b>broken_range_2</b>(X) when X &gt;= 14, X =&lt; 20 -&gt; true;
<a name="1650"/> 1650: <b>broken_range_2</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="broken_range_2-last_expr"/><a name="1651"/> 1651: <b>broken_range_2</b>(_) -&gt; false.
<a name="1652"/> 1652: 
<a name="broken_range_3-1"/><a name="1653"/> 1653: <b>broken_range_3</b>(X) when X &gt;= 10, X =&lt; 12 -&gt; true;
<a name="1654"/> 1654: <b>broken_range_3</b>(X) when X &gt;= 14, X &lt; 21 -&gt; true;
<a name="1655"/> 1655: <b>broken_range_3</b>(3) -&gt; true;
<a name="1656"/> 1656: <b>broken_range_3</b>(4) -&gt; true;
<a name="1657"/> 1657: <b>broken_range_3</b>(5) -&gt; true;
<a name="broken_range_3-last_expr"/><a name="1658"/> 1658: <b>broken_range_3</b>(_) -&gt; false.
<a name="1659"/> 1659: 
<a name="broken_range_4-1"/><a name="1660"/> 1660: <b>broken_range_4</b>(X) when X =&lt; 5, X &gt;= 3 -&gt; true;
<a name="1661"/> 1661: <b>broken_range_4</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1662"/> 1662: <b>broken_range_4</b>(X) when X =&lt; 100 -&gt; false;
<a name="broken_range_4-last_expr"/><a name="1663"/> 1663: <b>broken_range_4</b>(_) -&gt; false.
<a name="1664"/> 1664: 
<a name="broken_range_5-1"/><a name="1665"/> 1665: <b>broken_range_5</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1666"/> 1666: <b>broken_range_5</b>(X) when X &gt; 2, X =&lt; 5 -&gt; true;
<a name="broken_range_5-last_expr"/><a name="1667"/> 1667: <b>broken_range_5</b>(_) -&gt; false.
<a name="1668"/> 1668: 
<a name="broken_range_6-1"/><a name="1669"/> 1669: <b>broken_range_6</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1670"/> 1670: <b>broken_range_6</b>(X) when X &gt; 2, X &lt; 6 -&gt; true;
<a name="broken_range_6-last_expr"/><a name="1671"/> 1671: <b>broken_range_6</b>(_) -&gt; false.
<a name="1672"/> 1672: 
<a name="broken_range_7-1"/><a name="1673"/> 1673: <b>broken_range_7</b>(X) when X &gt; 2, X &lt; 6 -&gt; true;
<a name="1674"/> 1674: <b>broken_range_7</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1675"/> 1675: <b>broken_range_7</b>(X) when X &gt; 30 -&gt; false;
<a name="broken_range_7-last_expr"/><a name="1676"/> 1676: <b>broken_range_7</b>(_) -&gt; false.
<a name="1677"/> 1677: 
<a name="broken_range_8-1"/><a name="1678"/> 1678: <b>broken_range_8</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1679"/> 1679: <b>broken_range_8</b>(X) when X =:= 3 -&gt; true;
<a name="1680"/> 1680: <b>broken_range_8</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="broken_range_8-last_expr"/><a name="1681"/> 1681: <b>broken_range_8</b>(_) -&gt; false.
<a name="1682"/> 1682: 
<a name="broken_range_9-1"/><a name="1683"/> 1683: <b>broken_range_9</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1684"/> 1684: <b>broken_range_9</b>(X) when X =:= 13 -&gt; false;
<a name="1685"/> 1685: <b>broken_range_9</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="broken_range_9-last_expr"/><a name="1686"/> 1686: <b>broken_range_9</b>(_) -&gt; false.
<a name="1687"/> 1687: 
<a name="broken_range_10-1"/><a name="1688"/> 1688: <b>broken_range_10</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="1689"/> 1689: <b>broken_range_10</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1690"/> 1690: <b>broken_range_10</b>(X) when X =/= 13 -&gt; false;
<a name="broken_range_10-last_expr"/><a name="1691"/> 1691: <b>broken_range_10</b>(_) -&gt; false.
<a name="1692"/> 1692: 
<a name="broken_range_11-1"/><a name="1693"/> 1693: <b>broken_range_11</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1694"/> 1694: <b>broken_range_11</b>(X) when is_tuple(X), X =:= 10 -&gt; true;
<a name="1695"/> 1695: <b>broken_range_11</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="broken_range_11-last_expr"/><a name="1696"/> 1696: <b>broken_range_11</b>(_) -&gt; false.
<a name="1697"/> 1697: 
<a name="broken_range_12-1"/><a name="1698"/> 1698: <b>broken_range_12</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="1699"/> 1699: <b>broken_range_12</b>(X) when X &gt;= 10, X =&lt; 20, X =/= 13 -&gt; true;
<a name="1700"/> 1700: <b>broken_range_12</b>(X) when X &lt; 30, X &gt; 20 -&gt; false;
<a name="broken_range_12-last_expr"/><a name="1701"/> 1701: <b>broken_range_12</b>(_) -&gt; false.
<a name="1702"/> 1702: 
<a name="broken_range_13-1"/><a name="1703"/> 1703: <b>broken_range_13</b>(X) when X &gt;= 10, X =&lt; 20, 13 =/= X -&gt; true;
<a name="1704"/> 1704: <b>broken_range_13</b>(X) when X &gt;= 3, X =&lt; 5 -&gt; true;
<a name="broken_range_13-last_expr"/><a name="1705"/> 1705: <b>broken_range_13</b>(_) -&gt; false.
<a name="1706"/> 1706: 
<a name="rel_op_combinations_3-2"/><a name="1707"/> 1707: <b>rel_op_combinations_3</b>(0, _) -&gt;
<a name="1708"/> 1708:     ok;
<a name="1709"/> 1709: <b>rel_op_combinations_3</b>(N, Red) -&gt;
<a name="1710"/> 1710:     Val = case gb_trees:lookup(N, Red) of
<a name="1711"/> 1711: 	      none -&gt; none;
<a name="1712"/> 1712: 	      {value,V} -&gt; V
<a name="1713"/> 1713: 	  end,
<a name="1714"/> 1714:     Val = redundant(N),
<a name="rel_op_combinations_3-last_expr"/><a name="1715"/> 1715: <b>    rel_op_combinations_3</b>(N-1, Red).
<a name="1716"/> 1716: 
<a name="redundant-1"/><a name="1717"/> 1717: <b>redundant</b>(N) -&gt;
<a name="1718"/> 1718:     Val = redundant_1(N),
<a name="1719"/> 1719:     Val = redundant_2(N),
<a name="1720"/> 1720:     Val = redundant_3(N),
<a name="1721"/> 1721:     Val = redundant_4(N),
<a name="1722"/> 1722:     Val = redundant_5(N),
<a name="1723"/> 1723:     Val = redundant_6(N),
<a name="1724"/> 1724:     Val = redundant_7(N),
<a name="1725"/> 1725:     Val = redundant_8(N),
<a name="1726"/> 1726:     Val = redundant_9(N),
<a name="1727"/> 1727:     Val = redundant_10(N),
<a name="1728"/> 1728:     Val = redundant_11(N),
<a name="redundant-last_expr"/><a name="1729"/> 1729: <b>    Val = redundant_12</b>(N).
<a name="1730"/> 1730: 
<a name="redundant_1-1"/><a name="1731"/> 1731: <b>redundant_1</b>(X) when X &gt;= 51, X =&lt; 80 -&gt; 5*X;
<a name="1732"/> 1732: <b>redundant_1</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="redundant_1-last_expr"/><a name="1733"/> 1733: <b>redundant_1</b>(_) -&gt; none.
<a name="1734"/> 1734: 
<a name="redundant_2-1"/><a name="1735"/> 1735: <b>redundant_2</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="1736"/> 1736: <b>redundant_2</b>(X) when X &gt;= 51, X =&lt; 80 -&gt; 5*X;
<a name="redundant_2-last_expr"/><a name="1737"/> 1737: <b>redundant_2</b>(_) -&gt; none.
<a name="1738"/> 1738: 
<a name="redundant_3-1"/><a name="1739"/> 1739: <b>redundant_3</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="1740"/> 1740: <b>redundant_3</b>(X) when X =&lt; 80, X &gt;= 51 -&gt; 5*X;
<a name="1741"/> 1741: <b>redundant_3</b>(X) when X =/= 100 -&gt; none;
<a name="redundant_3-last_expr"/><a name="1742"/> 1742: <b>redundant_3</b>(_) -&gt; none.
<a name="1743"/> 1743: 
<a name="redundant_4-1"/><a name="1744"/> 1744: <b>redundant_4</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="1745"/> 1745: <b>redundant_4</b>(X) when X =&lt; 80, X &gt; 50 -&gt; 5*X;
<a name="1746"/> 1746: <b>redundant_4</b>(X) when X =/= 100 -&gt; none;
<a name="redundant_4-last_expr"/><a name="1747"/> 1747: <b>redundant_4</b>(_) -&gt; none.
<a name="1748"/> 1748: 
<a name="redundant_5-1"/><a name="1749"/> 1749: <b>redundant_5</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="1750"/> 1750: <b>redundant_5</b>(X) when X &gt; 50, X &lt; 81 -&gt; 5*X;
<a name="1751"/> 1751: <b>redundant_5</b>(X) when X =&lt; 10 -&gt; none;
<a name="redundant_5-last_expr"/><a name="1752"/> 1752: <b>redundant_5</b>(_) -&gt; none.
<a name="1753"/> 1753: 
<a name="redundant_6-1"/><a name="1754"/> 1754: <b>redundant_6</b>(X) when X &gt; 50, X =&lt; 80 -&gt; 5*X;
<a name="1755"/> 1755: <b>redundant_6</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="redundant_6-last_expr"/><a name="1756"/> 1756: <b>redundant_6</b>(_) -&gt; none.
<a name="1757"/> 1757: 
<a name="redundant_7-1"/><a name="1758"/> 1758: <b>redundant_7</b>(X) when is_integer(X), X &gt;= 51, X =&lt; 80 -&gt; 5*X;
<a name="1759"/> 1759: <b>redundant_7</b>(X) when is_integer(X), X &lt; 51 -&gt; 2*X;
<a name="redundant_7-last_expr"/><a name="1760"/> 1760: <b>redundant_7</b>(_) -&gt; none.
<a name="1761"/> 1761: 
<a name="redundant_8-1"/><a name="1762"/> 1762: <b>redundant_8</b>(X) when X &gt;= 51, X =&lt; 80 -&gt; 5*X;
<a name="1763"/> 1763: <b>redundant_8</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="redundant_8-last_expr"/><a name="1764"/> 1764: <b>redundant_8</b>(_) -&gt; none.
<a name="1765"/> 1765: 
<a name="redundant_9-1"/><a name="1766"/> 1766: <b>redundant_9</b>(X) when X &gt;= 51, X =&lt; 80 -&gt; 5*X;
<a name="1767"/> 1767: <b>redundant_9</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="1768"/> 1768: <b>redundant_9</b>(90) -&gt; none;
<a name="1769"/> 1769: <b>redundant_9</b>(X) when X =/= 90 -&gt; none;
<a name="redundant_9-last_expr"/><a name="1770"/> 1770: <b>redundant_9</b>(_) -&gt; none.
<a name="1771"/> 1771: 
<a name="redundant_10-1"/><a name="1772"/> 1772: <b>redundant_10</b>(X) when X &gt;= 51, X =&lt; 80 -&gt; 5*X;
<a name="1773"/> 1773: <b>redundant_10</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="1774"/> 1774: <b>redundant_10</b>(90) -&gt; none;
<a name="1775"/> 1775: <b>redundant_10</b>(X) when X =:= 90 -&gt; none;
<a name="redundant_10-last_expr"/><a name="1776"/> 1776: <b>redundant_10</b>(_) -&gt; none.
<a name="1777"/> 1777: 
<a name="redundant_11-1"/><a name="1778"/> 1778: <b>redundant_11</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="1779"/> 1779: <b>redundant_11</b>(X) when X =:= 10 -&gt; 2*X;
<a name="1780"/> 1780: <b>redundant_11</b>(X) when X &gt;= 51, X =&lt; 80 -&gt; 5*X;
<a name="redundant_11-last_expr"/><a name="1781"/> 1781: <b>redundant_11</b>(_) -&gt; none.
<a name="1782"/> 1782: 
<a name="redundant_12-1"/><a name="1783"/> 1783: <b>redundant_12</b>(50) -&gt; 100;
<a name="1784"/> 1784: <b>redundant_12</b>(X) when X &gt;= 50, X =&lt; 80 -&gt; 5*X;
<a name="1785"/> 1785: <b>redundant_12</b>(X) when X &lt; 51 -&gt; 2*X;
<a name="redundant_12-last_expr"/><a name="1786"/> 1786: <b>redundant_12</b>(_) -&gt; none.
<a name="1787"/> 1787: 
<a name="rel_op_combinations_4-0"/><a name="1788"/> 1788: <b>rel_op_combinations_4</b>() -&gt;
<a name="1789"/> 1789:     ne = rel_op_vars_1(id(a), id(b)),
<a name="1790"/> 1790:     le = rel_op_vars_1(id(x), id(x)),
<a name="1791"/> 1791: 
<a name="1792"/> 1792:     ne = rel_op_vars_2(id(a), id(b)),
<a name="1793"/> 1793:     ge = rel_op_vars_2(id(x), id(x)),
<a name="1794"/> 1794: 
<a name="rel_op_combinations_4-last_expr"/><a name="1795"/> 1795:     ok.
<a name="1796"/> 1796: 
<a name="rel_op_vars_1-2"/><a name="1797"/> 1797: <b>rel_op_vars_1</b>(X, N) when X =/= N -&gt; ne;
<a name="rel_op_vars_1-last_expr"/><a name="1798"/> 1798: <b>rel_op_vars_1</b>(X, N) when X =&lt; N -&gt; le.
<a name="1799"/> 1799: 
<a name="rel_op_vars_2-2"/><a name="1800"/> 1800: <b>rel_op_vars_2</b>(X, N) when X =/= N -&gt; ne;
<a name="rel_op_vars_2-last_expr"/><a name="1801"/> 1801: <b>rel_op_vars_2</b>(X, N) when X &gt;= N -&gt; ge.
<a name="1802"/> 1802: 
<a name="rel_op_combinations_5-0"/><a name="1803"/> 1803: <b>rel_op_combinations_5</b>() -&gt;
<a name="1804"/> 1804:     lt = lt_gt_eq(a, b),
<a name="1805"/> 1805:     lt = lt_gt_eq(1.0, 42),
<a name="1806"/> 1806:     lt = lt_gt_eq(1, 42.0),
<a name="1807"/> 1807: 
<a name="1808"/> 1808:     eq = lt_gt_eq(a, a),
<a name="1809"/> 1809:     eq = lt_gt_eq(42, 42),
<a name="1810"/> 1810:     eq = lt_gt_eq(42.0, 42),
<a name="1811"/> 1811:     eq = lt_gt_eq(42, 42.0),
<a name="1812"/> 1812:     eq = lt_gt_eq(42.0, 42.0),
<a name="1813"/> 1813: 
<a name="1814"/> 1814:     gt = lt_gt_eq(b, a),
<a name="1815"/> 1815:     gt = lt_gt_eq(42.0, 1),
<a name="1816"/> 1816:     gt = lt_gt_eq(42, 1.0),
<a name="1817"/> 1817: 
<a name="1818"/> 1818:     lt = eq_exact_lt_gt(a, b),
<a name="1819"/> 1819:     lt = eq_exact_lt_gt(1.0, 42),
<a name="1820"/> 1820:     lt = eq_exact_lt_gt(1, 42.0),
<a name="1821"/> 1821: 
<a name="1822"/> 1822:     eq = eq_exact_lt_gt(a, a),
<a name="1823"/> 1823:     eq = eq_exact_lt_gt(42, 42),
<a name="1824"/> 1824:     none = eq_exact_lt_gt(42, 42.0),
<a name="1825"/> 1825: 
<a name="1826"/> 1826:     gt = eq_exact_lt_gt(b, a),
<a name="1827"/> 1827:     gt = eq_exact_lt_gt(42.0, 1),
<a name="1828"/> 1828:     gt = eq_exact_lt_gt(42, 1.0),
<a name="1829"/> 1829: 
<a name="rel_op_combinations_5-last_expr"/><a name="1830"/> 1830:     ok.
<a name="1831"/> 1831: 
<a name="lt_gt_eq-2"/><a name="1832"/> 1832: <b>lt_gt_eq</b>(A, B) -&gt;
<a name="1833"/> 1833:     Res = lt_gt_eq_1(A, B),
<a name="1834"/> 1834:     Res = lt_gt_eq_2(A, B),
<a name="1835"/> 1835:     Res = lt_gt_eq_3(A, B),
<a name="1836"/> 1836:     Res = lt_gt_eq_4(A, B),
<a name="1837"/> 1837:     Res = lt_gt_eq_5(A, B),
<a name="lt_gt_eq-last_expr"/><a name="1838"/> 1838: <b>    lt_gt_eq_6</b>(A, B).
<a name="1839"/> 1839: 
<a name="1840"/> 1840: <i>%% The last test in each 'if' is unnecessary.</i>
<a name="lt_gt_eq_1-2"/><a name="1841"/> 1841: <b>lt_gt_eq_1</b>(A, B) -&gt;
<a name="lt_gt_eq_1-last_expr"/><a name="1842"/> 1842:     if
<a name="1843"/> 1843:         A &lt; B -&gt; lt;
<a name="1844"/> 1844:         A == B -&gt; eq;
<a name="1845"/> 1845:         A &gt; B -&gt; gt
<a name="1846"/> 1846:     end.
<a name="1847"/> 1847: 
<a name="lt_gt_eq_2-2"/><a name="1848"/> 1848: <b>lt_gt_eq_2</b>(A, B) -&gt;
<a name="lt_gt_eq_2-last_expr"/><a name="1849"/> 1849:     if
<a name="1850"/> 1850:         A &gt; B -&gt; gt;
<a name="1851"/> 1851:         A == B -&gt; eq;
<a name="1852"/> 1852:         A &lt; B -&gt; lt
<a name="1853"/> 1853:     end.
<a name="1854"/> 1854: 
<a name="lt_gt_eq_3-2"/><a name="1855"/> 1855: <b>lt_gt_eq_3</b>(A, B) -&gt;
<a name="lt_gt_eq_3-last_expr"/><a name="1856"/> 1856:     if
<a name="1857"/> 1857:         A == B -&gt; eq;
<a name="1858"/> 1858:         A &lt; B -&gt; lt;
<a name="1859"/> 1859:         A &gt; B -&gt; gt
<a name="1860"/> 1860:     end.
<a name="1861"/> 1861: 
<a name="lt_gt_eq_4-2"/><a name="1862"/> 1862: <b>lt_gt_eq_4</b>(A, B) -&gt;
<a name="lt_gt_eq_4-last_expr"/><a name="1863"/> 1863:     if
<a name="1864"/> 1864:         A == B -&gt; eq;
<a name="1865"/> 1865:         A &gt; B -&gt; gt;
<a name="1866"/> 1866:         A &lt; B -&gt; lt
<a name="1867"/> 1867:     end.
<a name="1868"/> 1868: 
<a name="lt_gt_eq_5-2"/><a name="1869"/> 1869: <b>lt_gt_eq_5</b>(A, B) -&gt;
<a name="lt_gt_eq_5-last_expr"/><a name="1870"/> 1870:     if
<a name="1871"/> 1871:         A &lt; B -&gt; lt;
<a name="1872"/> 1872:         A &gt; B -&gt; gt;
<a name="1873"/> 1873:         A == B -&gt; eq
<a name="1874"/> 1874:     end.
<a name="1875"/> 1875: 
<a name="lt_gt_eq_6-2"/><a name="1876"/> 1876: <b>lt_gt_eq_6</b>(A, B) -&gt;
<a name="lt_gt_eq_6-last_expr"/><a name="1877"/> 1877:     if
<a name="1878"/> 1878:         A &gt; B -&gt; gt;
<a name="1879"/> 1879:         A &lt; B -&gt; lt;
<a name="1880"/> 1880:         A == B -&gt; eq
<a name="1881"/> 1881:     end.
<a name="1882"/> 1882: 
<a name="eq_exact_lt_gt-2"/><a name="1883"/> 1883: <b>eq_exact_lt_gt</b>(A, B) -&gt;
<a name="1884"/> 1884:     Res = eq_exact_lt_gt_1(A, B),
<a name="1885"/> 1885:     Res = eq_exact_lt_gt_2(A, B),
<a name="1886"/> 1886:     Res = eq_exact_lt_gt_3(A, B),
<a name="1887"/> 1887:     Res = eq_exact_lt_gt_4(A, B),
<a name="1888"/> 1888:     Res = eq_exact_lt_gt_5(A, B),
<a name="eq_exact_lt_gt-last_expr"/><a name="1889"/> 1889: <b>    Res = eq_exact_lt_gt_6</b>(A, B).
<a name="1890"/> 1890: 
<a name="1891"/> 1891: <i>%% Not possible to optimize (unless we have type information so we</i>
<a name="1892"/> 1892: <i>%% know that A == B and A =:= B produces the same result).</i>
<a name="1893"/> 1893: 
<a name="eq_exact_lt_gt_1-2"/><a name="1894"/> 1894: <b>eq_exact_lt_gt_1</b>(A, B) -&gt;
<a name="eq_exact_lt_gt_1-last_expr"/><a name="1895"/> 1895:     if
<a name="1896"/> 1896:         A &lt; B -&gt; lt;
<a name="1897"/> 1897:         A =:= B -&gt; eq;
<a name="1898"/> 1898:         A &gt; B -&gt; gt;
<a name="1899"/> 1899:         true -&gt; none
<a name="1900"/> 1900:     end.
<a name="1901"/> 1901: 
<a name="eq_exact_lt_gt_2-2"/><a name="1902"/> 1902: <b>eq_exact_lt_gt_2</b>(A, B) -&gt;
<a name="eq_exact_lt_gt_2-last_expr"/><a name="1903"/> 1903:     if
<a name="1904"/> 1904:         A &gt; B -&gt; gt;
<a name="1905"/> 1905:         A =:= B -&gt; eq;
<a name="1906"/> 1906:         A &lt; B -&gt; lt;
<a name="1907"/> 1907:         true -&gt; none
<a name="1908"/> 1908:     end.
<a name="1909"/> 1909: 
<a name="eq_exact_lt_gt_3-2"/><a name="1910"/> 1910: <b>eq_exact_lt_gt_3</b>(A, B) -&gt;
<a name="eq_exact_lt_gt_3-last_expr"/><a name="1911"/> 1911:     if
<a name="1912"/> 1912:         A =:= B -&gt; eq;
<a name="1913"/> 1913:         A &lt; B -&gt; lt;
<a name="1914"/> 1914:         A &gt; B -&gt; gt;
<a name="1915"/> 1915:         true -&gt; none
<a name="1916"/> 1916:     end.
<a name="1917"/> 1917: 
<a name="eq_exact_lt_gt_4-2"/><a name="1918"/> 1918: <b>eq_exact_lt_gt_4</b>(A, B) -&gt;
<a name="eq_exact_lt_gt_4-last_expr"/><a name="1919"/> 1919:     if
<a name="1920"/> 1920:         A =:= B -&gt; eq;
<a name="1921"/> 1921:         A &gt; B -&gt; gt;
<a name="1922"/> 1922:         A &lt; B -&gt; lt;
<a name="1923"/> 1923:         true -&gt; none
<a name="1924"/> 1924:     end.
<a name="1925"/> 1925: 
<a name="eq_exact_lt_gt_5-2"/><a name="1926"/> 1926: <b>eq_exact_lt_gt_5</b>(A, B) -&gt;
<a name="eq_exact_lt_gt_5-last_expr"/><a name="1927"/> 1927:     if
<a name="1928"/> 1928:         A &lt; B -&gt; lt;
<a name="1929"/> 1929:         A &gt; B -&gt; gt;
<a name="1930"/> 1930:         A =:= B -&gt; eq;
<a name="1931"/> 1931:         true -&gt; none
<a name="1932"/> 1932:     end.
<a name="1933"/> 1933: 
<a name="eq_exact_lt_gt_6-2"/><a name="1934"/> 1934: <b>eq_exact_lt_gt_6</b>(A, B) -&gt;
<a name="eq_exact_lt_gt_6-last_expr"/><a name="1935"/> 1935:     if
<a name="1936"/> 1936:         A &gt; B -&gt; gt;
<a name="1937"/> 1937:         A &lt; B -&gt; lt;
<a name="1938"/> 1938:         A =:= B -&gt; eq;
<a name="1939"/> 1939:         true -&gt; none
<a name="1940"/> 1940:     end.
<a name="1941"/> 1941: 
<a name="1942"/> 1942: <i>%% Exhaustively test all combinations of relational operators</i>
<a name="1943"/> 1943: <i>%% to ensure the correctness of the optimizations in beam_ssa_dead.</i>
<a name="1944"/> 1944: 
<a name="generated_combinations-1"/><a name="1945"/> 1945: <b>generated_combinations</b>(_Config) -&gt;
<a name="1946"/> 1946:     Mod = ?FUNCTION_NAME,
<a name="1947"/> 1947:     RelOps = ['=:=','=/=','==','/=','&lt;','=&lt;','&gt;=','&gt;'],
<a name="1948"/> 1948:     Combinations0 = [{Op1,Op2} || Op1 &lt;- RelOps, Op2 &lt;- RelOps],
<a name="1949"/> 1949:     Combinations1 = gen_lit_combs(Combinations0),
<a name="1950"/> 1950:     Combinations2 = [{neq,Comb} ||
<a name="1951"/> 1951:                         {_Op1,_Lit1,Op2,_Lit2}=Comb &lt;- Combinations1,
<a name="1952"/> 1952:                         Op2 =:= '=/=' orelse Op2 =:= '/='] ++ Combinations1,
<a name="1953"/> 1953:     Combinations = gen_func_names(Combinations2, 0),
<a name="1954"/> 1954:     Fs = gen_rel_op_functions(Combinations),
<a name="1955"/> 1955:     Tree = ?Q([&quot;-module('@Mod@').&quot;,
<a name="1956"/> 1956:                &quot;-compile([export_all,nowarn_export_all]).&quot;]) ++ Fs,
<a name="1957"/> 1957:     %%merl:print(Tree),
<a name="1958"/> 1958:     Opts = test_lib:opt_opts(?MODULE),
<a name="1959"/> 1959:     {ok,_Bin} = merl:compile_and_load(Tree, Opts),
<a name="generated_combinations-last_expr"/><a name="1960"/> 1960: <b>    test_combinations</b>(Combinations, Mod).
<a name="1961"/> 1961: 
<a name="gen_lit_combs-1"/><a name="1962"/> 1962: <b>gen_lit_combs</b>([{Op1,Op2}|T]) -&gt;
<a name="1963"/> 1963:     [{Op1,7,Op2,6},
<a name="1964"/> 1964:      {Op1,7.0,Op2,6},
<a name="1965"/> 1965:      {Op1,7,Op2,6.0},
<a name="1966"/> 1966:      {Op1,7.0,Op2,6.0},
<a name="1967"/> 1967: 
<a name="1968"/> 1968:      {Op1,7,Op2,7},
<a name="1969"/> 1969:      {Op1,7.0,Op2,7},
<a name="1970"/> 1970:      {Op1,7,Op2,7.0},
<a name="1971"/> 1971:      {Op1,7.0,Op2,7.0},
<a name="1972"/> 1972: 
<a name="1973"/> 1973:      {Op1,6,Op2,7},
<a name="1974"/> 1974:      {Op1,6.0,Op2,7},
<a name="1975"/> 1975:      {Op1,6,Op2,7.0},
<a name="1976"/> 1976:      {Op1,6.0,Op2,7.0}|gen_lit_combs(T)];
<a name="gen_lit_combs-last_expr"/><a name="1977"/> 1977: <b>gen_lit_combs</b>([]) -&gt; [].
<a name="1978"/> 1978: 
<a name="gen_func_names-2"/><a name="1979"/> 1979: <b>gen_func_names</b>([E|Es], I) -&gt;
<a name="1980"/> 1980:     Name = list_to_atom(&quot;f&quot; ++ integer_to_list(I)),
<a name="1981"/> 1981:     [{Name,E}|gen_func_names(Es, I+1)];
<a name="gen_func_names-last_expr"/><a name="1982"/> 1982: <b>gen_func_names</b>([], _) -&gt; [].
<a name="1983"/> 1983: 
<a name="gen_rel_op_functions-1"/><a name="1984"/> 1984: <b>gen_rel_op_functions</b>([{Name,{neq,{Op1,Lit1,Op2,Lit2}}}|T]) -&gt;
<a name="1985"/> 1985:     %% Note that in the translation to SSA, '=/=' will be
<a name="1986"/> 1986:     %% translated to '=:=' in a guard (with switched success
<a name="1987"/> 1987:     %% and failure labels). Therefore, to test the optimization,
<a name="1988"/> 1988:     %% we must use '=/=' (or '/=') in a body context.
<a name="1989"/> 1989:     %%
<a name="1990"/> 1990:     %% Here is an example of a generated function:
<a name="1991"/> 1991:     %%
<a name="1992"/> 1992:     %%     f160(A) when erlang:'&gt;='(A, 7) -&gt;
<a name="1993"/> 1993:     %%          one;
<a name="1994"/> 1994:     %%     f160(A) -&gt;
<a name="1995"/> 1995:     %%          true = erlang:'/='(A, 7),
<a name="1996"/> 1996:     %%          two.
<a name="1997"/> 1997:     [?Q(&quot;'@Name@'(A) when erlang:'@Op1@'(A, _@Lit1@) -&gt; one;
<a name="1998"/> 1998:         '@Name@'(A) -&gt; true = erlang:'@Op2@'(A, _@Lit2@), two. &quot;)|
<a name="1999"/> 1999:      gen_rel_op_functions(T)];
<a name="2000"/> 2000: <b>gen_rel_op_functions</b>([{Name,{Op1,Lit1,Op2,Lit2}}|T]) -&gt;
<a name="2001"/> 2001:     %% Example of a generated function:
<a name="2002"/> 2002:     %%
<a name="2003"/> 2003:     %% f721(A) when erlang:'=&lt;'(A, 7.0) -&gt; one;
<a name="2004"/> 2004:     %% f721(A) when erlang:'&lt;'(A, 6) -&gt; two;
<a name="2005"/> 2005:     %% f721(_) -&gt; three.
<a name="2006"/> 2006:     [?Q(&quot;'@Name@'(A) when erlang:'@Op1@'(A, _@Lit1@) -&gt; one;
<a name="2007"/> 2007:         '@Name@'(A) when erlang:'@Op2@'(A, _@Lit2@) -&gt; two;
<a name="2008"/> 2008:         '@Name@'(_) -&gt; three.&quot;)|gen_rel_op_functions(T)];
<a name="gen_rel_op_functions-last_expr"/><a name="2009"/> 2009: <b>gen_rel_op_functions</b>([]) -&gt; [].
<a name="2010"/> 2010: 
<a name="test_combinations-2"/><a name="2011"/> 2011: <b>test_combinations</b>([{Name,E}|T], Mod) -&gt;
<a name="2012"/> 2012:     try
<a name="2013"/> 2013:         test_combinations_1([5,6,7,8,9], E, fun Mod:Name/1),
<a name="2014"/> 2014:         test_combination(6.5, E, fun Mod:Name/1)
<a name="2015"/> 2015:     catch
<a name="2016"/> 2016:         error:Reason:Stk -&gt;
<a name="2017"/> 2017:             io:format(&quot;~p: ~p\n&quot;, [Name,E]),
<a name="2018"/> 2018:             erlang:raise(error, Reason, Stk)
<a name="2019"/> 2019:     end,
<a name="2020"/> 2020:     test_combinations(T, Mod);
<a name="test_combinations-last_expr"/><a name="2021"/> 2021: <b>test_combinations</b>([], _Mod) -&gt; ok.
<a name="2022"/> 2022: 
<a name="test_combinations_1-3"/><a name="2023"/> 2023: <b>test_combinations_1</b>([V|Vs], E, Fun) -&gt;
<a name="2024"/> 2024:     test_combination(V, E, Fun),
<a name="2025"/> 2025:     test_combination(float(V), E, Fun),
<a name="2026"/> 2026:     test_combinations_1(Vs, E, Fun);
<a name="test_combinations_1-last_expr"/><a name="2027"/> 2027: <b>test_combinations_1</b>([], _, _) -&gt; ok.
<a name="2028"/> 2028: 
<a name="test_combination-3"/><a name="2029"/> 2029: <b>test_combination</b>(Val, {neq,Expr}, Fun) -&gt;
<a name="2030"/> 2030:     Result = eval_combination_expr(Expr, Val),
<a name="2031"/> 2031:     Result = try
<a name="2032"/> 2032:                  Fun(Val)                       %Returns 'one' or 'two'.
<a name="2033"/> 2033:              catch
<a name="2034"/> 2034:                  error:{badmatch,_} -&gt;
<a name="2035"/> 2035:                      three
<a name="2036"/> 2036:              end;
<a name="2037"/> 2037: <b>test_combination</b>(Val, Expr, Fun) -&gt;
<a name="2038"/> 2038:     Result = eval_combination_expr(Expr, Val),
<a name="test_combination-last_expr"/><a name="2039"/> 2039: <b>    Result = Fun</b>(Val).
<a name="2040"/> 2040: 
<a name="eval_combination_expr-2"/><a name="2041"/> 2041: <b>eval_combination_expr</b>({Op1,Lit1,Op2,Lit2}, Val) -&gt;
<a name="eval_combination_expr-last_expr"/><a name="2042"/> 2042: <b>    case erlang:Op1</b>(Val, Lit1) of
<a name="2043"/> 2043:         true -&gt;
<a name="2044"/> 2044:             one;
<a name="2045"/> 2045:         false -&gt;
<a name="2046"/> 2046:             case erlang:Op2(Val, Lit2) of
<a name="2047"/> 2047:                 true -&gt; two;
<a name="2048"/> 2048:                 false -&gt; three
<a name="2049"/> 2049:             end
<a name="2050"/> 2050:     end.
<a name="2051"/> 2051: 
<a name="2052"/> 2052: <i>%% Test type tests on literal values. (From emulator test suites.)</i>
<a name="literal_type_tests-1"/><a name="2053"/> 2053: <b>literal_type_tests</b>(Config) when is_list(Config) -&gt;
<a name="2054"/> 2054:     %% Generate an Erlang module with all different type of type tests.
<a name="2055"/> 2055:     Tests = make_test([{T,L} || T &lt;- type_tests(), L &lt;- literals()] ++
<a name="2056"/> 2056: 			    [{is_function,L1,L2} || 
<a name="2057"/> 2057: 				L1 &lt;- literals(), L2 &lt;- literals()]),
<a name="2058"/> 2058:     Mod = literal_test,
<a name="2059"/> 2059:     Anno = erl_anno:new(0),
<a name="2060"/> 2060:     Func = {function, Anno, test, 0, [{clause,Anno,[],[],Tests}]},
<a name="2061"/> 2061:     Form = [{attribute,Anno,module,Mod},
<a name="2062"/> 2062:             {attribute,Anno,compile,export_all},
<a name="2063"/> 2063:             Func, {eof,999}],
<a name="2064"/> 2064: 
<a name="2065"/> 2065:     %% Print generated code for inspection.
<a name="2066"/> 2066:     lists:foreach(fun (F) -&gt; io:put_chars([erl_pp:form(F),&quot;\n&quot;]) end, Form),
<a name="2067"/> 2067: 
<a name="2068"/> 2068:     %% Test compile:form/1.  This implies full optimization (default).
<a name="2069"/> 2069:     {ok,Mod,Code1} = compile:forms(Form),
<a name="2070"/> 2070:     smoke_disasm(Config, Mod, Code1),
<a name="2071"/> 2071:     {module,Mod} = code:load_binary(Mod, Mod, Code1),
<a name="2072"/> 2072:     Mod:test(),
<a name="2073"/> 2073:     true = code:delete(Mod),
<a name="2074"/> 2074:     code:purge(Mod),
<a name="2075"/> 2075: 			       
<a name="2076"/> 2076:     %% Test compile:form/2.  Turn off all optimizations.
<a name="2077"/> 2077:     {ok,Mod,Code2} = compile:forms(Form, [binary,report,time,
<a name="2078"/> 2078: 						no_copt,no_postopt]),
<a name="2079"/> 2079:     smoke_disasm(Config, Mod, Code2),
<a name="2080"/> 2080:     {module,Mod} = code:load_binary(Mod, Mod, Code2),
<a name="2081"/> 2081:     Mod:test(),
<a name="2082"/> 2082:     true = code:delete(Mod),
<a name="2083"/> 2083:     code:purge(Mod),
<a name="literal_type_tests-last_expr"/><a name="2084"/> 2084:     ok.
<a name="2085"/> 2085: 
<a name="make_test-1"/><a name="2086"/> 2086: <b>make_test</b>([{T,L1,L2}|Ts]) -&gt;
<a name="2087"/> 2087:     [test(T, L1, L2)|make_test(Ts)];
<a name="2088"/> 2088: <b>make_test</b>([{T,L}|Ts]) -&gt;
<a name="2089"/> 2089:     [test(T, L)|make_test(Ts)];
<a name="make_test-last_expr"/><a name="2090"/> 2090: <b>make_test</b>([]) -&gt; [].
<a name="2091"/> 2091: 
<a name="test-2"/><a name="2092"/> 2092: <b>test</b>(T, L) -&gt;
<a name="2093"/> 2093:     S0 = io_lib:format(&quot;begin io:format(\&quot;~~p~n\&quot;, [{~p,~p}]), if ~w(~w) -&gt; true; true -&gt; false end end. &quot;, [T,L,T,L]),
<a name="2094"/> 2094:     S = lists:flatten(S0),
<a name="2095"/> 2095:     {ok,Toks,_Line} = erl_scan:string(S),
<a name="2096"/> 2096:     {ok,E} = erl_parse:parse_exprs(Toks),
<a name="2097"/> 2097:     {value,Val,_Bs} = erl_eval:exprs(E, []),
<a name="2098"/> 2098:     Anno = erl_anno:new(0),
<a name="test-last_expr"/><a name="2099"/> 2099: <b>    {match,Anno,{atom,Anno,Val},hd</b>(E)}.
<a name="2100"/> 2100: 
<a name="test-3"/><a name="2101"/> 2101: <b>test</b>(T, L1, L2) -&gt;
<a name="2102"/> 2102:     S0 = io_lib:format(&quot;begin io:format(\&quot;~~p~n\&quot;, [{~p,~p,~p}]), if ~w(~w, ~w) -&gt; true; true -&gt; false end end. &quot;, [T,L1,L2,T,L1,L2]),
<a name="2103"/> 2103:     S = lists:flatten(S0),
<a name="2104"/> 2104:     {ok,Toks,_Line} = erl_scan:string(S),
<a name="2105"/> 2105:     {ok,E} = erl_parse:parse_exprs(Toks),
<a name="2106"/> 2106:     {value,Val,_Bs} = erl_eval:exprs(E, []),
<a name="2107"/> 2107:     Anno = erl_anno:new(0),
<a name="test-last_expr"/><a name="2108"/> 2108: <b>    {match,Anno,{atom,Anno,Val},hd</b>(E)}.
<a name="2109"/> 2109: 
<a name="smoke_disasm-3"/><a name="2110"/> 2110: <b>smoke_disasm</b>(Config, Mod, Bin) -&gt;
<a name="2111"/> 2111:     Priv = proplists:get_value(priv_dir, Config),
<a name="2112"/> 2112:     File = filename:join(Priv, atom_to_list(Mod)++&quot;.beam&quot;),
<a name="2113"/> 2113:     ok = file:write_file(File, Bin),
<a name="smoke_disasm-last_expr"/><a name="2114"/> 2114: <b>    test_lib:smoke_disasm</b>(File).
<a name="2115"/> 2115: 
<a name="literals-0"/><a name="2116"/> 2116: <b>literals</b>() -&gt;
<a name="literals-last_expr"/><a name="2117"/> 2117:     [42,
<a name="2118"/> 2118:      3.14,
<a name="2119"/> 2119:      -3,
<a name="2120"/> 2120:      32982724987789283473473838474,
<a name="2121"/> 2121:      [],
<a name="2122"/> 2122:      xxxx,
<a name="2123"/> 2123:      {a,b,c},
<a name="2124"/> 2124:      [a,list],
<a name="2125"/> 2125:      &lt;&lt;1,2,3&gt;&gt;,
<a name="2126"/> 2126:      &lt;&lt;42:17&gt;&gt;].
<a name="2127"/> 2127: 
<a name="type_tests-0"/><a name="2128"/> 2128: <b>type_tests</b>() -&gt;
<a name="type_tests-last_expr"/><a name="2129"/> 2129:     [is_boolean,
<a name="2130"/> 2130:      is_integer,
<a name="2131"/> 2131:      is_float,
<a name="2132"/> 2132:      is_number,
<a name="2133"/> 2133:      is_atom,
<a name="2134"/> 2134:      is_list,
<a name="2135"/> 2135:      is_tuple,
<a name="2136"/> 2136:      is_pid,
<a name="2137"/> 2137:      is_reference,
<a name="2138"/> 2138:      is_port,
<a name="2139"/> 2139:      is_binary,
<a name="2140"/> 2140:      is_bitstring,
<a name="2141"/> 2141:      is_function,
<a name="2142"/> 2142:      is_map].
<a name="2143"/> 2143: 
<a name="basic_andalso_orelse-1"/><a name="2144"/> 2144: <b>basic_andalso_orelse</b>(Config) when is_list(Config) -&gt;
<a name="2145"/> 2145:     T = id({type,integers,23,42}),
<a name="2146"/> 2146:     65 = if
<a name="2147"/> 2147: 	     ((element(1, T) =:= type) andalso (tuple_size(T) =:= 4) andalso
<a name="2148"/> 2148: 	      element(2, T)) == integers -&gt;
<a name="2149"/> 2149: 		 element(3, T) + element(4, T);
<a name="2150"/> 2150: 	     true -&gt; error
<a name="2151"/> 2151: 	 end,
<a name="2152"/> 2152:     65 = case [] of
<a name="2153"/> 2153: 	     [] when ((element(1, T) =:= type) andalso (tuple_size(T) =:= 4) andalso
<a name="2154"/> 2154: 		      element(2, T)) == integers -&gt;
<a name="2155"/> 2155: 		 element(3, T) + element(4, T)
<a name="2156"/> 2156: 	 end,
<a name="2157"/> 2157: 
<a name="2158"/> 2158:     42 = basic_rt({type,integers,40,2}),
<a name="2159"/> 2159:     5.0 = basic_rt({vector,{3.0,4.0}}),
<a name="2160"/> 2160:     20 = basic_rt(['+',3,7]),
<a name="2161"/> 2161:     {'Set',a,b} = basic_rt({{'Set',a,b},{'Set',a,b}}),
<a name="2162"/> 2162:     12 = basic_rt({klurf,4}),
<a name="2163"/> 2163: 
<a name="2164"/> 2164:     error = basic_rt({type,integers,40,2,3}),
<a name="2165"/> 2165:     error = basic_rt({kalle,integers,40,2}),
<a name="2166"/> 2166:     error = basic_rt({kalle,integers,40,2}),
<a name="2167"/> 2167:     error = basic_rt({1,2}),
<a name="2168"/> 2168:     error = basic_rt([]),
<a name="2169"/> 2169: 
<a name="2170"/> 2170:     RelProdBody =
<a name="2171"/> 2171: 	fun(R1, R2) -&gt;
<a name="2172"/> 2172: 		if
<a name="2173"/> 2173: 		    (erlang:size(R1) =:= 3) andalso (erlang:element(1,R1) =:= 'Set'),
<a name="2174"/> 2174: 		    (erlang:size(R2) =:= 3) andalso (erlang:element(1,R2) =:= 'Set') -&gt;
<a name="2175"/> 2175: 			ok
<a name="2176"/> 2176: 		end
<a name="2177"/> 2177: 	end,
<a name="2178"/> 2178: 
<a name="2179"/> 2179:     ok = RelProdBody({'Set',a,b}, {'Set',a,b}),
<a name="2180"/> 2180: 
<a name="2181"/> 2181:     %% 'andalso'/'orelse' with calls known to fail already at compile time.
<a name="2182"/> 2182:     %% Used to crash the code generator.
<a name="2183"/> 2183:     error = (fun() -&gt;
<a name="2184"/> 2184: 		     R = {vars,true},
<a name="2185"/> 2185: 		     if
<a name="2186"/> 2186: 			 is_record(R, vars, 2) andalso element(99, R) -&gt; ok;
<a name="2187"/> 2187: 			 true -&gt; error
<a name="2188"/> 2188: 		     end
<a name="2189"/> 2189: 	     end)(),
<a name="2190"/> 2190:     error = (fun(X) -&gt;
<a name="2191"/> 2191: 		     L = {a,b,c},
<a name="2192"/> 2192: 		     if
<a name="2193"/> 2193: 			 is_list(X) andalso length(L) &gt; 4 -&gt; ok;
<a name="2194"/> 2194: 			 true -&gt; error
<a name="2195"/> 2195: 		     end
<a name="2196"/> 2196: 	     end)([]),
<a name="basic_andalso_orelse-last_expr"/><a name="2197"/> 2197:     ok.
<a name="2198"/> 2198: 
<a name="basic_rt-1"/><a name="2199"/> 2199: <b>basic_rt</b>(T) when is_tuple(T) andalso tuple_size(T) =:= 4 andalso element(1, T) =:= type andalso
<a name="2200"/> 2200: 		 element(2, T) == integers -&gt;
<a name="2201"/> 2201:     element(3, T) + element(4, T);
<a name="2202"/> 2202: <b>basic_rt</b>(T) when is_tuple(T) andalso tuple_size(T) =:= 2 andalso element(1, T) =:= vector -&gt;
<a name="2203"/> 2203:     {X,Y} = element(2, T),
<a name="2204"/> 2204:     if
<a name="2205"/> 2205: 	is_float(X), is_float(Y) -&gt;
<a name="2206"/> 2206: 	    math:sqrt(X*X+Y*Y)
<a name="2207"/> 2207:     end;
<a name="2208"/> 2208: <b>basic_rt</b>(['+',A,B]) -&gt;
<a name="2209"/> 2209:     2*id(A+B);
<a name="2210"/> 2210: <b>basic_rt</b>({R1,R2}) when erlang:size(R1) =:= 3 andalso erlang:element(1,R1) =:= 'Set',
<a name="2211"/> 2211: 		       erlang:size(R2) =:= 3 andalso erlang:element(1,R2) =:= 'Set' -&gt;
<a name="2212"/> 2212:     R1 = id(R1),
<a name="2213"/> 2213:     R2 = id(R2),
<a name="2214"/> 2214:     R1;
<a name="2215"/> 2215: <b>basic_rt</b>(T) when is_tuple(T) andalso tuple_size(T) =:= 2 andalso element(1, T) =:= klurf -&gt;
<a name="2216"/> 2216:     3*id(element(2, T));
<a name="2217"/> 2217: <b>basic_rt</b>(_) -&gt;
<a name="basic_rt-last_expr"/><a name="2218"/> 2218:     error.
<a name="2219"/> 2219: 
<a name="traverse_dcd-1"/><a name="2220"/> 2220: <b>traverse_dcd</b>(Config) when is_list(Config) -&gt;
<a name="2221"/> 2221:     L0 = [{log_header,dcd_log,&quot;1.0&quot;,a,b,c},{log_header,dcd_log,&quot;2.0&quot;,a,b,c},
<a name="2222"/> 2222: 	  {log_header,dcd_log,&quot;0.0&quot;,a,b,c},blurf],
<a name="2223"/> 2223:     {cont,[{log_header,dcd_log,&quot;0.0&quot;,a,b,c},blurf],log,funny} = 
<a name="2224"/> 2224: 	traverse_dcd({cont,L0}, log, funny),
<a name="2225"/> 2225:     L1 = [{log_header,dcd_log,&quot;1.0&quot;}],
<a name="2226"/> 2226:     {cont,L1,log,funny} = traverse_dcd({cont,L1}, log, funny),
<a name="2227"/> 2227:     L2 = [{a,tuple}],
<a name="2228"/> 2228:     {cont,L2,log,funny} = traverse_dcd({cont,L2}, log, funny),
<a name="traverse_dcd-last_expr"/><a name="2229"/> 2229:     ok.
<a name="2230"/> 2230: 
<a name="2231"/> 2231: <i>%% The function starts out with 3 arguments in {x,0}, {x,1}, {x,2}.</i>
<a name="2232"/> 2232: <i>%% The outer match of a two tuple will places the first element in {x,3} and</i>
<a name="2233"/> 2233: <i>%% second in {x,4}. The guard for the first clause must make ensure that all of those</i>
<a name="2234"/> 2234: <i>%% registers are restored before entering the second clause.</i>
<a name="2235"/> 2235: <i>%%</i>
<a name="2236"/> 2236: <i>%% (From mnesia_checkpoint.erl, modified.)</i>
<a name="2237"/> 2237: 
<a name="traverse_dcd-3"/><a name="2238"/> 2238: <b>traverse_dcd</b>({Cont,[LogH|Rest]},Log,Fun)
<a name="2239"/> 2239:   when is_tuple(LogH) andalso tuple_size(LogH) =:= 6 andalso element(1, LogH) =:= log_header
<a name="2240"/> 2240: andalso erlang:element(2,LogH) == dcd_log,
<a name="2241"/> 2241: is_tuple(LogH) andalso tuple_size(LogH) =:= 6 andalso element(1, LogH) =:= log_header
<a name="2242"/> 2242: andalso erlang:element(3,LogH) &gt;= &quot;1.0&quot; -&gt;
<a name="2243"/> 2243:     traverse_dcd({Cont,Rest},Log,Fun);
<a name="2244"/> 2244: <b>traverse_dcd</b>({Cont,Recs},Log,Fun) -&gt;
<a name="traverse_dcd-last_expr"/><a name="2245"/> 2245:     {Cont,Recs,Log,Fun}.
<a name="2246"/> 2246: 
<a name="2247"/> 2247: 
<a name="check_qlc_hrl-1"/><a name="2248"/> 2248: <b>check_qlc_hrl</b>(Config) when is_list(Config) -&gt;
<a name="2249"/> 2249:     St = {r1,false,dum},
<a name="2250"/> 2250:     foo = cqlc(qlc, q, [{lc,1,2,3}], St),
<a name="2251"/> 2251:     foo = cqlc(qlc, q, [{lc,1,2,3},b], St),
<a name="2252"/> 2252:     St = cqlc(qlc, q, [], St),
<a name="2253"/> 2253:     St = cqlc(qlc, blurf, [{lc,1,2,3},b], St),
<a name="2254"/> 2254:     St = cqlc(q, q, [{lc,1,2,3},b], St),
<a name="2255"/> 2255:     St = cqlc(qlc, q, [{lc,1,2,3},b,c], St),
<a name="2256"/> 2256:     St = cqlc(qlc, q, [a,b], St),
<a name="2257"/> 2257:     {r1,true,kalle} = cqlc(qlc, q, [{lc,1,2,3},b], {r1,true,kalle}),
<a name="check_qlc_hrl-last_expr"/><a name="2258"/> 2258:     ok.
<a name="2259"/> 2259: 
<a name="2260"/> 2260: <i>%% From erl_lint.erl; original name was check_qlc_hrl/4.</i>
<a name="cqlc-4"/><a name="2261"/> 2261: <b>cqlc</b>(M, F, As, St) -&gt;
<a name="2262"/> 2262:     Arity = length(As),
<a name="cqlc-last_expr"/><a name="2263"/> 2263:     case As of
<a name="2264"/> 2264:         [{lc,_L,_E,_Qs}|_] when M =:= qlc, F =:= q, 
<a name="2265"/> 2265:                                 Arity &lt; 3, 
<a name="2266"/> 2266:                                 not (((element(1, St) =:= r1) orelse fail) and (tuple_size(St) =:= 3) and element(2, St)) -&gt;
<a name="2267"/> 2267:             foo;
<a name="2268"/> 2268:         _ -&gt;
<a name="2269"/> 2269:             St
<a name="2270"/> 2270:     end.
<a name="2271"/> 2271: 
<a name="2272"/> 2272: <i>%% OTP-7679: Thanks to Hunter Morris.</i>
<a name="andalso_semi-1"/><a name="2273"/> 2273: <b>andalso_semi</b>(Config) when is_list(Config) -&gt;
<a name="2274"/> 2274:     ok = andalso_semi_foo(0),
<a name="2275"/> 2275:     ok = andalso_semi_foo(1),
<a name="2276"/> 2276:     fc(catch andalso_semi_foo(2)),
<a name="2277"/> 2277: 
<a name="2278"/> 2278:     ok = andalso_semi_bar([a,b,c]),
<a name="2279"/> 2279:     ok = andalso_semi_bar(1),
<a name="2280"/> 2280:     fc(catch andalso_semi_bar([a,b])),
<a name="2281"/> 2281: 
<a name="2282"/> 2282:     ok = andalso_semi_dispatch(name, fun andalso_semi/1),
<a name="2283"/> 2283:     ok = andalso_semi_dispatch(name, fun ?MODULE:andalso_semi/1),
<a name="2284"/> 2284:     ok = andalso_semi_dispatch(name, {?MODULE,andalso_semi,1}),
<a name="2285"/> 2285:     fc(catch andalso_semi_dispatch(42, fun andalso_semi/1)),
<a name="2286"/> 2286:     fc(catch andalso_semi_dispatch(name, not_fun)),
<a name="2287"/> 2287:     fc(catch andalso_semi_dispatch(name, fun andalso_semi_dispatch/2)),
<a name="2288"/> 2288:     fc(catch andalso_semi_dispatch(42, {a,b})),
<a name="2289"/> 2289: 
<a name="andalso_semi-last_expr"/><a name="2290"/> 2290:     ok.
<a name="2291"/> 2291: 
<a name="andalso_semi_foo-1"/><a name="2292"/> 2292: <b>andalso_semi_foo</b>(Bar) when is_integer(Bar) andalso Bar =:= 0; Bar =:= 1 -&gt;
<a name="andalso_semi_foo-last_expr"/><a name="2293"/> 2293:    ok.
<a name="2294"/> 2294: 
<a name="andalso_semi_bar-1"/><a name="2295"/> 2295: <b>andalso_semi_bar</b>(Bar) when is_list(Bar) andalso length(Bar) =:= 3; Bar =:= 1 -&gt;
<a name="andalso_semi_bar-last_expr"/><a name="2296"/> 2296:    ok.
<a name="2297"/> 2297: 
<a name="andalso_semi_dispatch-2"/><a name="2298"/> 2298: <b>andalso_semi_dispatch</b>(Registry, MFAOrFun) when
<a name="2299"/> 2299:       is_atom(Registry) andalso is_function(MFAOrFun, 1);
<a name="2300"/> 2300:       is_atom(Registry) andalso tuple_size(MFAOrFun) == 3 -&gt;
<a name="andalso_semi_dispatch-last_expr"/><a name="2301"/> 2301:     ok.
<a name="2302"/> 2302: 
<a name="t_tuple_size-1"/><a name="2303"/> 2303: <b>t_tuple_size</b>(Config) when is_list(Config) -&gt;
<a name="2304"/> 2304:     10 = do_tuple_size({1,2,3,4}),
<a name="2305"/> 2305:     fc(catch do_tuple_size({1,2,3})),
<a name="2306"/> 2306:     fc(catch do_tuple_size(42)),
<a name="2307"/> 2307: 
<a name="2308"/> 2308:     error = ludicrous_tuple_size({a,b,c}),
<a name="2309"/> 2309:     error = ludicrous_tuple_size([a,b,c]),
<a name="2310"/> 2310: 
<a name="2311"/> 2311:     good_ip({1,2,3,4}),
<a name="2312"/> 2312:     good_ip({1,2,3,4,5,6,7,8}),
<a name="2313"/> 2313:     error = validate_ip({42,11}),
<a name="2314"/> 2314:     error = validate_ip(atom),
<a name="2315"/> 2315:     
<a name="t_tuple_size-last_expr"/><a name="2316"/> 2316:     ok.
<a name="2317"/> 2317: 
<a name="do_tuple_size-1"/><a name="2318"/> 2318: <b>do_tuple_size</b>(T) when tuple_size(T) =:= 4 -&gt;
<a name="2319"/> 2319:     {A,B,C,D} = T,
<a name="do_tuple_size-last_expr"/><a name="2320"/> 2320:     A+B+C+D.
<a name="2321"/> 2321: 
<a name="ludicrous_tuple_size-1"/><a name="2322"/> 2322: <b>ludicrous_tuple_size</b>(T)
<a name="2323"/> 2323:   when tuple_size(T) =:= 16#7777777777777777777777777777777777 -&gt; ok;
<a name="2324"/> 2324: <b>ludicrous_tuple_size</b>(T)
<a name="2325"/> 2325:   when tuple_size(T) =:= 16#10000000000000000 -&gt; ok;
<a name="2326"/> 2326: <b>ludicrous_tuple_size</b>(T)
<a name="2327"/> 2327:   when tuple_size(T) =:= (1 bsl 64) - 1 -&gt; ok;
<a name="2328"/> 2328: <b>ludicrous_tuple_size</b>(T)
<a name="2329"/> 2329:   when tuple_size(T) =:= 16#FFFFFFFFFFFFFFFF -&gt; ok;
<a name="ludicrous_tuple_size-last_expr"/><a name="2330"/> 2330: <b>ludicrous_tuple_size</b>(_) -&gt; error.
<a name="2331"/> 2331: 
<a name="good_ip-1"/><a name="2332"/> 2332: <b>good_ip</b>(IP) -&gt;
<a name="good_ip-last_expr"/><a name="2333"/> 2333: <b>    IP = validate_ip</b>(IP).
<a name="2334"/> 2334: 
<a name="validate_ip-1"/><a name="2335"/> 2335: <b>validate_ip</b>(Value) when is_tuple(Value) andalso
<a name="2336"/> 2336:                         ((size(Value) =:= 4) orelse (size(Value) =:= 8)) -&gt;
<a name="2337"/> 2337:     %% size/1 (converted to tuple_size) used more than once.
<a name="2338"/> 2338:     Value;
<a name="2339"/> 2339: <b>validate_ip</b>(_) -&gt;
<a name="validate_ip-last_expr"/><a name="2340"/> 2340:     error.
<a name="2341"/> 2341: 
<a name="2342"/> 2342: <i>%%</i>
<a name="2343"/> 2343: <i>%% The binary_part/2,3 guard BIFs</i>
<a name="2344"/> 2344: <i>%%</i>
<a name="2345"/> 2345: <b>-define</b>(MASK_ERROR(EXPR),mask_error((catch (EXPR)))).
<a name="mask_error-1"/><a name="2346"/> 2346: <b>mask_error</b>({'EXIT',{Err,_}}) -&gt;
<a name="2347"/> 2347:     Err;
<a name="2348"/> 2348: <b>mask_error</b>(Else) -&gt;
<a name="mask_error-last_expr"/><a name="2349"/> 2349:     Else.
<a name="2350"/> 2350: 
<a name="2351"/> 2351: <i>%% Test the binary_part/2,3 guard (GC) BIFs.</i>
<a name="binary_part-1"/><a name="2352"/> 2352: <b>binary_part</b>(Config) when is_list(Config) -&gt;
<a name="2353"/> 2353:     %% This is more or less a copy of what the guard_SUITE in emulator
<a name="2354"/> 2354:     %% does to cover the guard bif's
<a name="2355"/> 2355:     1 = bptest(&lt;&lt;1,2,3&gt;&gt;),
<a name="2356"/> 2356:     2 = bptest(&lt;&lt;2,1,3&gt;&gt;),
<a name="2357"/> 2357:     error = bptest(&lt;&lt;1&gt;&gt;),
<a name="2358"/> 2358:     error = bptest(&lt;&lt;&gt;&gt;),
<a name="2359"/> 2359:     error = bptest(apa),
<a name="2360"/> 2360:     3 = bptest(&lt;&lt;2,3,3&gt;&gt;),
<a name="2361"/> 2361:     % With one variable (pos)
<a name="2362"/> 2362:     1 = bptest(&lt;&lt;1,2,3&gt;&gt;,1),
<a name="2363"/> 2363:     2 = bptest(&lt;&lt;2,1,3&gt;&gt;,1),
<a name="2364"/> 2364:     error = bptest(&lt;&lt;1&gt;&gt;,1),
<a name="2365"/> 2365:     error = bptest(&lt;&lt;&gt;&gt;,1),
<a name="2366"/> 2366:     error = bptest(apa,1),
<a name="2367"/> 2367:     3 = bptest(&lt;&lt;2,3,3&gt;&gt;,1),
<a name="2368"/> 2368:     % With one variable (length)
<a name="2369"/> 2369:     1 = bptesty(&lt;&lt;1,2,3&gt;&gt;,1),
<a name="2370"/> 2370:     2 = bptesty(&lt;&lt;2,1,3&gt;&gt;,1),
<a name="2371"/> 2371:     error = bptesty(&lt;&lt;1&gt;&gt;,1),
<a name="2372"/> 2372:     error = bptesty(&lt;&lt;&gt;&gt;,1),
<a name="2373"/> 2373:     error = bptesty(apa,1),
<a name="2374"/> 2374:     3 = bptesty(&lt;&lt;2,3,3&gt;&gt;,2),
<a name="2375"/> 2375:     % With one variable (whole tuple)
<a name="2376"/> 2376:     1 = bptestx(&lt;&lt;1,2,3&gt;&gt;,{1,1}),
<a name="2377"/> 2377:     2 = bptestx(&lt;&lt;2,1,3&gt;&gt;,{1,1}),
<a name="2378"/> 2378:     error = bptestx(&lt;&lt;1&gt;&gt;,{1,1}),
<a name="2379"/> 2379:     error = bptestx(&lt;&lt;&gt;&gt;,{1,1}),
<a name="2380"/> 2380:     error = bptestx(apa,{1,1}),
<a name="2381"/> 2381:     3 = bptestx(&lt;&lt;2,3,3&gt;&gt;,{1,2}),
<a name="2382"/> 2382:     % With two variables
<a name="2383"/> 2383:     1 = bptest(&lt;&lt;1,2,3&gt;&gt;,1,1),
<a name="2384"/> 2384:     2 = bptest(&lt;&lt;2,1,3&gt;&gt;,1,1),
<a name="2385"/> 2385:     error = bptest(&lt;&lt;1&gt;&gt;,1,1),
<a name="2386"/> 2386:     error = bptest(&lt;&lt;&gt;&gt;,1,1),
<a name="2387"/> 2387:     error = bptest(apa,1,1),
<a name="2388"/> 2388:     3 = bptest(&lt;&lt;2,3,3&gt;&gt;,1,2),
<a name="2389"/> 2389:     % Direct (autoimported) call, these will be evaluated by the compiler...
<a name="2390"/> 2390:     &lt;&lt;2&gt;&gt; = binary_part(&lt;&lt;1,2,3&gt;&gt;,1,1),
<a name="2391"/> 2391:     &lt;&lt;1&gt;&gt; = binary_part(&lt;&lt;2,1,3&gt;&gt;,1,1),
<a name="2392"/> 2392:     % Compiler warnings due to constant evaluation expected (3)
<a name="2393"/> 2393:     badarg = ?MASK_ERROR(binary_part(&lt;&lt;1&gt;&gt;,1,1)),
<a name="2394"/> 2394:     badarg = ?MASK_ERROR(binary_part(&lt;&lt;&gt;&gt;,1,1)),
<a name="2395"/> 2395:     badarg = ?MASK_ERROR(binary_part(apa,1,1)),
<a name="2396"/> 2396:     &lt;&lt;3,3&gt;&gt; = binary_part(&lt;&lt;2,3,3&gt;&gt;,1,2),
<a name="2397"/> 2397:     % Direct call through apply
<a name="2398"/> 2398:     &lt;&lt;2&gt;&gt; = apply(erlang,binary_part,[&lt;&lt;1,2,3&gt;&gt;,1,1]),
<a name="2399"/> 2399:     &lt;&lt;1&gt;&gt; = apply(erlang,binary_part,[&lt;&lt;2,1,3&gt;&gt;,1,1]),
<a name="2400"/> 2400:     % Compiler warnings due to constant evaluation expected (3)
<a name="2401"/> 2401:     badarg = ?MASK_ERROR(apply(erlang,binary_part,[&lt;&lt;1&gt;&gt;,1,1])),
<a name="2402"/> 2402:     badarg = ?MASK_ERROR(apply(erlang,binary_part,[&lt;&lt;&gt;&gt;,1,1])),
<a name="2403"/> 2403:     badarg = ?MASK_ERROR(apply(erlang,binary_part,[apa,1,1])),
<a name="2404"/> 2404:     &lt;&lt;3,3&gt;&gt; = apply(erlang,binary_part,[&lt;&lt;2,3,3&gt;&gt;,1,2]),
<a name="2405"/> 2405:     % Constant propagation
<a name="2406"/> 2406:      Bin = &lt;&lt;1,2,3&gt;&gt;,
<a name="2407"/> 2407:      ok = if
<a name="2408"/> 2408: 		    binary_part(Bin,1,1) =:= &lt;&lt;2&gt;&gt; -&gt;
<a name="2409"/> 2409: 			ok;
<a name="2410"/> 2410: 		    %% Compiler warning, clause cannot match (expected)
<a name="2411"/> 2411: 		    true -&gt;
<a name="2412"/> 2412: 			error
<a name="2413"/> 2413: 		end,
<a name="2414"/> 2414:      ok = if
<a name="2415"/> 2415: 		    binary_part(Bin,{1,1}) =:= &lt;&lt;2&gt;&gt; -&gt;
<a name="2416"/> 2416: 			ok;
<a name="2417"/> 2417: 		    %% Compiler warning, clause cannot match (expected)
<a name="2418"/> 2418: 		    true -&gt;
<a name="2419"/> 2419: 			error
<a name="2420"/> 2420: 		end,
<a name="2421"/> 2421:     error = bp_coverage_1(id(&lt;&lt;&gt;&gt;)),
<a name="2422"/> 2422: 
<a name="binary_part-last_expr"/><a name="2423"/> 2423:     ok.
<a name="2424"/> 2424: 
<a name="2425"/> 2425: 
<a name="bptest-1"/><a name="2426"/> 2426: <b>bptest</b>(B) when length(B) =:= 1337 -&gt;
<a name="2427"/> 2427:     1;
<a name="2428"/> 2428: <b>bptest</b>(B) when binary_part(B,{1,1}) =:= &lt;&lt;2&gt;&gt; -&gt;
<a name="2429"/> 2429:     1;
<a name="2430"/> 2430: <b>bptest</b>(B) when erlang:binary_part(B,1,1) =:= &lt;&lt;1&gt;&gt; -&gt;
<a name="2431"/> 2431:     2;
<a name="2432"/> 2432: <b>bptest</b>(B)  when erlang:binary_part(B,{1,2}) =:= &lt;&lt;3,3&gt;&gt; -&gt;
<a name="2433"/> 2433:     3;
<a name="2434"/> 2434: <b>bptest</b>(_) -&gt;
<a name="bptest-last_expr"/><a name="2435"/> 2435:     error.
<a name="2436"/> 2436: 
<a name="bptest-2"/><a name="2437"/> 2437: <b>bptest</b>(B,A) when length(B) =:= A -&gt;
<a name="2438"/> 2438:     1;
<a name="2439"/> 2439: <b>bptest</b>(B,A) when binary_part(B,{A,1}) =:= &lt;&lt;2&gt;&gt; -&gt;
<a name="2440"/> 2440:     1;
<a name="2441"/> 2441: <b>bptest</b>(B,A) when erlang:binary_part(B,A,1) =:= &lt;&lt;1&gt;&gt; -&gt;
<a name="2442"/> 2442:     2;
<a name="2443"/> 2443: <b>bptest</b>(B,A)  when erlang:binary_part(B,{A,2}) =:= &lt;&lt;3,3&gt;&gt; -&gt;
<a name="2444"/> 2444:     3;
<a name="2445"/> 2445: <b>bptest</b>(_,_) -&gt;
<a name="bptest-last_expr"/><a name="2446"/> 2446:     error.
<a name="2447"/> 2447: 
<a name="bptestx-2"/><a name="2448"/> 2448: <b>bptestx</b>(B,A) when length(B) =:= A -&gt;
<a name="2449"/> 2449:     1;
<a name="2450"/> 2450: <b>bptestx</b>(B,A) when binary_part(B,A) =:= &lt;&lt;2&gt;&gt; -&gt;
<a name="2451"/> 2451:     1;
<a name="2452"/> 2452: <b>bptestx</b>(B,A) when erlang:binary_part(B,A) =:= &lt;&lt;1&gt;&gt; -&gt;
<a name="2453"/> 2453:     2;
<a name="2454"/> 2454: <b>bptestx</b>(B,A)  when erlang:binary_part(B,A) =:= &lt;&lt;3,3&gt;&gt; -&gt;
<a name="2455"/> 2455:     3;
<a name="2456"/> 2456: <b>bptestx</b>(_,_) -&gt;
<a name="bptestx-last_expr"/><a name="2457"/> 2457:     error.
<a name="2458"/> 2458: 
<a name="bptesty-2"/><a name="2459"/> 2459: <b>bptesty</b>(B,A) when length(B) =:= A -&gt;
<a name="2460"/> 2460:     1;
<a name="2461"/> 2461: <b>bptesty</b>(B,A) when binary_part(B,{1,A}) =:= &lt;&lt;2&gt;&gt; -&gt;
<a name="2462"/> 2462:     1;
<a name="2463"/> 2463: <b>bptesty</b>(B,A) when erlang:binary_part(B,1,A) =:= &lt;&lt;1&gt;&gt; -&gt;
<a name="2464"/> 2464:     2;
<a name="2465"/> 2465: <b>bptesty</b>(B,A)  when erlang:binary_part(B,{1,A}) =:= &lt;&lt;3,3&gt;&gt; -&gt;
<a name="2466"/> 2466:     3;
<a name="2467"/> 2467: <b>bptesty</b>(_,_) -&gt;
<a name="bptesty-last_expr"/><a name="2468"/> 2468:     error.
<a name="2469"/> 2469: 
<a name="bptest-3"/><a name="2470"/> 2470: <b>bptest</b>(B,A,_C) when length(B) =:= A -&gt;
<a name="2471"/> 2471:     1;
<a name="2472"/> 2472: <b>bptest</b>(B,A,C) when binary_part(B,{A,C}) =:= &lt;&lt;2&gt;&gt; -&gt;
<a name="2473"/> 2473:     1;
<a name="2474"/> 2474: <b>bptest</b>(B,A,C) when erlang:binary_part(B,A,C) =:= &lt;&lt;1&gt;&gt; -&gt;
<a name="2475"/> 2475:     2;
<a name="2476"/> 2476: <b>bptest</b>(B,A,C)  when erlang:binary_part(B,{A,C}) =:= &lt;&lt;3,3&gt;&gt; -&gt;
<a name="2477"/> 2477:     3;
<a name="2478"/> 2478: <b>bptest</b>(_,_,_) -&gt;
<a name="bptest-last_expr"/><a name="2479"/> 2479:     error.
<a name="2480"/> 2480: 
<a name="bp_coverage_1-1"/><a name="2481"/> 2481: <b>bp_coverage_1</b>(A) when binary_part(A, A, floor(float(0))) -&gt;
<a name="2482"/> 2482:     ok;
<a name="2483"/> 2483: <b>bp_coverage_1</b>(_) -&gt;
<a name="bp_coverage_1-last_expr"/><a name="2484"/> 2484:     error.
<a name="2485"/> 2485: 
<a name="2486"/> 2486: <b>-define</b>(FAILING(C),
<a name="2487"/> 2487: 	if
<a name="2488"/> 2488: 	    C -&gt; ct:fail(should_fail);
<a name="2489"/> 2489: 	    true -&gt; ok
<a name="2490"/> 2490: 	end,
<a name="2491"/> 2491: 	if
<a name="2492"/> 2492: 	    true, C -&gt; ct:fail(should_fail);
<a name="2493"/> 2493: 	    true -&gt; ok
<a name="2494"/> 2494: 	end).
<a name="2495"/> 2495: 
<a name="bad_constants-1"/><a name="2496"/> 2496: <b>bad_constants</b>(Config) when is_list(Config) -&gt;
<a name="2497"/> 2497:     ?FAILING(false),
<a name="2498"/> 2498:     ?FAILING([]),
<a name="2499"/> 2499:     ?FAILING([a]),
<a name="2500"/> 2500:     ?FAILING([Config]),
<a name="2501"/> 2501:     ?FAILING({a,b}),
<a name="2502"/> 2502:     ?FAILING({a,Config}),
<a name="2503"/> 2503:     ?FAILING(&lt;&lt;1&gt;&gt;),
<a name="2504"/> 2504:     ?FAILING(42),
<a name="2505"/> 2505:     ?FAILING(3.14),
<a name="bad_constants-last_expr"/><a name="2506"/> 2506:     ok.
<a name="2507"/> 2507: 
<a name="bad_guards-1"/><a name="2508"/> 2508: <b>bad_guards</b>(Config) when is_list(Config) -&gt;
<a name="2509"/> 2509:     if erlang:float(self()); true -&gt; ok end,
<a name="2510"/> 2510: 
<a name="2511"/> 2511:     fc(catch bad_guards_1(1, [])),
<a name="2512"/> 2512:     fc(catch bad_guards_1(1, [2])),
<a name="2513"/> 2513:     fc(catch bad_guards_1(atom, [2])),
<a name="2514"/> 2514: 
<a name="2515"/> 2515:     fc(catch bad_guards_2(#{a=&gt;0,b=&gt;0}, [])),
<a name="2516"/> 2516:     fc(catch bad_guards_2(#{a=&gt;0,b=&gt;0}, [x])),
<a name="2517"/> 2517:     fc(catch bad_guards_2(not_a_map, [x])),
<a name="2518"/> 2518:     fc(catch bad_guards_2(42, [x])),
<a name="2519"/> 2519: 
<a name="2520"/> 2520:     fc(catch bad_guards_3(#{a=&gt;0,b=&gt;0}, [])),
<a name="2521"/> 2521:     fc(catch bad_guards_3(#{a=&gt;0,b=&gt;0}, [x])),
<a name="2522"/> 2522:     fc(catch bad_guards_3(not_a_map, [x])),
<a name="2523"/> 2523:     fc(catch bad_guards_3(42, [x])),
<a name="2524"/> 2524: 
<a name="2525"/> 2525:     fc(catch bad_guards_4()),
<a name="2526"/> 2526: 
<a name="2527"/> 2527:     {0,undefined} = bad_guards_5(id(&lt;&lt;&gt;&gt;), id(undefined)),
<a name="2528"/> 2528: 
<a name="bad_guards-last_expr"/><a name="2529"/> 2529:     ok.
<a name="2530"/> 2530: 
<a name="2531"/> 2531: <i>%% beam_bool used to produce GC BIF instructions whose</i>
<a name="2532"/> 2532: <i>%% Live operands included uninitialized registers.</i>
<a name="2533"/> 2533: 
<a name="bad_guards_1-2"/><a name="2534"/> 2534: <b>bad_guards_1</b>(X, [_]) when {{X}}, -X -&gt;
<a name="bad_guards_1-last_expr"/><a name="2535"/> 2535:     ok.
<a name="2536"/> 2536: 
<a name="bad_guards_2-2"/><a name="2537"/> 2537: <b>bad_guards_2</b>(M, [_]) when M#{a := 0, b =&gt; 0}, map_size(M) -&gt;
<a name="bad_guards_2-last_expr"/><a name="2538"/> 2538:     ok.
<a name="2539"/> 2539: 
<a name="2540"/> 2540: <i>%% beam_type used to produce an GC BIF instruction whose Live operand</i>
<a name="2541"/> 2541: <i>%% included uninitialized registers.</i>
<a name="2542"/> 2542: 
<a name="bad_guards_3-2"/><a name="2543"/> 2543: <b>bad_guards_3</b>(M, [_]) when is_map(M) andalso M#{a := 0, b =&gt; 0}, length(M) -&gt;
<a name="bad_guards_3-last_expr"/><a name="2544"/> 2544:     ok.
<a name="2545"/> 2545: 
<a name="2546"/> 2546: <i>%% v3_codegen would generate a jump to the failure label, but</i>
<a name="2547"/> 2547: <i>%% without initializing x(0). The code at the failure label expected</i>
<a name="2548"/> 2548: <i>%% x(0) to be initialized.</i>
<a name="2549"/> 2549: 
<a name="bad_guards_4-0"/><a name="bad_guards_4-last_expr"/><a name="2550"/> 2550: <b>bad_guards_4</b>() when not (error#{}); {not 0.0} -&gt; freedom.
<a name="2551"/> 2551: 
<a name="2552"/> 2552: <i>%% The JIT used to segfault when a guard rem instruction failed</i>
<a name="2553"/> 2553: <i>%% with badarith AND a bif had been called just before it.</i>
<a name="bad_guards_5-2"/><a name="2554"/> 2554: <b>bad_guards_5</b>(A, B) -&gt;
<a name="bad_guards_5-last_expr"/><a name="2555"/> 2555: <b>    {byte_size</b>(A), undefined = bad_guards_5_1(B)}.
<a name="bad_guards_5_1-1"/><a name="2556"/> 2556: <b>bad_guards_5_1</b>(A) when is_integer(A rem 255) -&gt;
<a name="2557"/> 2557:     A rem 255;
<a name="2558"/> 2558: <b>bad_guards_5_1</b>(_) -&gt;
<a name="bad_guards_5_1-last_expr"/><a name="2559"/> 2559:     undefined.
<a name="2560"/> 2560: 
<a name="2561"/> 2561: <i>%% Building maps in a guard in a 'catch' would crash v3_codegen.</i>
<a name="2562"/> 2562: 
<a name="guard_in_catch-1"/><a name="2563"/> 2563: <b>guard_in_catch</b>(_Config) -&gt;
<a name="2564"/> 2564:     {'EXIT',{if_clause,_}} = do_guard_in_catch_map_1(#{}),
<a name="2565"/> 2565:     {'EXIT',{if_clause,_}} = do_guard_in_catch_map_1(#{a=&gt;b}),
<a name="2566"/> 2566:     {'EXIT',{if_clause,_}} = do_guard_in_catch_map_1(atom),
<a name="2567"/> 2567: 
<a name="2568"/> 2568:     {'EXIT',{if_clause,_}} = do_guard_in_catch_map_2(#{}),
<a name="2569"/> 2569:     {'EXIT',{if_clause,_}} = do_guard_in_catch_map_2(#{a=&gt;b}),
<a name="2570"/> 2570:     {'EXIT',{if_clause,_}} = do_guard_in_catch_map_2(atom),
<a name="2571"/> 2571: 
<a name="2572"/> 2572:     {'EXIT',{if_clause,_}} = (catch do_guard_in_catch_map_3()),
<a name="2573"/> 2573: 
<a name="2574"/> 2574:     {'EXIT',{if_clause,_}} = do_guard_in_catch_bin(42),
<a name="2575"/> 2575:     {'EXIT',{if_clause,_}} = do_guard_in_catch_bin(&lt;&lt;1,2,3&gt;&gt;),
<a name="2576"/> 2576:     {'EXIT',{if_clause,_}} = do_guard_in_catch_bin(atom),
<a name="2577"/> 2577:     {'EXIT',{if_clause,_}} = do_guard_in_catch_bin(#{}),
<a name="2578"/> 2578: 
<a name="guard_in_catch-last_expr"/><a name="2579"/> 2579:     ok.
<a name="2580"/> 2580: 
<a name="do_guard_in_catch_map_1-1"/><a name="2581"/> 2581: <b>do_guard_in_catch_map_1</b>(From) -&gt;
<a name="do_guard_in_catch_map_1-last_expr"/><a name="2582"/> 2582:     catch
<a name="2583"/> 2583: 	if
<a name="2584"/> 2584: 	    From#{[] =&gt; sufficient} -&gt;
<a name="2585"/> 2585: 		saint
<a name="2586"/> 2586: 	end.
<a name="2587"/> 2587: 
<a name="do_guard_in_catch_map_2-1"/><a name="2588"/> 2588: <b>do_guard_in_catch_map_2</b>(From) -&gt;
<a name="do_guard_in_catch_map_2-last_expr"/><a name="2589"/> 2589:     catch
<a name="2590"/> 2590: 	if
<a name="2591"/> 2591: 	    From#{From =&gt; sufficient} -&gt;
<a name="2592"/> 2592: 		saint
<a name="2593"/> 2593: 	end.
<a name="2594"/> 2594: 
<a name="do_guard_in_catch_map_3-0"/><a name="2595"/> 2595: <b>do_guard_in_catch_map_3</b>() -&gt;
<a name="do_guard_in_catch_map_3-last_expr"/><a name="2596"/> 2596:     try
<a name="2597"/> 2597: 	if [] -&gt; solo end
<a name="2598"/> 2598:     catch
<a name="2599"/> 2599: 	Friendly when Friendly#{0 =&gt; []} -&gt; minutes
<a name="2600"/> 2600:     after
<a name="2601"/> 2601: 	membership
<a name="2602"/> 2602:     end.
<a name="2603"/> 2603: 
<a name="do_guard_in_catch_bin-1"/><a name="2604"/> 2604: <b>do_guard_in_catch_bin</b>(From) -&gt;
<a name="2605"/> 2605:     %% Would not crash v3_codegen, but there would be an unnecessary
<a name="2606"/> 2606:     %% 'move' to a Y register.
<a name="do_guard_in_catch_bin-last_expr"/><a name="2607"/> 2607:     catch
<a name="2608"/> 2608: 	if
<a name="2609"/> 2609: 	    &lt;&lt;From:32&gt;&gt; -&gt;
<a name="2610"/> 2610: 		saint
<a name="2611"/> 2611: 	end.
<a name="2612"/> 2612: 
<a name="2613"/> 2613: <i>%%%</i>
<a name="2614"/> 2614: <i>%%% The beam_bool pass has been eliminated. Here are the tests from</i>
<a name="2615"/> 2615: <i>%%% beam_bool_SUITE, as well as new tests to test the new beam_ssa_bool</i>
<a name="2616"/> 2616: <i>%%% module.</i>
<a name="2617"/> 2617: <i>%%%</i>
<a name="2618"/> 2618: 
<a name="beam_bool_SUITE-1"/><a name="2619"/> 2619: <b>beam_bool_SUITE</b>(_Config) -&gt;
<a name="2620"/> 2620:     before_and_inside_if(),
<a name="2621"/> 2621:     scotland(),
<a name="2622"/> 2622:     y_registers(),
<a name="2623"/> 2623:     protected(),
<a name="2624"/> 2624:     maps(),
<a name="2625"/> 2625:     cover_shortcut_branches(),
<a name="2626"/> 2626:     wrong_order(),
<a name="2627"/> 2627:     megaco(),
<a name="2628"/> 2628:     looks_like_a_guard(),
<a name="2629"/> 2629:     fail_in_guard(),
<a name="2630"/> 2630:     in_catch(),
<a name="2631"/> 2631:     recv_semi(),
<a name="2632"/> 2632:     andalso_repeated_var(),
<a name="2633"/> 2633:     erl1246(),
<a name="2634"/> 2634:     erl1253(),
<a name="2635"/> 2635:     erl1384(),
<a name="2636"/> 2636:     gh4788(),
<a name="2637"/> 2637:     beam_ssa_bool_coverage(),
<a name="2638"/> 2638:     bad_map_in_guard(),
<a name="2639"/> 2639:     gh_6164(),
<a name="2640"/> 2640:     gh_6184(),
<a name="2641"/> 2641:     gh_7252(),
<a name="2642"/> 2642:     gh_7339(),
<a name="2643"/> 2643:     gh_7370(),
<a name="2644"/> 2644:     gh_7517(),
<a name="beam_bool_SUITE-last_expr"/><a name="2645"/> 2645:     ok.
<a name="2646"/> 2646: 
<a name="before_and_inside_if-0"/><a name="2647"/> 2647: <b>before_and_inside_if</b>() -&gt;
<a name="2648"/> 2648:     no = before_and_inside_if([a], [b], delete),
<a name="2649"/> 2649:     no = before_and_inside_if([a], [b], x),
<a name="2650"/> 2650:     no = before_and_inside_if([a], [], delete),
<a name="2651"/> 2651:     no = before_and_inside_if([a], [], x),
<a name="2652"/> 2652:     no = before_and_inside_if([], [], delete),
<a name="2653"/> 2653:     yes = before_and_inside_if([], [], x),
<a name="2654"/> 2654:     yes = before_and_inside_if([], [b], delete),
<a name="2655"/> 2655:     yes = before_and_inside_if([], [b], x),
<a name="2656"/> 2656: 
<a name="2657"/> 2657:     {ch1,ch2} = before_and_inside_if_2([a], [b], blah),
<a name="2658"/> 2658:     {ch1,ch2} = before_and_inside_if_2([a], [b], xx),
<a name="2659"/> 2659:     {ch1,ch2} = before_and_inside_if_2([a], [], blah),
<a name="2660"/> 2660:     {ch1,ch2} = before_and_inside_if_2([a], [], xx),
<a name="2661"/> 2661:     {no,no} = before_and_inside_if_2([], [b], blah),
<a name="2662"/> 2662:     {no,no} = before_and_inside_if_2([], [b], xx),
<a name="2663"/> 2663:     {ch1,no} = before_and_inside_if_2([], [], blah),
<a name="2664"/> 2664:     {no,ch2} = before_and_inside_if_2([], [], xx),
<a name="before_and_inside_if-last_expr"/><a name="2665"/> 2665:     ok.
<a name="2666"/> 2666: 
<a name="2667"/> 2667: <i>%% Thanks to Simon Cornish and Kostis Sagonas.</i>
<a name="2668"/> 2668: <i>%% Used to crash beam_bool.</i>
<a name="before_and_inside_if-3"/><a name="2669"/> 2669: <b>before_and_inside_if</b>(XDo1, XDo2, Do3) -&gt;
<a name="2670"/> 2670:     Do1 = (XDo1 =/= []),
<a name="2671"/> 2671:     Do2 = (XDo2 =/= []),
<a name="before_and_inside_if-last_expr"/><a name="2672"/> 2672:     if
<a name="2673"/> 2673: 	%% This expression occurs in a try/catch (protected)
<a name="2674"/> 2674: 	%% block, which cannot refer to variables outside of
<a name="2675"/> 2675: 	%% the block that are boolean expressions.
<a name="2676"/> 2676: 	Do1 =:= true;
<a name="2677"/> 2677: 	Do1 =:= false, Do2 =:= false, Do3 =:= delete -&gt;
<a name="2678"/> 2678: 	    no;
<a name="2679"/> 2679:        true -&gt;
<a name="2680"/> 2680: 	    yes
<a name="2681"/> 2681:     end.
<a name="2682"/> 2682: 
<a name="2683"/> 2683: <i>%% Thanks to Simon Cornish.</i>
<a name="2684"/> 2684: <i>%% Used to generate code that would not set {y,0} on</i>
<a name="2685"/> 2685: <i>%% all paths before its use (and therefore fail</i>
<a name="2686"/> 2686: <i>%% validation by the beam_validator).</i>
<a name="before_and_inside_if_2-3"/><a name="2687"/> 2687: <b>before_and_inside_if_2</b>(XDo1, XDo2, Do3) -&gt;
<a name="2688"/> 2688:     Do1    = (XDo1 =/= []),
<a name="2689"/> 2689:     Do2    = (XDo2 =/= []),
<a name="2690"/> 2690:     CH1 = if Do1 == true;
<a name="2691"/> 2691: 	     Do1 == false,Do2==false,Do3 == blah -&gt;
<a name="2692"/> 2692: 		  ch1;
<a name="2693"/> 2693: 	     true -&gt;
<a name="2694"/> 2694: 		  no
<a name="2695"/> 2695: 	  end,
<a name="2696"/> 2696:     CH2 = if Do1 == true;
<a name="2697"/> 2697: 	     Do1 == false,Do2==false,Do3 == xx -&gt;
<a name="2698"/> 2698: 		  ch2;
<a name="2699"/> 2699: 	     true -&gt;
<a name="2700"/> 2700: 		  no
<a name="2701"/> 2701: 	  end,
<a name="before_and_inside_if_2-last_expr"/><a name="2702"/> 2702:     {CH1,CH2}.
<a name="2703"/> 2703: 
<a name="2704"/> 2704: 
<a name="2705"/> 2705: <i>%% beam_bool would remove the initialization of {y,0}.</i>
<a name="2706"/> 2706: <i>%% (Thanks to Thomas Arts and QuickCheck.)</i>
<a name="2707"/> 2707: 
<a name="scotland-0"/><a name="2708"/> 2708: <b>scotland</b>() -&gt;
<a name="2709"/> 2709:     million = do_scotland(placed),
<a name="2710"/> 2710:     {'EXIT',{{badmatch,placed},_}} = (catch do_scotland(false)),
<a name="2711"/> 2711:     {'EXIT',{{badmatch,placed},_}} = (catch do_scotland(true)),
<a name="2712"/> 2712:     {'EXIT',{{badmatch,placed},_}} = (catch do_scotland(echo)),
<a name="scotland-last_expr"/><a name="2713"/> 2713:     ok.
<a name="2714"/> 2714: 
<a name="do_scotland-1"/><a name="2715"/> 2715: <b>do_scotland</b>(Echo) -&gt;
<a name="do_scotland-last_expr"/><a name="2716"/> 2716: <b>  found</b>(case Echo of
<a name="2717"/> 2717: 	    Echo when true; Echo, Echo, Echo -&gt;
<a name="2718"/> 2718: 		Echo;
<a name="2719"/> 2719: 	    echo -&gt;
<a name="2720"/> 2720: 		[]
<a name="2721"/> 2721: 	end,
<a name="2722"/> 2722: 	Echo = placed).
<a name="2723"/> 2723: 
<a name="found-2"/><a name="found-last_expr"/><a name="2724"/> 2724: <b>found</b>(_, _) -&gt; million.
<a name="2725"/> 2725: 
<a name="2726"/> 2726: 
<a name="2727"/> 2727: <i>%% ERL-143: beam_bool could not handle Y registers as a destination.</i>
<a name="y_registers-0"/><a name="2728"/> 2728: <b>y_registers</b>() -&gt;
<a name="2729"/> 2729:     {'EXIT',{badarith,[_|_]}} = (catch baker(valentine)),
<a name="2730"/> 2730:     {'EXIT',{badarith,[_|_]}} = (catch baker(clementine)),
<a name="2731"/> 2731: 
<a name="2732"/> 2732:     {not_ok,true} = potter([]),
<a name="2733"/> 2733:     {ok,false} = potter([{encoding,any}]),
<a name="2734"/> 2734: 
<a name="y_registers-last_expr"/><a name="2735"/> 2735:     ok.
<a name="2736"/> 2736: 
<a name="2737"/> 2737: <i>%% Thanks to Quickcheck.</i>
<a name="baker-1"/><a name="2738"/> 2738: <b>baker</b>(Baker) -&gt;
<a name="baker-last_expr"/><a name="2739"/> 2739: <b>    </b>(valentine == Baker) +
<a name="2740"/> 2740: 	case Baker of
<a name="2741"/> 2741: 	    Baker when Baker; Baker -&gt;
<a name="2742"/> 2742: 		Baker;
<a name="2743"/> 2743: 	    Baker -&gt;
<a name="2744"/> 2744: 		[]
<a name="2745"/> 2745: 	end.
<a name="2746"/> 2746: 
<a name="2747"/> 2747: <i>%% Thanks to Jose Valim.</i>
<a name="potter-1"/><a name="2748"/> 2748: <b>potter</b>(Modes) -&gt;
<a name="2749"/> 2749:     Raw = lists:keyfind(encoding, 1, Modes) == false,
<a name="2750"/> 2750:     Final = case Raw of
<a name="2751"/> 2751: 		X when X == false; X == nil -&gt; ok;
<a name="2752"/> 2752: 		_ -&gt; not_ok
<a name="2753"/> 2753: 	    end,
<a name="potter-last_expr"/><a name="2754"/> 2754:     {Final,Raw}.
<a name="2755"/> 2755: 
<a name="protected-0"/><a name="2756"/> 2756: <b>protected</b>() -&gt;
<a name="2757"/> 2757:     {'EXIT',{if_clause,_}} = (catch photographs({1, surprise, true}, opinions)),
<a name="2758"/> 2758: 
<a name="2759"/> 2759:     {{true}} = welcome({perfect, true}),
<a name="2760"/> 2760:     {'EXIT',{if_clause,_}} = (catch welcome({perfect, false})),
<a name="protected-last_expr"/><a name="2761"/> 2761:     ok.
<a name="2762"/> 2762: 
<a name="photographs-2"/><a name="2763"/> 2763: <b>photographs</b>({_Violation, surprise, Deep}, opinions) -&gt;
<a name="photographs-last_expr"/><a name="2764"/> 2764:     {if
<a name="2765"/> 2765: 	 0; &quot;here&quot;, Deep -&gt;
<a name="2766"/> 2766: 	     Deep = Deep
<a name="2767"/> 2767:      end}.
<a name="2768"/> 2768: 
<a name="welcome-1"/><a name="2769"/> 2769: <b>welcome</b>({perfect, Profit}) -&gt;
<a name="welcome-last_expr"/><a name="2770"/> 2770:     if
<a name="2771"/> 2771: 	Profit, Profit, Profit; 0 -&gt;
<a name="2772"/> 2772: 	    {id({Profit})}
<a name="2773"/> 2773:     end.
<a name="2774"/> 2774: 
<a name="maps-0"/><a name="2775"/> 2775: <b>maps</b>() -&gt;
<a name="maps-last_expr"/><a name="2776"/> 2776: <b>    ok = evidence</b>(#{0 =&gt; 42}).
<a name="2777"/> 2777: 
<a name="2778"/> 2778: <i>%% Cover handling of put_map in in split_block_label_used/2.</i>
<a name="evidence-1"/><a name="2779"/> 2779: <b>evidence</b>(#{0 := Charge}) when 0; #{[] =&gt; Charge} == #{[] =&gt; 42} -&gt;
<a name="evidence-last_expr"/><a name="2780"/> 2780:     ok.
<a name="2781"/> 2781: 
<a name="cover_shortcut_branches-0"/><a name="2782"/> 2782: <b>cover_shortcut_branches</b>() -&gt;
<a name="2783"/> 2783:     ok = cover_shortcut_branches({r1}, 0, 42, false),
<a name="2784"/> 2784:     ok = cover_shortcut_branches({r1}, 42, 42, true),
<a name="2785"/> 2785:     error = cover_shortcut_branches({r1}, same, same, false),
<a name="2786"/> 2786:     error = cover_shortcut_branches({r1}, x, y, true),
<a name="2787"/> 2787:     error = cover_shortcut_branches({r2}, 0, 42, false),
<a name="2788"/> 2788:     error = cover_shortcut_branches({}, 0, 42, false),
<a name="2789"/> 2789:     error = cover_shortcut_branches(not_tuple, 0, 42, false),
<a name="cover_shortcut_branches-last_expr"/><a name="2790"/> 2790:     ok.
<a name="2791"/> 2791: 
<a name="cover_shortcut_branches-4"/><a name="2792"/> 2792: <b>cover_shortcut_branches</b>(St, X, Y, Z) -&gt;
<a name="cover_shortcut_branches-last_expr"/><a name="2793"/> 2793:     if
<a name="2794"/> 2794:         %% The ((Y =:= X) =:= Z) part will test handling of a comparison
<a name="2795"/> 2795:         %% operator followed by a one-way `br`.
<a name="2796"/> 2796:         ((element(1, St) =:= r1) orelse fail) and ((Y =:= X) =:= Z) -&gt;
<a name="2797"/> 2797:             ok;
<a name="2798"/> 2798:         true -&gt;
<a name="2799"/> 2799:             error
<a name="2800"/> 2800:     end.
<a name="2801"/> 2801: 
<a name="wrong_order-0"/><a name="2802"/> 2802: <b>wrong_order</b>() -&gt;
<a name="2803"/> 2803:     ok = wrong_order(repeat_until_fail, true),
<a name="2804"/> 2804:     ok = wrong_order(repeat_until_fail, whatever),
<a name="2805"/> 2805:     error = wrong_order(repeat_until_fail, false),
<a name="2806"/> 2806:     error = wrong_order(nope, true),
<a name="wrong_order-last_expr"/><a name="2807"/> 2807:     ok.
<a name="2808"/> 2808: 
<a name="wrong_order-2"/><a name="2809"/> 2809: <b>wrong_order</b>(RepeatType, Mode) -&gt;
<a name="2810"/> 2810:     Parallel = Mode =/= false,
<a name="2811"/> 2811:     RepeatStop = RepeatType =:= repeat_until_fail,
<a name="wrong_order-last_expr"/><a name="2812"/> 2812:     if
<a name="2813"/> 2813:         Parallel andalso RepeatStop -&gt;
<a name="2814"/> 2814:             ok;
<a name="2815"/> 2815:         true -&gt;
<a name="2816"/> 2816:             error
<a name="2817"/> 2817:     end.
<a name="2818"/> 2818: 
<a name="megaco-0"/><a name="2819"/> 2819: <b>megaco</b>() -&gt;
<a name="2820"/> 2820:     ok = megaco('NULL', 0),
<a name="2821"/> 2821:     ok = megaco('NULL', 7),
<a name="2822"/> 2822:     ok = megaco('NULL', 15),
<a name="2823"/> 2823:     ok = megaco('NULL', asn1_NOVALUE),
<a name="2824"/> 2824:     ok = megaco(asn1_NOVALUE, 0),
<a name="2825"/> 2825:     ok = megaco(asn1_NOVALUE, 7),
<a name="2826"/> 2826:     ok = megaco(asn1_NOVALUE, 15),
<a name="2827"/> 2827:     ok = megaco(asn1_NOVALUE, asn1_NOVALUE),
<a name="2828"/> 2828: 
<a name="2829"/> 2829:     error = megaco(bad, 0),
<a name="2830"/> 2830:     error = megaco(bad, 7),
<a name="2831"/> 2831:     error = megaco(bad, 15),
<a name="2832"/> 2832:     error = megaco(bad, asn1_NOVALUE),
<a name="2833"/> 2833: 
<a name="2834"/> 2834:     error = megaco('NULL', not_integer),
<a name="2835"/> 2835:     error = megaco('NULL', -1),
<a name="2836"/> 2836:     error = megaco('NULL', 16),
<a name="2837"/> 2837:     error = megaco(asn1_NOVALUE, not_integer),
<a name="2838"/> 2838:     error = megaco(asn1_NOVALUE, -1),
<a name="2839"/> 2839:     error = megaco(asn1_NOVALUE, 16),
<a name="2840"/> 2840: 
<a name="2841"/> 2841:     error = megaco(bad, bad),
<a name="2842"/> 2842:     error = megaco(bad, -1),
<a name="2843"/> 2843:     error = megaco(bad, 42),
<a name="2844"/> 2844: 
<a name="megaco-last_expr"/><a name="2845"/> 2845:     ok.
<a name="2846"/> 2846: 
<a name="megaco-2"/><a name="2847"/> 2847: <b>megaco</b>(Top, SelPrio)
<a name="2848"/> 2848:   when (Top =:= 'NULL' orelse Top =:= asn1_NOVALUE) andalso
<a name="2849"/> 2849:        ((is_integer(SelPrio) andalso ((0 =&lt; SelPrio) and (SelPrio =&lt; 15))) orelse
<a name="2850"/> 2850: 	SelPrio =:= asn1_NOVALUE) -&gt;
<a name="2851"/> 2851:     ok;
<a name="2852"/> 2852: <b>megaco</b>(_, _) -&gt;
<a name="megaco-last_expr"/><a name="2853"/> 2853:     error.
<a name="2854"/> 2854: 
<a name="2855"/> 2855: <i>%% ERL-1054.</i>
<a name="looks_like_a_guard-0"/><a name="2856"/> 2856: <b>looks_like_a_guard</b>() -&gt;
<a name="2857"/> 2857:     ok = looks_like_a_guard(0),
<a name="2858"/> 2858:     ok = looks_like_a_guard(1),
<a name="looks_like_a_guard-last_expr"/><a name="2859"/> 2859:     ok.
<a name="2860"/> 2860: 
<a name="looks_like_a_guard-1"/><a name="2861"/> 2861: <b>looks_like_a_guard</b>(N) -&gt;
<a name="2862"/> 2862:     GuessPosition = id(42),
<a name="2863"/> 2863:     %% The matching of `true` would look like a guard to
<a name="2864"/> 2864:     %% beam_ssa_bool. The optimized code would not be safe.
<a name="looks_like_a_guard-last_expr"/><a name="2865"/> 2865:     case {1 &gt;= N, GuessPosition == 0} of
<a name="2866"/> 2866:         {true, _} -&gt; ok;
<a name="2867"/> 2867:         {_, true} -&gt; ok;
<a name="2868"/> 2868:         _ -&gt; looks_like_a_guard(N)
<a name="2869"/> 2869:     end.
<a name="2870"/> 2870: 
<a name="2871"/> 2871: <b>-record</b>(fail_in_guard, {f}).
<a name="fail_in_guard-0"/><a name="2872"/> 2872: <b>fail_in_guard</b>() -&gt;
<a name="2873"/> 2873:     false = struct_or_map(a, &quot;foo&quot;),
<a name="2874"/> 2874:     false = struct_or_map(a, foo),
<a name="2875"/> 2875:     false = struct_or_map(#{}, &quot;foo&quot;),
<a name="2876"/> 2876:     true = struct_or_map(#{}, foo),
<a name="2877"/> 2877: 
<a name="2878"/> 2878:     false = (fun() when whatever =/= (program andalso []) -&gt; true;
<a name="2879"/> 2879:                 () -&gt; false
<a name="2880"/> 2880:              end)(),
<a name="2881"/> 2881:     false = if whatever =/= (program orelse []) -&gt; true;
<a name="2882"/> 2882:                true -&gt; false
<a name="2883"/> 2883:             end,
<a name="2884"/> 2884: 
<a name="2885"/> 2885:     %% Would crash the compiler if optimizing passes
<a name="2886"/> 2886:     %% were disabled.
<a name="2887"/> 2887:     error = if
<a name="2888"/> 2888:                 0.1 orelse &quot;VZ&quot;, 42 -&gt; ok;
<a name="2889"/> 2889:                 true -&gt; error
<a name="2890"/> 2890:             end,
<a name="2891"/> 2891:     error = (fun() when 3.14; &lt;&lt;[]:(ceil($D))&gt;&gt; -&gt; ok;
<a name="2892"/> 2892:                () -&gt; error
<a name="2893"/> 2893:             end)(),
<a name="2894"/> 2894:     error = fun() when eye; &quot;&quot;#fail_in_guard.f andalso #{[] =&gt; true and false} -&gt;
<a name="2895"/> 2895:                     ok;
<a name="2896"/> 2896:                () -&gt;
<a name="2897"/> 2897:                     error
<a name="2898"/> 2898:             end(),
<a name="2899"/> 2899:     error = fun() when (0 #fail_in_guard.f)#fail_in_guard.f -&gt; ok;
<a name="2900"/> 2900:                () -&gt; error
<a name="2901"/> 2901:             end(),
<a name="2902"/> 2902:     error = fun() when 42; &lt;&lt;0.5,0:(element(true, false))&gt;&gt; -&gt;
<a name="2903"/> 2903:                     a = b;
<a name="2904"/> 2904:                () -&gt; error
<a name="2905"/> 2905:             end(),
<a name="2906"/> 2906: 
<a name="fail_in_guard-last_expr"/><a name="2907"/> 2907:     ok.
<a name="2908"/> 2908: 
<a name="2909"/> 2909: <i>%% ERL-1183. If Name is not an atom, the `fail` atom must cause the</i>
<a name="2910"/> 2910: <i>%% entire guard to fail.</i>
<a name="struct_or_map-2"/><a name="2911"/> 2911: <b>struct_or_map</b>(Arg, Name) when
<a name="2912"/> 2912:       (is_map(Arg) andalso (is_atom(Name) orelse fail) andalso
<a name="2913"/> 2913:        is_map_key(struct, Arg)) orelse is_map(Arg) -&gt; true;
<a name="2914"/> 2914: <b>struct_or_map</b>(_Arg, _Name) -&gt;
<a name="struct_or_map-last_expr"/><a name="2915"/> 2915:     false.
<a name="2916"/> 2916: 
<a name="in_catch-0"/><a name="2917"/> 2917: <b>in_catch</b>() -&gt;
<a name="2918"/> 2918:     ok = in_catch(true),
<a name="2919"/> 2919:     {'EXIT',{{case_clause,false},[_|_]}} = in_catch(false),
<a name="2920"/> 2920:     {'EXIT',{badarg,[_|_]}} = in_catch(any),
<a name="in_catch-last_expr"/><a name="2921"/> 2921:     ok.
<a name="2922"/> 2922: 
<a name="in_catch-1"/><a name="2923"/> 2923: <b>in_catch</b>(V) -&gt;
<a name="in_catch-last_expr"/><a name="2924"/> 2924:     catch
<a name="2925"/> 2925:         case false or V of
<a name="2926"/> 2926:             true -&gt; ok
<a name="2927"/> 2927:         end.
<a name="2928"/> 2928: 
<a name="recv_semi-0"/><a name="2929"/> 2929: <b>recv_semi</b>() -&gt;
<a name="recv_semi-last_expr"/><a name="2930"/> 2930: <b>    timeout = id</b>(receive
<a name="2931"/> 2931:                      ok when home; &lt;&lt;(m#{}):false&gt;&gt; -&gt;
<a name="2932"/> 2932:                          ok
<a name="2933"/> 2933:                  after 0 -&gt;
<a name="2934"/> 2934:                          timeout
<a name="2935"/> 2935:                  end).
<a name="2936"/> 2936: 
<a name="andalso_repeated_var-0"/><a name="2937"/> 2937: <b>andalso_repeated_var</b>() -&gt;
<a name="2938"/> 2938:     ok = andalso_repeated_var(true),
<a name="2939"/> 2939:     error = andalso_repeated_var(false),
<a name="2940"/> 2940:     error = andalso_repeated_var([not_boolean]),
<a name="andalso_repeated_var-last_expr"/><a name="2941"/> 2941:     ok.
<a name="2942"/> 2942: 
<a name="andalso_repeated_var-1"/><a name="2943"/> 2943: <b>andalso_repeated_var</b>(B) when B andalso B -&gt; ok;
<a name="andalso_repeated_var-last_expr"/><a name="2944"/> 2944: <b>andalso_repeated_var</b>(_) -&gt; error.
<a name="2945"/> 2945: 
<a name="2946"/> 2946: <b>-record</b>(erl1246, {tran_stat = 0}).
<a name="2947"/> 2947: 
<a name="erl1246-0"/><a name="2948"/> 2948: <b>erl1246</b>() -&gt;
<a name="2949"/> 2949:     false = erl1246(#erl1246{tran_stat = 0}, #{cid =&gt; 1131}),
<a name="2950"/> 2950:     false = erl1246(#erl1246{tran_stat = 12}, #{cid =&gt; 1131}),
<a name="2951"/> 2951:     false = erl1246(#erl1246{tran_stat = 12}, #{cid =&gt; 9502}),
<a name="2952"/> 2952:     true = erl1246(#erl1246{tran_stat = 0}, #{cid =&gt; 9502}),
<a name="erl1246-last_expr"/><a name="2953"/> 2953:     ok.
<a name="2954"/> 2954: 
<a name="erl1246-2"/><a name="2955"/> 2955: <b>erl1246</b>(Rec, #{cid := CollID}) -&gt;
<a name="2956"/> 2956:     {GiftCollID, _} = erl1246_conf(gift_coll),
<a name="2957"/> 2957:     IsTranStat = Rec#erl1246.tran_stat =:= erl1246_conf(transform_id),
<a name="erl1246-last_expr"/><a name="2958"/> 2958:     if
<a name="2959"/> 2959:         %% Optimization of 'not' in a guard was broken.
<a name="2960"/> 2960:         CollID =:= GiftCollID andalso not IsTranStat -&gt;
<a name="2961"/> 2961:             true;
<a name="2962"/> 2962:         true -&gt;
<a name="2963"/> 2963:             false
<a name="2964"/> 2964:     end.
<a name="2965"/> 2965: 
<a name="erl1246_conf-1"/><a name="2966"/> 2966: <b>erl1246_conf</b>(gift_coll) -&gt; {9502, {112, 45}};
<a name="2967"/> 2967: <b>erl1246_conf</b>(transform_id) -&gt; 12;
<a name="erl1246_conf-last_expr"/><a name="2968"/> 2968: <b>erl1246_conf</b>(_) -&gt; undefined.
<a name="2969"/> 2969: 
<a name="erl1253-0"/><a name="2970"/> 2970: <b>erl1253</b>() -&gt;
<a name="2971"/> 2971:     ok = erl1253_orelse_false(a, a, any),
<a name="2972"/> 2972:     ok = erl1253_orelse_false(a, a, true),
<a name="2973"/> 2973:     ok = erl1253_orelse_false(a, a, false),
<a name="2974"/> 2974:     error = erl1253_orelse_false(a, b, any),
<a name="2975"/> 2975:     error = erl1253_orelse_false(a, b, true),
<a name="2976"/> 2976:     ok = erl1253_orelse_false(a, b, false),
<a name="2977"/> 2977: 
<a name="2978"/> 2978:     ok = erl1253_orelse_true(a, a, any),
<a name="2979"/> 2979:     ok = erl1253_orelse_true(a, a, true),
<a name="2980"/> 2980:     ok = erl1253_orelse_true(a, a, false),
<a name="2981"/> 2981:     error = erl1253_orelse_true(a, b, any),
<a name="2982"/> 2982:     ok = erl1253_orelse_true(a, b, true),
<a name="2983"/> 2983:     error = erl1253_orelse_true(a, b, false),
<a name="2984"/> 2984: 
<a name="2985"/> 2985:     error = erl1253_andalso_false(a, a, any),
<a name="2986"/> 2986:     error = erl1253_andalso_false(a, a, true),
<a name="2987"/> 2987:     ok = erl1253_andalso_false(a, a, false),
<a name="2988"/> 2988:     error = erl1253_andalso_false(a, b, any),
<a name="2989"/> 2989:     error = erl1253_andalso_false(a, b, true),
<a name="2990"/> 2990:     error = erl1253_andalso_false(a, b, false),
<a name="2991"/> 2991: 
<a name="2992"/> 2992:     error = erl1253_andalso_true(a, a, any),
<a name="2993"/> 2993:     ok = erl1253_andalso_true(a, a, true),
<a name="2994"/> 2994:     error = erl1253_andalso_true(a, a, false),
<a name="2995"/> 2995:     error = erl1253_andalso_true(a, b, any),
<a name="2996"/> 2996:     error = erl1253_andalso_true(a, b, true),
<a name="2997"/> 2997:     error = erl1253_andalso_true(a, b, false),
<a name="2998"/> 2998: 
<a name="erl1253-last_expr"/><a name="2999"/> 2999:     ok.
<a name="3000"/> 3000: 
<a name="erl1253_orelse_false-3"/><a name="3001"/> 3001: <b>erl1253_orelse_false</b>(X, Y, Z) -&gt;
<a name="3002"/> 3002:     Res = erl1253_orelse_false_1(X, Y, Z),
<a name="3003"/> 3003:     Res = erl1253_orelse_false_2(X, Y, Z),
<a name="erl1253_orelse_false-last_expr"/><a name="3004"/> 3004: <b>    Res = erl1253_orelse_false_3</b>(X, Y, Z).
<a name="3005"/> 3005: 
<a name="erl1253_orelse_false_1-3"/><a name="3006"/> 3006: <b>erl1253_orelse_false_1</b>(X, Y, Z) -&gt;
<a name="3007"/> 3007:     Bool = Z =:= false,
<a name="erl1253_orelse_false_1-last_expr"/><a name="3008"/> 3008:     if
<a name="3009"/> 3009:         X =:= Y orelse Bool -&gt; ok;
<a name="3010"/> 3010:         true -&gt; error
<a name="3011"/> 3011:     end.
<a name="3012"/> 3012: 
<a name="erl1253_orelse_false_2-3"/><a name="3013"/> 3013: <b>erl1253_orelse_false_2</b>(X, Y, Z) -&gt;
<a name="3014"/> 3014:     Bool = Z =:= false,
<a name="erl1253_orelse_false_2-last_expr"/><a name="3015"/> 3015:     if
<a name="3016"/> 3016:         Bool orelse X =:= Y -&gt; ok;
<a name="3017"/> 3017:         true -&gt; error
<a name="3018"/> 3018:     end.
<a name="3019"/> 3019: 
<a name="erl1253_orelse_false_3-3"/><a name="3020"/> 3020: <b>erl1253_orelse_false_3</b>(X, Y, Z) -&gt;
<a name="3021"/> 3021:     Bool1 = X =:= Y,
<a name="3022"/> 3022:     Bool2 = Z =:= false,
<a name="erl1253_orelse_false_3-last_expr"/><a name="3023"/> 3023:     if
<a name="3024"/> 3024:         Bool1 orelse Bool2 -&gt; ok;
<a name="3025"/> 3025:         true -&gt; error
<a name="3026"/> 3026:     end.
<a name="3027"/> 3027: 
<a name="erl1253_orelse_true-3"/><a name="3028"/> 3028: <b>erl1253_orelse_true</b>(X, Y, Z) -&gt;
<a name="3029"/> 3029:     Res = erl1253_orelse_true_1(X, Y, Z),
<a name="3030"/> 3030:     Res = erl1253_orelse_true_2(X, Y, Z),
<a name="erl1253_orelse_true-last_expr"/><a name="3031"/> 3031: <b>    Res = erl1253_orelse_true_3</b>(X, Y, Z).
<a name="3032"/> 3032: 
<a name="erl1253_orelse_true_1-3"/><a name="3033"/> 3033: <b>erl1253_orelse_true_1</b>(X, Y, Z)   -&gt;
<a name="3034"/> 3034:     Bool = Z =:= true,
<a name="erl1253_orelse_true_1-last_expr"/><a name="3035"/> 3035:     if
<a name="3036"/> 3036:         X =:= Y orelse Bool -&gt; ok;
<a name="3037"/> 3037:         true -&gt; error
<a name="3038"/> 3038:     end.
<a name="3039"/> 3039: 
<a name="erl1253_orelse_true_2-3"/><a name="3040"/> 3040: <b>erl1253_orelse_true_2</b>(X, Y, Z) -&gt;
<a name="3041"/> 3041:     Bool = Z =:= true,
<a name="erl1253_orelse_true_2-last_expr"/><a name="3042"/> 3042:     if
<a name="3043"/> 3043:         Bool orelse X =:= Y -&gt; ok;
<a name="3044"/> 3044:         true -&gt; error
<a name="3045"/> 3045:     end.
<a name="3046"/> 3046: 
<a name="erl1253_orelse_true_3-3"/><a name="3047"/> 3047: <b>erl1253_orelse_true_3</b>(X, Y, Z)   -&gt;
<a name="3048"/> 3048:     Bool1 = X =:= Y,
<a name="3049"/> 3049:     Bool2 = Z =:= true,
<a name="erl1253_orelse_true_3-last_expr"/><a name="3050"/> 3050:     if
<a name="3051"/> 3051:         Bool1 orelse Bool2 -&gt; ok;
<a name="3052"/> 3052:         true -&gt; error
<a name="3053"/> 3053:     end.
<a name="3054"/> 3054: 
<a name="erl1253_andalso_false-3"/><a name="3055"/> 3055: <b>erl1253_andalso_false</b>(X, Y, Z) -&gt;
<a name="3056"/> 3056:     Res = erl1253_andalso_false_1(X, Y, Z),
<a name="3057"/> 3057:     Res = erl1253_andalso_false_2(X, Y, Z),
<a name="erl1253_andalso_false-last_expr"/><a name="3058"/> 3058: <b>    Res = erl1253_andalso_false_3</b>(X, Y, Z).
<a name="3059"/> 3059: 
<a name="erl1253_andalso_false_1-3"/><a name="3060"/> 3060: <b>erl1253_andalso_false_1</b>(X, Y, Z) -&gt;
<a name="3061"/> 3061:     Bool = Z =:= false,
<a name="erl1253_andalso_false_1-last_expr"/><a name="3062"/> 3062:     if
<a name="3063"/> 3063:         X =:= Y andalso Bool -&gt; ok;
<a name="3064"/> 3064:         true -&gt; error
<a name="3065"/> 3065:     end.
<a name="3066"/> 3066: 
<a name="erl1253_andalso_false_2-3"/><a name="3067"/> 3067: <b>erl1253_andalso_false_2</b>(X, Y, Z) -&gt;
<a name="3068"/> 3068:     Bool1 = X =:= Y,
<a name="3069"/> 3069:     Bool2 = Z =:= false,
<a name="erl1253_andalso_false_2-last_expr"/><a name="3070"/> 3070:     if
<a name="3071"/> 3071:         Bool1 andalso Bool2 -&gt; ok;
<a name="3072"/> 3072:         true -&gt; error
<a name="3073"/> 3073:     end.
<a name="3074"/> 3074: 
<a name="erl1253_andalso_false_3-3"/><a name="3075"/> 3075: <b>erl1253_andalso_false_3</b>(X, Y, Z) -&gt;
<a name="3076"/> 3076:     Bool1 = X =:= Y,
<a name="3077"/> 3077:     Bool2 = Z =:= false,
<a name="erl1253_andalso_false_3-last_expr"/><a name="3078"/> 3078:     if
<a name="3079"/> 3079:         Bool1 andalso Bool2 -&gt; ok;
<a name="3080"/> 3080:         true -&gt; error
<a name="3081"/> 3081:     end.
<a name="3082"/> 3082: 
<a name="erl1253_andalso_true-3"/><a name="3083"/> 3083: <b>erl1253_andalso_true</b>(X, Y, Z) -&gt;
<a name="3084"/> 3084:     Res = erl1253_andalso_true_1(X, Y, Z),
<a name="3085"/> 3085:     Res = erl1253_andalso_true_2(X, Y, Z),
<a name="erl1253_andalso_true-last_expr"/><a name="3086"/> 3086: <b>    Res = erl1253_andalso_true_3</b>(X, Y, Z).
<a name="3087"/> 3087: 
<a name="erl1253_andalso_true_1-3"/><a name="3088"/> 3088: <b>erl1253_andalso_true_1</b>(X, Y, Z) -&gt;
<a name="3089"/> 3089:     Bool = Z =:= true,
<a name="erl1253_andalso_true_1-last_expr"/><a name="3090"/> 3090:     if
<a name="3091"/> 3091:         X =:= Y andalso Bool -&gt; ok;
<a name="3092"/> 3092:         true -&gt; error
<a name="3093"/> 3093:     end.
<a name="3094"/> 3094: 
<a name="erl1253_andalso_true_2-3"/><a name="3095"/> 3095: <b>erl1253_andalso_true_2</b>(X, Y, Z) -&gt;
<a name="3096"/> 3096:     Bool = Z =:= true,
<a name="erl1253_andalso_true_2-last_expr"/><a name="3097"/> 3097:     if
<a name="3098"/> 3098:         Bool andalso X =:= Y-&gt; ok;
<a name="3099"/> 3099:         true -&gt; error
<a name="3100"/> 3100:     end.
<a name="3101"/> 3101: 
<a name="erl1253_andalso_true_3-3"/><a name="3102"/> 3102: <b>erl1253_andalso_true_3</b>(X, Y, Z) -&gt;
<a name="3103"/> 3103:     Bool1 = X =:= Y,
<a name="3104"/> 3104:     Bool2 = Z =:= true,
<a name="erl1253_andalso_true_3-last_expr"/><a name="3105"/> 3105:     if
<a name="3106"/> 3106:         Bool1 andalso Bool2 -&gt; ok;
<a name="3107"/> 3107:         true -&gt; error
<a name="3108"/> 3108:     end.
<a name="3109"/> 3109: 
<a name="erl1384-0"/><a name="3110"/> 3110: <b>erl1384</b>() -&gt;
<a name="3111"/> 3111:     gurka = erl1384_1(id(a)),
<a name="3112"/> 3112:     gaffel = erl1384_1(id(b)),
<a name="erl1384-last_expr"/><a name="3113"/> 3113:     ok.
<a name="3114"/> 3114: 
<a name="erl1384_1-1"/><a name="3115"/> 3115: <b>erl1384_1</b>(V) -&gt;
<a name="erl1384_1-last_expr"/><a name="3116"/> 3116: <b>    case {id</b>(false), V =/= a} of
<a name="3117"/> 3117:         {true, true} -&gt; not_reachable;
<a name="3118"/> 3118:         {_, false} -&gt; gurka;
<a name="3119"/> 3119:         _ -&gt; gaffel
<a name="3120"/> 3120:     end.
<a name="3121"/> 3121: 
<a name="gh4788-0"/><a name="3122"/> 3122: <b>gh4788</b>() -&gt;
<a name="3123"/> 3123:     ok = do_gh4788(id(0)),
<a name="3124"/> 3124:     ok = do_gh4788(id(1)),
<a name="3125"/> 3125:     ok = do_gh4788(id(undefined)),
<a name="3126"/> 3126:     lt_0_or_undefined = catch do_gh4788(id(-1)),
<a name="gh4788-last_expr"/><a name="3127"/> 3127:     ok.
<a name="3128"/> 3128: 
<a name="do_gh4788-1"/><a name="3129"/> 3129: <b>do_gh4788</b>(N) -&gt;
<a name="3130"/> 3130:     %% beam_ssa_bool would do an unsafe optimization when run after
<a name="3131"/> 3131:     %% the beam_ssa_share pass.
<a name="3132"/> 3132:     case {N &gt;= 0, N == undefined} of
<a name="3133"/> 3133:         {true, _} -&gt; ok;
<a name="3134"/> 3134:         {_, true} -&gt; ok;
<a name="3135"/> 3135:         _ -&gt; throw(lt_0_or_undefined)
<a name="3136"/> 3136:     end,
<a name="do_gh4788-last_expr"/><a name="3137"/> 3137:     ok.
<a name="3138"/> 3138: 
<a name="beam_ssa_bool_coverage-0"/><a name="3139"/> 3139: <b>beam_ssa_bool_coverage</b>() -&gt;
<a name="3140"/> 3140:     {&quot;*&quot;,&quot;abc&quot;} = collect_modifiers(&quot;abc*&quot;, []),
<a name="3141"/> 3141:     error = beam_ssa_bool_coverage_1(true),
<a name="3142"/> 3142: 
<a name="3143"/> 3143:     ok = beam_ssa_bool_coverage_2(self()),
<a name="3144"/> 3144:     ok = beam_ssa_bool_coverage_2(true),
<a name="3145"/> 3145:     error = beam_ssa_bool_coverage_2(false),
<a name="3146"/> 3146:     error = beam_ssa_bool_coverage_2(42),
<a name="3147"/> 3147: 
<a name="3148"/> 3148:     error = beam_ssa_bool_coverage_3(42),
<a name="3149"/> 3149:     error = beam_ssa_bool_coverage_3(a),
<a name="3150"/> 3150: 
<a name="3151"/> 3151:     error = beam_ssa_bool_coverage_4(42, 42),
<a name="3152"/> 3152:     error = beam_ssa_bool_coverage_4(ok, ok),
<a name="3153"/> 3153:     error = beam_ssa_bool_coverage_4(a, b),
<a name="3154"/> 3154: 
<a name="3155"/> 3155:     ok = beam_ssa_bool_coverage_5(ok),
<a name="3156"/> 3156:     ok = beam_ssa_bool_coverage_5(2.0),
<a name="3157"/> 3157:     ok = beam_ssa_bool_coverage_5(42),
<a name="3158"/> 3158: 
<a name="3159"/> 3159:     ok = beam_ssa_bool_coverage_6(&lt;&lt;&gt;&gt;),
<a name="3160"/> 3160:     error = beam_ssa_bool_coverage_6(a),
<a name="3161"/> 3161:     error = beam_ssa_bool_coverage_6(42),
<a name="3162"/> 3162: 
<a name="beam_ssa_bool_coverage-last_expr"/><a name="3163"/> 3163:     ok.
<a name="3164"/> 3164: 
<a name="collect_modifiers-2"/><a name="3165"/> 3165: <b>collect_modifiers</b>([H | T], Buffer)
<a name="3166"/> 3166:     when (H &gt;= $a andalso H =&lt; $z) or
<a name="3167"/> 3167:          (H &gt;= $A andalso H =&lt; $Z) -&gt;
<a name="3168"/> 3168:     collect_modifiers(T, [H | Buffer]);
<a name="3169"/> 3169: <b>collect_modifiers</b>(Rest, Buffer) -&gt;
<a name="collect_modifiers-last_expr"/><a name="3170"/> 3170: <b>    {Rest, lists:reverse</b>(Buffer)}.
<a name="3171"/> 3171: 
<a name="beam_ssa_bool_coverage_1-1"/><a name="3172"/> 3172: <b>beam_ssa_bool_coverage_1</b>(V) when V andalso 0, tuple_size(0) -&gt;
<a name="3173"/> 3173:     ok;
<a name="3174"/> 3174: <b>beam_ssa_bool_coverage_1</b>(_) -&gt;
<a name="beam_ssa_bool_coverage_1-last_expr"/><a name="3175"/> 3175:     error.
<a name="3176"/> 3176: 
<a name="beam_ssa_bool_coverage_2-1"/><a name="3177"/> 3177: <b>beam_ssa_bool_coverage_2</b>(A) when is_pid(A) andalso true; A -&gt;
<a name="3178"/> 3178:     ok;
<a name="3179"/> 3179: <b>beam_ssa_bool_coverage_2</b>(_) -&gt;
<a name="beam_ssa_bool_coverage_2-last_expr"/><a name="3180"/> 3180:     error.
<a name="3181"/> 3181: 
<a name="beam_ssa_bool_coverage_3-1"/><a name="3182"/> 3182: <b>beam_ssa_bool_coverage_3</b>(A) when ok; ((ok =&lt; A + 1) or false) and true orelse ok -&gt;
<a name="3183"/> 3183:     ok;
<a name="3184"/> 3184: <b>beam_ssa_bool_coverage_3</b>(_) -&gt;
<a name="beam_ssa_bool_coverage_3-last_expr"/><a name="3185"/> 3185:     error.
<a name="3186"/> 3186: 
<a name="beam_ssa_bool_coverage_4-2"/><a name="3187"/> 3187: <b>beam_ssa_bool_coverage_4</b>(A, A) when ok == A andalso ok -&gt;
<a name="3188"/> 3188:     ok;
<a name="3189"/> 3189: <b>beam_ssa_bool_coverage_4</b>(_, _) -&gt;
<a name="beam_ssa_bool_coverage_4-last_expr"/><a name="3190"/> 3190:     error.
<a name="3191"/> 3191: 
<a name="beam_ssa_bool_coverage_5-1"/><a name="3192"/> 3192: <b>beam_ssa_bool_coverage_5</b>(A) -&gt;
<a name="beam_ssa_bool_coverage_5-last_expr"/><a name="3193"/> 3193:     maybe
<a name="3194"/> 3194:         case case maybe ok end of
<a name="3195"/> 3195:                  2.0 -&gt;
<a name="3196"/> 3196:                      false;
<a name="3197"/> 3197:                  A -&gt;
<a name="3198"/> 3198:                      true;
<a name="3199"/> 3199:                  _ -&gt;
<a name="3200"/> 3200:                      true
<a name="3201"/> 3201:              end of
<a name="3202"/> 3202:             true -&gt;
<a name="3203"/> 3203:                 ok;
<a name="3204"/> 3204:             _ -&gt;
<a name="3205"/> 3205:                 error
<a name="3206"/> 3206:         end
<a name="3207"/> 3207:     end.
<a name="3208"/> 3208: 
<a name="beam_ssa_bool_coverage_6-1"/><a name="3209"/> 3209: <b>beam_ssa_bool_coverage_6</b>(A) when is_bitstring(A) orelse ok;
<a name="3210"/> 3210:                                  is_bitstring(A) andalso ok bsr ok -&gt;
<a name="3211"/> 3211:     ok;
<a name="3212"/> 3212: <b>beam_ssa_bool_coverage_6</b>(_) -&gt;
<a name="beam_ssa_bool_coverage_6-last_expr"/><a name="3213"/> 3213:     error.
<a name="3214"/> 3214: 
<a name="3215"/> 3215: 
<a name="gh_6164-0"/><a name="3216"/> 3216: <b>gh_6164</b>() -&gt;
<a name="3217"/> 3217:     true = do_gh_6164(id([])),
<a name="3218"/> 3218:     {'EXIT',{{case_clause,42},_}} = catch do_gh_6164(id(0)),
<a name="3219"/> 3219: 
<a name="gh_6164-last_expr"/><a name="3220"/> 3220:     ok.
<a name="3221"/> 3221: 
<a name="do_gh_6164-1"/><a name="3222"/> 3222: <b>do_gh_6164</b>(V1) -&gt;
<a name="do_gh_6164-last_expr"/><a name="3223"/> 3223:     case 42 of
<a name="3224"/> 3224:         V2 -&gt;
<a name="3225"/> 3225:             case is_list(V1) of
<a name="3226"/> 3226:                 V3 -&gt;
<a name="3227"/> 3227:                     case V3 orelse V2 of
<a name="3228"/> 3228:                         _ when V3 -&gt; 100
<a name="3229"/> 3229:                     end =&lt; V3
<a name="3230"/> 3230:             end
<a name="3231"/> 3231:     end.
<a name="3232"/> 3232: 
<a name="gh_6184-0"/><a name="3233"/> 3233: <b>gh_6184</b>() -&gt;
<a name="3234"/> 3234:     {'EXIT',{function_clause,_}} = catch do_gh_6184(id(true), id({a,b,c})),
<a name="3235"/> 3235:     {'EXIT',{function_clause,_}} = catch do_gh_6184(true, true),
<a name="3236"/> 3236:     {'EXIT',{function_clause,_}} = catch do_gh_6184({a,b,c}, {x,y,z}),
<a name="3237"/> 3237: 
<a name="gh_6184-last_expr"/><a name="3238"/> 3238:     ok.
<a name="3239"/> 3239: 
<a name="do_gh_6184-2"/><a name="3240"/> 3240: <b>do_gh_6184</b>(V1, V2) when (false and is_tuple(V2)) andalso (V1 orelse V2) -&gt;
<a name="do_gh_6184-last_expr"/><a name="3241"/> 3241:     V2 orelse V2.
<a name="3242"/> 3242: 
<a name="3243"/> 3243: <b>-record</b>(bad_map_in_guard, {name}).
<a name="bad_map_in_guard-0"/><a name="3244"/> 3244: <b>bad_map_in_guard</b>() -&gt;
<a name="bad_map_in_guard-last_expr"/><a name="3245"/> 3245: <b>    error = bad_map_in_guard_1</b>().
<a name="3246"/> 3246: 
<a name="bad_map_in_guard_1-0"/><a name="3247"/> 3247: <b>bad_map_in_guard_1</b>() when (a#{key =&gt; value})#bad_map_in_guard.name -&gt;
<a name="3248"/> 3248:     ok;
<a name="3249"/> 3249: <b>bad_map_in_guard_1</b>() -&gt;
<a name="bad_map_in_guard_1-last_expr"/><a name="3250"/> 3250:     error.
<a name="3251"/> 3251: 
<a name="gh_7252-0"/><a name="3252"/> 3252: <b>gh_7252</b>() -&gt;
<a name="3253"/> 3253:     bar = gh_7252_a(id(bar), id([])),
<a name="3254"/> 3254:     bar = gh_7252_a(id(bar), id(ok)),
<a name="3255"/> 3255: 
<a name="3256"/> 3256:     foo = gh_7252_b(id(ok), id(&lt;&lt;&gt;&gt;)),
<a name="3257"/> 3257:     bar = gh_7252_b(id(ok), id(ok)),
<a name="3258"/> 3258: 
<a name="3259"/> 3259:     bar = gh_7252_c(id(ok)),
<a name="3260"/> 3260: 
<a name="gh_7252-last_expr"/><a name="3261"/> 3261:     ok.
<a name="3262"/> 3262: 
<a name="gh_7252_a-2"/><a name="3263"/> 3263: <b>gh_7252_a</b>(_, B) when ((ok == B) and (ok =/= trunc(ok))) or (ok &lt; B) -&gt;
<a name="3264"/> 3264:     foo;
<a name="3265"/> 3265: <b>gh_7252_a</b>(A, _) -&gt;
<a name="gh_7252_a-last_expr"/><a name="3266"/> 3266:     A.
<a name="3267"/> 3267: 
<a name="gh_7252_b-2"/><a name="3268"/> 3268: <b>gh_7252_b</b>(A, B)
<a name="3269"/> 3269:   when (true xor is_float(A)) or (is_bitstring(B) orelse &lt;&lt;(ok):(ok)&gt;&gt;) -&gt;
<a name="3270"/> 3270:     foo;
<a name="3271"/> 3271: <b>gh_7252_b</b>(_, _) -&gt;
<a name="gh_7252_b-last_expr"/><a name="3272"/> 3272:     bar.
<a name="3273"/> 3273: 
<a name="gh_7252_c-1"/><a name="3274"/> 3274: <b>gh_7252_c</b>(A) when ((ok &gt; A) and ((bnot ok) =:= ok)) or (not (ok &gt; A)) -&gt;
<a name="3275"/> 3275:     foo;
<a name="3276"/> 3276: <b>gh_7252_c</b>(_) -&gt;
<a name="gh_7252_c-last_expr"/><a name="3277"/> 3277:     bar.
<a name="3278"/> 3278: 
<a name="gh_7339-0"/><a name="3279"/> 3279: <b>gh_7339</b>() -&gt;
<a name="3280"/> 3280:     b = do_gh_7339(id(42)),
<a name="3281"/> 3281:     b = do_gh_7339(id(42.0)),
<a name="3282"/> 3282:     b = do_gh_7339(id(#{})),
<a name="gh_7339-last_expr"/><a name="3283"/> 3283:     ok.
<a name="3284"/> 3284: 
<a name="do_gh_7339-1"/><a name="3285"/> 3285: <b>do_gh_7339</b>(M) when is_number(M) or (not is_map(M#{a =&gt; b})) -&gt;
<a name="3286"/> 3286:   a;
<a name="3287"/> 3287: <b>do_gh_7339</b>(_) -&gt;
<a name="do_gh_7339-last_expr"/><a name="3288"/> 3288:   b.
<a name="3289"/> 3289: 
<a name="gh_7370-0"/><a name="3290"/> 3290: <b>gh_7370</b>() -&gt;
<a name="3291"/> 3291:     b = gh_7370(id(42)),
<a name="3292"/> 3292:     b = gh_7370(id(42.0)),
<a name="gh_7370-last_expr"/><a name="3293"/> 3293:     ok.
<a name="3294"/> 3294: 
<a name="gh_7370-1"/><a name="3295"/> 3295: <b>gh_7370</b>(A) when (not (not is_float(A))) =/= ((ok and ok) or true) -&gt;
<a name="3296"/> 3296:     a;
<a name="3297"/> 3297: <b>gh_7370</b>(_) -&gt;
<a name="gh_7370-last_expr"/><a name="3298"/> 3298:     b.
<a name="3299"/> 3299: 
<a name="gh_7517-0"/><a name="3300"/> 3300: <b>gh_7517</b>() -&gt;
<a name="3301"/> 3301:     ok = catch do_gh_7517([]),
<a name="3302"/> 3302:     ok = catch do_gh_7517([a,b,c]),
<a name="3303"/> 3303:     {'EXIT',{function_clause,_}} = catch do_gh_7517(ok),
<a name="3304"/> 3304:     {'EXIT',{function_clause,_}} = catch do_gh_7517(&lt;&lt;&gt;&gt;),
<a name="gh_7517-last_expr"/><a name="3305"/> 3305:     ok.
<a name="3306"/> 3306: 
<a name="do_gh_7517-1"/><a name="3307"/> 3307: <b>do_gh_7517</b>(A) when (ok /= A) or is_float(is_list(A) orelse ok andalso ok) -&gt;
<a name="do_gh_7517-last_expr"/><a name="3308"/> 3308:     ok.
<a name="3309"/> 3309: 
<a name="3310"/> 3310: 
<a name="3311"/> 3311: <i>%%%</i>
<a name="3312"/> 3312: <i>%%% End of beam_bool_SUITE tests.</i>
<a name="3313"/> 3313: <i>%%%</i>
<a name="3314"/> 3314: 
<a name="repeated_type_tests-1"/><a name="3315"/> 3315: <b>repeated_type_tests</b>(_Config) -&gt;
<a name="3316"/> 3316:     binary = repeated_type_test(&lt;&lt;42&gt;&gt;),
<a name="3317"/> 3317:     bitstring = repeated_type_test(&lt;&lt;1:1&gt;&gt;),
<a name="3318"/> 3318:     other = repeated_type_test(atom),
<a name="repeated_type_tests-last_expr"/><a name="3319"/> 3319:     ok.
<a name="3320"/> 3320: 
<a name="repeated_type_test-1"/><a name="3321"/> 3321: <b>repeated_type_test</b>(T) -&gt;
<a name="3322"/> 3322:     %% Test for a bug in beam_ssa_dead.
<a name="repeated_type_test-last_expr"/><a name="3323"/> 3323: <b>    if is_bitstring</b>(T) -&gt;
<a name="3324"/> 3324:             if is_binary(T) -&gt;                  %This test would be optimized away.
<a name="3325"/> 3325:                     binary;
<a name="3326"/> 3326:                true -&gt;
<a name="3327"/> 3327:                     bitstring
<a name="3328"/> 3328:             end;
<a name="3329"/> 3329:        true -&gt;
<a name="3330"/> 3330:             other
<a name="3331"/> 3331:     end.
<a name="3332"/> 3332: 
<a name="3333"/> 3333: <i>%% ERL-1179: The result of '=/=' would be flipped if it was used after being</i>
<a name="3334"/> 3334: <i>%% branched on.</i>
<a name="use_after_branch-1"/><a name="3335"/> 3335: <b>use_after_branch</b>(_Config) -&gt;
<a name="3336"/> 3336:     {false, gaffel} = use_after_branch_1(foo),
<a name="3337"/> 3337:     {true, gurka} = use_after_branch_1(bar),
<a name="use_after_branch-last_expr"/><a name="3338"/> 3338:     ok.
<a name="3339"/> 3339: 
<a name="use_after_branch_1-1"/><a name="3340"/> 3340: <b>use_after_branch_1</b>(A) -&gt;
<a name="3341"/> 3341:     Boolean = A =/= foo,
<a name="3342"/> 3342:     case Boolean of
<a name="3343"/> 3343:         true -&gt; id(something);
<a name="3344"/> 3344:         false -&gt; id(other)
<a name="3345"/> 3345:     end,
<a name="use_after_branch_1-last_expr"/><a name="3346"/> 3346:     case Boolean of
<a name="3347"/> 3347:         true -&gt; {id(Boolean), gurka};
<a name="3348"/> 3348:         false -&gt; {id(Boolean), gaffel}
<a name="3349"/> 3349:     end.
<a name="3350"/> 3350: 
<a name="3351"/> 3351: <i>%% Call this function to turn off constant propagation.</i>
<a name="id-1"/><a name="id-last_expr"/><a name="3352"/> 3352: <b>id</b>(I) -&gt; I.
<a name="3353"/> 3353: 
<a name="check-2"/><a name="3354"/> 3354: <b>check</b>(F, Result) -&gt;
<a name="check-last_expr"/><a name="3355"/> 3355: <b>    case F</b>() of
<a name="3356"/> 3356: 	Result -&gt; ok;
<a name="3357"/> 3357: 	Other -&gt;
<a name="3358"/> 3358: 	    io:format(&quot;Expected: ~p\n&quot;, [Result]),
<a name="3359"/> 3359: 	    io:format(&quot;     Got: ~p\n&quot;, [Other]),
<a name="3360"/> 3360: 	    ct:fail(check_failed)
<a name="3361"/> 3361:     end.
<a name="3362"/> 3362: 
<a name="fc-1"/><a name="fc-last_expr"/><a name="3363"/> 3363: <b>fc</b>({'EXIT',{function_clause,_}}) -&gt; ok.
</pre>
<script>
var hash = window.location.hash.substring(1);
var anchor = document.getElementsByName(hash);
anchor[0].style.backgroundColor="orange";
</script>
</body>
</html>
