<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/lib/crypto/make_test_dir/crypto_test/crypto_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%</i>
<a name="2"/>    2: <i>%% %CopyrightBegin%</i>
<a name="3"/>    3: <i>%%</i>
<a name="4"/>    4: <i>%% Copyright Ericsson AB 1999-2024. All Rights Reserved.</i>
<a name="5"/>    5: <i>%%</i>
<a name="6"/>    6: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="7"/>    7: <i>%% you may not use this file except in compliance with the License.</i>
<a name="8"/>    8: <i>%% You may obtain a copy of the License at</i>
<a name="9"/>    9: <i>%%</i>
<a name="10"/>   10: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="11"/>   11: <i>%%</i>
<a name="12"/>   12: 
<a name="13"/>   13: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="14"/>   14: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="15"/>   15: <i>%% See the License for the specific language governing permissions and</i>
<a name="16"/>   16: <i>%% limitations under the License.</i>
<a name="17"/>   17: <i>%%</i>
<a name="18"/>   18: <i>%% %CopyrightEnd%</i>
<a name="19"/>   19: <i>%%</i>
<a name="20"/>   20: <b>-module</b>(crypto_SUITE).
<a name="21"/>   21: 
<a name="22"/>   22: <b>-include_lib</b>(&quot;common_test/include/ct.hrl&quot;).
<a name="23"/>   23: 
<a name="24"/>   24: 
<a name="25"/>   25: <b>-export</b>([
<a name="26"/>   26:          %% CT callbacks:
<a name="27"/>   27:          suite/0,
<a name="28"/>   28:          all/0,
<a name="29"/>   29:          groups/0,
<a name="30"/>   30:          init_per_suite/1,
<a name="31"/>   31:          end_per_suite/1,
<a name="32"/>   32:          init_per_group/2,
<a name="33"/>   33:          end_per_group/2,
<a name="34"/>   34:          init_per_testcase/2,
<a name="35"/>   35:          end_per_testcase/2,
<a name="36"/>   36:          
<a name="37"/>   37:          %% Test cases:
<a name="38"/>   38:          aead_bad_tag/1,
<a name="39"/>   39:          aead_ng/1,
<a name="40"/>   40:          all_ciphers/1,
<a name="41"/>   41:          api_errors_ecdh/1,
<a name="42"/>   42:          api_ng/0,
<a name="43"/>   43:          api_ng/1,
<a name="44"/>   44:          api_ng_one_shot/0,
<a name="45"/>   45:          api_ng_one_shot/1,
<a name="46"/>   46:          app/0,
<a name="47"/>   47:          app/1,
<a name="48"/>   48:          appup/0,
<a name="49"/>   49:          appup/1,
<a name="50"/>   50:          bad_key_length/1,
<a name="51"/>   51:          bad_cipher_name/1,
<a name="52"/>   52:          bad_generate_key_name/1,
<a name="53"/>   53:          bad_cmac_name/1,
<a name="54"/>   54:          bad_hash_name/1,
<a name="55"/>   55:          bad_hmac_name/1,
<a name="56"/>   56:          bad_mac_name/1,
<a name="57"/>   57:          bad_sign_name/1,
<a name="58"/>   58:          bad_verify_name/1,
<a name="59"/>   59:          cipher_info/0,
<a name="60"/>   60:          cipher_info/1,
<a name="61"/>   61:          cipher_info_prop_aead_attr/0,
<a name="62"/>   62:          cipher_info_prop_aead_attr/1,
<a name="63"/>   63:          cipher_padding/1,
<a name="64"/>   64:          cmac/0,
<a name="65"/>   65:          cmac/1,
<a name="66"/>   66:          cmac_update/0,
<a name="67"/>   67:          cmac_update/1,
<a name="68"/>   68:          compute/0,
<a name="69"/>   69:          compute/1,
<a name="70"/>   70:          compute_bug/0,
<a name="71"/>   71:          compute_bug/1,
<a name="72"/>   72:          crypto_load/1,
<a name="73"/>   73:          crypto_load_and_call/1,
<a name="74"/>   74:          exor/0,
<a name="75"/>   75:          exor/1,
<a name="76"/>   76:          generate/0,
<a name="77"/>   77:          generate/1,
<a name="78"/>   78:          generate_compute/0,
<a name="79"/>   79:          generate_compute/1,
<a name="80"/>   80:          hash/0,
<a name="81"/>   81:          hash/1,
<a name="82"/>   82:          hash_xof/0,
<a name="83"/>   83:          hash_xof/1,
<a name="84"/>   84:          hash_info/0,
<a name="85"/>   85:          hash_info/1,
<a name="86"/>   86:          hmac/0,
<a name="87"/>   87:          hmac/1,
<a name="88"/>   88:          hmac_update/0,
<a name="89"/>   89:          hmac_update/1,
<a name="90"/>   90:          info/1,
<a name="91"/>   91:          mod_pow/0,
<a name="92"/>   92:          mod_pow/1,
<a name="93"/>   93:          no_aead_ng/0,
<a name="94"/>   94:          no_aead_ng/1,
<a name="95"/>   95:          no_generate_compute/0,
<a name="96"/>   96:          no_generate_compute/1,
<a name="97"/>   97:          no_hash/0,
<a name="98"/>   98:          no_hash/1,
<a name="99"/>   99:          no_hmac/0,
<a name="100"/>  100:          no_hmac/1,
<a name="101"/>  101:          no_poly1305/0,
<a name="102"/>  102:          no_poly1305/1,
<a name="103"/>  103:          no_sign_verify/0,
<a name="104"/>  104:          no_sign_verify/1,
<a name="105"/>  105:          no_support/0,
<a name="106"/>  106:          no_support/1,
<a name="107"/>  107:          node_supports_cache/1,
<a name="108"/>  108:          poly1305/0,
<a name="109"/>  109:          poly1305/1,
<a name="110"/>  110:          private_encrypt/0,
<a name="111"/>  111:          private_encrypt/1,
<a name="112"/>  112:          public_encrypt/0,
<a name="113"/>  113:          public_encrypt/1,
<a name="114"/>  114:          rand_plugin/0,
<a name="115"/>  115:          rand_plugin/1,
<a name="116"/>  116:          rand_plugin_s/0,
<a name="117"/>  117:          rand_plugin_s/1,
<a name="118"/>  118:          rand_threads/0,
<a name="119"/>  119:          rand_threads/1,
<a name="120"/>  120:          rand_uniform/0,
<a name="121"/>  121:          rand_uniform/1,
<a name="122"/>  122:          hash_equals/0,
<a name="123"/>  123:          hash_equals/1,
<a name="124"/>  124:          sign_verify/0,
<a name="125"/>  125:          sign_verify/1,
<a name="126"/>  126:          ec_key_padding/1,
<a name="127"/>  127:          use_all_ec_sign_verify/1,
<a name="128"/>  128:          use_all_ecdh_generate_compute/1,
<a name="129"/>  129:          use_all_eddh_generate_compute/1,
<a name="130"/>  130:          pbkdf2_hmac/0,
<a name="131"/>  131:          pbkdf2_hmac/1,
<a name="132"/>  132:          pbkdf2_hmac_invalid_input/0,
<a name="133"/>  133:          pbkdf2_hmac_invalid_input/1,
<a name="134"/>  134:          privkey_to_pubkey/1,
<a name="135"/>  135: 
<a name="136"/>  136:          %% Others:
<a name="137"/>  137:          aes_128_cbc/1,
<a name="138"/>  138:          aes_128_ccm/1,
<a name="139"/>  139:          aes_128_cfb128/1,
<a name="140"/>  140:          aes_128_cfb8/1,
<a name="141"/>  141:          aes_128_ctr/1,
<a name="142"/>  142:          aes_128_ecb/1,
<a name="143"/>  143:          aes_128_gcm/1,
<a name="144"/>  144:          aes_128_ofb/1,
<a name="145"/>  145:          aes_192_cbc/1,
<a name="146"/>  146:          aes_192_ccm/1,
<a name="147"/>  147:          aes_192_cfb128/1,
<a name="148"/>  148:          aes_192_cfb8/1,
<a name="149"/>  149:          aes_192_ctr/1,
<a name="150"/>  150:          aes_192_ecb/1,
<a name="151"/>  151:          aes_192_gcm/1,
<a name="152"/>  152:          aes_192_ofb/1,
<a name="153"/>  153:          aes_256_cbc/1,
<a name="154"/>  154:          aes_256_ccm/1,
<a name="155"/>  155:          aes_256_cfb128/1,
<a name="156"/>  156:          aes_256_cfb8/1,
<a name="157"/>  157:          aes_256_ctr/1,
<a name="158"/>  158:          aes_256_ecb/1,
<a name="159"/>  159:          aes_256_gcm/1,
<a name="160"/>  160:          aes_256_ofb/1,
<a name="161"/>  161:          aes_cbc/1,
<a name="162"/>  162:          aes_cbc128/1,
<a name="163"/>  163:          aes_cbc256/1,
<a name="164"/>  164:          aes_ccm/1,
<a name="165"/>  165:          aes_cfb128/1,
<a name="166"/>  166:          aes_cfb8/1,
<a name="167"/>  167:          aes_ecb/1,
<a name="168"/>  168:          aes_gcm/1,
<a name="169"/>  169:          blowfish_cbc/1,
<a name="170"/>  170:          blowfish_cfb64/1,
<a name="171"/>  171:          blowfish_ecb/1,
<a name="172"/>  172:          blowfish_ofb64/1,
<a name="173"/>  173:          chacha20/1,
<a name="174"/>  174:          chacha20_poly1305/1,
<a name="175"/>  175:          des3_cbc/1,
<a name="176"/>  176:          des3_cbf/1,
<a name="177"/>  177:          des3_cfb/1,
<a name="178"/>  178:          des_cbc/1,
<a name="179"/>  179:          des_cfb/1,
<a name="180"/>  180:          des_ede3/1,
<a name="181"/>  181:          des_ede3_cbc/1,
<a name="182"/>  182:          des_ede3_cfb/1,
<a name="183"/>  183:          mac_check/1,
<a name="184"/>  184:          rc2_cbc/1,
<a name="185"/>  185:          rc4/1,
<a name="186"/>  186:          sm4_ecb/1,
<a name="187"/>  187:          sm4_cbc/1,
<a name="188"/>  188:          sm4_ofb/1,
<a name="189"/>  189:          sm4_cfb/1,
<a name="190"/>  190:          sm4_ctr/1,
<a name="191"/>  191:          sm4_gcm/1,
<a name="192"/>  192:          sm4_ccm/1,
<a name="193"/>  193:          ripemd160_incr_digest/0,
<a name="194"/>  194:          ripemd160_incr_msgs/0,
<a name="195"/>  195:          rsa_oaep/0,
<a name="196"/>  196:          rsa_oaep256/0,
<a name="197"/>  197:          rsa_oaep_label/0
<a name="198"/>  198:         ]).
<a name="199"/>  199: 
<a name="200"/>  200: 
<a name="201"/>  201: <i>%%--------------------------------------------------------------------</i>
<a name="202"/>  202: <i>%% Common Test interface functions -----------------------------------</i>
<a name="203"/>  203: <i>%%--------------------------------------------------------------------</i>
<a name="204"/>  204: 
<a name="suite-0"/><a name="suite-last_expr"/><a name="205"/>  205: <b>suite</b>() -&gt; [{ct_hooks,[ts_install_cth]}].
<a name="206"/>  206: 
<a name="all-0"/><a name="207"/>  207: <b>all</b>() -&gt;
<a name="all-last_expr"/><a name="208"/>  208:     [%%crypto_load,
<a name="209"/>  209:      %%crypto_load_and_call,
<a name="210"/>  210:      app,
<a name="211"/>  211:      {group, api_errors},
<a name="212"/>  212:      appup,
<a name="213"/>  213:      all_ciphers,
<a name="214"/>  214:      {group, fips},
<a name="215"/>  215:      {group, non_fips},
<a name="216"/>  216:      cipher_padding,
<a name="217"/>  217:      ec_key_padding,
<a name="218"/>  218:      node_supports_cache,
<a name="219"/>  219:      mod_pow,
<a name="220"/>  220:      exor,
<a name="221"/>  221:      rand_uniform,
<a name="222"/>  222:      rand_threads,
<a name="223"/>  223:      rand_plugin,
<a name="224"/>  224:      rand_plugin_s,
<a name="225"/>  225:      info,
<a name="226"/>  226:      cipher_info,
<a name="227"/>  227:      hash_info,
<a name="228"/>  228:      hash_equals,
<a name="229"/>  229:      pbkdf2_hmac,
<a name="230"/>  230:      pbkdf2_hmac_invalid_input
<a name="231"/>  231:     ].
<a name="232"/>  232: 
<a name="233"/>  233: <b>-define</b>(NEW_CIPHER_TYPE_SCHEMA,
<a name="234"/>  234:        ).
<a name="235"/>  235:         
<a name="groups-0"/><a name="236"/>  236: <b>groups</b>() -&gt;
<a name="groups-last_expr"/><a name="237"/>  237:     [{non_fips, [], [
<a name="238"/>  238:                      {group, blake2b},
<a name="239"/>  239:                      {group, blake2s},
<a name="240"/>  240:                      {group, poly1305},
<a name="241"/>  241:                      {group, dss},
<a name="242"/>  242:                      {group, ecdsa},
<a name="243"/>  243:                      {group, ed25519},
<a name="244"/>  244:                      {group, ed448},
<a name="245"/>  245:                      {group, rsa},
<a name="246"/>  246: 
<a name="247"/>  247:                      {group, md4},
<a name="248"/>  248:                      {group, md5},
<a name="249"/>  249:                      {group, ripemd160},
<a name="250"/>  250:                      {group, sha224},
<a name="251"/>  251:                      {group, sha256},
<a name="252"/>  252:                      {group, sha384},
<a name="253"/>  253:                      {group, sha3_224},
<a name="254"/>  254:                      {group, sha3_256},
<a name="255"/>  255:                      {group, sha3_384},
<a name="256"/>  256:                      {group, sha3_512},
<a name="257"/>  257:                      {group, sha512},
<a name="258"/>  258:                      {group, shake128},
<a name="259"/>  259:                      {group, shake256},
<a name="260"/>  260:                      {group, sha},
<a name="261"/>  261:                      {group, sm3},
<a name="262"/>  262: 
<a name="263"/>  263:                      {group, dh},
<a name="264"/>  264:                      {group, ecdh},
<a name="265"/>  265:                      {group, eddh},
<a name="266"/>  266:                      {group, srp},
<a name="267"/>  267: 
<a name="268"/>  268: 		     {group, chacha20_poly1305},
<a name="269"/>  269: 		     {group, chacha20},
<a name="270"/>  270:                      {group, blowfish_cbc},
<a name="271"/>  271:                      {group, blowfish_cfb64},
<a name="272"/>  272:                      {group, blowfish_ecb},
<a name="273"/>  273:                      {group, blowfish_ofb64},
<a name="274"/>  274: 
<a name="275"/>  275:                      {group, des_cbc},
<a name="276"/>  276:                      {group, des_cfb},
<a name="277"/>  277:                      {group, rc2_cbc},
<a name="278"/>  278:                      {group, rc4},
<a name="279"/>  279: 
<a name="280"/>  280:                      {group, sm4_ecb},
<a name="281"/>  281:                      {group, sm4_cbc},
<a name="282"/>  282:                      {group, sm4_ofb},
<a name="283"/>  283:                      {group, sm4_cfb},
<a name="284"/>  284:                      {group, sm4_ctr},
<a name="285"/>  285:                      {group, sm4_gcm},
<a name="286"/>  286:                      {group, sm4_ccm},
<a name="287"/>  287: 
<a name="288"/>  288:                      {group, des_ede3_cbc},
<a name="289"/>  289:                      {group, des_ede3_cfb},
<a name="290"/>  290:                      {group, aes_128_cbc},
<a name="291"/>  291:                      {group, aes_192_cbc},
<a name="292"/>  292:                      {group, aes_256_cbc},
<a name="293"/>  293:                      {group, aes_128_ctr},
<a name="294"/>  294:                      {group, aes_192_ctr},
<a name="295"/>  295:                      {group, aes_256_ctr},
<a name="296"/>  296:                      {group, aes_128_ccm},
<a name="297"/>  297:                      {group, aes_192_ccm},
<a name="298"/>  298:                      {group, aes_256_ccm},
<a name="299"/>  299:                      {group, aes_128_ecb},
<a name="300"/>  300:                      {group, aes_192_ecb},
<a name="301"/>  301:                      {group, aes_256_ecb},
<a name="302"/>  302:                      {group, aes_128_gcm},
<a name="303"/>  303:                      {group, aes_192_gcm},
<a name="304"/>  304:                      {group, aes_256_gcm},
<a name="305"/>  305:                      {group, des_ede3_cbc},
<a name="306"/>  306:                      {group, des_ede3_cfb},
<a name="307"/>  307:                      {group, aes_128_cfb128},
<a name="308"/>  308:                      {group, aes_192_cfb128},
<a name="309"/>  309:                      {group, aes_256_cfb128},
<a name="310"/>  310:                      {group, aes_128_cfb8},
<a name="311"/>  311:                      {group, aes_192_cfb8},
<a name="312"/>  312:                      {group, aes_256_cfb8},
<a name="313"/>  313:                      {group, aes_128_ofb},
<a name="314"/>  314:                      {group, aes_192_ofb},
<a name="315"/>  315:                      {group, aes_256_ofb}
<a name="316"/>  316:                     ]},
<a name="317"/>  317:      {fips, [], [
<a name="318"/>  318:                  {group, no_blake2b},
<a name="319"/>  319:                  {group, no_blake2s},
<a name="320"/>  320:                  {group, no_poly1305},
<a name="321"/>  321:                  {group, dss},
<a name="322"/>  322:                  {group, ecdsa},
<a name="323"/>  323:                  {group, no_ed25519},
<a name="324"/>  324:                  {group, no_ed448},
<a name="325"/>  325:                  {group, rsa},
<a name="326"/>  326: 
<a name="327"/>  327:                  {group, no_md4},
<a name="328"/>  328:                  {group, no_md5},
<a name="329"/>  329:                  {group, no_ripemd160},
<a name="330"/>  330:                  {group, sha},
<a name="331"/>  331:                  {group, sha224},
<a name="332"/>  332:                  {group, sha256},
<a name="333"/>  333:                  {group, sha384},
<a name="334"/>  334:                  {group, sha512},
<a name="335"/>  335:                  {group, sm3},
<a name="336"/>  336: 
<a name="337"/>  337:                  {group, dh},
<a name="338"/>  338:                  {group, ecdh},
<a name="339"/>  339:                  {group, no_srp},
<a name="340"/>  340: 
<a name="341"/>  341: 		 {group, no_chacha20_poly1305},
<a name="342"/>  342: 		 {group, no_chacha20},
<a name="343"/>  343:                  {group, no_blowfish_cbc},
<a name="344"/>  344:                  {group, no_blowfish_cfb64},
<a name="345"/>  345:                  {group, no_blowfish_ecb},
<a name="346"/>  346:                  {group, no_blowfish_ofb64},
<a name="347"/>  347: 
<a name="348"/>  348:                  {group, no_des_cbc},
<a name="349"/>  349:                  {group, no_des_cfb},
<a name="350"/>  350:                  {group, no_rc2_cbc},
<a name="351"/>  351:                  {group, no_rc4},
<a name="352"/>  352: 
<a name="353"/>  353:                  {group, des_ede3_cbc},
<a name="354"/>  354:                  {group, des_ede3_cfb},
<a name="355"/>  355:                  {group, aes_128_cbc},
<a name="356"/>  356:                  {group, aes_192_cbc},
<a name="357"/>  357:                  {group, aes_256_cbc},
<a name="358"/>  358:                  {group, aes_128_ctr},
<a name="359"/>  359:                  {group, aes_192_ctr},
<a name="360"/>  360:                  {group, aes_256_ctr},
<a name="361"/>  361:                  {group, aes_128_ccm},
<a name="362"/>  362:                  {group, aes_192_ccm},
<a name="363"/>  363:                  {group, aes_256_ccm},
<a name="364"/>  364:                  {group, aes_128_ecb},
<a name="365"/>  365:                  {group, aes_192_ecb},
<a name="366"/>  366:                  {group, aes_256_ecb},
<a name="367"/>  367:                  {group, aes_128_gcm},
<a name="368"/>  368:                  {group, aes_192_gcm},
<a name="369"/>  369:                  {group, aes_256_gcm},
<a name="370"/>  370:                  {group, des_ede3_cbc},
<a name="371"/>  371:                  {group, des_ede3_cfb},
<a name="372"/>  372:                  {group, aes_128_cfb128},
<a name="373"/>  373:                  {group, aes_192_cfb128},
<a name="374"/>  374:                  {group, aes_256_cfb128},
<a name="375"/>  375:                  {group, aes_128_cfb8},
<a name="376"/>  376:                  {group, aes_192_cfb8},
<a name="377"/>  377:                  {group, aes_256_cfb8},
<a name="378"/>  378:                  {group, aes_128_ofb},
<a name="379"/>  379:                  {group, aes_192_ofb},
<a name="380"/>  380:                  {group, aes_256_ofb}
<a name="381"/>  381:                 ]},
<a name="382"/>  382: 
<a name="383"/>  383:      {md4,                  [], [hash]},
<a name="384"/>  384:      {md5,                  [], [hash, hmac, hmac_update]},
<a name="385"/>  385:      {ripemd160,            [], [hash]},
<a name="386"/>  386:      {sha,                  [], [hash, hmac, hmac_update]},
<a name="387"/>  387:      {sha224,               [], [hash, hmac, hmac_update]},
<a name="388"/>  388:      {sha256,               [], [hash, hmac, hmac_update]},
<a name="389"/>  389:      {sha384,               [], [hash, hmac, hmac_update]},
<a name="390"/>  390:      {sha512,               [], [hash, hmac, hmac_update]},
<a name="391"/>  391:      {sha3_224,             [], [hash, hmac, hmac_update]},
<a name="392"/>  392:      {sha3_256,             [], [hash, hmac, hmac_update]},
<a name="393"/>  393:      {sha3_384,             [], [hash, hmac, hmac_update]},
<a name="394"/>  394:      {sha3_512,             [], [hash, hmac, hmac_update]},
<a name="395"/>  395:      {shake128,             [], [hash_xof]},
<a name="396"/>  396:      {shake256,             [], [hash_xof]},
<a name="397"/>  397:      {sm3,                  [], [hash, hmac]},
<a name="398"/>  398:      {blake2b,              [], [hash, hmac, hmac_update]},
<a name="399"/>  399:      {blake2s,              [], [hash, hmac, hmac_update]},
<a name="400"/>  400:      {no_blake2b,           [], [no_hash, no_hmac]},
<a name="401"/>  401:      {no_blake2s,           [], [no_hash, no_hmac]},
<a name="402"/>  402:      {rsa,                  [], [sign_verify,
<a name="403"/>  403:                                  public_encrypt,
<a name="404"/>  404:                                  private_encrypt,
<a name="405"/>  405:                                  generate,
<a name="406"/>  406:                                  privkey_to_pubkey
<a name="407"/>  407:                                 ]},
<a name="408"/>  408:      {dss,                  [], [sign_verify
<a name="409"/>  409:                                  %% Does not work yet:  ,public_encrypt, private_encrypt
<a name="410"/>  410:                                  %% dsa seem to always have been given bad result. Must fix:
<a name="411"/>  411:                                  %%      ,privkey_to_pubkey
<a name="412"/>  412:                                 ]},
<a name="413"/>  413:      {ecdsa,                [], [sign_verify, use_all_ec_sign_verify
<a name="414"/>  414:                                  %% Does not work yet:  ,public_encrypt, private_encrypt
<a name="415"/>  415:                                 ]},
<a name="416"/>  416:      {ed25519,              [], [sign_verify,
<a name="417"/>  417:                                  %% Does not work yet:  ,public_encrypt, private_encrypt
<a name="418"/>  418:                                  generate
<a name="419"/>  419:                               ]},
<a name="420"/>  420:      {ed448,                [], [sign_verify,
<a name="421"/>  421:                                  %% Does not work yet:  ,public_encrypt, private_encrypt
<a name="422"/>  422:                                  generate
<a name="423"/>  423:                                 ]},
<a name="424"/>  424:      {dh,                   [], [generate_compute, compute_bug]},
<a name="425"/>  425:      {ecdh,                 [], [compute, generate, use_all_ecdh_generate_compute]},
<a name="426"/>  426:      {eddh,                 [], [compute, generate, use_all_eddh_generate_compute]},
<a name="427"/>  427:      {srp,                  [], [generate_compute]},
<a name="428"/>  428:      {des_cbc,              [], [api_ng, api_ng_one_shot, cmac, cmac_update]},
<a name="429"/>  429:      {des_cfb,              [], [api_ng, api_ng_one_shot]},
<a name="430"/>  430:      {des_ede3_cbc,         [], [api_ng, api_ng_one_shot, cmac, cmac_update]},
<a name="431"/>  431:      {des_ede3_cfb,         [], [api_ng, api_ng_one_shot]},
<a name="432"/>  432:      {rc2_cbc,              [], [api_ng, api_ng_one_shot, cmac, cmac_update]},
<a name="433"/>  433:      {aes_cfb8,             [], []},
<a name="434"/>  434:      {aes_128_cfb8,         [], [api_ng, api_ng_one_shot]},
<a name="435"/>  435:      {aes_192_cfb8,         [], [api_ng, api_ng_one_shot]},
<a name="436"/>  436:      {aes_256_cfb8,         [], [api_ng, api_ng_one_shot]},
<a name="437"/>  437:      {no_aes_cfb8,          [], [no_support]},
<a name="438"/>  438:      {aes_cfb128,           [], []},
<a name="439"/>  439:      {aes_128_cfb128,       [], [api_ng, api_ng_one_shot]},
<a name="440"/>  440:      {aes_192_cfb128,       [], [api_ng, api_ng_one_shot]},
<a name="441"/>  441:      {aes_256_cfb128,       [], [api_ng, api_ng_one_shot]},
<a name="442"/>  442:      {no_aes_cfb128,        [], [no_support]},
<a name="443"/>  443:      {blowfish_cbc,         [], [api_ng, api_ng_one_shot, cmac, cmac_update]},
<a name="444"/>  444:      {blowfish_ecb,         [], [api_ng, api_ng_one_shot]},
<a name="445"/>  445:      {blowfish_cfb64,       [], [api_ng, api_ng_one_shot]},
<a name="446"/>  446:      {blowfish_ofb64,       [], [api_ng, api_ng_one_shot]},
<a name="447"/>  447:      {rc4,                  [], [api_ng, api_ng_one_shot]},
<a name="448"/>  448:      {sm4_ecb,              [], [api_ng, api_ng_one_shot]},
<a name="449"/>  449:      {sm4_cbc,              [], [api_ng, api_ng_one_shot]},
<a name="450"/>  450:      {sm4_ofb,              [], [api_ng, api_ng_one_shot]},
<a name="451"/>  451:      {sm4_cfb,              [], [api_ng, api_ng_one_shot]},
<a name="452"/>  452:      {sm4_ctr,              [], [api_ng, api_ng_one_shot]},
<a name="453"/>  453:      {sm4_gcm,              [], [aead_ng, aead_bad_tag]},
<a name="454"/>  454:      {sm4_ccm,              [], [aead_ng, aead_bad_tag]},
<a name="455"/>  455:      {chacha20_poly1305,    [], [aead_ng, aead_bad_tag]},
<a name="456"/>  456:      {chacha20,             [], [api_ng, api_ng_one_shot]},
<a name="457"/>  457:      {poly1305,             [], [poly1305]},
<a name="458"/>  458:      {no_poly1305,          [], [no_poly1305]},
<a name="459"/>  459:      {no_aes_cfb128,        [], [no_support]},
<a name="460"/>  460:      {no_md4,               [], [no_support, no_hash]},
<a name="461"/>  461:      {no_md5,               [], [no_support, no_hash, no_hmac]},
<a name="462"/>  462:      {no_ed25519,           [], [no_support, no_sign_verify
<a name="463"/>  463:                                  %% Does not work yet:  ,public_encrypt, private_encrypt
<a name="464"/>  464:                                 ]},
<a name="465"/>  465:      {no_ed448,             [], [no_support, no_sign_verify
<a name="466"/>  466:                                  %% Does not work yet:  ,public_encrypt, private_encrypt
<a name="467"/>  467:                                 ]},
<a name="468"/>  468:      {no_ripemd160,         [], [no_support, no_hash]},
<a name="469"/>  469:      {no_srp,               [], [no_support, no_generate_compute]},
<a name="470"/>  470:      {no_des_cbc,           [], [no_support]},
<a name="471"/>  471:      {no_des_cfb,           [], [no_support]},
<a name="472"/>  472:      {no_blowfish_cbc,      [], [no_support]},
<a name="473"/>  473:      {no_blowfish_ecb,      [], [no_support]},
<a name="474"/>  474:      {no_blowfish_cfb64,    [], [no_support]},
<a name="475"/>  475:      {no_blowfish_ofb64,    [], [no_support]},
<a name="476"/>  476:      {no_chacha20_poly1305, [], [no_support, no_aead_ng]},
<a name="477"/>  477:      {no_chacha20,          [], [no_support]},
<a name="478"/>  478:      {no_rc2_cbc,           [], [no_support]},
<a name="479"/>  479:      {no_rc4,               [], [no_support]},
<a name="480"/>  480:      {api_errors,           [], [api_errors_ecdh,
<a name="481"/>  481:                                  bad_key_length,
<a name="482"/>  482:                                  bad_cipher_name,
<a name="483"/>  483:                                  bad_generate_key_name,
<a name="484"/>  484:                                  bad_hash_name,
<a name="485"/>  485:                                  bad_mac_name,
<a name="486"/>  486:                                  bad_hmac_name,
<a name="487"/>  487:                                  bad_cmac_name,
<a name="488"/>  488:                                  bad_sign_name,
<a name="489"/>  489:                                  bad_verify_name
<a name="490"/>  490:                                 ]},
<a name="491"/>  491: 
<a name="492"/>  492:      %% New cipher nameing schema
<a name="493"/>  493:      {des_ede3_cbc, [], [api_ng, api_ng_one_shot]},
<a name="494"/>  494:      {des_ede3_cfb, [], [api_ng, api_ng_one_shot]},
<a name="495"/>  495:      {aes_128_cbc,  [], [api_ng, api_ng_one_shot, cmac, cmac_update]},
<a name="496"/>  496:      {aes_192_cbc,  [], [api_ng, api_ng_one_shot, cmac, cmac_update]},
<a name="497"/>  497:      {aes_256_cbc,  [], [api_ng, api_ng_one_shot, cmac, cmac_update]},
<a name="498"/>  498:      {aes_128_ctr,  [], [api_ng, api_ng_one_shot]},
<a name="499"/>  499:      {aes_192_ctr,  [], [api_ng, api_ng_one_shot]},
<a name="500"/>  500:      {aes_256_ctr,  [], [api_ng, api_ng_one_shot]},
<a name="501"/>  501:      {aes_128_ccm,  [], [aead_ng, aead_bad_tag]},
<a name="502"/>  502:      {aes_192_ccm,  [], [aead_ng, aead_bad_tag]},
<a name="503"/>  503:      {aes_256_ccm,  [], [aead_ng, aead_bad_tag]},
<a name="504"/>  504:      {aes_128_ecb,  [], [api_ng, api_ng_one_shot]},
<a name="505"/>  505:      {aes_192_ecb,  [], [api_ng, api_ng_one_shot]},
<a name="506"/>  506:      {aes_256_ecb,  [], [api_ng, api_ng_one_shot]},
<a name="507"/>  507:      {aes_128_gcm,  [], [aead_ng, aead_bad_tag]},
<a name="508"/>  508:      {aes_192_gcm,  [], [aead_ng, aead_bad_tag]},
<a name="509"/>  509:      {aes_256_gcm,  [], [aead_ng, aead_bad_tag]},
<a name="510"/>  510:      {aes_128_ofb,  [], [api_ng, api_ng_one_shot]},
<a name="511"/>  511:      {aes_192_ofb,  [], [api_ng, api_ng_one_shot]},
<a name="512"/>  512:      {aes_256_ofb,  [], [api_ng, api_ng_one_shot]}
<a name="513"/>  513:     ].
<a name="514"/>  514: 
<a name="515"/>  515: <i>%%-------------------------------------------------------------------</i>
<a name="init_per_suite-1"/><a name="516"/>  516: <b>init_per_suite</b>(Config) -&gt;
<a name="517"/>  517:     file:set_cwd(datadir(Config)),
<a name="518"/>  518:     {ok, _} = zip:unzip(&quot;KAT_AES.zip&quot;),
<a name="519"/>  519:     {ok, _} = zip:unzip(&quot;aesmmt.zip&quot;),
<a name="520"/>  520:     {ok, _} = zip:unzip(&quot;cmactestvectors.zip&quot;),
<a name="521"/>  521:     {ok, _} = zip:unzip(&quot;gcmtestvectors.zip&quot;),
<a name="522"/>  522: 
<a name="init_per_suite-last_expr"/><a name="523"/>  523: <b>    try is_ok</b>(crypto:start()) of
<a name="524"/>  524: 	ok -&gt;
<a name="525"/>  525:             catch ct:comment(&quot;~s&quot;,[element(3,hd(crypto:info_lib()))]),
<a name="526"/>  526:             catch ct:log(&quot;crypto:info()     -&gt; ~p~n&quot;
<a name="527"/>  527:                          &quot;crypto:info_lib() -&gt; ~p~n&quot;
<a name="528"/>  528:                          &quot;crypto:version()  -&gt; ~p~n&quot;
<a name="529"/>  529:                          &quot;crypto:supports() -&gt; ~p~n&quot;
<a name="530"/>  530:                         ,[crypto:info(), crypto:info_lib(), crypto:version(), crypto:supports()]),
<a name="531"/>  531: 
<a name="532"/>  532: 	    try crypto:strong_rand_bytes(1) of
<a name="533"/>  533: 		_ -&gt;
<a name="534"/>  534: 		    Config
<a name="535"/>  535: 	    catch error:low_entropy -&gt;
<a name="536"/>  536:                     %% We are testing on an OS with low entropy in its random
<a name="537"/>  537:                     %% seed. So we have to seed it with a binary to get started.
<a name="538"/>  538: 
<a name="539"/>  539: 		    %% This is NOT how you want to do seeding, it is just here
<a name="540"/>  540: 		    %% to make the tests pass. Check your OS manual for how you
<a name="541"/>  541: 		    %% really want to seed.
<a name="542"/>  542: 		    {H,M,L} = erlang:timestamp(),
<a name="543"/>  543: 		    Bin = &lt;&lt;H:24,M:20,L:20&gt;&gt;,
<a name="544"/>  544: 		    crypto:rand_seed(&lt;&lt; &lt;&lt;Bin/binary&gt;&gt; || _ &lt;- lists:seq(1,16) &gt;&gt;),
<a name="545"/>  545: 		    Config
<a name="546"/>  546: 	    end
<a name="547"/>  547:                   
<a name="548"/>  548:     catch C:E:S -&gt;
<a name="549"/>  549:             ct:log(&quot;~p ~p~n~p&quot;, [C,E,S]),
<a name="550"/>  550: 	    {fail, &quot;Crypto did not start&quot;}
<a name="551"/>  551:     end.
<a name="552"/>  552: 
<a name="is_ok-1"/><a name="553"/>  553: <b>is_ok</b>(ok) -&gt; ok;
<a name="554"/>  554: <b>is_ok</b>({error, already_started}) -&gt; ok;
<a name="is_ok-last_expr"/><a name="555"/>  555: <b>is_ok</b>({error,{already_started,crypto}}) -&gt; ok.
<a name="556"/>  556: 
<a name="557"/>  557:     
<a name="558"/>  558: 
<a name="end_per_suite-1"/><a name="559"/>  559: <b>end_per_suite</b>(_Config) -&gt;
<a name="end_per_suite-last_expr"/><a name="560"/>  560: <b>    application:stop</b>(crypto).
<a name="561"/>  561: 
<a name="562"/>  562: <i>%%-------------------------------------------------------------------</i>
<a name="init_per_group-2"/><a name="563"/>  563: <b>init_per_group</b>(fips, Config) -&gt;
<a name="564"/>  564:     try_enable_fips_mode(Config);
<a name="565"/>  565: <b>init_per_group</b>(non_fips, Config) -&gt;
<a name="566"/>  566:     NonFIPSConfig = [{fips, false} | Config],
<a name="567"/>  567:     case crypto:info_fips() of
<a name="568"/>  568:         enabled -&gt;
<a name="569"/>  569:             true = crypto:enable_fips_mode(false),
<a name="570"/>  570:             not_enabled = crypto:info_fips(),
<a name="571"/>  571:             NonFIPSConfig;
<a name="572"/>  572:         _NotEnabled -&gt;
<a name="573"/>  573:             NonFIPSConfig
<a name="574"/>  574:     end;
<a name="575"/>  575: <b>init_per_group</b>(api_errors, Config) -&gt;
<a name="576"/>  576:     Config;
<a name="577"/>  577: <b>init_per_group</b>(GroupName, Config) -&gt;
<a name="init_per_group-last_expr"/><a name="578"/>  578: <b>    case atom_to_list</b>(GroupName) of
<a name="579"/>  579:         &quot;no_&quot; ++ TypeStr -&gt;
<a name="580"/>  580:             %% Negated test case: check the algorithm is not supported
<a name="581"/>  581:             %% (e.g. due to FIPS mode limitations)
<a name="582"/>  582:             TypeAtom = list_to_atom(TypeStr),
<a name="583"/>  583:             [{type, TypeAtom} | group_config(TypeAtom, Config)];
<a name="584"/>  584:         _Other -&gt;
<a name="585"/>  585:             %% Regular test case: skip if the algorithm is not supported
<a name="586"/>  586:             case is_supported(GroupName) of
<a name="587"/>  587:                 true -&gt;
<a name="588"/>  588:                     [{type, GroupName} | group_config(GroupName, Config)];
<a name="589"/>  589:                 false -&gt;
<a name="590"/>  590:                     {skip, &quot;Group not supported&quot;}
<a name="591"/>  591:             end
<a name="592"/>  592:     end.
<a name="593"/>  593: 
<a name="end_per_group-2"/><a name="594"/>  594: <b>end_per_group</b>(_GroupName, Config) -&gt;
<a name="end_per_group-last_expr"/><a name="595"/>  595:     Config.
<a name="596"/>  596: 
<a name="init_per_testcase-2"/><a name="597"/>  597: <b>init_per_testcase</b>(info, Config) -&gt;
<a name="598"/>  598:     Config;
<a name="599"/>  599: <b>init_per_testcase</b>(cmac, Config) -&gt;
<a name="600"/>  600:     case is_supported(cmac) of
<a name="601"/>  601:         true -&gt;
<a name="602"/>  602:             configure_mac(cmac, proplists:get_value(type,Config), Config);
<a name="603"/>  603:         false -&gt;
<a name="604"/>  604:             {skip, &quot;CMAC is not supported&quot;}
<a name="605"/>  605:     end;
<a name="606"/>  606: <b>init_per_testcase</b>(cmac_update, Config) -&gt;
<a name="607"/>  607:     case {is_supported(cmac),
<a name="608"/>  608:           maps:get(cryptolib_version_linked, crypto:info(), &quot;&quot;)} of
<a name="609"/>  609:         {true, &quot;OpenSSL 1.0.&quot;++_} -&gt; {skip, &quot;cmac_update is not supported&quot;};
<a name="610"/>  610:         {false,                _} -&gt; {skip, &quot;CMAC is not supported&quot;};
<a name="611"/>  611:         _ -&gt; Config
<a name="612"/>  612:     end;
<a name="613"/>  613: <b>init_per_testcase</b>(generate, Config) -&gt;
<a name="614"/>  614:     case proplists:get_value(type, Config) of
<a name="615"/>  615: 	rsa -&gt;
<a name="616"/>  616: 	    % RSA key generation is a lengthy process, and is only available
<a name="617"/>  617: 	    % if dirty CPU scheduler support was enabled for this runtime.
<a name="618"/>  618: 	    case try erlang:system_info(dirty_cpu_schedulers) of
<a name="619"/>  619: 		     N -&gt; N &gt; 0
<a name="620"/>  620: 		 catch
<a name="621"/>  621: 		     error:badarg -&gt; false
<a name="622"/>  622: 		 end of
<a name="623"/>  623: 		true -&gt; Config;
<a name="624"/>  624: 		false -&gt; {skip, &quot;RSA key generation requires dirty scheduler support.&quot;}
<a name="625"/>  625: 	    end;
<a name="626"/>  626: 	_ -&gt; Config
<a name="627"/>  627:     end;
<a name="628"/>  628: <b>init_per_testcase</b>(hmac, Config) -&gt;
<a name="629"/>  629:     configure_mac(hmac, proplists:get_value(type,Config), Config);
<a name="630"/>  630: <b>init_per_testcase</b>(_Name,Config) -&gt;
<a name="631"/>  631:     Skip =
<a name="632"/>  632:         lists:member(_Name, [%%i_ng_tls
<a name="633"/>  633: <i>%%                            , node_supports_cache</i>
<a name="634"/>  634:                             ]) andalso
<a name="635"/>  635:         asan == maps:get(compile_type, crypto:info(), undefined) andalso
<a name="636"/>  636:         lists:prefix(&quot;OpenSSL 3.0.0 &quot;, maps:get(cryptolib_version_linked, crypto:info(), &quot;&quot;)),
<a name="init_per_testcase-last_expr"/><a name="637"/>  637:     case Skip of
<a name="638"/>  638:         true -&gt; {skip, &quot;Coredumps 3.0.0 asan&quot;};
<a name="639"/>  639:         false -&gt; Config
<a name="640"/>  640:     end.
<a name="641"/>  641: 
<a name="end_per_testcase-2"/><a name="642"/>  642: <b>end_per_testcase</b>(info, Config) -&gt;
<a name="643"/>  643:     Config;
<a name="644"/>  644: <b>end_per_testcase</b>(_Name,Config) -&gt;
<a name="end_per_testcase-last_expr"/><a name="645"/>  645:     Config.
<a name="646"/>  646: 
<a name="647"/>  647: <i>%%--------------------------------------------------------------------</i>
<a name="648"/>  648: <i>%% Test Cases --------------------------------------------------------</i>
<a name="649"/>  649: <i>%%--------------------------------------------------------------------</i>
<a name="app-0"/><a name="650"/>  650: <b>app</b>() -&gt;
<a name="app-last_expr"/><a name="651"/>  651:     [{doc, &quot;Test that the crypto app file is ok&quot;}].
<a name="app-1"/><a name="652"/>  652: <b>app</b>(Config) when is_list(Config) -&gt;
<a name="app-last_expr"/><a name="653"/>  653: <b>    ok = test_server:app_test</b>(crypto).
<a name="654"/>  654: <i>%%--------------------------------------------------------------------</i>
<a name="appup-0"/><a name="655"/>  655: <b>appup</b>() -&gt;
<a name="appup-last_expr"/><a name="656"/>  656:     [{doc, &quot;Test that the crypto appup file is ok&quot;}].
<a name="appup-1"/><a name="657"/>  657: <b>appup</b>(Config) when is_list(Config) -&gt;
<a name="appup-last_expr"/><a name="658"/>  658: <b>    ok = test_server:appup_test</b>(crypto).
<a name="659"/>  659: 
<a name="660"/>  660: <i>%%--------------------------------------------------------------------</i>
<a name="661"/>  661: <i>%% Simple encode/decode for all ciphers in crypto:supports(ciphers). No</i>
<a name="662"/>  662: <i>%% checking of the encrypted text, just check that it is decrypted back</i>
<a name="663"/>  663: <i>%% to the plain text.</i>
<a name="all_ciphers-1"/><a name="664"/>  664: <b>all_ciphers</b>(_Config) -&gt;
<a name="all_ciphers-last_expr"/><a name="665"/>  665: <b>    case [C || C &lt;- crypto:supports</b>(ciphers),
<a name="666"/>  666:                ok =/= simple_cipher_test(C)] of
<a name="667"/>  667:         [] -&gt;
<a name="668"/>  668:             ok;
<a name="669"/>  669:         BadCiphers -&gt;
<a name="670"/>  670:             ct:log(&quot;Bad ciphers: ~p&quot;, [BadCiphers]),
<a name="671"/>  671:             {fail, &quot;Cipher(s) failed&quot;}
<a name="672"/>  672:     end.
<a name="673"/>  673: 
<a name="simple_cipher_test-1"/><a name="674"/>  674: <b>simple_cipher_test</b>(Cipher) -&gt;
<a name="simple_cipher_test-last_expr"/><a name="675"/>  675:     try
<a name="676"/>  676:         #{key_length := KeyLength,
<a name="677"/>  677:           iv_length := IvLength,
<a name="678"/>  678:           block_size := BlockSize,
<a name="679"/>  679:           mode := CipherMode
<a name="680"/>  680:          } = crypto:cipher_info(Cipher),
<a name="681"/>  681:         Key = &lt;&lt;1:KeyLength/unit:8&gt;&gt;,
<a name="682"/>  682:         IV = &lt;&lt;0:IvLength/unit:8&gt;&gt;,
<a name="683"/>  683:         Plain0 = &lt;&lt;&quot;Hello world! Let's do some cipher tests&quot;&gt;&gt;,
<a name="684"/>  684:         Plain = case BlockSize of
<a name="685"/>  685:                     1 -&gt; Plain0;
<a name="686"/>  686:                     _ -&gt; &lt;&lt;Plain0:BlockSize/binary&gt;&gt;
<a name="687"/>  687:                 end,
<a name="688"/>  688:         enc_dec(Cipher, Key, IV, CipherMode, Plain)
<a name="689"/>  689:     catch
<a name="690"/>  690:         Class:Error:Stack -&gt;
<a name="691"/>  691:             ct:log(&quot;Error for cipher ~p:~nClass = ~p~nError = ~p~nStack = ~p&quot;,
<a name="692"/>  692:                    [Cipher, Class, Error, Stack]),
<a name="693"/>  693:             error
<a name="694"/>  694:     end.
<a name="695"/>  695: 
<a name="696"/>  696: 
<a name="697"/>  697: 
<a name="enc_dec-5"/><a name="698"/>  698: <b>enc_dec</b>(Cipher, Key, 0, _Mode, Plain) -&gt;
<a name="699"/>  699:     case crypto:crypto_one_time(Cipher, Key, Plain, true) of
<a name="700"/>  700:         Encrypted when is_binary(Encrypted) -&gt;
<a name="701"/>  701:              case crypto:crypto_one_time(Cipher, Key, Encrypted, false) of
<a name="702"/>  702:                  Plain -&gt;
<a name="703"/>  703:                      ok;
<a name="704"/>  704:                  Other -&gt;
<a name="705"/>  705:                      ct:log(&quot;~p:~p Error for cipher ~p:~n~p&quot;, [?MODULE,?LINE,Cipher, Other]),
<a name="706"/>  706:                      error
<a name="707"/>  707:              end;
<a name="708"/>  708:         Other -&gt;
<a name="709"/>  709:             ct:log(&quot;~p:~p Error for cipher ~p:~n~p&quot;, [?MODULE,?LINE,Cipher, Other]),
<a name="710"/>  710:             error
<a name="711"/>  711:     end;
<a name="712"/>  712: 
<a name="713"/>  713: <b>enc_dec</b>(Cipher, Key, IV, Mode, Plain) when Mode == ccm_mode ;
<a name="714"/>  714:                                            Mode == gcm_mode ;
<a name="715"/>  715:                                            Cipher == chacha20_poly1305 -&gt;
<a name="716"/>  716:     AAD = aad(Cipher, Mode),
<a name="717"/>  717:     case crypto:crypto_one_time_aead(Cipher, Key, IV, Plain, AAD, true) of
<a name="718"/>  718:         {Encrypted,Tag} when is_binary(Encrypted) -&gt;
<a name="719"/>  719:             case crypto:crypto_one_time_aead(Cipher, Key, IV, Encrypted, AAD, Tag, false) of
<a name="720"/>  720:                  Plain -&gt;
<a name="721"/>  721:                      ok;
<a name="722"/>  722:                  Other -&gt;
<a name="723"/>  723:                      ct:log(&quot;~p:~p Error for cipher ~p:~n~p&quot;, [?MODULE,?LINE,Cipher, Other]),
<a name="724"/>  724:                      error
<a name="725"/>  725:              end;
<a name="726"/>  726:         Other -&gt;
<a name="727"/>  727:             ct:log(&quot;~p:~p Error for cipher ~p:~n~p&quot;, [?MODULE,?LINE,Cipher, Other]),
<a name="728"/>  728:             error
<a name="729"/>  729:     end;
<a name="730"/>  730: 
<a name="731"/>  731: <b>enc_dec</b>(Cipher, Key, IV, _Mode, Plain) -&gt;
<a name="enc_dec-last_expr"/><a name="732"/>  732: <b>    case crypto:crypto_one_time</b>(Cipher, Key, IV, Plain, true) of
<a name="733"/>  733:         Encrypted when is_binary(Encrypted) -&gt;
<a name="734"/>  734:              case crypto:crypto_one_time(Cipher, Key, IV, Encrypted, false) of
<a name="735"/>  735:                  Plain -&gt;
<a name="736"/>  736:                      ok;
<a name="737"/>  737:                  Other -&gt;
<a name="738"/>  738:                      ct:log(&quot;~p:~p Error for cipher ~p:~n~p&quot;, [?MODULE,?LINE,Cipher, Other]),
<a name="739"/>  739:                      error
<a name="740"/>  740:              end;
<a name="741"/>  741:         Other -&gt;
<a name="742"/>  742:             ct:log(&quot;~p:~p Error for cipher ~p:~n~p&quot;, [?MODULE,?LINE,Cipher, Other]),
<a name="743"/>  743:             error
<a name="744"/>  744:     end.
<a name="745"/>  745: 
<a name="aad-2"/><a name="746"/>  746: <b>aad</b>(_Cipher, _Mode) -&gt;
<a name="747"/>  747:     %% Any size will do
<a name="aad-last_expr"/><a name="748"/>  748:     &lt;&lt;&quot;Some text&quot;&gt;&gt;.
<a name="749"/>  749: 
<a name="750"/>  750: <i>%%--------------------------------------------------------------------</i>
<a name="no_support-0"/><a name="751"/>  751: <b>no_support</b>() -&gt;
<a name="no_support-last_expr"/><a name="752"/>  752:     [{doc, &quot;Test an algorithm is not reported in the supported list&quot;}].
<a name="no_support-1"/><a name="753"/>  753: <b>no_support</b>(Config) when is_list(Config) -&gt;
<a name="754"/>  754:     Type  = ?config(type, Config),
<a name="no_support-last_expr"/><a name="755"/>  755: <b>    false = is_supported</b>(Type).
<a name="756"/>  756: <i>%%--------------------------------------------------------------------</i>
<a name="crypto_load-1"/><a name="757"/>  757: <b>crypto_load</b>(_Config) -&gt;
<a name="758"/>  758:     (catch crypto:stop()),
<a name="759"/>  759:     code:delete(crypto),
<a name="760"/>  760:     code:purge(crypto),
<a name="crypto_load-last_expr"/><a name="761"/>  761: <b>    crypto:start</b>().
<a name="762"/>  762: <i>%%--------------------------------------------------------------------</i>
<a name="crypto_load_and_call-1"/><a name="763"/>  763: <b>crypto_load_and_call</b>(_Config) -&gt;
<a name="764"/>  764:     (catch crypto:stop()),
<a name="765"/>  765:     code:delete(crypto),
<a name="766"/>  766:     code:purge(crypto),
<a name="767"/>  767:     Key0 = &quot;ablurf123BX#$;3&quot;,
<a name="768"/>  768:     Bin0 = erlang:md5(&lt;&lt;&quot;whatever&quot;&gt;&gt;),
<a name="769"/>  769:     {Key,IVec,_BlockSize} = make_crypto_key(Key0),
<a name="crypto_load_and_call-last_expr"/><a name="770"/>  770: <b>    crypto:crypto_one_time</b>(des_ede3_cbc, Key, IVec, Bin0, true).
<a name="771"/>  771: 
<a name="make_crypto_key-1"/><a name="772"/>  772: <b>make_crypto_key</b>(String) -&gt;
<a name="773"/>  773:     &lt;&lt;K1:8/binary,K2:8/binary&gt;&gt; = First = erlang:md5(String),
<a name="774"/>  774:     &lt;&lt;K3:8/binary,IVec:8/binary&gt;&gt; = erlang:md5([First|lists:reverse(String)]),
<a name="make_crypto_key-last_expr"/><a name="775"/>  775:     {[K1,K2,K3],IVec,8}.
<a name="776"/>  776: <i>%%--------------------------------------------------------------------</i>
<a name="777"/>  777: <i>%% Test that a spawned node has initialized the cache</i>
<a name="778"/>  778: 
<a name="node_supports_cache-1"/><a name="779"/>  779: <b>node_supports_cache</b>(_Config) -&gt;
<a name="780"/>  780:     ECs = crypto:supports(curves),
<a name="781"/>  781:     {ok,Peer,Node} = ?CT_PEER(),
<a name="node_supports_cache-last_expr"/><a name="782"/>  782: <b>    case erpc:call</b>(Node, crypto, supports, [curves]) of
<a name="783"/>  783:         ECs -&gt;
<a name="784"/>  784:             peer:stop(Peer);
<a name="785"/>  785:         OtherECs -&gt;
<a name="786"/>  786:             peer:stop(Peer),
<a name="787"/>  787:             ct:log(&quot;At master:~p~nAt slave:~p~n&quot;
<a name="788"/>  788:                    &quot;Missing at slave: ~p~nmissing at master: ~p&quot;,
<a name="789"/>  789:                    [ECs, OtherECs, ECs--OtherECs, OtherECs--ECs]),
<a name="790"/>  790:             {fail, &quot;different support at slave&quot;}
<a name="791"/>  791:     end.
<a name="792"/>  792: 
<a name="793"/>  793: <i>%%--------------------------------------------------------------------</i>
<a name="hash-0"/><a name="794"/>  794: <b>hash</b>() -&gt;
<a name="hash-last_expr"/><a name="795"/>  795:     [{doc, &quot;Test all different hash functions&quot;}].
<a name="hash-1"/><a name="796"/>  796: <b>hash</b>(Config) when is_list(Config) -&gt;
<a name="797"/>  797:     {Type, MsgsLE, Digests} = proplists:get_value(hash, Config),
<a name="798"/>  798:     Msgs = lazy_eval(MsgsLE),
<a name="799"/>  799:     [LongMsg | _] = lists:reverse(Msgs),
<a name="800"/>  800:     Inc = iolistify(LongMsg),
<a name="801"/>  801:     [IncrDigest | _] = lists:reverse(Digests),
<a name="802"/>  802:     hash(Type, Msgs, Digests),
<a name="803"/>  803:     hash(Type, lists:map(fun iolistify/1, Msgs), Digests),
<a name="hash-last_expr"/><a name="804"/>  804: <b>    hash_increment</b>(Type, Inc, IncrDigest).
<a name="805"/>  805: 
<a name="hash_xof-0"/><a name="806"/>  806: <b>hash_xof</b>() -&gt;
<a name="hash_xof-last_expr"/><a name="807"/>  807:   [{doc, &quot;Test all different hash_xof functions&quot;}].
<a name="hash_xof-1"/><a name="808"/>  808: <b>hash_xof</b>(Config) when is_list(Config) -&gt;
<a name="809"/>  809:   {Type, MsgsLE, Digests, Lengths} = proplists:get_value(hash_xof, Config),
<a name="810"/>  810:   Msgs = lazy_eval(MsgsLE),
<a name="hash_xof-last_expr"/><a name="811"/>  811: <b>  hash_xof</b>(Type, Msgs, Digests, Lengths).
<a name="812"/>  812: 
<a name="813"/>  813: <i>%%--------------------------------------------------------------------</i>
<a name="no_hash-0"/><a name="814"/>  814: <b>no_hash</b>() -&gt;
<a name="no_hash-last_expr"/><a name="815"/>  815:     [{doc, &quot;Test all disabled hash functions&quot;}].
<a name="no_hash-1"/><a name="816"/>  816: <b>no_hash</b>(Config) when is_list(Config) -&gt;
<a name="817"/>  817:     Type = ?config(type, Config),
<a name="818"/>  818:     notsup(fun crypto:hash/2, [Type, &lt;&lt;&quot;Hi There&quot;&gt;&gt;]),
<a name="no_hash-last_expr"/><a name="819"/>  819: <b>    notsup</b>(fun crypto:hash_init/1, [Type]).
<a name="820"/>  820: <i>%%--------------------------------------------------------------------</i>
<a name="hmac-0"/><a name="821"/>  821: <b>hmac</b>() -&gt;
<a name="hmac-last_expr"/><a name="822"/>  822:      [{doc, &quot;Test hmac function&quot;}].
<a name="hmac-1"/><a name="823"/>  823: <b>hmac</b>(Config) when is_list(Config) -&gt;
<a name="824"/>  824:     Tuples = lazy_eval(proplists:get_value(hmac, Config)),
<a name="hmac-last_expr"/><a name="825"/>  825: <b>    do_cipher_tests</b>(fun mac_check/1, Tuples++mac_listify(Tuples)).
<a name="826"/>  826: <i>%%--------------------------------------------------------------------</i>
<a name="no_hmac-0"/><a name="827"/>  827: <b>no_hmac</b>() -&gt;
<a name="no_hmac-last_expr"/><a name="828"/>  828:      [{doc, &quot;Test all disabled hmac functions&quot;}].
<a name="no_hmac-1"/><a name="829"/>  829: <b>no_hmac</b>(Config) when is_list(Config) -&gt;
<a name="830"/>  830:     Type = ?config(type, Config),
<a name="no_hmac-last_expr"/><a name="831"/>  831: <b>    notsup</b>(fun crypto:mac/4, [hmac, Type, &lt;&lt;&quot;Key&quot;&gt;&gt;, &lt;&lt;&quot;Hi There&quot;&gt;&gt;]).
<a name="832"/>  832: <i>%%--------------------------------------------------------------------</i>
<a name="hmac_update-0"/><a name="833"/>  833: <b>hmac_update</b>() -&gt;
<a name="hmac_update-last_expr"/><a name="834"/>  834:      [{doc, &quot;Test all incremental hmac functions&quot;}].
<a name="hmac_update-1"/><a name="835"/>  835: <b>hmac_update</b>(Config) -&gt;
<a name="836"/>  836:     SubType = ?config(type, Config),
<a name="837"/>  837:     Key = hmac_key(SubType),
<a name="838"/>  838:     Increments = hmac_inc(SubType),
<a name="hmac_update-last_expr"/><a name="839"/>  839: <b>    mac_increment</b>(hmac, SubType, Key, Increments).
<a name="840"/>  840: <i>%%--------------------------------------------------------------------</i>
<a name="cmac-0"/><a name="841"/>  841: <b>cmac</b>() -&gt;
<a name="cmac-last_expr"/><a name="842"/>  842:      [{doc, &quot;Test all different cmac functions&quot;}].
<a name="cmac-1"/><a name="843"/>  843: <b>cmac</b>(Config) when is_list(Config) -&gt;
<a name="844"/>  844:     Pairs = lazy_eval(proplists:get_value(cmac, Config)),
<a name="cmac-last_expr"/><a name="845"/>  845: <b>    do_cipher_tests</b>(fun mac_check/1, Pairs ++ mac_listify(Pairs)).
<a name="846"/>  846: <i>%%--------------------------------------------------------------------</i>
<a name="cmac_update-0"/><a name="847"/>  847: <b>cmac_update</b>() -&gt;
<a name="cmac_update-last_expr"/><a name="848"/>  848:      [{doc, &quot;Test all incremental cmac functions&quot;}].
<a name="cmac_update-1"/><a name="849"/>  849: <b>cmac_update</b>(Config) -&gt;
<a name="850"/>  850:     SubType = ?config(type, Config),
<a name="851"/>  851:     Key = cmac_key(SubType),
<a name="852"/>  852:     Increments = cmac_inc(SubType),
<a name="cmac_update-last_expr"/><a name="853"/>  853: <b>    mac_increment</b>(cmac, SubType, Key, Increments).
<a name="854"/>  854: <i>%%--------------------------------------------------------------------</i>
<a name="poly1305-0"/><a name="855"/>  855: <b>poly1305</b>() -&gt;
<a name="poly1305-last_expr"/><a name="856"/>  856:     [{doc, &quot;Test poly1305 function&quot;}].
<a name="poly1305-1"/><a name="857"/>  857: <b>poly1305</b>(Config) -&gt;
<a name="poly1305-last_expr"/><a name="858"/>  858: <b>    lists:foreach</b>(
<a name="859"/>  859:       fun({Key, Txt, Expect}) -&gt;
<a name="860"/>  860:               case crypto:mac(poly1305,Key,Txt) of
<a name="861"/>  861:                   Expect -&gt;
<a name="862"/>  862:                       ok;
<a name="863"/>  863:                   Other -&gt;
<a name="864"/>  864:                       ct:fail({{crypto, mac, [poly1305, Key, Txt]}, {expected, Expect}, {got, Other}})
<a name="865"/>  865:               end
<a name="866"/>  866:       end, proplists:get_value(poly1305, Config)).
<a name="867"/>  867: 
<a name="868"/>  868: <i>%%--------------------------------------------------------------------</i>
<a name="no_poly1305-0"/><a name="869"/>  869: <b>no_poly1305</b>() -&gt;
<a name="no_poly1305-last_expr"/><a name="870"/>  870:     [{doc, &quot;Test disabled poly1305 function&quot;}].
<a name="no_poly1305-1"/><a name="871"/>  871: <b>no_poly1305</b>(_Config) -&gt;
<a name="872"/>  872:     Key = &lt;&lt;133,214,190,120,87,85,109,51,127,68,82,254,66,213,6,168,1,
<a name="873"/>  873:             3,128,138,251,13,178,253,74,191,246,175,65,73,245,27&gt;&gt;,
<a name="874"/>  874:     Txt = &lt;&lt;&quot;Cryptographic Forum Research Group&quot;&gt;&gt;,
<a name="no_poly1305-last_expr"/><a name="875"/>  875: <b>    notsup</b>(fun crypto:mac/3, [poly1305,Key,Txt]).
<a name="876"/>  876: 
<a name="877"/>  877: <i>%%--------------------------------------------------------------------</i>
<a name="api_ng-0"/><a name="878"/>  878: <b>api_ng</b>() -&gt;
<a name="api_ng-last_expr"/><a name="879"/>  879:      [{doc, &quot;Test new api&quot;}].
<a name="880"/>  880: 
<a name="api_ng-1"/><a name="881"/>  881: <b>api_ng</b>(Config) when is_list(Config) -&gt;
<a name="882"/>  882:     [_|_] = Ciphers = lazy_eval(proplists:get_value(cipher, Config, [])),
<a name="api_ng-last_expr"/><a name="883"/>  883: <b>    lists:foreach</b>(fun api_ng_cipher_increment/1, Ciphers ++ spec_0_bytes(Config)).
<a name="884"/>  884: 
<a name="api_ng_cipher_increment-1"/><a name="885"/>  885: <b>api_ng_cipher_increment</b>({Type, Key, PlainTexts}=_X) -&gt;
<a name="886"/>  886:     ct:log(&quot;~p&quot;,[_X]),
<a name="887"/>  887:     api_ng_cipher_increment({Type, Key, &lt;&lt;&gt;&gt;, PlainTexts});
<a name="888"/>  888: 
<a name="889"/>  889: <b>api_ng_cipher_increment</b>({Type, Key, IV, PlainTexts}=_X) -&gt;
<a name="890"/>  890:     ct:log(&quot;~p&quot;,[_X]),
<a name="891"/>  891:     api_ng_cipher_increment({Type, Key, IV, PlainTexts, undefined});
<a name="892"/>  892: 
<a name="893"/>  893: <b>api_ng_cipher_increment</b>({Type, Key, IV, PlainText0, ExpectedEncText}=_X) -&gt;
<a name="894"/>  894:     ct:log(&quot;~p&quot;,[_X]),
<a name="895"/>  895:     PlainTexts = iolistify(PlainText0),
<a name="896"/>  896:     RefEnc = crypto:crypto_init(Type, Key, IV, true),
<a name="897"/>  897:     RefDec = crypto:crypto_init(Type, Key, IV, false),
<a name="898"/>  898:     EncTexts = api_ng_cipher_increment_loop(RefEnc, PlainTexts),
<a name="899"/>  899:     EncFinal = crypto:crypto_final(RefEnc),
<a name="900"/>  900:     Enc = iolist_to_binary(EncTexts++[EncFinal]),
<a name="901"/>  901:     case ExpectedEncText of
<a name="902"/>  902:         undefined -&gt;
<a name="903"/>  903:             ok;
<a name="904"/>  904:         Enc -&gt;
<a name="905"/>  905:             ok;
<a name="906"/>  906:         _ -&gt;
<a name="907"/>  907:             ct:log(&quot;encode~nIn: ~p~nExpected: ~p~nEnc: ~p~n&quot;, [{Type,Key,IV,PlainTexts}, ExpectedEncText, Enc]),
<a name="908"/>  908:             ct:fail(&quot;api_ng_cipher_increment (encode)&quot;,[])
<a name="909"/>  909:     end,
<a name="910"/>  910:     Plain = iolist_to_binary(PlainTexts),
<a name="911"/>  911:     DecTexts = api_ng_cipher_increment_loop(RefDec, EncTexts),
<a name="912"/>  912:     DecFinal =  crypto:crypto_final(RefDec),
<a name="api_ng_cipher_increment-last_expr"/><a name="913"/>  913: <b>    case iolist_to_binary</b>(DecTexts++[DecFinal]) of
<a name="914"/>  914:         Plain -&gt;
<a name="915"/>  915:             ok;
<a name="916"/>  916:         OtherPT -&gt;
<a name="917"/>  917:             ct:log(&quot;decode~nIn: ~p~nExpected: ~p~nDec: ~p~n&quot;, [{Type,Key,IV,EncTexts}, Plain, OtherPT]),
<a name="918"/>  918:             ct:fail(&quot;api_ng_cipher_increment (encode)&quot;,[])
<a name="919"/>  919:     end.
<a name="920"/>  920: 
<a name="921"/>  921: 
<a name="api_ng_cipher_increment_loop-2"/><a name="922"/>  922: <b>api_ng_cipher_increment_loop</b>(Ref, InTexts) -&gt;
<a name="api_ng_cipher_increment_loop-last_expr"/><a name="923"/>  923: <b>    lists:map</b>(fun(Txt) -&gt;
<a name="924"/>  924:                       try crypto:crypto_update(Ref, Txt)
<a name="925"/>  925:                       of
<a name="926"/>  926:                           Bin when is_binary(Bin) -&gt;
<a name="927"/>  927:                               Bin
<a name="928"/>  928:                       catch
<a name="929"/>  929:                           error:Error -&gt;
<a name="930"/>  930:                               ct:log(&quot;Txt = ~p&quot;,[Txt]),
<a name="931"/>  931:                               ct:fail(&quot;~p&quot;,[Error])
<a name="932"/>  932:                       end
<a name="933"/>  933:               end, InTexts).
<a name="934"/>  934: 
<a name="935"/>  935: <i>%%--------------------------------------------------------------------</i>
<a name="936"/>  936: <i>%% Check that crypto do not core dump on early 0.9.8 cryptolibs</i>
<a name="spec_0_bytes-1"/><a name="937"/>  937: <b>spec_0_bytes</b>(Config) -&gt;
<a name="938"/>  938:     Type = proplists:get_value(type, Config),
<a name="939"/>  939:     #{iv_length := IVS, key_length := KS} = Spec = crypto:cipher_info(Type),
<a name="940"/>  940:     Key = &lt;&lt;0:KS/unit:8&gt;&gt;,
<a name="941"/>  941:     IV = &lt;&lt;0:IVS/unit:8&gt;&gt;,
<a name="spec_0_bytes-last_expr"/><a name="942"/>  942: <b>    spec_0_bytes</b>(Type, Key, IV, Spec).
<a name="943"/>  943: 
<a name="944"/>  944: 
<a name="spec_0_bytes-4"/><a name="945"/>  945: <b>spec_0_bytes</b>(chacha20_poly1305, _, _, _) -&gt;
<a name="946"/>  946:     [];
<a name="947"/>  947: <b>spec_0_bytes</b>(Type, Key, IV, #{mode := M}) when M == ccm_mode ;
<a name="948"/>  948:                                                M == gcm_mode -&gt;
<a name="949"/>  949:     AAD = &lt;&lt;&gt;&gt;,
<a name="950"/>  950:     Plain = &lt;&lt;&gt;&gt;,
<a name="951"/>  951:     {_, Tag} = crypto:crypto_one_time_aead(Type, Key, IV, Plain, AAD, true),
<a name="952"/>  952:     [{Type, Key, Plain, IV, AAD, &lt;&lt;&gt;&gt;, Tag, []}];
<a name="953"/>  953: <b>spec_0_bytes</b>(Type, Key, IV, _Spec) -&gt;
<a name="spec_0_bytes-last_expr"/><a name="954"/>  954:     [{Type, Key, IV, &lt;&lt;&gt;&gt;, &lt;&lt;&gt;&gt;}].
<a name="955"/>  955: 
<a name="956"/>  956: <i>%%--------------------------------------------------------------------</i>
<a name="api_ng_one_shot-0"/><a name="957"/>  957: <b>api_ng_one_shot</b>() -&gt;
<a name="api_ng_one_shot-last_expr"/><a name="958"/>  958:      [{doc, &quot;Test new api&quot;}].
<a name="959"/>  959: 
<a name="api_ng_one_shot-1"/><a name="960"/>  960: <b>api_ng_one_shot</b>(Config) when is_list(Config) -&gt;
<a name="961"/>  961:     [_|_] = Ciphers = lazy_eval(proplists:get_value(cipher, Config, [])),
<a name="api_ng_one_shot-last_expr"/><a name="962"/>  962: <b>    lists:foreach</b>(fun do_api_ng_one_shot/1, Ciphers ++ spec_0_bytes(Config)).
<a name="963"/>  963: 
<a name="do_api_ng_one_shot-1"/><a name="964"/>  964: <b>do_api_ng_one_shot</b>({Type, Key, PlainTexts}=_X) -&gt;
<a name="965"/>  965:     ct:log(&quot;~p&quot;,[_X]),
<a name="966"/>  966:     do_api_ng_one_shot({Type, Key, &lt;&lt;&gt;&gt;, PlainTexts});
<a name="967"/>  967: 
<a name="968"/>  968: <b>do_api_ng_one_shot</b>({Type, Key, IV, PlainTexts}=_X) -&gt;
<a name="969"/>  969:     ct:log(&quot;~p&quot;,[_X]),
<a name="970"/>  970:     do_api_ng_one_shot({Type, Key, IV, PlainTexts, undefined});
<a name="971"/>  971: 
<a name="972"/>  972: <b>do_api_ng_one_shot</b>({Type, Key, IV, PlainText0, ExpectedEncText}=_X) -&gt;
<a name="973"/>  973:     ct:log(&quot;~p&quot;,[_X]),
<a name="974"/>  974:     PlainText = iolist_to_binary(lazy_eval(PlainText0)),
<a name="975"/>  975:     EncTxt = crypto:crypto_one_time(Type, Key, IV, PlainText, true),
<a name="976"/>  976:     case ExpectedEncText of
<a name="977"/>  977:         undefined -&gt;
<a name="978"/>  978:             ok;
<a name="979"/>  979:         EncTxt -&gt;
<a name="980"/>  980:             ok;
<a name="981"/>  981:         _ -&gt;
<a name="982"/>  982:             ct:log(&quot;encode~nIn: ~p~nExpected: ~p~nEnc: ~p~n&quot;, [{Type,Key,IV,PlainText}, ExpectedEncText, EncTxt]),
<a name="983"/>  983:             ct:fail(&quot;api_ng_one_time (encode)&quot;,[])
<a name="984"/>  984:     end,
<a name="do_api_ng_one_shot-last_expr"/><a name="985"/>  985: <b>    case crypto:crypto_one_time</b>(Type, Key, IV, EncTxt, false) of
<a name="986"/>  986:         PlainText -&gt;
<a name="987"/>  987:             ok;
<a name="988"/>  988:         OtherPT -&gt;
<a name="989"/>  989:             ct:log(&quot;decode~nIn: ~p~nExpected: ~p~nDec: ~p~n&quot;, [{Type,Key,IV,EncTxt}, PlainText, OtherPT]),
<a name="990"/>  990:             ct:fail(&quot;api_ng_one_time (decode)&quot;,[])
<a name="991"/>  991:     end.
<a name="992"/>  992: 
<a name="993"/>  993: <i>%%--------------------------------------------------------------------</i>
<a name="cipher_padding-1"/><a name="994"/>  994: <b>cipher_padding</b>(_Config) -&gt;
<a name="995"/>  995:     Ciphers = [{C,pkcs_padding}
<a name="996"/>  996:                || C &lt;- crypto:supports(ciphers),
<a name="997"/>  997:                   C =/= chacha20_poly1305,
<a name="998"/>  998:                   case crypto:cipher_info(C) of
<a name="999"/>  999:                       #{mode := ccm_mode} -&gt; false;
<a name="1000"/> 1000:                       #{mode := gcm_mode} -&gt; false;
<a name="1001"/> 1001:                       _ -&gt; true
<a name="1002"/> 1002:                   end],
<a name="cipher_padding-last_expr"/><a name="1003"/> 1003: <b>    lists:foreach</b>(fun cipher_padding_test/1, Ciphers).
<a name="1004"/> 1004: 
<a name="cipher_padding_test-1"/><a name="1005"/> 1005: <b>cipher_padding_test</b>({Cipher, Padding}) -&gt;
<a name="1006"/> 1006:     #{block_size := Sblock,
<a name="1007"/> 1007:       iv_length  := Siv,
<a name="1008"/> 1008:       key_length := Skey} = Inf = crypto:cipher_info(Cipher),
<a name="1009"/> 1009:     ct:log(&quot;~p ~p&quot;, [Cipher,Inf]),
<a name="1010"/> 1010: 
<a name="1011"/> 1011:     Key = &lt;&lt;1:Skey/unit:8&gt;&gt;,
<a name="1012"/> 1012:     IV  = &lt;&lt;0:Siv/unit:8&gt;&gt;,
<a name="1013"/> 1013:     MsgLen = 5*Sblock + 3,
<a name="1014"/> 1014:     Tplain = crypto:strong_rand_bytes(MsgLen),
<a name="1015"/> 1015:     PadSize = if
<a name="1016"/> 1016:                   (Padding == zero) ; (Padding == random) -&gt;
<a name="1017"/> 1017:                       (Sblock - (MsgLen rem Sblock)) rem Sblock;
<a name="1018"/> 1018:                   true -&gt;
<a name="1019"/> 1019:                       0
<a name="1020"/> 1020:               end,
<a name="1021"/> 1021:     Tcrypt =
<a name="1022"/> 1022:         case Siv of
<a name="1023"/> 1023:             0 -&gt;
<a name="1024"/> 1024:                 crypto:crypto_one_time(Cipher, Key, Tplain, [{encrypt,true},{padding,Padding}]);
<a name="1025"/> 1025:             _ -&gt;
<a name="1026"/> 1026:                 crypto:crypto_one_time(Cipher, Key, IV, Tplain, [{encrypt,true},{padding,Padding}])
<a name="1027"/> 1027:         end,
<a name="1028"/> 1028: 
<a name="1029"/> 1029:     TdecryptPadded =
<a name="1030"/> 1030:         case Siv of
<a name="1031"/> 1031:             0 -&gt;
<a name="1032"/> 1032:                 crypto:crypto_one_time(Cipher, Key, Tcrypt, [{encrypt,false},{padding,Padding}]);
<a name="1033"/> 1033:             _ -&gt;
<a name="1034"/> 1034:                 crypto:crypto_one_time(Cipher, Key, IV, Tcrypt, [{encrypt,false},{padding,Padding}])
<a name="1035"/> 1035:         end,
<a name="1036"/> 1036: 
<a name="cipher_padding_test-last_expr"/><a name="1037"/> 1037: <b>    case split_binary</b>(TdecryptPadded, size(TdecryptPadded) - PadSize) of
<a name="1038"/> 1038:         {Tplain, _} -&gt;
<a name="1039"/> 1039:             ok;
<a name="1040"/> 1040:         {Tdecrypt,Tpad} -&gt;
<a name="1041"/> 1041:             ct:log(&quot;Key = ~p~nIV = ~p~nTplain = ~p~nTcrypt = ~p~nTdecrypt = ~p~nPadding = ~p&quot;,
<a name="1042"/> 1042:                    [Key, IV, Tplain, Tcrypt, Tdecrypt, Tpad]),
<a name="1043"/> 1043:             ct:fail(&quot;~p&quot;, [Cipher])
<a name="1044"/> 1044:     end.
<a name="1045"/> 1045: 
<a name="1046"/> 1046: <i>%%--------------------------------------------------------------------</i>
<a name="ec_key_padding-1"/><a name="1047"/> 1047: <b>ec_key_padding</b>(_Config) -&gt;
<a name="ec_key_padding-last_expr"/><a name="1048"/> 1048: <b>    lists:foreach</b>(fun test_ec_key_padding/1,
<a name="1049"/> 1049:                   crypto:supports(curves) -- [ed25519, ed448, x25519, x448]
<a name="1050"/> 1050:                  ).
<a name="1051"/> 1051: 
<a name="test_ec_key_padding-1"/><a name="1052"/> 1052: <b>test_ec_key_padding</b>(CurveName) -&gt;
<a name="1053"/> 1053:     ExpectedSize = expected_ec_size(CurveName),
<a name="test_ec_key_padding-last_expr"/><a name="1054"/> 1054: <b>    repeat</b>(100, % Enough to provoke an error in the 85 curves
<a name="1055"/> 1055:                % With for example 1000, the total test time would be too large
<a name="1056"/> 1056:            fun() -&gt;
<a name="1057"/> 1057:                    case crypto:generate_key(ecdh, CurveName) of
<a name="1058"/> 1058:                        {_PubKey, PrivKey} when byte_size(PrivKey) == ExpectedSize -&gt;
<a name="1059"/> 1059:                            %% ct:pal(&quot;~p:~p Test ~p, size ~p, expected size ~p&quot;,
<a name="1060"/> 1060:                            %%        [?MODULE,?LINE, CurveName, byte_size(PrivKey), ExpectedSize]),
<a name="1061"/> 1061:                            ok;
<a name="1062"/> 1062:                        {_PubKey, PrivKey} -&gt;
<a name="1063"/> 1063:                            ct:fail(&quot;Bad ~p size: ~p expected: ~p&quot;, [CurveName, byte_size(PrivKey), ExpectedSize]);
<a name="1064"/> 1064:                        Other -&gt;
<a name="1065"/> 1065:                            ct:pal(&quot;~p:~p ~p&quot;, [?MODULE,?LINE,Other]),
<a name="1066"/> 1066:                            ct:fail(&quot;Bad public_key:generate_key result for ~p&quot;, [CurveName])
<a name="1067"/> 1067:                    end
<a name="1068"/> 1068:            end).
<a name="1069"/> 1069: 
<a name="repeat-2"/><a name="1070"/> 1070: <b>repeat</b>(Times, F) when Times &gt; 0 -&gt; F(), repeat(Times-1, F);
<a name="repeat-last_expr"/><a name="1071"/> 1071: <b>repeat</b>(_, _) -&gt; ok.
<a name="1072"/> 1072: 
<a name="expected_ec_size-1"/><a name="1073"/> 1073: <b>expected_ec_size</b>(CurveName) when is_atom(CurveName) -&gt;
<a name="1074"/> 1074:     expected_ec_size(crypto_ec_curves:curve(CurveName));
<a name="1075"/> 1075: <b>expected_ec_size</b>({{prime_field,_}, _, _, Order, _}) -&gt; byte_size(Order);
<a name="expected_ec_size-last_expr"/><a name="1076"/> 1076: <b>expected_ec_size</b>({{characteristic_two_field, _, _}, _, _, Order, _}) -&gt; size(Order).
<a name="1077"/> 1077: 
<a name="1078"/> 1078: <i>%%--------------------------------------------------------------------</i>
<a name="no_aead_ng-0"/><a name="1079"/> 1079: <b>no_aead_ng</b>() -&gt;
<a name="no_aead_ng-last_expr"/><a name="1080"/> 1080:      [{doc, &quot;Test disabled aead ciphers&quot;}].
<a name="no_aead_ng-1"/><a name="1081"/> 1081: <b>no_aead_ng</b>(Config) when is_list(Config) -&gt;
<a name="1082"/> 1082:     {EncFun, EncryptArgs} =
<a name="1083"/> 1083:         case lazy_eval(proplists:get_value(cipher, Config)) of
<a name="1084"/> 1084:             [{Type, Key, PlainText, IV, AAD, CipherText, CipherTag, TagLen, _Info} | _] -&gt;
<a name="1085"/> 1085:                 {fun crypto:crypto_one_time_aead/7, [Type, Key, IV, PlainText, AAD, TagLen, true]};
<a name="1086"/> 1086: 
<a name="1087"/> 1087:             [{Type, Key, PlainText, IV, AAD, CipherText, CipherTag, _Info} | _] -&gt;
<a name="1088"/> 1088:                 {fun crypto:crypto_one_time_aead/6, [Type, Key, IV, PlainText, AAD, true]}
<a name="1089"/> 1089:         end,
<a name="1090"/> 1090:     notsup(EncFun, EncryptArgs),
<a name="1091"/> 1091: 
<a name="1092"/> 1092:     DecryptArgs = [Type, Key, IV, CipherText, AAD, CipherTag, false],
<a name="no_aead_ng-last_expr"/><a name="1093"/> 1093: <b>    notsup</b>(fun crypto:crypto_one_time_aead/7, DecryptArgs).
<a name="1094"/> 1094: 
<a name="1095"/> 1095: <i>%%--------------------------------------------------------------------</i>
<a name="aead_ng-1"/><a name="1096"/> 1096: <b>aead_ng</b>(Config) when is_list(Config) -&gt;
<a name="1097"/> 1097:     [_|_] = AEADs = lazy_eval(proplists:get_value(cipher, Config)),
<a name="1098"/> 1098:     FilteredAEADs =
<a name="1099"/> 1099: 	case proplists:get_bool(fips, Config) of
<a name="1100"/> 1100: 	    false -&gt;
<a name="1101"/> 1101: 		AEADs;
<a name="1102"/> 1102: 	    true -&gt;
<a name="1103"/> 1103: 		%% In FIPS mode, the IV length must be at least 12 bytes.
<a name="1104"/> 1104: 		lists:filter(
<a name="1105"/> 1105: 		  fun(Tuple) -&gt;
<a name="1106"/> 1106: 			  IVLen = byte_size(element(4, Tuple)),
<a name="1107"/> 1107: 			  IVLen &gt;= 12
<a name="1108"/> 1108: 		  end, AEADs)
<a name="1109"/> 1109: 	end,
<a name="aead_ng-last_expr"/><a name="1110"/> 1110: <b>    do_cipher_tests</b>(fun aead_cipher_ng/1, FilteredAEADs ++ spec_0_bytes(Config)).
<a name="1111"/> 1111: 
<a name="1112"/> 1112: <i>%%-------------------------------------------------------------------- </i>
<a name="aead_bad_tag-1"/><a name="1113"/> 1113: <b>aead_bad_tag</b>(Config) -&gt;
<a name="1114"/> 1114:     [_|_] = AEADs = lazy_eval(proplists:get_value(cipher, Config)),
<a name="1115"/> 1115:     FilteredAEADs =
<a name="1116"/> 1116: 	case proplists:get_bool(fips, Config) of
<a name="1117"/> 1117: 	    false -&gt;
<a name="1118"/> 1118: 		AEADs;
<a name="1119"/> 1119: 	    true -&gt;
<a name="1120"/> 1120: 		%% In FIPS mode, the IV length must be at least 12 bytes.
<a name="1121"/> 1121: 		lists:filter(
<a name="1122"/> 1122: 		  fun(Tuple) -&gt;
<a name="1123"/> 1123: 			  IVLen = byte_size(element(4, Tuple)),
<a name="1124"/> 1124: 			  IVLen &gt;= 12
<a name="1125"/> 1125: 		  end, AEADs)
<a name="1126"/> 1126: 	end,
<a name="aead_bad_tag-last_expr"/><a name="1127"/> 1127: <b>    do_cipher_tests</b>(fun aead_cipher_bad_tag/1, FilteredAEADs).
<a name="1128"/> 1128: 
<a name="1129"/> 1129: <i>%%-------------------------------------------------------------------- </i>
<a name="sign_verify-0"/><a name="1130"/> 1130: <b>sign_verify</b>() -&gt;
<a name="sign_verify-last_expr"/><a name="1131"/> 1131:      [{doc, &quot;Sign/verify digital signatures&quot;}].
<a name="sign_verify-1"/><a name="1132"/> 1132: <b>sign_verify</b>(Config) when is_list(Config) -&gt;
<a name="1133"/> 1133:     SignVerify = proplists:get_value(sign_verify, Config),
<a name="sign_verify-last_expr"/><a name="1134"/> 1134: <b>    lists:foreach</b>(fun do_sign_verify/1, SignVerify).
<a name="1135"/> 1135: 
<a name="1136"/> 1136: <i>%%--------------------------------------------------------------------</i>
<a name="no_sign_verify-0"/><a name="1137"/> 1137: <b>no_sign_verify</b>() -&gt;
<a name="no_sign_verify-last_expr"/><a name="1138"/> 1138:     [{doc, &quot;Test disabled sign/verify digital signatures&quot;}].
<a name="no_sign_verify-1"/><a name="1139"/> 1139: <b>no_sign_verify</b>(Config) when is_list(Config) -&gt;
<a name="1140"/> 1140:     [SignVerifyHd|_] = proplists:get_value(sign_verify, Config),
<a name="no_sign_verify-last_expr"/><a name="1141"/> 1141: <b>    notsup</b>(fun do_sign_verify/1, [SignVerifyHd]).
<a name="1142"/> 1142: 
<a name="1143"/> 1143: <i>%%-------------------------------------------------------------------- </i>
<a name="public_encrypt-0"/><a name="1144"/> 1144: <b>public_encrypt</b>() -&gt;
<a name="public_encrypt-last_expr"/><a name="1145"/> 1145:      [{doc, &quot;Test public_encrypt/decrypt &quot;}].
<a name="public_encrypt-1"/><a name="1146"/> 1146: <b>public_encrypt</b>(Config) when is_list(Config) -&gt;
<a name="1147"/> 1147:     ct:log(&quot;public_encrypt&quot;, []),
<a name="1148"/> 1148:     Params = proplists:get_value(pub_pub_encrypt, Config, []),
<a name="public_encrypt-last_expr"/><a name="1149"/> 1149: <b>    lists:foreach</b>(fun do_public_encrypt/1, Params).
<a name="1150"/> 1150: 
<a name="1151"/> 1151: <i>%%-------------------------------------------------------------------- </i>
<a name="private_encrypt-0"/><a name="1152"/> 1152: <b>private_encrypt</b>() -&gt;
<a name="private_encrypt-last_expr"/><a name="1153"/> 1153:      [{doc, &quot;Test private_encrypt/decrypt functions. &quot;}].
<a name="private_encrypt-1"/><a name="1154"/> 1154: <b>private_encrypt</b>(Config) when is_list(Config) -&gt;
<a name="1155"/> 1155:     Params = proplists:get_value(pub_priv_encrypt, Config, []),
<a name="private_encrypt-last_expr"/><a name="1156"/> 1156: <b>    lists:foreach</b>(fun do_private_encrypt/1, Params).
<a name="1157"/> 1157: 
<a name="1158"/> 1158: <i>%%--------------------------------------------------------------------</i>
<a name="privkey_to_pubkey-1"/><a name="1159"/> 1159: <b>privkey_to_pubkey</b>(Config) -&gt;
<a name="1160"/> 1160:     Params = proplists:get_value(privkey_to_pubkey, Config),
<a name="privkey_to_pubkey-last_expr"/><a name="1161"/> 1161: <b>    lists:foreach</b>(fun do_privkey_to_pubkey/1, Params).
<a name="1162"/> 1162: 
<a name="do_privkey_to_pubkey-1"/><a name="1163"/> 1163: <b>do_privkey_to_pubkey</b>({Type, Priv, Pub}) -&gt;
<a name="1164"/> 1164:     ct:log(&quot;~p:~p~nType = ~p,~nPriv = ~p,~n  Pub = ~p&quot;, [?MODULE,?LINE,Type,Priv,Pub]),
<a name="do_privkey_to_pubkey-last_expr"/><a name="1165"/> 1165: <b>    case crypto:privkey_to_pubkey</b>(Type, Priv) of
<a name="1166"/> 1166:         Pub -&gt;
<a name="1167"/> 1167:             ok;
<a name="1168"/> 1168:         Priv -&gt;
<a name="1169"/> 1169:             ct:fail(&quot;Returned private key&quot;, []);
<a name="1170"/> 1170:         Other -&gt;
<a name="1171"/> 1171:             ct:log(&quot;~p:~p Other = ~p&quot;, [?MODULE,?LINE,Other]),
<a name="1172"/> 1172:             ct:fail(&quot;bad&quot;, [])
<a name="1173"/> 1173:     end.
<a name="1174"/> 1174: 
<a name="1175"/> 1175: <i>%%--------------------------------------------------------------------</i>
<a name="generate_compute-0"/><a name="1176"/> 1176: <b>generate_compute</b>() -&gt;
<a name="generate_compute-last_expr"/><a name="1177"/> 1177:      [{doc, &quot; Test crypto:genarate_key and crypto:compute_key&quot;}].
<a name="generate_compute-1"/><a name="1178"/> 1178: <b>generate_compute</b>(Config) when is_list(Config) -&gt;
<a name="1179"/> 1179:     GenCom = proplists:get_value(generate_compute, Config),
<a name="generate_compute-last_expr"/><a name="1180"/> 1180: <b>    lists:foreach</b>(fun do_generate_compute/1, GenCom).
<a name="1181"/> 1181: <i>%%--------------------------------------------------------------------</i>
<a name="compute_bug-0"/><a name="1182"/> 1182: <b>compute_bug</b>() -&gt;
<a name="compute_bug-last_expr"/><a name="1183"/> 1183:     [{doc, &quot;Test that it works even if the Secret is smaller than expected&quot;}].
<a name="compute_bug-1"/><a name="1184"/> 1184: <b>compute_bug</b>(_Config) -&gt;
<a name="compute_bug-last_expr"/><a name="1185"/> 1185: <b>    case crypto:info_fips</b>() of
<a name="1186"/> 1186:         enabled -&gt;
<a name="1187"/> 1187:             %% FIPs on OpenSSL 3 seems to demand P to be a safe prime
<a name="1188"/> 1188:             %% where Q = (P-1)/2 is also prime.
<a name="1189"/> 1189:             skip;
<a name="1190"/> 1190:         _ -&gt; do_compute_bug()
<a name="1191"/> 1191:     end.
<a name="1192"/> 1192: 
<a name="do_compute_bug-0"/><a name="1193"/> 1193: <b>do_compute_bug</b>() -&gt;
<a name="1194"/> 1194:     ExpectedSecret = &lt;&lt;118,89,171,16,156,18,156,103,189,134,130,49,28,144,111,241,247,82,79,32,228,11,209,141,119,176,251,80,105,143,235,251,203,121,223,211,129,3,233,133,45,2,31,157,24,111,5,75,153,66,135,185,128,115,229,178,216,39,73,52,80,151,8,241,34,52,226,71,137,167,53,48,59,224,175,154,89,110,76,83,24,117,149,21,72,6,186,78,149,74,188,56,98,244,30,77,108,248,88,194,195,237,23,51,20,242,254,123,21,12,209,74,217,168,230,65,7,60,211,139,128,239,234,153,22,229,180,59,159,121,41,156,121,200,177,130,163,162,54,224,93,1,94,11,177,254,118,28,156,26,116,10,207,145,219,166,214,189,214,230,221,170,228,15,69,88,31,68,94,255,113,58,49,82,86,192,248,176,131,133,39,186,194,172,206,84,184,16,66,68,153,128,178,227,27,118,52,130,122,92,24,222,102,195,221,207,255,13,152,175,65,32,167,84,54,244,243,109,244,18,234,16,159,224,188,2,106,123,27,17,131,171,226,34,111,251,62,119,155,124,221,124,254,62,97,167,1,105,116,98,98,19,197,30,72,180,79,221,100,134,120,117,124,85,73,132,224,223,222,41,155,137,218,130,238,237,157,161,134,150,69,206,91,141,17,89,120,218,235,229,37,150,76,197,7,157,56,144,42,203,137,100,200,72,141,194,239,1,67,236,238,183,48,214,75,76,108,235,3,237,67,40,137,45,182,236,246,37,116,103,144,237,142,211,88,233,11,24,21,218,41,245,250,51,130,250,104,74,189,17,69,145,70,50,50,215,253,155,10,128,41,114,185,211,82,164,72,92,17,145,104,66,6,140,226,80,43,62,1,166,216,153,118,96,15,147,126,137,118,191,192,75,149,241,206,18,92,17,154,215,219,18,6,139,190,103,210,156,184,29,224,213,157,60,112,189,104,220,125,40,186,50,119,17,143,136,149,38,74,107,21,192,59,61,59,42,231,144,59,175,3,176,87,23,16,122,54,31,82,34,230,211,44,81,41,47,86,37,228,175,130,148,88,136,131,254,241,202,99,199,175,1,141,215,124,155,120,43,141,89,11,140,120,141,29,35,82,219,155,204,75,12,66,241,253,33,250,84,24,85,68,13,80,85,142,227,34,139,26,146,24&gt;&gt;,
<a name="1195"/> 1195:     OthersPublicKey = 635619632099733175381667940709387641100492974601603060984753028943194386334921787463327680809776598322996634648015962954045728174069768874873236397421720142610982770302060309928552098274817978606093380781524199673890631795310930242601197479471368910519338301177304682162189801040921618559902948819107531088646753320486728060005223263561551402855338732899079439899705951063999951507319258050864346087428042978411873495523439615429804957374639092580169417598963105885529553632847023899713490485619763926900318508906706745060947269748612049634207985438016935262521715769812475329234748426647554362991758104620357149045960316987533503707855364806010494793980069245562784050236811004893018183726397041999426883788660276453352521120006817370050691205529335316794439089316232980047277245051173281601960196573681285904611182521967067911862467395705665888521948321299521549941618586026714676885890192323289343756440666276226084448279082483536164085883288884231665240707495770544705648564889889198060417915693315346959170105413290799314390963124178046425737828369059171472978294050322371452255088799865552038756937873388385970088906560408959959429398326288750834357514847891423941047433478384621074116184703014798814515161475596555032391555842,
<a name="1196"/> 1196:     MyPrivateKey = 387759582879975726965038486537011291913744975764132199838375902680222019267527675651273586836110220500657652661706223760165097275862806031329642160439090779625708664007910974206651834216043397115514725827856461492311499129200688538220719685637154290305617686974719521885238198226075381217068175824097878445476010193039590876624464274744156624589136789060427283492343902761765833713520850870233407503430180028104167029073459918756981323130062648615262139444306321256382009848217866984408901761817655567071716275177768316006340055589170095799943481591033461616307776069027985761229636731465482676467627154100912586936231051371168178564599296638350391246393336702334311781595616786107810962134407697848002331639021101685320844880636050048769216986088652236979636019052557155807310341483407890060105599892252118584570558049301477535792498672552850760356632076013402382600669875697284264329434950712239302528367835155163504374877787288116104285944993818319105835423479332617802010952731990182088670508346704423006877514817882782443833997288652405892920173712497948376815825396272381214976859009518623799156300136570204539240675245115597412280078940442452936425561984312708387584800789375684525365060589104566195610526570099527133097201479,
<a name="1197"/> 1197:     P = 818034524162384276004384029858643530286875094391273833506734966261806257117433972760379103507630310628953496150318170372254219924175532996281953750642804369831900894594960807970232131410638888573275563720690293481410915588408505771183615664441221559618326229227448328879290185035795866796496147000467456347856187771645103733376761936369144682074588463621004219054111244232031965820058057143484947957179035662640791007685559024477920075136419228662974090561346329074935312181886940693299380892129818458511403741106419480550004799657220331973244248753744516935739033770420884365608406478656143540532371463443324228730693491647103274058971797182813283112583029849186056551355376851686616057869624968077484471229044125401535456699914745876082047459812392122562460031611344154642406382436701361983114768023990405077450124649862159757605118611426368650203370143674925598905779061402007525955196464201496773278952462368223659263492419274489020447849336502432222101793313731259141617677580646998184158969477474527427664187763741360356528830301163614618231141541403007931347398186427059736520580903587497382362610721261644208653717495736748724114113311672504064943864203789205551568648546606356374830209356446449765364678719909024329058480379,
<a name="1198"/> 1198:     G = 2,
<a name="1199"/> 1199:     DHParameters = [P, G],
<a name="do_compute_bug-last_expr"/><a name="1200"/> 1200: <b>    case crypto:compute_key</b>(dh, OthersPublicKey, MyPrivateKey, DHParameters) of
<a name="1201"/> 1201:         ExpectedSecret -&gt;
<a name="1202"/> 1202:             ok;
<a name="1203"/> 1203:         Others -&gt;
<a name="1204"/> 1204:             ct:log(&quot;Got ~p&quot;,[Others]),
<a name="1205"/> 1205:             {fail, &quot;crypto:compute_key(dh,...) failed for the bug test&quot;}
<a name="1206"/> 1206:     end.
<a name="1207"/> 1207: 
<a name="1208"/> 1208: <i>%%--------------------------------------------------------------------</i>
<a name="no_generate_compute-0"/><a name="1209"/> 1209: <b>no_generate_compute</b>() -&gt;
<a name="no_generate_compute-last_expr"/><a name="1210"/> 1210:      [{doc, &quot;Test crypto:genarate_key and crypto:compute_key &quot;
<a name="1211"/> 1211:        &quot;for disabled algorithms&quot;}].
<a name="no_generate_compute-1"/><a name="1212"/> 1212: <b>no_generate_compute</b>(Config) when is_list(Config) -&gt;
<a name="1213"/> 1213:     %% This test is specific to the SRP protocol
<a name="1214"/> 1214:     srp = ?config(type, Config),
<a name="1215"/> 1215:     {srp,
<a name="1216"/> 1216:      UserPrivate, UserGenParams, UserComParams,
<a name="1217"/> 1217:      HostPublic, HostPrivate, HostGenParams, HostComParams,
<a name="1218"/> 1218:      _SessionKey} = srp3(),
<a name="1219"/> 1219:     UserPublic = HostPublic,                    % use a fake public key
<a name="1220"/> 1220:     notsup(fun crypto:generate_key/3, [srp, UserGenParams, UserPrivate]),
<a name="1221"/> 1221:     notsup(fun crypto:generate_key/3, [srp, HostGenParams, HostPrivate]),
<a name="1222"/> 1222:     notsup(fun crypto:compute_key/4,
<a name="1223"/> 1223:            [srp, HostPublic, {UserPublic, UserPrivate}, UserComParams]),
<a name="no_generate_compute-last_expr"/><a name="1224"/> 1224: <b>    notsup</b>(fun crypto:compute_key/4,
<a name="1225"/> 1225:            [srp, UserPublic, {HostPublic, HostPrivate}, HostComParams]).
<a name="1226"/> 1226: <i>%%--------------------------------------------------------------------</i>
<a name="compute-0"/><a name="1227"/> 1227: <b>compute</b>() -&gt;
<a name="compute-last_expr"/><a name="1228"/> 1228:      [{doc, &quot; Test crypto:compute_key&quot;}].
<a name="compute-1"/><a name="1229"/> 1229: <b>compute</b>(Config) when is_list(Config) -&gt;
<a name="1230"/> 1230:     Gen0 = proplists:get_value(compute, Config),
<a name="1231"/> 1231:     Gen = case crypto:info_fips() of
<a name="1232"/> 1232:               enabled -&gt;
<a name="1233"/> 1233:                   SkipCurves = [secp192r1],
<a name="1234"/> 1234:                   lists:filter(fun({_,_,_,Curve,_}) -&gt;
<a name="1235"/> 1235:                                        not lists:member(Curve,SkipCurves)
<a name="1236"/> 1236:                                end,
<a name="1237"/> 1237:                                Gen0);
<a name="1238"/> 1238:               _ -&gt;
<a name="1239"/> 1239:                   Gen0
<a name="1240"/> 1240:     end,
<a name="compute-last_expr"/><a name="1241"/> 1241: <b>    lists:foreach</b>(fun do_compute/1, Gen).
<a name="1242"/> 1242: 
<a name="1243"/> 1243: <i>%%--------------------------------------------------------------------</i>
<a name="use_all_ec_sign_verify-1"/><a name="1244"/> 1244: <b>use_all_ec_sign_verify</b>(_Config) -&gt;
<a name="1245"/> 1245:     Msg = &lt;&lt;&quot;hello world!&quot;&gt;&gt;,
<a name="1246"/> 1246:     Sups = crypto:supports(),
<a name="1247"/> 1247:     Curves = proplists:get_value(curves, Sups),
<a name="1248"/> 1248:     Hashs = proplists:get_value(hashs, Sups) -- [shake128, shake256, sm3],
<a name="1249"/> 1249:     ct:log(&quot;Lib: ~p~nFIPS: ~p~nCurves:~n~p~nHashs: ~p&quot;, [crypto:info_lib(),
<a name="1250"/> 1250:                                                          crypto:info_fips(),
<a name="1251"/> 1251:                                                          Curves,
<a name="1252"/> 1252:                                                          Hashs]),
<a name="1253"/> 1253:     SkipHashs0 = [md4, md5, ripemd160, sha3_224, sha3_256, sha3_384, sha3_512,
<a name="1254"/> 1254:                   blake2b, blake2s],
<a name="1255"/> 1255:     SkipCurves0 = [ed25519, ed448, x25519, x448, ipsec3, ipsec4],
<a name="1256"/> 1256: 
<a name="1257"/> 1257:     {SkipHashs, SkipCurves}
<a name="1258"/> 1258:         = case crypto:info_fips() of
<a name="1259"/> 1259:               enabled -&gt;
<a name="1260"/> 1260:                   {[sha | SkipHashs0],
<a name="1261"/> 1261:                    [secp192r1, prime192v1, sect163k1, sect163r2]};
<a name="1262"/> 1262:               _ -&gt;
<a name="1263"/> 1263:                   {SkipHashs0, SkipCurves0}
<a name="1264"/> 1264:           end,
<a name="1265"/> 1265: 
<a name="1266"/> 1266:     Results =
<a name="1267"/> 1267:         [{{Curve,Hash},
<a name="1268"/> 1268:           try
<a name="1269"/> 1269:               ct:log(&quot;~p ~p&quot;,[Curve,Hash]),
<a name="1270"/> 1270:               {Pub,Priv} = crypto:generate_key(ecdh, Curve),
<a name="1271"/> 1271:               true = is_binary(Pub),
<a name="1272"/> 1272:               true = is_binary(Priv),
<a name="1273"/> 1273:               Sig = crypto:sign(ecdsa, Hash, Msg, [Priv, Curve]),
<a name="1274"/> 1274:               crypto:verify(ecdsa, Hash, Msg, Sig, [Pub, Curve])
<a name="1275"/> 1275:           catch
<a name="1276"/> 1276:               C:E -&gt;
<a name="1277"/> 1277:                   {C,E}
<a name="1278"/> 1278:           end}
<a name="1279"/> 1279:          || Curve &lt;- Curves -- SkipCurves,
<a name="1280"/> 1280:             Hash &lt;- Hashs -- SkipHashs
<a name="1281"/> 1281:         ],
<a name="1282"/> 1282:     Fails =
<a name="1283"/> 1283:         lists:filter(fun({_,true}) -&gt; false;
<a name="1284"/> 1284:                         (_) -&gt; true
<a name="1285"/> 1285:                      end, Results),
<a name="use_all_ec_sign_verify-last_expr"/><a name="1286"/> 1286:     case Fails of
<a name="1287"/> 1287:         [] -&gt;
<a name="1288"/> 1288:             ok;
<a name="1289"/> 1289:         _ -&gt;
<a name="1290"/> 1290:             ct:log(&quot;Fails:~n~p&quot;,[Fails]),
<a name="1291"/> 1291:             Errors = lists:usort([Err || {_,Err} &lt;- Fails]),
<a name="1292"/> 1292:             FailedCurves = [Curve || {Curve,_} &lt;- Fails],
<a name="1293"/> 1293:             FailedCurvesPerError = [{E, [C || {C,E0} &lt;- Fails,
<a name="1294"/> 1294:                                               E0 == E]}
<a name="1295"/> 1295:                                     || E &lt;- Errors],
<a name="1296"/> 1296:             ct:pal(&quot;~p failed curves: ~p&quot;, [length(FailedCurves), FailedCurves]),
<a name="1297"/> 1297:             ct:pal(&quot;Failed curves per error:~n~s&quot;, 
<a name="1298"/> 1298:                    [
<a name="1299"/> 1299:                     [io_lib:format(&quot;  Error: ~p~n Curves: ~p~n~n&quot;, [E,Cs])
<a name="1300"/> 1300:                      || {E,Cs} &lt;- FailedCurvesPerError]
<a name="1301"/> 1301:                    ]
<a name="1302"/> 1302:                   ), 
<a name="1303"/> 1303:             ct:fail(&quot;Bad curve(s)&quot;,[])
<a name="1304"/> 1304:     end.
<a name="1305"/> 1305: 
<a name="1306"/> 1306: <i>%%--------------------------------------------------------------------</i>
<a name="use_all_ecdh_generate_compute-1"/><a name="1307"/> 1307: <b>use_all_ecdh_generate_compute</b>(Config) -&gt;
<a name="1308"/> 1308:     SkipCurves0 = [ed25519, ed448, x25519, x448],
<a name="1309"/> 1309:     SkipCurves =
<a name="1310"/> 1310:         case crypto:info_fips() of
<a name="1311"/> 1311:             enabled -&gt;
<a name="1312"/> 1312:                 [secp192r1, prime192v1, sect163k1, sect163r2 | SkipCurves0];
<a name="1313"/> 1313:             _ -&gt;
<a name="1314"/> 1314:                 SkipCurves0
<a name="1315"/> 1315:         end,
<a name="1316"/> 1316:     Curves = crypto:supports(curves) -- SkipCurves,
<a name="use_all_ecdh_generate_compute-last_expr"/><a name="1317"/> 1317: <b>    do_dh_curves</b>(Config, Curves).
<a name="1318"/> 1318: 
<a name="use_all_eddh_generate_compute-1"/><a name="1319"/> 1319: <b>use_all_eddh_generate_compute</b>(Config) -&gt;
<a name="1320"/> 1320:     AllCurves = crypto:supports(curves),
<a name="1321"/> 1321:     Curves = [C || C &lt;- [x25519, x448],
<a name="1322"/> 1322:                      lists:member(C, AllCurves)],
<a name="use_all_eddh_generate_compute-last_expr"/><a name="1323"/> 1323: <b>    do_dh_curves</b>(Config, Curves).
<a name="1324"/> 1324: 
<a name="do_dh_curves-2"/><a name="1325"/> 1325: <b>do_dh_curves</b>(_Config, Curves) -&gt;
<a name="1326"/> 1326:     ct:log(&quot;Lib: ~p~nFIPS: ~p~nCurves:~n~p~n&quot;, [crypto:info_lib(),
<a name="1327"/> 1327:                                                 crypto:info_fips(),
<a name="1328"/> 1328:                                                 Curves]),
<a name="1329"/> 1329:     Results =
<a name="1330"/> 1330:         [{Curve,
<a name="1331"/> 1331:           try
<a name="1332"/> 1332:               ct:log(&quot;~p&quot;,[Curve]),
<a name="1333"/> 1333:               {APub,APriv} = crypto:generate_key(ecdh, Curve),
<a name="1334"/> 1334:               {BPub,BPriv} = crypto:generate_key(ecdh, Curve),
<a name="1335"/> 1335:               true = is_binary(APub),
<a name="1336"/> 1336:               true = is_binary(APriv),
<a name="1337"/> 1337:               true = is_binary(BPub),
<a name="1338"/> 1338:               true = is_binary(BPriv),
<a name="1339"/> 1339: 
<a name="1340"/> 1340:               ACommonSecret = crypto:compute_key(ecdh, BPub, APriv, Curve),
<a name="1341"/> 1341:               BCommonSecret = crypto:compute_key(ecdh, APub, BPriv, Curve),
<a name="1342"/> 1342:               ACommonSecret == BCommonSecret
<a name="1343"/> 1343:           catch
<a name="1344"/> 1344:               C:E -&gt;
<a name="1345"/> 1345:                   {C,E}
<a name="1346"/> 1346:           end}
<a name="1347"/> 1347:          || Curve &lt;- Curves
<a name="1348"/> 1348:         ],
<a name="1349"/> 1349: 
<a name="1350"/> 1350:     Fails =
<a name="1351"/> 1351:         lists:filter(fun({_,true}) -&gt; false;
<a name="1352"/> 1352:                         (_) -&gt; true
<a name="1353"/> 1353:                      end, Results),
<a name="1354"/> 1354: 
<a name="1355"/> 1355:     Succedes =
<a name="1356"/> 1356:         lists:filter(fun({_,true}) -&gt; true;
<a name="1357"/> 1357:                         (_) -&gt; false
<a name="1358"/> 1358:                      end, Results),
<a name="1359"/> 1359: 
<a name="do_dh_curves-last_expr"/><a name="1360"/> 1360:     case Fails of
<a name="1361"/> 1361:         [] -&gt;
<a name="1362"/> 1362:             ct:comment(&quot;All ~p passed&quot;,[length(Results)]),
<a name="1363"/> 1363:             ok;
<a name="1364"/> 1364:         _ -&gt;
<a name="1365"/> 1365:             ct:comment(&quot;passed: ~p, failed: ~p&quot;,[length(Results)-length(Fails),length(Fails)]),
<a name="1366"/> 1366:             ct:log(&quot;Succedes:~n~p&quot;,[Succedes]),
<a name="1367"/> 1367:             ct:log(&quot;Fails:~n~p&quot;,[Fails]),
<a name="1368"/> 1368:             Errors = lists:usort([Err || {_,Err} &lt;- Fails]),
<a name="1369"/> 1369:             FailedCurves = [C || {C,_} &lt;- Fails],
<a name="1370"/> 1370:             FailedCurvesPerError = [{E, [C || {C,E0} &lt;- Fails,
<a name="1371"/> 1371:                                               E == E0]}
<a name="1372"/> 1372:                                     || E &lt;- Errors],
<a name="1373"/> 1373:             ct:pal(&quot;~p (~p) failed curves: ~p&quot;, [length(FailedCurves), length(Results), FailedCurves]),
<a name="1374"/> 1374:             ct:pal(&quot;Failed curves per error:~n~s&quot;, 
<a name="1375"/> 1375:                    [
<a name="1376"/> 1376:                     [io_lib:format(&quot;  Error: ~p~n Curves: ~p~n~n&quot;, [E,Cs])
<a name="1377"/> 1377:                      || {E,Cs} &lt;- FailedCurvesPerError]
<a name="1378"/> 1378:                    ]
<a name="1379"/> 1379:                   ), 
<a name="1380"/> 1380:             ct:fail(&quot;Bad curve(s)&quot;,[])
<a name="1381"/> 1381:     end.
<a name="1382"/> 1382: 
<a name="1383"/> 1383: <i>%%--------------------------------------------------------------------</i>
<a name="generate-0"/><a name="1384"/> 1384: <b>generate</b>() -&gt;
<a name="generate-last_expr"/><a name="1385"/> 1385:      [{doc, &quot; Test crypto:generate_key&quot;}].
<a name="generate-1"/><a name="1386"/> 1386: <b>generate</b>(Config) when is_list(Config) -&gt;
<a name="1387"/> 1387:     Gen = proplists:get_value(generate, Config),
<a name="generate-last_expr"/><a name="1388"/> 1388: <b>    lists:foreach</b>(fun do_generate/1, Gen).
<a name="1389"/> 1389: <i>%%--------------------------------------------------------------------</i>
<a name="mod_pow-0"/><a name="1390"/> 1390: <b>mod_pow</b>() -&gt;
<a name="mod_pow-last_expr"/><a name="1391"/> 1391: <b>    [{doc, &quot;mod_pow testing </b>(A ^ M % P with bignums)&quot;}].
<a name="mod_pow-1"/><a name="1392"/> 1392: <b>mod_pow</b>(Config) when is_list(Config) -&gt;
<a name="mod_pow-last_expr"/><a name="1393"/> 1393: <b>    mod_pow_aux_test</b>(2, 5, 10, 8).
<a name="1394"/> 1394: <i>%%--------------------------------------------------------------------</i>
<a name="exor-0"/><a name="1395"/> 1395: <b>exor</b>() -&gt;
<a name="exor-last_expr"/><a name="1396"/> 1396:     [{doc, &quot;Test the exor function&quot;}].
<a name="exor-1"/><a name="1397"/> 1397: <b>exor</b>(Config) when is_list(Config) -&gt;
<a name="1398"/> 1398:     do_exor(&lt;&lt;1, 2, 3, 4, 5, 6, 7, 8, 9, 10&gt;&gt;),
<a name="exor-last_expr"/><a name="1399"/> 1399: <b>    do_exor</b>(term_to_binary(lists:seq(1, 1000000))).
<a name="1400"/> 1400: <i>%%--------------------------------------------------------------------</i>
<a name="hash_equals-0"/><a name="1401"/> 1401: <b>hash_equals</b>() -&gt;
<a name="hash_equals-last_expr"/><a name="1402"/> 1402:     [{doc, &quot;Test the hash_equals function&quot;}].
<a name="hash_equals-1"/><a name="1403"/> 1403: <b>hash_equals</b>(Config) when is_list(Config) -&gt;
<a name="hash_equals-last_expr"/><a name="1404"/> 1404:     try
<a name="1405"/> 1405:         true = crypto:hash_equals(&lt;&lt;&gt;&gt;, &lt;&lt;&gt;&gt;),
<a name="1406"/> 1406:         true = crypto:hash_equals(&lt;&lt;&quot;abc&quot;&gt;&gt;, &lt;&lt;&quot;abc&quot;&gt;&gt;),
<a name="1407"/> 1407:         false = crypto:hash_equals(&lt;&lt;&quot;abc&quot;&gt;&gt;, &lt;&lt;&quot;abe&quot;&gt;&gt;)
<a name="1408"/> 1408:     catch
<a name="1409"/> 1409:         error:{notsup,{&quot;hash_equals.c&quot;,_Line},&quot;Unsupported CRYPTO_memcmp&quot;++_} -&gt;
<a name="1410"/> 1410:             {skip, &quot;No CRYPTO_memcmp&quot;}
<a name="1411"/> 1411:     end.
<a name="1412"/> 1412: <i>%%--------------------------------------------------------------------</i>
<a name="rand_uniform-0"/><a name="1413"/> 1413: <b>rand_uniform</b>() -&gt;
<a name="rand_uniform-last_expr"/><a name="1414"/> 1414:     [{doc, &quot;rand_uniform and random_bytes testing&quot;}].
<a name="rand_uniform-1"/><a name="1415"/> 1415: <b>rand_uniform</b>(Config) when is_list(Config) -&gt;
<a name="1416"/> 1416:     rand_uniform_aux_test(10),
<a name="rand_uniform-last_expr"/><a name="1417"/> 1417: <b>    10 = byte_size</b>(crypto:strong_rand_bytes(10)).
<a name="1418"/> 1418: 
<a name="1419"/> 1419: <i>%%--------------------------------------------------------------------</i>
<a name="rand_threads-0"/><a name="1420"/> 1420: <b>rand_threads</b>() -&gt;
<a name="rand_threads-last_expr"/><a name="1421"/> 1421:     [{doc, &quot;strong_rand_bytes in parallel threads&quot;}].
<a name="rand_threads-1"/><a name="1422"/> 1422: <b>rand_threads</b>(Config) when is_list(Config) -&gt;
<a name="1423"/> 1423:     %% This will crash the emulator on at least one version of libcrypto
<a name="1424"/> 1424:     %% with buggy multithreading in RAND_bytes().
<a name="1425"/> 1425:     %% The test needs to run at least a few minutes...
<a name="1426"/> 1426:     NofThreads = 4,
<a name="1427"/> 1427:     Fun = fun F() -&gt; crypto:strong_rand_bytes(16), F() end,
<a name="1428"/> 1428:     PidRefs = [spawn_monitor(Fun) || _ &lt;- lists:seq(1, NofThreads)],
<a name="1429"/> 1429: <i>%%% The test case takes too much time to run.</i>
<a name="1430"/> 1430: <i>%%% Keep it around for reference by setting it down to just 10 seconds.</i>
<a name="1431"/> 1431: <i>%%%    receive after 10 * 60 * 1000 -&gt; ok end, % 10 minutes</i>
<a name="1432"/> 1432:     receive after 10 * 1000 -&gt; ok end, % 10 seconds
<a name="1433"/> 1433:     spawn_link(fun () -&gt; receive after 5000 -&gt; exit(timeout) end end),
<a name="1434"/> 1434:     [exit(Pid, stop) || {Pid,_Ref} &lt;- PidRefs],
<a name="1435"/> 1435:     [receive {'DOWN',Ref,_,_,stop} -&gt; ok end || {_Pid,Ref} &lt;- PidRefs],
<a name="rand_threads-last_expr"/><a name="1436"/> 1436:     ok.
<a name="1437"/> 1437: 
<a name="1438"/> 1438: <i>%%--------------------------------------------------------------------</i>
<a name="rand_plugin-0"/><a name="1439"/> 1439: <b>rand_plugin</b>() -&gt;
<a name="rand_plugin-last_expr"/><a name="1440"/> 1440: <b>    [{doc, &quot;crypto rand plugin testing </b>(implicit state / process dictionary)&quot;}].
<a name="rand_plugin-1"/><a name="1441"/> 1441: <b>rand_plugin</b>(Config) when is_list(Config) -&gt;
<a name="rand_plugin-last_expr"/><a name="1442"/> 1442: <b>    rand_plugin_aux</b>(implicit_state).
<a name="1443"/> 1443: 
<a name="rand_plugin_s-0"/><a name="1444"/> 1444: <b>rand_plugin_s</b>() -&gt;
<a name="rand_plugin_s-last_expr"/><a name="1445"/> 1445: <b>    [{doc, &quot;crypto rand plugin testing </b>(explicit state)&quot;}].
<a name="rand_plugin_s-1"/><a name="1446"/> 1446: <b>rand_plugin_s</b>(Config) when is_list(Config) -&gt;
<a name="rand_plugin_s-last_expr"/><a name="1447"/> 1447: <b>    rand_plugin_aux</b>(explicit_state).
<a name="1448"/> 1448: 
<a name="1449"/> 1449: <i>%%--------------------------------------------------------------------</i>
<a name="info-1"/><a name="1450"/> 1450: <b>info</b>(_Config) -&gt;
<a name="1451"/> 1451:     [{_,_,VerBin}] = crypto:info_lib(),
<a name="1452"/> 1452:     LibVer = binary:bin_to_list(VerBin),
<a name="info-last_expr"/><a name="1453"/> 1453:     try
<a name="1454"/> 1454:         crypto:info()
<a name="1455"/> 1455:     of
<a name="1456"/> 1456:         #{cryptolib_version_compiled := LibVer,
<a name="1457"/> 1457:           cryptolib_version_linked := LibVer,
<a name="1458"/> 1458:           compile_type := Tc,
<a name="1459"/> 1459:           link_type := Tl} when is_atom(Tc), is_atom(Tl) -&gt;
<a name="1460"/> 1460:             ok;
<a name="1461"/> 1461: 
<a name="1462"/> 1462:         %% Version strings in header vs lib seen to differ slightly on SUSE
<a name="1463"/> 1463:         %% but OpenSSL version numbers should be the same
<a name="1464"/> 1464:         #{cryptolib_version_compiled := CompVer,
<a name="1465"/> 1465:           cryptolib_version_linked := LibVer,
<a name="1466"/> 1466:           compile_type := Tc,
<a name="1467"/> 1467:           link_type := Tl} when is_atom(Tc), is_atom(Tl) -&gt;
<a name="1468"/> 1468:             RE = &quot;OpenSSL (\\d+\\.\\d+\\.\\d+.)&quot;,
<a name="1469"/> 1469:             Opts = [{capture,first,list}],
<a name="1470"/> 1470:             {match,[CompV]} = re:run(CompVer, RE, Opts),
<a name="1471"/> 1471:             {match,[LinkV]} = re:run(LibVer, RE, Opts),
<a name="1472"/> 1472:             {CompV,CompV} = {CompV,LinkV},
<a name="1473"/> 1473:             ok;
<a name="1474"/> 1474: 
<a name="1475"/> 1475:         Other -&gt;
<a name="1476"/> 1476:             ct:log(&quot;LibVer = ~p~ncrypto:info() -&gt; ~p&quot;, [LibVer,Other]),
<a name="1477"/> 1477:             ct:fail(&quot;Version mismatch&quot;, [])
<a name="1478"/> 1478:     catch
<a name="1479"/> 1479:         C:E -&gt;
<a name="1480"/> 1480:             ct:log(&quot;Exception ~p:~p&quot;, [C,E]),
<a name="1481"/> 1481:             ct:fail(&quot;Exception when calling crypto:info/0&quot;, [])
<a name="1482"/> 1482:     end.
<a name="1483"/> 1483: 
<a name="1484"/> 1484: <i>%%--------------------------------------------------------------------</i>
<a name="cipher_info-0"/><a name="1485"/> 1485: <b>cipher_info</b>() -&gt;
<a name="cipher_info-last_expr"/><a name="1486"/> 1486:     [{doc, &quot;crypto cipher_info testing&quot;}].
<a name="cipher_info-1"/><a name="1487"/> 1487: <b>cipher_info</b>(Config) when is_list(Config) -&gt;
<a name="1488"/> 1488:     #{type := _,key_length := _,iv_length := _,
<a name="1489"/> 1489:         block_size := _,mode := _} = crypto:cipher_info(aes_128_cbc),
<a name="1490"/> 1490:     {'EXIT',_} = (catch crypto:cipher_info(not_a_cipher)),
<a name="cipher_info-last_expr"/><a name="1491"/> 1491: <b>    case lists:foldl</b>(fun(C,Ok) -&gt;
<a name="1492"/> 1492:                              try crypto:cipher_info(C)
<a name="1493"/> 1493:                              of
<a name="1494"/> 1494:                                  _ -&gt; Ok
<a name="1495"/> 1495:                              catch Cls:Exc -&gt;
<a name="1496"/> 1496:                                      ct:log(&quot;~p:~p ~p&quot;,[Cls,Exc,C]),
<a name="1497"/> 1497:                                      false
<a name="1498"/> 1498:                              end
<a name="1499"/> 1499:                      end,
<a name="1500"/> 1500:                      true,
<a name="1501"/> 1501:                      crypto:supports(ciphers)
<a name="1502"/> 1502:                     )
<a name="1503"/> 1503:     of
<a name="1504"/> 1504:         true -&gt;
<a name="1505"/> 1505:             ok;
<a name="1506"/> 1506:         false -&gt;
<a name="1507"/> 1507:             ct:fail('Cipher unsupported',[])
<a name="1508"/> 1508:     end.
<a name="1509"/> 1509:                                                                          
<a name="cipher_info_prop_aead_attr-0"/><a name="1510"/> 1510: <b>cipher_info_prop_aead_attr</b>() -&gt;
<a name="cipher_info_prop_aead_attr-last_expr"/><a name="1511"/> 1511:     [{doc, &quot;crypto cipher_info prop_aead attribute testing&quot;}].
<a name="cipher_info_prop_aead_attr-1"/><a name="1512"/> 1512: <b>cipher_info_prop_aead_attr</b>(Config) when is_list(Config) -&gt;
<a name="1513"/> 1513:     AeadCiphers = [aes_128_ccm, aes_192_ccm, aes_256_ccm, aes_128_gcm, aes_192_gcm, aes_256_gcm, chacha20_poly1305],
<a name="1514"/> 1514:     case lists:foldl(fun(C,Ok) -&gt;
<a name="1515"/> 1515:                         case crypto:cipher_info(C) of
<a name="1516"/> 1516:                             #{prop_aead := true} -&gt;
<a name="1517"/> 1517:                                 true and Ok;
<a name="1518"/> 1518:                             _ -&gt;
<a name="1519"/> 1519:                                 false
<a name="1520"/> 1520:                         end
<a name="1521"/> 1521:                      end,
<a name="1522"/> 1522:                      true,
<a name="1523"/> 1523:                      AeadCiphers
<a name="1524"/> 1524:                     )
<a name="1525"/> 1525:     of
<a name="1526"/> 1526:         true -&gt;
<a name="1527"/> 1527:             ok;
<a name="1528"/> 1528:         false -&gt;
<a name="1529"/> 1529:             ct:fail('AEAD Cipher attribute reported false',[])
<a name="1530"/> 1530:     end,
<a name="1531"/> 1531:     NonAeadCiphers = [aes_ige256, blowfish_cbc, blowfish_cfb64],
<a name="cipher_info_prop_aead_attr-last_expr"/><a name="1532"/> 1532: <b>    case lists:foldl</b>(fun(C,Ok) -&gt;
<a name="1533"/> 1533:                         case crypto:cipher_info(C) of
<a name="1534"/> 1534:                             #{prop_aead := false} -&gt;
<a name="1535"/> 1535:                                 true and Ok;
<a name="1536"/> 1536:                             _ -&gt;
<a name="1537"/> 1537:                                 false
<a name="1538"/> 1538:                         end
<a name="1539"/> 1539:                      end,
<a name="1540"/> 1540:                      true,
<a name="1541"/> 1541:                      NonAeadCiphers
<a name="1542"/> 1542:                     )
<a name="1543"/> 1543:     of
<a name="1544"/> 1544:         true -&gt;
<a name="1545"/> 1545:             ok;
<a name="1546"/> 1546:         false -&gt;
<a name="1547"/> 1547:             ct:fail('Non-AEAD Cipher attribute reported true',[])
<a name="1548"/> 1548:     end.
<a name="1549"/> 1549: 
<a name="1550"/> 1550: <i>%%--------------------------------------------------------------------</i>
<a name="hash_info-0"/><a name="1551"/> 1551: <b>hash_info</b>() -&gt;
<a name="hash_info-last_expr"/><a name="1552"/> 1552:     [{doc, &quot;crypto hash_info testing&quot;}].
<a name="hash_info-1"/><a name="1553"/> 1553: <b>hash_info</b>(Config) when is_list(Config) -&gt;
<a name="1554"/> 1554:     #{type := _,size := _,block_size := _} = crypto:hash_info(sha256),
<a name="1555"/> 1555:     {'EXIT',_} = (catch crypto:hash_info(not_a_hash)),
<a name="hash_info-last_expr"/><a name="1556"/> 1556: <b>    lists:foreach</b>(fun(H) -&gt; crypto:hash_info(H) end,
<a name="1557"/> 1557:         proplists:get_value(hashs, crypto:supports())).
<a name="1558"/> 1558: 
<a name="1559"/> 1559: <i>%%--------------------------------------------------------------------</i>
<a name="1560"/> 1560: <i>%% Internal functions ------------------------------------------------</i>
<a name="1561"/> 1561: <i>%%--------------------------------------------------------------------</i>
<a name="hash-3"/><a name="1562"/> 1562: <b>hash</b>(_, [], []) -&gt;
<a name="1563"/> 1563:     ok;
<a name="1564"/> 1564: <b>hash</b>(Type, [Msg | RestMsg], [Digest| RestDigest]) -&gt;
<a name="hash-last_expr"/><a name="1565"/> 1565: <b>    case crypto:hash</b>(Type, Msg) of
<a name="1566"/> 1566: 	Digest -&gt;
<a name="1567"/> 1567: 	    hash(Type, RestMsg, RestDigest);
<a name="1568"/> 1568: 	Other -&gt;
<a name="1569"/> 1569: 	    ct:fail({{crypto, hash, [Type, Msg]}, {expected, Digest}, {got, Other}})
<a name="1570"/> 1570:     end.
<a name="1571"/> 1571: 
<a name="hash_xof-4"/><a name="1572"/> 1572: <b>hash_xof</b>(_, [], [], []) -&gt;
<a name="1573"/> 1573:   ok;
<a name="1574"/> 1574: <b>hash_xof</b>(Type, [Msg | RestMsg], [Digest | RestDigest], [Length | RestLength]) -&gt;
<a name="hash_xof-last_expr"/><a name="1575"/> 1575: <b>  case crypto:hash_xof</b>(Type, Msg, Length) of
<a name="1576"/> 1576:     Digest -&gt;
<a name="1577"/> 1577:       hash_xof(Type, RestMsg, RestDigest, RestLength);
<a name="1578"/> 1578:     Other -&gt;
<a name="1579"/> 1579:       ct:fail({{crypto, hash_xof, [Type, Msg, Length]}, {expected, Digest}, {got, Other}})
<a name="1580"/> 1580:   end.
<a name="1581"/> 1581: 
<a name="hash_increment-3"/><a name="1582"/> 1582: <b>hash_increment</b>(Type, Increments, Digest) -&gt;
<a name="1583"/> 1583:     State = crypto:hash_init(Type),
<a name="hash_increment-last_expr"/><a name="1584"/> 1584: <b>    case hash_increment</b>(State, Increments) of
<a name="1585"/> 1585: 	Digest -&gt;
<a name="1586"/> 1586: 	    ok;
<a name="1587"/> 1587: 	Other -&gt;
<a name="1588"/> 1588: 	    ct:fail({{crypto, &quot;hash_init/update/final&quot;, [Type, Increments]}, {expected, Digest}, {got, Other}})  
<a name="1589"/> 1589:     end.
<a name="1590"/> 1590: 
<a name="hash_increment-2"/><a name="1591"/> 1591: <b>hash_increment</b>(State, []) -&gt;
<a name="1592"/> 1592:     crypto:hash_final(State);
<a name="1593"/> 1593: <b>hash_increment</b>(State0, [Increment | Rest]) -&gt;
<a name="1594"/> 1594:     State = crypto:hash_update(State0, Increment),
<a name="hash_increment-last_expr"/><a name="1595"/> 1595: <b>    hash_increment</b>(State, Rest).
<a name="1596"/> 1596: 
<a name="1597"/> 1597: <i>%%%----------------------------------------------------------------</i>
<a name="mac_check-1"/><a name="1598"/> 1598: <b>mac_check</b>({MacType, SubType, Key, Text, Mac}=T) -&gt;
<a name="1599"/> 1599:     ExpMac = iolist_to_binary(Mac),
<a name="1600"/> 1600:     cipher_test(T,
<a name="1601"/> 1601:                 fun() -&gt; crypto:mac(MacType, SubType, Key, Text) end,
<a name="1602"/> 1602:                 ExpMac);
<a name="1603"/> 1603: <b>mac_check</b>({MacType, SubType, Key, Text, Size, Mac}=T) -&gt;
<a name="1604"/> 1604:     ExpMac = iolist_to_binary(Mac),
<a name="mac_check-last_expr"/><a name="1605"/> 1605: <b>    cipher_test</b>(T,
<a name="1606"/> 1606:                 fun() -&gt; crypto:macN(MacType, SubType, Key, Text, Size) end,
<a name="1607"/> 1607:                 ExpMac).
<a name="1608"/> 1608: 
<a name="mac_increment-4"/><a name="1609"/> 1609: <b>mac_increment</b>(Type, SubType, Key, Increments) -&gt;
<a name="1610"/> 1610:     Expected = crypto:mac(Type, SubType, Key, Increments),
<a name="1611"/> 1611:     State = crypto:mac_init(Type, SubType, Key),
<a name="mac_increment-last_expr"/><a name="1612"/> 1612: <b>    case do_mac_increment</b>(State, Increments) of
<a name="1613"/> 1613: 	Expected -&gt;
<a name="1614"/> 1614: 	    ok;
<a name="1615"/> 1615: 	Other -&gt;
<a name="1616"/> 1616: 	    ct:fail({{crypto, &quot;mac_init/update/final&quot;, [Type, SubType, Increments]},
<a name="1617"/> 1617:                      {expected, Expected},
<a name="1618"/> 1618:                      {got, Other}})  
<a name="1619"/> 1619:     end.
<a name="1620"/> 1620: 
<a name="do_mac_increment-2"/><a name="1621"/> 1621: <b>do_mac_increment</b>(State, []) -&gt;
<a name="1622"/> 1622:     crypto:mac_final(State);
<a name="1623"/> 1623: <b>do_mac_increment</b>(State0, [Increment | Rest]) -&gt;
<a name="1624"/> 1624:     State = crypto:mac_update(State0, Increment),
<a name="do_mac_increment-last_expr"/><a name="1625"/> 1625: <b>    do_mac_increment</b>(State, Rest).
<a name="1626"/> 1626: 
<a name="aead_cipher_ng-1"/><a name="1627"/> 1627: <b>aead_cipher_ng</b>({Type, Key, PlainText, IV, AAD, CipherText, CipherTag, _Info}=T) -&gt;
<a name="1628"/> 1628:     Plain = iolist_to_binary(PlainText),
<a name="1629"/> 1629:     cipher_test(T,
<a name="1630"/> 1630:                 fun() -&gt; crypto:crypto_one_time_aead(Type, Key, IV, PlainText, AAD, true) end,
<a name="1631"/> 1631:                 {CipherText, CipherTag},
<a name="1632"/> 1632:                 fun() -&gt; crypto:crypto_one_time_aead(Type, Key, IV, CipherText, AAD, CipherTag, false) end,
<a name="1633"/> 1633:                 Plain);
<a name="1634"/> 1634: <b>aead_cipher_ng</b>({Type, Key, PlainText, IV, AAD, CipherText, CipherTag, TagLen, _Info}=T) -&gt;
<a name="1635"/> 1635:     &lt;&lt;TruncatedCipherTag:TagLen/binary, _/binary&gt;&gt; = CipherTag,
<a name="1636"/> 1636:     Plain = iolist_to_binary(PlainText),
<a name="aead_cipher_ng-last_expr"/><a name="1637"/> 1637: <b>    cipher_test</b>(T,
<a name="1638"/> 1638:                 fun() -&gt; crypto:crypto_one_time_aead(Type, Key, IV, PlainText, AAD, TagLen, true) end,
<a name="1639"/> 1639:                 {CipherText, TruncatedCipherTag},
<a name="1640"/> 1640:                 fun() -&gt; crypto:crypto_one_time_aead(Type, Key, IV, CipherText, AAD, TruncatedCipherTag, false) end,
<a name="1641"/> 1641:                 Plain).
<a name="1642"/> 1642: 
<a name="aead_cipher_bad_tag-1"/><a name="1643"/> 1643: <b>aead_cipher_bad_tag</b>({Type, Key, _PlainText, IV, AAD, CipherText, CipherTag, _Info}=T) -&gt;
<a name="1644"/> 1644:     BadTag = mk_bad_tag(CipherTag),
<a name="1645"/> 1645:     cipher_test(T,
<a name="1646"/> 1646:                 fun() -&gt; crypto:crypto_one_time_aead(Type, Key, IV, CipherText, AAD, BadTag, false) end,
<a name="1647"/> 1647:                 error);
<a name="1648"/> 1648: <b>aead_cipher_bad_tag</b>({Type, Key, _PlainText, IV, AAD, CipherText, CipherTag, TagLen, _Info}=T) -&gt;
<a name="1649"/> 1649:     &lt;&lt;TruncatedCipherTag:TagLen/binary, _/binary&gt;&gt; = CipherTag,
<a name="1650"/> 1650:     BadTruncatedTag = mk_bad_tag(TruncatedCipherTag),
<a name="aead_cipher_bad_tag-last_expr"/><a name="1651"/> 1651: <b>    cipher_test</b>(T,
<a name="1652"/> 1652:                 fun() -&gt; crypto:crypto_one_time_aead(Type, Key, IV, CipherText, AAD, BadTruncatedTag, false) end,
<a name="1653"/> 1653:                 error).
<a name="1654"/> 1654: 
<a name="1655"/> 1655: 
<a name="cipher_test-5"/><a name="1656"/> 1656: <b>cipher_test</b>(T, Fe, Ee, Fd, Ed) -&gt;
<a name="1657"/> 1657:     %% Test encrypt
<a name="1658"/> 1658:     Re = cipher_test(encrypt, T, Fe, Ee),
<a name="1659"/> 1659:     %% Test decrypt
<a name="1660"/> 1660:     Rd = cipher_test(decrypt, T, Fd, Ed),
<a name="cipher_test-last_expr"/><a name="1661"/> 1661:     case {Re, Rd} of
<a name="1662"/> 1662:         {ok,ok} -&gt; ok;
<a name="1663"/> 1663:         {ok,_} -&gt; Rd;
<a name="1664"/> 1664:         {_,ok} -&gt; Re;
<a name="1665"/> 1665:         _ -&gt; {Re,Rd}
<a name="1666"/> 1666:     end.
<a name="1667"/> 1667: 
<a name="cipher_test-3"/><a name="1668"/> 1668: <b>cipher_test</b>(T, F, E) -&gt;
<a name="cipher_test-last_expr"/><a name="1669"/> 1669: <b>    cipher_test</b>(notag, T, F, E).
<a name="1670"/> 1670: 
<a name="cipher_test-4"/><a name="1671"/> 1671: <b>cipher_test</b>(Tag, T, F, E) -&gt;
<a name="cipher_test-last_expr"/><a name="1672"/> 1672: <b>    try F</b>() of
<a name="1673"/> 1673:         E -&gt; ok;
<a name="1674"/> 1674:         Other -&gt; {other, {Tag,T,Other}}
<a name="1675"/> 1675:     catch
<a name="1676"/> 1676:         error:Error -&gt; ct:pal(&quot;Tag = ~p,~n T = ~p,~n F = ~p,~n E = ~p,~n Error = ~p&quot;, [Tag, T, F, E, Error]), {error, {Tag,T,Error}}
<a name="1677"/> 1677:     end.
<a name="1678"/> 1678: 
<a name="do_cipher_tests-2"/><a name="1679"/> 1679: <b>do_cipher_tests</b>(F, TestVectors) when is_function(F,1) -&gt;
<a name="1680"/> 1680:     {Passed,Failed} =
<a name="1681"/> 1681:         lists:partition(
<a name="1682"/> 1682:           fun(R) -&gt; R == ok end,
<a name="1683"/> 1683:           lists:map(F, TestVectors)
<a name="1684"/> 1684:          ),
<a name="1685"/> 1685:     BothFailed = lists:filter(fun({ok,_}) -&gt; false;
<a name="1686"/> 1686:                                  ({_,ok}) -&gt; false;
<a name="1687"/> 1687:                                  (ok) -&gt; false;
<a name="1688"/> 1688:                                  (_) -&gt; true
<a name="1689"/> 1689:                               end,
<a name="1690"/> 1690:                               Failed),
<a name="1691"/> 1691:     ct:log(&quot;Passed: ~p, BothFailed: ~p OnlyOneFailed: ~p&quot;,
<a name="1692"/> 1692:            [length(Passed), length(BothFailed), length(Failed)-length(BothFailed)]),
<a name="do_cipher_tests-last_expr"/><a name="1693"/> 1693:     case Failed of
<a name="1694"/> 1694:         [] -&gt;
<a name="1695"/> 1695:             ct:comment(&quot;All ~p passed&quot;, [length(Passed)]);
<a name="1696"/> 1696:         _ -&gt;
<a name="1697"/> 1697:             ct:log(&quot;~p&quot;,[hd(Failed)]),
<a name="1698"/> 1698:             ct:comment(&quot;Passed: ~p, BothFailed: ~p OnlyOneFailed: ~p&quot;,
<a name="1699"/> 1699:                        [length(Passed), length(BothFailed), length(Failed)-length(BothFailed)]),
<a name="1700"/> 1700:             ct:fail(&quot;Failed&quot;, [])
<a name="1701"/> 1701:     end.
<a name="1702"/> 1702: 
<a name="1703"/> 1703: 
<a name="mk_bad_tag-1"/><a name="1704"/> 1704: <b>mk_bad_tag</b>(CipherTag) -&gt;
<a name="mk_bad_tag-last_expr"/><a name="1705"/> 1705: <b>    case &lt;&lt;0:</b>(size(CipherTag))/unit:8&gt;&gt; of
<a name="1706"/> 1706:         CipherTag -&gt; % The correct tag may happen to be a suite of zeroes
<a name="1707"/> 1707:             &lt;&lt;1:(size(CipherTag))/unit:8&gt;&gt;;
<a name="1708"/> 1708:         X -&gt;
<a name="1709"/> 1709:             X
<a name="1710"/> 1710:     end.
<a name="1711"/> 1711: 
<a name="do_sign_verify-1"/><a name="1712"/> 1712: <b>do_sign_verify</b>({Type, undefined=Hash, Private, Public, Msg, Signature}) -&gt;
<a name="1713"/> 1713:     case crypto:sign(eddsa, Hash, Msg, [Private,Type]) of
<a name="1714"/> 1714:         Signature -&gt;
<a name="1715"/> 1715:             ct:log(&quot;OK crypto:sign(eddsa, ~p, Msg, [Private,~p])&quot;, [Hash,Type]),
<a name="1716"/> 1716:             case crypto:verify(eddsa, Hash, Msg, Signature, [Public,Type]) of
<a name="1717"/> 1717:                 true -&gt;
<a name="1718"/> 1718:                     ct:log(&quot;OK crypto:verify(eddsa, ~p, Msg, Signature, [Public,~p])&quot;, [Hash,Type]),
<a name="1719"/> 1719:                     negative_verify(eddsa, Hash, Msg, &lt;&lt;10,20&gt;&gt;, [Public,Type]);
<a name="1720"/> 1720:                 false -&gt;
<a name="1721"/> 1721:                     ct:log(&quot;ERROR crypto:verify(eddsa, ~p, Msg= ~p, Signature= ~p, [Public= ~p,~p])&quot;,
<a name="1722"/> 1722:                            [Hash,Msg,Signature,Public,Type]),
<a name="1723"/> 1723:                     ct:fail({{crypto, verify, [eddsa, Hash, Msg, Signature, [Public,Type]]}})
<a name="1724"/> 1724:             end;
<a name="1725"/> 1725:         ErrorSig -&gt;
<a name="1726"/> 1726:             ct:log(&quot;ERROR crypto:sign(~p, ~p, ..., [Private= ~p,~p])&quot;, [eddsa,Hash,Private,Type]),
<a name="1727"/> 1727:             ct:log(&quot;ERROR crypto:verify(eddsa, ~p, Msg= ~p, [Public= ~p,~p])~n&quot;
<a name="1728"/> 1728:                    &quot;ErrorSig   = ~p~n&quot;
<a name="1729"/> 1729:                    &quot;CorrectSig = ~p~n&quot;
<a name="1730"/> 1730:                   ,
<a name="1731"/> 1731:                    [Hash,Msg,Public,Type,ErrorSig,Signature]),
<a name="1732"/> 1732:             ct:fail({{crypto, sign, [Type, Hash, Msg, ErrorSig, [Private]]}})
<a name="1733"/> 1733:     end;
<a name="1734"/> 1734: 
<a name="1735"/> 1735: <b>do_sign_verify</b>({Type, Hash, Public, Private, Msg}) -&gt;
<a name="1736"/> 1736:     case {Hash, crypto:info_fips()} of
<a name="1737"/> 1737:         {sha, enabled} -&gt;
<a name="1738"/> 1738:             io:format(&quot;Skip sign with SHA for FIPS\n&quot;);
<a name="1739"/> 1739:         _ -&gt;
<a name="1740"/> 1740:             Signature = crypto:sign(Type, Hash, Msg, Private),
<a name="1741"/> 1741:             case crypto:verify(Type, Hash, Msg, Signature, Public) of
<a name="1742"/> 1742:                 true -&gt;
<a name="1743"/> 1743:                     ct:log(&quot;OK crypto:sign(~p, ~p, ..., ..., ...)&quot;, [Type,Hash]),
<a name="1744"/> 1744:                     negative_verify(Type, Hash, Msg, &lt;&lt;10,20&gt;&gt;, Public);
<a name="1745"/> 1745:                 false -&gt;
<a name="1746"/> 1746:                     ct:log(&quot;ERROR crypto:sign(~p, ~p, ..., ..., ...)&quot;, [Type,Hash]),
<a name="1747"/> 1747:                     ct:fail({{crypto, verify, [Type, Hash, Msg, Signature, Public]}})
<a name="1748"/> 1748:             end
<a name="1749"/> 1749:     end;
<a name="1750"/> 1750: <b>do_sign_verify</b>({Type, Hash, Public, Private, Msg, Options}) -&gt;
<a name="1751"/> 1751:     LibVer =
<a name="1752"/> 1752:         case crypto:info_lib() of
<a name="1753"/> 1753:             [{&lt;&lt;&quot;OpenSSL&quot;&gt;&gt;,Ver,&lt;&lt;&quot;OpenSSL&quot;,_/binary&gt;&gt;}] -&gt; Ver;
<a name="1754"/> 1754:             _ -&gt; infinity
<a name="1755"/> 1755:         end,
<a name="1756"/> 1756:     Pad = proplists:get_value(rsa_padding, Options),
<a name="1757"/> 1757:     NotSupLow = lists:member(Pad, [rsa_pkcs1_pss_padding]),
<a name="do_sign_verify-last_expr"/><a name="1758"/> 1758:     try
<a name="1759"/> 1759:         crypto:sign(Type, Hash, Msg, Private, Options)
<a name="1760"/> 1760:     of
<a name="1761"/> 1761:         Signature -&gt;
<a name="1762"/> 1762:             case crypto:verify(Type, Hash, Msg, Signature, Public, Options) of
<a name="1763"/> 1763:                 true -&gt;
<a name="1764"/> 1764:                     ct:log(&quot;OK crypto:sign(~p, ~p, ..., ..., ..., ~p)&quot;, [Type,Hash,Options]),
<a name="1765"/> 1765:                     negative_verify(Type, Hash, Msg, &lt;&lt;10,20&gt;&gt;, Public, Options);
<a name="1766"/> 1766:                 false -&gt;
<a name="1767"/> 1767:                     ct:log(&quot;ERROR crypto:sign(~p, ~p, ..., ..., ..., ~p)&quot;, [Type,Hash,Options]),
<a name="1768"/> 1768:                     ct:fail({{crypto, verify, [Type, Hash, Msg, Signature, Public, Options]}})
<a name="1769"/> 1769:             end
<a name="1770"/> 1770:     catch
<a name="1771"/> 1771:         error:notsup when NotSupLow == true,
<a name="1772"/> 1772:                           is_integer(LibVer),
<a name="1773"/> 1773:                           LibVer &lt; 16#10001000 -&gt;
<a name="1774"/> 1774:             %% Those opts where introduced in 1.0.1
<a name="1775"/> 1775:             ct:log(&quot;notsup but OK in old cryptolib crypto:sign(~p, ~p, ..., ..., ..., ~p)&quot;,
<a name="1776"/> 1776:                    [Type,Hash,Options]),
<a name="1777"/> 1777:             true;
<a name="1778"/> 1778:         error:{notsup,_,_} when NotSupLow == true,
<a name="1779"/> 1779:                           is_integer(LibVer),
<a name="1780"/> 1780:                           LibVer &lt; 16#10001000 -&gt;
<a name="1781"/> 1781:             %% Those opts where introduced in 1.0.1
<a name="1782"/> 1782:             ct:log(&quot;notsup but OK in old cryptolib crypto:sign(~p, ~p, ..., ..., ..., ~p)&quot;,
<a name="1783"/> 1783:                    [Type,Hash,Options]),
<a name="1784"/> 1784:             true;
<a name="1785"/> 1785:         C:E -&gt;
<a name="1786"/> 1786:             ct:log(&quot;~p:~p  crypto:sign(~p, ~p, ..., ..., ..., ~p)&quot;, [C,E,Type,Hash,Options]),
<a name="1787"/> 1787:             ct:fail({{crypto, sign_verify, [LibVer, Type, Hash, Msg, Public, Options]}})
<a name="1788"/> 1788:     end.
<a name="1789"/> 1789: 
<a name="negative_verify-5"/><a name="1790"/> 1790: <b>negative_verify</b>(Type, Hash, Msg, Signature, Public) -&gt;
<a name="negative_verify-last_expr"/><a name="1791"/> 1791: <b>    case crypto:verify</b>(Type, Hash, Msg, Signature, Public) of
<a name="1792"/> 1792: 	true -&gt;
<a name="1793"/> 1793: 	    ct:fail({{crypto, verify, [Type, Hash, Msg, Signature, Public]}, should_fail});
<a name="1794"/> 1794: 	false -&gt;
<a name="1795"/> 1795: 	    ok
<a name="1796"/> 1796:     end.
<a name="1797"/> 1797: 
<a name="negative_verify-6"/><a name="1798"/> 1798: <b>negative_verify</b>(Type, Hash, Msg, Signature, Public, Options) -&gt;
<a name="negative_verify-last_expr"/><a name="1799"/> 1799: <b>    case crypto:verify</b>(Type, Hash, Msg, Signature, Public, Options) of
<a name="1800"/> 1800: 	true -&gt;
<a name="1801"/> 1801: 	    ct:fail({{crypto, verify, [Type, Hash, Msg, Signature, Public, Options]}, should_fail});
<a name="1802"/> 1802: 	false -&gt;
<a name="1803"/> 1803: 	    ok
<a name="1804"/> 1804:     end.
<a name="1805"/> 1805: 
<a name="do_public_encrypt-1"/><a name="1806"/> 1806: <b>do_public_encrypt</b>({Type, Public, Private, Msg, Padding}) -&gt;
<a name="1807"/> 1807:     ct:log(&quot;do_public_encrypt Type=~p, Padding=~p,~nPublic = ~p,~nPrivate = ~p,~nMsg = ~p.&quot;,
<a name="1808"/> 1808:            [Type, Padding, Public, Private, Msg]),
<a name="1809"/> 1809:     timer:sleep(100),
<a name="do_public_encrypt-last_expr"/><a name="1810"/> 1810:     try
<a name="1811"/> 1811:         crypto:public_encrypt(Type, Msg, Public, Padding)
<a name="1812"/> 1812:     of
<a name="1813"/> 1813:         PublicEcn -&gt;
<a name="1814"/> 1814:             ct:log(&quot;private_decrypt~nPublicEcn = ~p.&quot;, [PublicEcn]),
<a name="1815"/> 1815:             timer:sleep(100),
<a name="1816"/> 1816:             try
<a name="1817"/> 1817:                 crypto:private_decrypt(Type, PublicEcn, Private, Padding)
<a name="1818"/> 1818:             of
<a name="1819"/> 1819:                 Msg -&gt;
<a name="1820"/> 1820:                     ct:log(&quot;~p:~p ok&quot;, [?MODULE,?LINE]),
<a name="1821"/> 1821:                     timer:sleep(100),
<a name="1822"/> 1822:                     ok;
<a name="1823"/> 1823:                 Other -&gt;
<a name="1824"/> 1824:                     ct:log(&quot;~p:~p Other = ~p&quot;, [?MODULE,?LINE,Other]),
<a name="1825"/> 1825:                     timer:sleep(100),
<a name="1826"/> 1826:                     ct:fail({{crypto, private_decrypt, [Type, PublicEcn, Private, Padding]}, {expected, Msg}, {got, Other}})
<a name="1827"/> 1827:             catch
<a name="1828"/> 1828:                 CC:EE -&gt;
<a name="1829"/> 1829:                     ct:log(&quot;~p:~p EXC. ~p:~p&quot;, [?MODULE,?LINE,CC,EE]),
<a name="1830"/> 1830:                     timer:sleep(100),
<a name="1831"/> 1831:                     ct:fail({{crypto, private_decrypt, [Type, PublicEcn, Private, Padding]}, {expected, Msg}, {got, {CC,EE}}})
<a name="1832"/> 1832:             end
<a name="1833"/> 1833:     catch
<a name="1834"/> 1834:         CC:EE -&gt;
<a name="1835"/> 1835:             ct:log(&quot;~p:~p EXC 2. ~p:~p&quot;, [?MODULE,?LINE,CC,EE]),
<a name="1836"/> 1836:             timer:sleep(100),
<a name="1837"/> 1837:             ct:fail({{crypto, public_encrypt, [Type, Msg, Public, Padding]}, {got, {CC,EE}}})
<a name="1838"/> 1838:     end. 
<a name="1839"/> 1839: 
<a name="1840"/> 1840: 
<a name="do_private_encrypt-1"/><a name="1841"/> 1841: <b>do_private_encrypt</b>({Type, Public, Private, Msg, Padding}) -&gt;
<a name="1842"/> 1842:     ct:log(&quot;do_private_encrypt Type=~p, Padding=~p,~nPublic = ~p,~nPrivate = ~p,~nMsg = ~p.&quot;,
<a name="1843"/> 1843:            [Type, Padding, Public, Private, Msg]),
<a name="do_private_encrypt-last_expr"/><a name="1844"/> 1844:     try
<a name="1845"/> 1845:         crypto:private_encrypt(Type, Msg, Private, Padding)
<a name="1846"/> 1846:     of
<a name="1847"/> 1847:         PrivEcn -&gt;
<a name="1848"/> 1848:             try
<a name="1849"/> 1849:                 ct:log(&quot;public_decrypt~nPrivEcn = ~p.&quot;, [PrivEcn]),
<a name="1850"/> 1850:                 crypto:public_decrypt(Type, PrivEcn, Public, Padding)
<a name="1851"/> 1851:             of
<a name="1852"/> 1852:                 Msg -&gt;
<a name="1853"/> 1853:                     ct:log(&quot;~p:~p ok&quot;, [?MODULE,?LINE]),
<a name="1854"/> 1854:                     ok;
<a name="1855"/> 1855:                 Other -&gt;
<a name="1856"/> 1856:                     ct:log(&quot;~p:~p Other = ~p&quot;, [?MODULE,?LINE,Other]),
<a name="1857"/> 1857:                     ct:fail({{crypto, public_decrypt, [Type, PrivEcn, Public, Padding]}, {expected, Msg}, {got, Other}})
<a name="1858"/> 1858:             catch
<a name="1859"/> 1859:                 CC:EE -&gt;
<a name="1860"/> 1860:                     ct:log(&quot;~p:~p EXC. ~p:~p&quot;, [?MODULE,?LINE,CC,EE]),
<a name="1861"/> 1861:                     ct:fail({{crypto, public_decrypt, [Type, PrivEcn, Public, Padding]}, {expected, Msg}, {got, {CC,EE}}})
<a name="1862"/> 1862:             end
<a name="1863"/> 1863:     catch
<a name="1864"/> 1864:         CC:EE -&gt;
<a name="1865"/> 1865:             ct:log(&quot;~p:~p EXC 2. ~p:~p&quot;, [?MODULE,?LINE,CC,EE]),
<a name="1866"/> 1866:             ct:fail({{crypto, private_encrypt, [Type, Msg, Private, Padding]}, {got, {CC,EE}}})
<a name="1867"/> 1867:     end.
<a name="1868"/> 1868: 
<a name="do_generate_compute-1"/><a name="1869"/> 1869: <b>do_generate_compute</b>({srp = Type, UserPrivate, UserGenParams, UserComParams,
<a name="1870"/> 1870: 		     HostPublic, HostPrivate, HostGenParams, HostComParam, SessionKey}) -&gt;
<a name="1871"/> 1871:     {UserPublic, UserPrivate} = crypto:generate_key(Type, UserGenParams, UserPrivate),
<a name="1872"/> 1872:     {HostPublic, HostPrivate} = crypto:generate_key(Type, HostGenParams, HostPrivate),
<a name="1873"/> 1873:     SessionKey = crypto:compute_key(Type, HostPublic, {UserPublic, UserPrivate},
<a name="1874"/> 1874:      				    UserComParams),
<a name="1875"/> 1875:     SessionKey = crypto:compute_key(Type, UserPublic, {HostPublic, HostPrivate},
<a name="1876"/> 1876: 				    HostComParam);
<a name="1877"/> 1877: 
<a name="1878"/> 1878: 
<a name="1879"/> 1879: 
<a name="1880"/> 1880: <b>do_generate_compute</b>({dh, P, G}) -&gt;
<a name="1881"/> 1881:     {UserPub, UserPriv} = crypto:generate_key(dh, [P, G]),
<a name="1882"/> 1882:     {HostPub, HostPriv} = crypto:generate_key(dh, [P, G]),
<a name="1883"/> 1883:     SharedSecret = crypto:compute_key(dh, HostPub, UserPriv, [P, G]),
<a name="do_generate_compute-last_expr"/><a name="1884"/> 1884: <b>    SharedSecret = crypto:compute_key</b>(dh, UserPub, HostPriv, [P, G]).
<a name="1885"/> 1885:     
<a name="do_compute-1"/><a name="1886"/> 1886: <b>do_compute</b>({ecdh = Type, Pub, Priv, Curve, SharedSecret}) -&gt;
<a name="1887"/> 1887:     ct:log(&quot;~p ~p&quot;, [Type,Curve]),
<a name="1888"/> 1888:     Secret = crypto:compute_key(Type, Pub, Priv, Curve),
<a name="do_compute-last_expr"/><a name="1889"/> 1889:      case Secret of
<a name="1890"/> 1890: 	 SharedSecret -&gt;
<a name="1891"/> 1891: 	     ok;
<a name="1892"/> 1892: 	 Other -&gt;
<a name="1893"/> 1893: 	     ct:fail({{crypto, compute_key, [Type, Pub, Priv, Curve]}, {expected, SharedSecret}, {got, Other}})
<a name="1894"/> 1894:      end.
<a name="1895"/> 1895: 
<a name="do_generate-1"/><a name="1896"/> 1896: <b>do_generate</b>({Type, Curve, Priv, Pub}) when Type == ecdh ; Type == eddsa -&gt;
<a name="1897"/> 1897:     ct:log(&quot;~p ~p&quot;, [Type,Curve]),
<a name="1898"/> 1898:     case crypto:generate_key(Type, Curve, Priv) of
<a name="1899"/> 1899: 	{Pub, _} -&gt;
<a name="1900"/> 1900: 	    ok;
<a name="1901"/> 1901: 	{Other, _} -&gt;
<a name="1902"/> 1902: 	    ct:fail({{crypto, generate_key, [Type, Priv, Curve]}, {expected, Pub}, {got, Other}})
<a name="1903"/> 1903:     end;
<a name="1904"/> 1904: <b>do_generate</b>({rsa = Type, Mod, Exp}) -&gt;
<a name="1905"/> 1905:     ct:log(&quot;~p&quot;, [Type]),
<a name="do_generate-last_expr"/><a name="1906"/> 1906: <b>    case crypto:info_fips</b>() of
<a name="1907"/> 1907:         enabled when Mod &lt; 3072 -&gt;
<a name="1908"/> 1908:             ct:log(&quot;SKIP do_generate ~p FIPS=~p, Mod=~p  Exp=~p&quot;, [Type, enabled, Mod, Exp]),
<a name="1909"/> 1909:             {skip, &quot;FIPS violation&quot;};
<a name="1910"/> 1910:         FIPS -&gt;
<a name="1911"/> 1911:             ct:log(&quot;do_generate ~p FIPS=~p, Mod=~p  Exp=~p&quot;, [Type, FIPS, Mod, Exp]),
<a name="1912"/> 1912:             {Pub,Priv} = crypto:generate_key(Type, {Mod,Exp}),
<a name="1913"/> 1913:             do_sign_verify({rsa, sha256, Pub, Priv, rsa_plain()})
<a name="1914"/> 1914:     end.
<a name="1915"/> 1915: 
<a name="notsup-2"/><a name="1916"/> 1916: <b>notsup</b>(Fun, Args) -&gt;
<a name="1917"/> 1917:     Result =
<a name="1918"/> 1918:         try
<a name="1919"/> 1919:             {error, {return, apply(Fun, Args)}}
<a name="1920"/> 1920:         catch
<a name="1921"/> 1921:             error:notsup -&gt;
<a name="1922"/> 1922:                 ok;
<a name="1923"/> 1923:             error: {notsup, _, _} -&gt;
<a name="1924"/> 1924:                 ok;
<a name="1925"/> 1925:             Class:Error -&gt;
<a name="1926"/> 1926:                 {error, {Class, Error}}
<a name="1927"/> 1927:         end,
<a name="notsup-last_expr"/><a name="1928"/> 1928:     case Result of
<a name="1929"/> 1929:         ok -&gt;
<a name="1930"/> 1930:             ok;
<a name="1931"/> 1931:         {error, Value} -&gt;
<a name="1932"/> 1932:             {module, Module} = erlang:fun_info(Fun, module),
<a name="1933"/> 1933:             {name,   Name}   = erlang:fun_info(Fun, name),
<a name="1934"/> 1934:             ct:fail({{Module, Name, Args}, {expected, {error, notsup}}, {got, Value}})
<a name="1935"/> 1935:     end.
<a name="1936"/> 1936: 
<a name="hexstr2point-2"/><a name="1937"/> 1937: <b>hexstr2point</b>(X, Y) -&gt;
<a name="hexstr2point-last_expr"/><a name="1938"/> 1938: <b>    &lt;&lt;4:8, </b>(hexstr2bin(X))/binary, (hexstr2bin(Y))/binary&gt;&gt;.
<a name="1939"/> 1939: 
<a name="hexstr2bin-1"/><a name="1940"/> 1940: <b>hexstr2bin</b>(S) when is_binary(S) -&gt;
<a name="1941"/> 1941:     list_to_binary(hexstr2list(binary_to_list(S)));
<a name="1942"/> 1942: <b>hexstr2bin</b>(S) -&gt;
<a name="hexstr2bin-last_expr"/><a name="1943"/> 1943: <b>    list_to_binary</b>(hexstr2list(S)).
<a name="1944"/> 1944: 
<a name="hexstr2list-1"/><a name="1945"/> 1945: <b>hexstr2list</b>([$ |T]) -&gt;
<a name="1946"/> 1946:     hexstr2list(T);
<a name="1947"/> 1947: <b>hexstr2list</b>([X,Y|T]) -&gt;
<a name="1948"/> 1948:     [mkint(X)*16 + mkint(Y) | hexstr2list(T)];
<a name="1949"/> 1949: <b>hexstr2list</b>([]) -&gt;
<a name="hexstr2list-last_expr"/><a name="1950"/> 1950:     [].
<a name="mkint-1"/><a name="1951"/> 1951: <b>mkint</b>(C) when $0 =&lt; C, C =&lt; $9 -&gt;
<a name="1952"/> 1952:     C - $0;
<a name="1953"/> 1953: <b>mkint</b>(C) when $A =&lt; C, C =&lt; $F -&gt;
<a name="1954"/> 1954:     C - $A + 10;
<a name="1955"/> 1955: <b>mkint</b>(C) when $a =&lt; C, C =&lt; $f -&gt;
<a name="mkint-last_expr"/><a name="1956"/> 1956:     C - $a + 10.
<a name="1957"/> 1957: 
<a name="decstr2int-1"/><a name="1958"/> 1958: <b>decstr2int</b>(S) when is_binary(S) -&gt;
<a name="1959"/> 1959:     list_to_integer(binary:bin_to_list(S));
<a name="1960"/> 1960: <b>decstr2int</b>(S) -&gt;
<a name="decstr2int-last_expr"/><a name="1961"/> 1961: <b>    list_to_integer</b>(S).
<a name="1962"/> 1962: 
<a name="is_supported-1"/><a name="1963"/> 1963: <b>is_supported</b>(Group) -&gt;
<a name="is_supported-last_expr"/><a name="1964"/> 1964: <b>    lists:member</b>(Group, lists:append([Algo ||  {_, Algo}  &lt;- crypto:supports()])). 
<a name="1965"/> 1965: 
<a name="1966"/> 1966: 
<a name="mac_listify-1"/><a name="1967"/> 1967: <b>mac_listify</b>(Blocks) -&gt;
<a name="mac_listify-last_expr"/><a name="1968"/> 1968: <b>    lists:map</b>(fun do_mac_listify/1, Blocks).
<a name="1969"/> 1969: 
<a name="do_mac_listify-1"/><a name="1970"/> 1970: <b>do_mac_listify</b>({MType, Type, Key, Text, CMac}) -&gt;
<a name="1971"/> 1971:     {MType, Type, iolistify(Key), iolistify(Text), CMac};
<a name="1972"/> 1972: <b>do_mac_listify</b>({MType, Type, Key, Text, Size, CMac}) -&gt;
<a name="do_mac_listify-last_expr"/><a name="1973"/> 1973: <b>    {MType, Type, iolistify</b>(Key), iolistify(Text), Size, CMac}.
<a name="1974"/> 1974: 
<a name="1975"/> 1975: 
<a name="iolistify-1"/><a name="1976"/> 1976: <b>iolistify</b>(X) -&gt;
<a name="iolistify-last_expr"/><a name="1977"/> 1977: <b>    iolistify1</b>(lazy_eval(X)).
<a name="1978"/> 1978: 
<a name="iolistify1-1"/><a name="1979"/> 1979: <b>iolistify1</b>(&lt;&lt;&quot;Test With Truncation&quot;&gt;&gt;)-&gt;
<a name="1980"/> 1980:     %% Do not iolistify as it spoils this special case
<a name="1981"/> 1981:     &lt;&lt;&quot;Test With Truncation&quot;&gt;&gt;;
<a name="1982"/> 1982: <b>iolistify1</b>(Msg) when is_binary(Msg) -&gt;
<a name="1983"/> 1983:     Length = erlang:byte_size(Msg),
<a name="1984"/> 1984:     Split = Length div 2,
<a name="1985"/> 1985:     List0 = binary_to_list(Msg),
<a name="1986"/> 1986:    case lists:split(Split, List0) of
<a name="1987"/> 1987:        {[Element | List1], List2} -&gt;
<a name="1988"/> 1988: 	   [[Element], List1, List2];
<a name="1989"/> 1989:        {List1, List2}-&gt;
<a name="1990"/> 1990: 	   [List1, List2]
<a name="1991"/> 1991:    end;
<a name="1992"/> 1992: <b>iolistify1</b>(Msg) when is_list(Msg) -&gt;
<a name="iolistify1-last_expr"/><a name="1993"/> 1993: <b>    iolistify1</b>(list_to_binary(Msg)).
<a name="1994"/> 1994: 
<a name="1995"/> 1995: <i>%%--------------------------------------------------------------------</i>
<a name="mod_pow_aux_test-4"/><a name="1996"/> 1996: <b>mod_pow_aux_test</b>(_, _, _, 0) -&gt;
<a name="1997"/> 1997:     ok;
<a name="1998"/> 1998: <b>mod_pow_aux_test</b>(B, E, M, N) -&gt;
<a name="1999"/> 1999:     Result = crypto:bytes_to_integer(crypto:mod_pow(B, E, M)),
<a name="2000"/> 2000:     Result = ipow(B, E, M),
<a name="mod_pow_aux_test-last_expr"/><a name="2001"/> 2001: <b>    mod_pow_aux_test</b>(B, E*E+1, M*M+1, N-1).
<a name="2002"/> 2002: 
<a name="2003"/> 2003: <i>%% mod_exp in erlang (copied from jungerl's ssh_math.erl)</i>
<a name="ipow-3"/><a name="2004"/> 2004: <b>ipow</b>(A, B, M) when M &gt; 0, B &gt;= 0 -&gt;
<a name="ipow-last_expr"/><a name="2005"/> 2005:     if A == 1 -&gt; 
<a name="2006"/> 2006:  	    1;
<a name="2007"/> 2007:        true -&gt; 
<a name="2008"/> 2008:  	    ipow(A, B, M, 1)
<a name="2009"/> 2009:     end.
<a name="2010"/> 2010: 
<a name="ipow-4"/><a name="2011"/> 2011: <b>ipow</b>(A, 1, M, Prod) -&gt;
<a name="2012"/> 2012:     (A*Prod) rem M;
<a name="2013"/> 2013: <b>ipow</b>(_A, 0, _M, Prod) -&gt;
<a name="2014"/> 2014:     Prod;
<a name="2015"/> 2015: <b>ipow</b>(A, B, M, Prod)  -&gt;
<a name="2016"/> 2016:     B1 = B bsr 1,
<a name="2017"/> 2017:     A1 = (A*A) rem M,
<a name="ipow-last_expr"/><a name="2018"/> 2018:     if B - B1 == B1 -&gt;
<a name="2019"/> 2019: 	    ipow(A1, B1, M, Prod);
<a name="2020"/> 2020:        true -&gt;
<a name="2021"/> 2021: 	    ipow(A1, B1, M, (A*Prod) rem M)
<a name="2022"/> 2022:     end.
<a name="2023"/> 2023: 
<a name="do_exor-1"/><a name="2024"/> 2024: <b>do_exor</b>(B) -&gt;
<a name="2025"/> 2025:     Z1 = zero_bin(B),
<a name="2026"/> 2026:     Z1 = crypto:exor(B, B),
<a name="2027"/> 2027:     B1 = crypto:strong_rand_bytes(100),
<a name="2028"/> 2028:     B2 = crypto:strong_rand_bytes(100),
<a name="2029"/> 2029:     Z2 = zero_bin(B1),
<a name="2030"/> 2030:     Z2 = crypto:exor(B1, B1),
<a name="2031"/> 2031:     Z2 = crypto:exor(B2, B2),
<a name="2032"/> 2032:     R = xor_bytes(B1, B2),
<a name="do_exor-last_expr"/><a name="2033"/> 2033: <b>    R = crypto:exor</b>(B1, B2).
<a name="2034"/> 2034: 
<a name="zero_bin-1"/><a name="2035"/> 2035: <b>zero_bin</b>(N) when is_integer(N) -&gt;
<a name="2036"/> 2036:     N8 = N * 8,
<a name="2037"/> 2037:     &lt;&lt;0:N8/integer&gt;&gt;;
<a name="2038"/> 2038: <b>zero_bin</b>(B) when is_binary(B) -&gt;
<a name="zero_bin-last_expr"/><a name="2039"/> 2039: <b>    zero_bin</b>(size(B)).
<a name="xor_bytes-2"/><a name="2040"/> 2040: <b>xor_bytes</b>(Bin1, Bin2) when is_binary(Bin1), is_binary(Bin2) -&gt;
<a name="2041"/> 2041:     L1 = binary_to_list(Bin1),
<a name="2042"/> 2042:     L2 = binary_to_list(Bin2),
<a name="2043"/> 2043:     list_to_binary(xor_bytes(L1, L2));
<a name="2044"/> 2044: <b>xor_bytes</b>(L1, L2) -&gt;
<a name="xor_bytes-last_expr"/><a name="2045"/> 2045: <b>    xor_bytes</b>(L1, L2, []).
<a name="2046"/> 2046: 
<a name="xor_bytes-3"/><a name="2047"/> 2047: <b>xor_bytes</b>([], [], Acc) -&gt;
<a name="2048"/> 2048:     lists:reverse(Acc);
<a name="2049"/> 2049: <b>xor_bytes</b>([N1 | Tl1], [N2 | Tl2], Acc) -&gt;
<a name="xor_bytes-last_expr"/><a name="2050"/> 2050: <b>    xor_bytes</b>(Tl1, Tl2, [N1 bxor N2 | Acc]).
<a name="rand_uniform_aux_test-1"/><a name="2051"/> 2051: <b>rand_uniform_aux_test</b>(0) -&gt;
<a name="2052"/> 2052:     ok;
<a name="2053"/> 2053: <b>rand_uniform_aux_test</b>(N) -&gt;
<a name="2054"/> 2054:     L = N*1000,
<a name="2055"/> 2055:     H = N*100000+1,
<a name="2056"/> 2056:     crypto_rand_uniform(L, H),
<a name="2057"/> 2057:     crypto_rand_uniform(-L, L),
<a name="2058"/> 2058:     crypto_rand_uniform(-H, -L),
<a name="2059"/> 2059:     crypto_rand_uniform(-H, L),
<a name="rand_uniform_aux_test-last_expr"/><a name="2060"/> 2060: <b>    rand_uniform_aux_test</b>(N-1).
<a name="2061"/> 2061: 
<a name="crypto_rand_uniform-2"/><a name="2062"/> 2062: <b>crypto_rand_uniform</b>(L,H) -&gt;
<a name="2063"/> 2063:     R1 = (L-1) + rand:uniform(H-L),
<a name="crypto_rand_uniform-last_expr"/><a name="2064"/> 2064: <b>    case </b>(R1 &gt;= L) and (R1 &lt; H) of
<a name="2065"/> 2065: 	true  -&gt;
<a name="2066"/> 2066: 	    ok;
<a name="2067"/> 2067: 	false -&gt;
<a name="2068"/> 2068: 	    ct:fail({&quot;Not in interval&quot;, R1, L, H})
<a name="2069"/> 2069:     end.
<a name="2070"/> 2070: 
<a name="foldallmap-3"/><a name="2071"/> 2071: <b>foldallmap</b>(_Fun, AccN, []) -&gt;
<a name="2072"/> 2072:     {true, AccN};
<a name="2073"/> 2073: <b>foldallmap</b>(Fun, AccN, [H|T]) -&gt;
<a name="foldallmap-last_expr"/><a name="2074"/> 2074: <b>    case Fun</b>(H, AccN) of
<a name="2075"/> 2075:         {true, AccM} -&gt; foldallmap(Fun, AccM, T);
<a name="2076"/> 2076:         {{false, Result}, AccM} -&gt; {Result, AccM}
<a name="2077"/> 2077:     end.
<a name="2078"/> 2078: 
<a name="allmap-2"/><a name="2079"/> 2079: <b>allmap</b>(_Fun, []) -&gt;
<a name="2080"/> 2080:     true;
<a name="2081"/> 2081: <b>allmap</b>(Fun, [H|T]) -&gt;
<a name="allmap-last_expr"/><a name="2082"/> 2082: <b>    case Fun</b>(H) of
<a name="2083"/> 2083:         true -&gt; allmap(Fun, T);
<a name="2084"/> 2084:         {false, Result} -&gt; Result
<a name="2085"/> 2085:     end.
<a name="2086"/> 2086: 
<a name="rand_plugin_aux-1"/><a name="2087"/> 2087: <b>rand_plugin_aux</b>(StateType) -&gt;
<a name="2088"/> 2088:     {Seeder, SeedExporter, FloatGenerator, IntegerGenerator} = rand_plugin_functions(StateType),
<a name="2089"/> 2089:     State0 = Seeder(),
<a name="2090"/> 2090:     {crypto, no_seed} = SeedExporter(State0),
<a name="2091"/> 2091:     {FloatTestResult, State1} = rand_plugin_aux_floats(State0, FloatGenerator),
<a name="rand_plugin_aux-last_expr"/><a name="2092"/> 2092:     case FloatTestResult of
<a name="2093"/> 2093:         true -&gt;
<a name="2094"/> 2094:             {IntegerTestResult, _State2} = rand_plugin_aux_integers(State1, IntegerGenerator),
<a name="2095"/> 2095:             IntegerTestResult;
<a name="2096"/> 2096:         {false, _} -&gt;
<a name="2097"/> 2097:             FloatTestResult
<a name="2098"/> 2098:     end.
<a name="2099"/> 2099: 
<a name="2100"/> 2100: <i>% returns {Seeder, SeedExporter, FloatGenerator, IntegerGenerator} with consistent signatures</i>
<a name="rand_plugin_functions-1"/><a name="2101"/> 2101: <b>rand_plugin_functions</b>(implicit_state) -&gt;
<a name="2102"/> 2102:     {fun () -&gt; crypto:rand_seed(), implicit_state end,
<a name="2103"/> 2103:      fun (implicit_state) -&gt; rand:export_seed() end,
<a name="2104"/> 2104:      fun (implicit_state) -&gt; {rand:uniform(), implicit_state} end,
<a name="2105"/> 2105:      fun (N, implicit_state) -&gt; {rand:uniform(N), implicit_state} end};
<a name="2106"/> 2106: <b>rand_plugin_functions</b>(explicit_state) -&gt;
<a name="rand_plugin_functions-last_expr"/><a name="2107"/> 2107:     {fun crypto:rand_seed_s/0,
<a name="2108"/> 2108:      fun rand:export_seed_s/1,
<a name="2109"/> 2109:      fun rand:uniform_s/1,
<a name="2110"/> 2110:      fun rand:uniform_s/2}.
<a name="2111"/> 2111: 
<a name="rand_plugin_aux_floats-2"/><a name="2112"/> 2112: <b>rand_plugin_aux_floats</b>(State0, FloatGenerator) -&gt;
<a name="2113"/> 2113:     {FloatSamples, State1} =
<a name="2114"/> 2114:         lists:mapfoldl(
<a name="2115"/> 2115:           fun (_, StateAcc) -&gt;
<a name="2116"/> 2116:                   FloatGenerator(StateAcc)
<a name="2117"/> 2117:           end,
<a name="2118"/> 2118:           State0,
<a name="2119"/> 2119:           lists:seq(1, 10000)),
<a name="2120"/> 2120: 
<a name="rand_plugin_aux_floats-last_expr"/><a name="2121"/> 2121: <b>    {allmap</b>(
<a name="2122"/> 2122:        fun (V) -&gt;
<a name="2123"/> 2123:                (V &gt;= 0.0 andalso V &lt; 1.0)
<a name="2124"/> 2124:                orelse {false, ct:fail({&quot;Float sample not in interval&quot;, V, 0.0, 1.0})}
<a name="2125"/> 2125:        end,
<a name="2126"/> 2126:        FloatSamples),
<a name="2127"/> 2127:      State1}.
<a name="2128"/> 2128: 
<a name="rand_plugin_aux_integers-2"/><a name="2129"/> 2129: <b>rand_plugin_aux_integers</b>(State0, IntegerGenerator) -&gt;
<a name="2130"/> 2130:     MaxIntegerCeiling = 1 bsl 32,
<a name="2131"/> 2131:     {IntegerCeilings, State1} =
<a name="2132"/> 2132:         lists:mapfoldl(
<a name="2133"/> 2133:           fun (_, StateAcc) -&gt;
<a name="2134"/> 2134:                   IntegerGenerator(MaxIntegerCeiling, StateAcc)
<a name="2135"/> 2135:           end,
<a name="2136"/> 2136:           State0,
<a name="2137"/> 2137:           lists:seq(1, 100)),
<a name="2138"/> 2138: 
<a name="rand_plugin_aux_integers-last_expr"/><a name="2139"/> 2139: <b>    foldallmap</b>(
<a name="2140"/> 2140:       fun (Ceiling, StateAcc) -&gt;
<a name="2141"/> 2141:               case Ceiling &gt;= 1 andalso Ceiling =&lt; MaxIntegerCeiling of
<a name="2142"/> 2142:                   false -&gt;
<a name="2143"/> 2143:                       {{false, ct:fail({&quot;Integer ceiling not in interval&quot;,
<a name="2144"/> 2144:                                         Ceiling, 1, MaxIntegerCeiling})},
<a name="2145"/> 2145:                        StateAcc};
<a name="2146"/> 2146:                   true -&gt;
<a name="2147"/> 2147:                       foldallmap(
<a name="2148"/> 2148:                         fun (_, SubStateAcc) -&gt;
<a name="2149"/> 2149:                                 {Sample, NewSubStateAcc} = IntegerGenerator(Ceiling, SubStateAcc),
<a name="2150"/> 2150:                                 case Sample &gt;= 1 andalso Sample =&lt; Ceiling of
<a name="2151"/> 2151:                                     false -&gt;
<a name="2152"/> 2152:                                         {{false, ct:fail({&quot;Integer sample not in interval&quot;,
<a name="2153"/> 2153:                                                           Sample, 1, Ceiling})},
<a name="2154"/> 2154:                                          NewSubStateAcc};
<a name="2155"/> 2155:                                     true -&gt;
<a name="2156"/> 2156:                                         {true, NewSubStateAcc}
<a name="2157"/> 2157:                                 end
<a name="2158"/> 2158:                         end,
<a name="2159"/> 2159:                         StateAcc,
<a name="2160"/> 2160:                         lists:seq(1, 100))
<a name="2161"/> 2161:               end
<a name="2162"/> 2162:       end,
<a name="2163"/> 2163:       State1,
<a name="2164"/> 2164:       IntegerCeilings).
<a name="2165"/> 2165: 
<a name="2166"/> 2166: <i>%%--------------------------------------------------------------------</i>
<a name="2167"/> 2167: <i>%% Test data ------------------------------------------------</i>
<a name="2168"/> 2168: <i>%%--------------------------------------------------------------------</i>
<a name="group_config-2"/><a name="2169"/> 2169: <b>group_config</b>(md4 = Type, Config) -&gt;
<a name="2170"/> 2170:     Msgs = rfc_1321_msgs(),
<a name="2171"/> 2171:     Digests = rfc_1321_md4_digests(),
<a name="2172"/> 2172:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2173"/> 2173: <b>group_config</b>(md5 = Type, Config) -&gt;
<a name="2174"/> 2174:     Msgs = rfc_1321_msgs(),
<a name="2175"/> 2175:     Digests = rfc_1321_md5_digests(),
<a name="2176"/> 2176:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2177"/> 2177: <b>group_config</b>(ripemd160 = Type, Config) -&gt;
<a name="2178"/> 2178:     Msgs = ripemd160_msgs(),
<a name="2179"/> 2179:     Digests = ripemd160_digests(),
<a name="2180"/> 2180:    [{hash, {Type, Msgs, Digests}} | Config];
<a name="2181"/> 2181: <b>group_config</b>(sha = Type, Config) -&gt;
<a name="2182"/> 2182:     Msgs = [rfc_4634_test1(), rfc_4634_test2_1(),long_msg()],
<a name="2183"/> 2183:     Digests = rfc_4634_sha_digests() ++ [long_sha_digest()],
<a name="2184"/> 2184:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2185"/> 2185: <b>group_config</b>(sha224 = Type, Config) -&gt;
<a name="2186"/> 2186:     Msgs = [rfc_4634_test1(), rfc_4634_test2_1()], 
<a name="2187"/> 2187:     Digests = rfc_4634_sha224_digests(),
<a name="2188"/> 2188:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2189"/> 2189: <b>group_config</b>(sha256 = Type, Config) -&gt;
<a name="2190"/> 2190:     Msgs =   [rfc_4634_test1(), rfc_4634_test2_1(), long_msg()],
<a name="2191"/> 2191:     Digests = rfc_4634_sha256_digests()  ++ [long_sha256_digest()],
<a name="2192"/> 2192:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2193"/> 2193: <b>group_config</b>(sha384 = Type, Config) -&gt;
<a name="2194"/> 2194:     Msgs =  [rfc_4634_test1(), rfc_4634_test2(), long_msg()],
<a name="2195"/> 2195:     Digests = rfc_4634_sha384_digests()  ++ [long_sha384_digest()],
<a name="2196"/> 2196:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2197"/> 2197: <b>group_config</b>(sha512 = Type, Config) -&gt;
<a name="2198"/> 2198:     Msgs =  [rfc_4634_test1(), rfc_4634_test2(), long_msg()],
<a name="2199"/> 2199:     Digests = rfc_4634_sha512_digests() ++ [long_sha512_digest()],
<a name="2200"/> 2200:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2201"/> 2201: <b>group_config</b>(sha3_224 = Type, Config) -&gt;
<a name="2202"/> 2202:     {Msgs,Digests} = sha3_test_vectors(Type),
<a name="2203"/> 2203:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2204"/> 2204: <b>group_config</b>(sha3_256 = Type, Config) -&gt;
<a name="2205"/> 2205:     {Msgs,Digests} = sha3_test_vectors(Type),
<a name="2206"/> 2206:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2207"/> 2207: <b>group_config</b>(sha3_384 = Type, Config) -&gt;
<a name="2208"/> 2208:     {Msgs,Digests} = sha3_test_vectors(Type),
<a name="2209"/> 2209:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2210"/> 2210: <b>group_config</b>(sha3_512 = Type, Config) -&gt;
<a name="2211"/> 2211:     {Msgs,Digests} = sha3_test_vectors(Type),
<a name="2212"/> 2212:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2213"/> 2213: <b>group_config</b>(sm3 = Type, Config) -&gt;
<a name="2214"/> 2214:     {Msgs,Digests} = sm3_test_vectors(),
<a name="2215"/> 2215:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2216"/> 2216: <b>group_config</b>(shake128 = Type, Config) -&gt;
<a name="2217"/> 2217:     {Msgs,Digests,Lengths} = sha3_shake128_test_vectors(Type),
<a name="2218"/> 2218:     [{hash_xof, {Type, Msgs, Digests, Lengths}} | Config];
<a name="2219"/> 2219: <b>group_config</b>(shake256 = Type, Config) -&gt;
<a name="2220"/> 2220:     {Msgs,Digests,Lengths} = sha3_shake256_test_vectors(Type),
<a name="2221"/> 2221:     [{hash_xof, {Type, Msgs, Digests, Lengths}} | Config];
<a name="2222"/> 2222: <b>group_config</b>(blake2b = Type, Config) -&gt;
<a name="2223"/> 2223:     {Msgs, Digests} = blake2_test_vectors(Type),
<a name="2224"/> 2224:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2225"/> 2225: <b>group_config</b>(blake2s = Type, Config) -&gt;
<a name="2226"/> 2226:     {Msgs, Digests} = blake2_test_vectors(Type),
<a name="2227"/> 2227:     [{hash, {Type, Msgs, Digests}} | Config];
<a name="2228"/> 2228: <b>group_config</b>(rsa, Config) -&gt;
<a name="2229"/> 2229:     Msg = rsa_plain(),
<a name="2230"/> 2230:     Public = rsa_public(),
<a name="2231"/> 2231:     Private = rsa_private(),
<a name="2232"/> 2232:     PublicS = rsa_public_stronger(),
<a name="2233"/> 2233:     PrivateS = rsa_private_stronger(),
<a name="2234"/> 2234:     MsgPubEnc = &lt;&lt;&quot;7896345786348 Asldi&quot;&gt;&gt;,
<a name="2235"/> 2235:     SignVerify_OptsToTry = [[{rsa_padding, rsa_x931_padding}],
<a name="2236"/> 2236:                             [{rsa_padding, rsa_pkcs1_padding}],
<a name="2237"/> 2237:                             [{rsa_padding, rsa_pkcs1_pss_padding}],
<a name="2238"/> 2238:                             [{rsa_padding, rsa_pkcs1_pss_padding}, {rsa_pss_saltlen, -2}],
<a name="2239"/> 2239:                             [{rsa_padding, rsa_pkcs1_pss_padding}, {rsa_pss_saltlen, 5}],
<a name="2240"/> 2240:                             [{rsa_padding, rsa_pkcs1_pss_padding}, {rsa_mgf1_md,sha}],
<a name="2241"/> 2241:                             [{rsa_padding, rsa_pkcs1_pss_padding}, {rsa_mgf1_md,sha}, {rsa_pss_saltlen, 5}]
<a name="2242"/> 2242:                            ],
<a name="2243"/> 2243:     PrivEnc_OptsToTry = [rsa_pkcs1_padding,              % Compatibility
<a name="2244"/> 2244:                          [{rsa_pad, rsa_pkcs1_padding}], % Compatibility
<a name="2245"/> 2245:                          [{rsa_padding, rsa_pkcs1_padding}],
<a name="2246"/> 2246:                          [{rsa_padding,rsa_x931_padding}]
<a name="2247"/> 2247:                         ],
<a name="2248"/> 2248:     PubEnc_OptsToTry = [rsa_pkcs1_padding,              % Compatibility
<a name="2249"/> 2249:                  [{rsa_pad, rsa_pkcs1_padding}], % Compatibility
<a name="2250"/> 2250:                  [{rsa_padding, rsa_pkcs1_padding}],
<a name="2251"/> 2251:                  [{rsa_padding,rsa_pkcs1_oaep_padding}],
<a name="2252"/> 2252:                  [{rsa_padding,rsa_pkcs1_oaep_padding}, {rsa_oaep_label, &lt;&lt;&quot;Hej hopp&quot;&gt;&gt;}],
<a name="2253"/> 2253:                  [{rsa_padding,rsa_pkcs1_oaep_padding}, {rsa_oaep_md,sha}],
<a name="2254"/> 2254:                  [{rsa_padding,rsa_pkcs1_oaep_padding}, {rsa_oaep_md,sha}, {rsa_oaep_label, &lt;&lt;&quot;Hej hopp&quot;&gt;&gt;}],
<a name="2255"/> 2255:                  [{rsa_padding,rsa_pkcs1_oaep_padding}, {rsa_mgf1_md,sha}],
<a name="2256"/> 2256:                  [{rsa_padding,rsa_pkcs1_oaep_padding}, {rsa_mgf1_md,sha}, {rsa_oaep_label, &lt;&lt;&quot;Hej hopp&quot;&gt;&gt;}],
<a name="2257"/> 2257:                  [{rsa_padding,rsa_pkcs1_oaep_padding}, {rsa_mgf1_md,sha}, {rsa_oaep_md,sha}, {rsa_oaep_label, &lt;&lt;&quot;Hej hopp&quot;&gt;&gt;}]
<a name="2258"/> 2258:                  ],
<a name="2259"/> 2259:     RsaSignVerify = rsa_sign_verify_tests(Config, Msg, Public, Private, PublicS, PrivateS, SignVerify_OptsToTry),
<a name="2260"/> 2260:     [{sign_verify,      RsaSignVerify},
<a name="2261"/> 2261:      {pub_priv_encrypt, gen_rsa_pub_priv_tests(PublicS, PrivateS, MsgPubEnc, PrivEnc_OptsToTry)},
<a name="2262"/> 2262:      {pub_pub_encrypt,  gen_rsa_pub_priv_tests(PublicS, PrivateS, MsgPubEnc, PubEnc_OptsToTry)},
<a name="2263"/> 2263:      {privkey_to_pubkey, get_priv_pub_from_sign_verify(RsaSignVerify)},
<a name="2264"/> 2264:      {generate, [{rsa, 1024, 3},  {rsa, 2048, 17},  {rsa, 3072, 65537}]}
<a name="2265"/> 2265:      | Config];
<a name="2266"/> 2266: <b>group_config</b>(dss = Type, Config) -&gt;
<a name="2267"/> 2267:     Msg = dss_plain(),
<a name="2268"/> 2268:     Public = dss_params() ++ [dss_public()], 
<a name="2269"/> 2269:     Private = dss_params() ++ [dss_private()], 
<a name="2270"/> 2270:     SupportedHashs = proplists:get_value(hashs, crypto:supports(), []),
<a name="2271"/> 2271:     DssHashs0 =
<a name="2272"/> 2272:         case crypto:info_lib() of
<a name="2273"/> 2273:             [{&lt;&lt;&quot;OpenSSL&quot;&gt;&gt;,LibVer,_}] when is_integer(LibVer), LibVer &gt; 16#10001000 -&gt;
<a name="2274"/> 2274:                 [sha224, sha256, sha384, sha512];
<a name="2275"/> 2275:             [{&lt;&lt;&quot;OpenSSL&quot;&gt;&gt;,LibVer,_}] when is_integer(LibVer), LibVer &gt; 16#10000000 -&gt;
<a name="2276"/> 2276:                 [sha224, sha256];
<a name="2277"/> 2277:             _Else -&gt;
<a name="2278"/> 2278:                 []
<a name="2279"/> 2279:         end,
<a name="2280"/> 2280:     DssHashs = case crypto:info_fips() of
<a name="2281"/> 2281:                    enabled -&gt; DssHashs0;
<a name="2282"/> 2282:                    _ -&gt; [sha | DssHashs0]
<a name="2283"/> 2283:                end,
<a name="2284"/> 2284:     SignVerify = [{Type, Hash, Public, Private, Msg} 
<a name="2285"/> 2285:                   || Hash &lt;- DssHashs,
<a name="2286"/> 2286:                      lists:member(Hash, SupportedHashs)],
<a name="2287"/> 2287:     MsgPubEnc = &lt;&lt;&quot;7896345786348 Asldi&quot;&gt;&gt;,
<a name="2288"/> 2288:     PubPrivEnc = [{dss, Public, Private, MsgPubEnc, []}],
<a name="2289"/> 2289:     [{sign_verify, SignVerify},
<a name="2290"/> 2290:      {pub_priv_encrypt, PubPrivEnc},
<a name="2291"/> 2291:      {privkey_to_pubkey, get_priv_pub_from_sign_verify(SignVerify)}
<a name="2292"/> 2292:      | Config];
<a name="2293"/> 2293: <b>group_config</b>(ecdsa = Type, Config) -&gt;
<a name="2294"/> 2294:     {Private, Public} = ec_key_named(),
<a name="2295"/> 2295:     Msg = ec_msg(),
<a name="2296"/> 2296:     SupportedHashs = proplists:get_value(hashs, crypto:supports(), []),
<a name="2297"/> 2297:     DssHashs = [sha, sha224, sha256, sha384, sha512],
<a name="2298"/> 2298:     SignVerify = [{Type, Hash, Public, Private, Msg} 
<a name="2299"/> 2299:                   || Hash &lt;- DssHashs,
<a name="2300"/> 2300:                      lists:member(Hash, SupportedHashs)],
<a name="2301"/> 2301:     MsgPubEnc = &lt;&lt;&quot;7896345786348 Asldi&quot;&gt;&gt;,
<a name="2302"/> 2302:     PubPrivEnc = [{ecdsa, Public, Private, MsgPubEnc, []}],
<a name="2303"/> 2303:     [{sign_verify, SignVerify}, {pub_priv_encrypt, PubPrivEnc} | Config];
<a name="2304"/> 2304: <b>group_config</b>(Type, Config) when Type == ed25519 ; Type == ed448 -&gt;
<a name="2305"/> 2305:     TestVectors = eddsa(Type),
<a name="2306"/> 2306:     Generate = lists:map(fun({Curve, _Hash, Priv, Pub, _Msg, _Signature}) -&gt;
<a name="2307"/> 2307:                              {eddsa, Curve, Priv, Pub}
<a name="2308"/> 2308:                          end, TestVectors),
<a name="2309"/> 2309:     [{sign_verify,TestVectors}, {generate, Generate} | Config]; 
<a name="2310"/> 2310: <b>group_config</b>(srp, Config) -&gt;
<a name="2311"/> 2311:     GenerateCompute = [srp3(), srp6(), srp6a(), srp6a_smaller_prime()],
<a name="2312"/> 2312:     [{generate_compute, GenerateCompute} | Config];
<a name="2313"/> 2313: <b>group_config</b>(ecdh, Config) -&gt;
<a name="2314"/> 2314:     Compute = ecdh(),
<a name="2315"/> 2315:     Generate = ecc(),
<a name="2316"/> 2316:     [{compute, Compute}, {generate, Generate} | Config];
<a name="2317"/> 2317: <b>group_config</b>(eddh, Config) -&gt;
<a name="2318"/> 2318:     [{compute, []}, {generate, []} | Config];
<a name="2319"/> 2319: <b>group_config</b>(dh, Config) -&gt;
<a name="2320"/> 2320:     GenerateCompute = [dh()],
<a name="2321"/> 2321:     [{generate_compute, GenerateCompute} | Config];
<a name="2322"/> 2322: <b>group_config</b>(poly1305, Config) -&gt;
<a name="2323"/> 2323:     V = [%% {Key, Txt, Expect}
<a name="2324"/> 2324:          {%% RFC7539 2.5.2
<a name="2325"/> 2325:            hexstr2bin(&quot;85d6be7857556d337f4452fe42d506a80103808afb0db2fd4abff6af4149f51b&quot;),
<a name="2326"/> 2326:            &lt;&lt;&quot;Cryptographic Forum Research Group&quot;&gt;&gt;,
<a name="2327"/> 2327:            hexstr2bin(&quot;a8061dc1305136c6c22b8baf0c0127a9&quot;)
<a name="2328"/> 2328:          }
<a name="2329"/> 2329:         ],
<a name="2330"/> 2330:     [{poly1305,V} | Config];
<a name="2331"/> 2331: 
<a name="2332"/> 2332: <b>group_config</b>(F, Config) -&gt;
<a name="2333"/> 2333:     TestVectors = fun() -&gt; ?MODULE:F(Config) end,
<a name="group_config-last_expr"/><a name="2334"/> 2334:     [{cipher, TestVectors} | Config].
<a name="2335"/> 2335: 
<a name="2336"/> 2336: 
<a name="configure_mac-3"/><a name="2337"/> 2337: <b>configure_mac</b>(MacType, SubType, Config) -&gt;
<a name="configure_mac-last_expr"/><a name="2338"/> 2338: <b>    case do_configure_mac</b>(MacType, SubType, Config) of
<a name="2339"/> 2339:         undefined -&gt;
<a name="2340"/> 2340:             {skip, io_lib:format(&quot;No ~p test vectors for ~p&quot;, [MacType, SubType])};
<a name="2341"/> 2341:         Pairs -&gt;
<a name="2342"/> 2342:             [{MacType, Pairs} | Config]
<a name="2343"/> 2343:     end.
<a name="2344"/> 2344: 
<a name="do_configure_mac-3"/><a name="2345"/> 2345: <b>do_configure_mac</b>(hmac, Type, _Config) -&gt;
<a name="2346"/> 2346:     case Type of
<a name="2347"/> 2347:         md5 -&gt;
<a name="2348"/> 2348:             Keys = rfc_2202_md5_keys() ++ [long_hmac_key(md5)],
<a name="2349"/> 2349:             Data = rfc_2202_msgs() ++ [long_msg()],
<a name="2350"/> 2350:             Hmac = rfc_2202_hmac_md5()  ++ [long_hmac(md5)],
<a name="2351"/> 2351:             zip3_special(hmac, Type, Keys, Data, Hmac);
<a name="2352"/> 2352:         sha -&gt;
<a name="2353"/> 2353:             Keys = rfc_2202_sha_keys() ++ [long_hmac_key(sha)],
<a name="2354"/> 2354:             Data = rfc_2202_msgs() ++ [long_msg()],
<a name="2355"/> 2355:             Hmac = rfc_2202_hmac_sha()  ++ [long_hmac(sha)],
<a name="2356"/> 2356:             zip3_special(hmac, Type, Keys, Data, Hmac);
<a name="2357"/> 2357:         sha224 -&gt;
<a name="2358"/> 2358:             Keys = rfc_4231_keys(),
<a name="2359"/> 2359:             Data = rfc_4231_msgs(),
<a name="2360"/> 2360:             Hmac = rfc4231_hmac_sha224(),
<a name="2361"/> 2361:             zip3_special(hmac, Type, Keys, Data, Hmac);
<a name="2362"/> 2362:         sha256 -&gt;
<a name="2363"/> 2363:             Keys = rfc_4231_keys() ++ [long_hmac_key(sha256)],
<a name="2364"/> 2364:             Data = rfc_4231_msgs()  ++ [long_msg()],
<a name="2365"/> 2365:             Hmac = rfc4231_hmac_sha256()  ++ [long_hmac(sha256)],
<a name="2366"/> 2366:             zip3_special(hmac, Type, Keys, Data, Hmac);
<a name="2367"/> 2367:         sha384 -&gt;
<a name="2368"/> 2368:             Keys = rfc_4231_keys() ++ [long_hmac_key(sha384)],
<a name="2369"/> 2369:             Data = rfc_4231_msgs()  ++ [long_msg()],
<a name="2370"/> 2370:             Hmac = rfc4231_hmac_sha384()  ++ [long_hmac(sha384)],
<a name="2371"/> 2371:             zip3_special(hmac, Type, Keys, Data, Hmac);
<a name="2372"/> 2372:         sha512 -&gt;
<a name="2373"/> 2373:             Keys = rfc_4231_keys() ++ [long_hmac_key(sha512)],
<a name="2374"/> 2374:             Data = rfc_4231_msgs() ++ [long_msg()],
<a name="2375"/> 2375:             Hmac = rfc4231_hmac_sha512() ++ [long_hmac(sha512)],
<a name="2376"/> 2376:             zip3_special(hmac, Type, Keys, Data, Hmac);
<a name="2377"/> 2377:         sm3 -&gt;
<a name="2378"/> 2378:             Keys = sm3_keys(),
<a name="2379"/> 2379:             Data = sm3_msgs(),
<a name="2380"/> 2380:             Hmac = sm3_hmac(),
<a name="2381"/> 2381:             zip3_special(hmac, Type, Keys, Data, Hmac);
<a name="2382"/> 2382:         sha3_224 -&gt;
<a name="2383"/> 2383:             hmac_sha3(Type);
<a name="2384"/> 2384:         sha3_256 -&gt;
<a name="2385"/> 2385:             hmac_sha3(Type);
<a name="2386"/> 2386:         sha3_384 -&gt;
<a name="2387"/> 2387:             hmac_sha3(Type);
<a name="2388"/> 2388:         sha3_512 -&gt;
<a name="2389"/> 2389:             hmac_sha3(Type);
<a name="2390"/> 2390:         blake2b -&gt;
<a name="2391"/> 2391:             blake2_hmac(Type);
<a name="2392"/> 2392:         blake2s -&gt;
<a name="2393"/> 2393:             blake2_hmac(Type);
<a name="2394"/> 2394:         _ -&gt;
<a name="2395"/> 2395:             undefined
<a name="2396"/> 2396:     end;
<a name="2397"/> 2397: <b>do_configure_mac</b>(cmac, Cipher, Config) -&gt;
<a name="do_configure_mac-last_expr"/><a name="2398"/> 2398:     case Cipher of
<a name="2399"/> 2399:         aes_128_cbc -&gt;
<a name="2400"/> 2400:             fun() -&gt; read_rsp(Config, Cipher,  [&quot;CMACGenAES128.rsp&quot;, &quot;CMACVerAES128.rsp&quot;]) end;
<a name="2401"/> 2401:         aes_192_cbc -&gt;
<a name="2402"/> 2402:             fun() -&gt; read_rsp(Config, Cipher,  [&quot;CMACGenAES192.rsp&quot;, &quot;CMACVerAES192.rsp&quot;]) end;
<a name="2403"/> 2403:         aes_256_cbc -&gt;
<a name="2404"/> 2404:             fun() -&gt; read_rsp(Config, Cipher,  [&quot;CMACGenAES256.rsp&quot;, &quot;CMACVerAES256.rsp&quot;]) end;
<a name="2405"/> 2405:         des_ede3_cbc -&gt;
<a name="2406"/> 2406:             fun() -&gt; read_rsp(Config, Cipher,  [&quot;CMACGenTDES3.rsp&quot;, &quot;CMACVerTDES3.rsp&quot;]) end;
<a name="2407"/> 2407:         _ -&gt;
<a name="2408"/> 2408:             undefined
<a name="2409"/> 2409:     end.
<a name="2410"/> 2410: 
<a name="2411"/> 2411: 
<a name="zip3_special-5"/><a name="2412"/> 2412: <b>zip3_special</b>(Type, SubType, As, Bs, Cs) -&gt;
<a name="zip3_special-last_expr"/><a name="2413"/> 2413: <b>    [mk_zip3_special_elem</b>(Type, SubType, A, B, C)
<a name="2414"/> 2414:      || {A,B,C} &lt;- lists:zip3(As, Bs, Cs)].
<a name="2415"/> 2415: 
<a name="mk_zip3_special_elem-5"/><a name="2416"/> 2416: <b>mk_zip3_special_elem</b>(hmac, sha, Key, &lt;&lt;&quot;Test With Truncation&quot;&gt;&gt;=Data, Expected) -&gt;
<a name="2417"/> 2417:     {hmac, sha, Key, Data, 20, Expected};
<a name="2418"/> 2418: <b>mk_zip3_special_elem</b>(hmac, SubType, Key, &lt;&lt;&quot;Test With Truncation&quot;&gt;&gt;=Data, Expected) -&gt;
<a name="2419"/> 2419:     {hmac, SubType, Key, Data, 16, Expected};
<a name="2420"/> 2420: <b>mk_zip3_special_elem</b>(Type, SubType, A, B, C) -&gt;
<a name="mk_zip3_special_elem-last_expr"/><a name="2421"/> 2421:     {Type, SubType, A, B, C}.
<a name="2422"/> 2422: 
<a name="rsa_sign_verify_tests-7"/><a name="2423"/> 2423: <b>rsa_sign_verify_tests</b>(Config, Msg, Public, Private, PublicS, PrivateS, OptsToTry) -&gt;
<a name="rsa_sign_verify_tests-last_expr"/><a name="2424"/> 2424: <b>        case ?config</b>(fips, Config) of
<a name="2425"/> 2425:             true -&gt;
<a name="2426"/> 2426:                 %% Use only the strong keys in FIPS mode
<a name="2427"/> 2427:                 rsa_sign_verify_tests(Msg,
<a name="2428"/> 2428:                                       PublicS, PrivateS,
<a name="2429"/> 2429:                                       PublicS, PrivateS,
<a name="2430"/> 2430:                                       OptsToTry);
<a name="2431"/> 2431:             false -&gt;
<a name="2432"/> 2432:                 rsa_sign_verify_tests(Msg,
<a name="2433"/> 2433:                                       Public,  Private,
<a name="2434"/> 2434:                                       PublicS, PrivateS,
<a name="2435"/> 2435:                                       OptsToTry)
<a name="2436"/> 2436:         end.
<a name="2437"/> 2437: 
<a name="rsa_sign_verify_tests-6"/><a name="2438"/> 2438: <b>rsa_sign_verify_tests</b>(Msg, Public, Private, PublicS, PrivateS, OptsToTry) -&gt;
<a name="2439"/> 2439:     Hashs0 = [sha224, sha256],
<a name="2440"/> 2440:     Hashs = case crypto:info_fips() of
<a name="2441"/> 2441:                 enabled -&gt; Hashs0;
<a name="2442"/> 2442:                 _ -&gt; [md5, ripemd160, sha | Hashs0]
<a name="2443"/> 2443:             end,
<a name="2444"/> 2444:     gen_rsa_sign_verify_tests(Hashs, Msg, Public, Private,
<a name="rsa_sign_verify_tests-last_expr"/><a name="2445"/> 2445:                               [undefined | OptsToTry]) ++
<a name="2446"/> 2446: 	gen_rsa_sign_verify_tests([sha384, sha512], Msg, PublicS, PrivateS,
<a name="2447"/> 2447:                                   [undefined | OptsToTry]).
<a name="2448"/> 2448: 
<a name="gen_rsa_sign_verify_tests-5"/><a name="2449"/> 2449: <b>gen_rsa_sign_verify_tests</b>(Hashs, Msg, Public, Private, Opts) -&gt;
<a name="2450"/> 2450:     SupOpts = proplists:get_value(rsa_opts, crypto:supports(), []),
<a name="gen_rsa_sign_verify_tests-last_expr"/><a name="2451"/> 2451: <b>    lists:foldr</b>(fun(Hash, Acc0) -&gt;
<a name="2452"/> 2452: 	case is_supported(Hash) of
<a name="2453"/> 2453: 	    true -&gt;
<a name="2454"/> 2454: 		lists:foldr(fun
<a name="2455"/> 2455: 		    (undefined, Acc1) -&gt;
<a name="2456"/> 2456: 			[{rsa, Hash, Public, Private, Msg} | Acc1];
<a name="2457"/> 2457: 		    ([{rsa_padding, rsa_x931_padding} | _], Acc1)
<a name="2458"/> 2458: 			    when Hash =:= md5
<a name="2459"/> 2459: 			    orelse Hash =:= ripemd160
<a name="2460"/> 2460: 			    orelse Hash =:= sha224 -&gt;
<a name="2461"/> 2461: 			Acc1;
<a name="2462"/> 2462: 		    (Opt, Acc1) -&gt;
<a name="2463"/> 2463:                         case rsa_opt_is_supported(Opt, SupOpts) of
<a name="2464"/> 2464:                             true -&gt;
<a name="2465"/> 2465:                                 [{rsa, Hash, Public, Private, Msg, Opt} | Acc1];
<a name="2466"/> 2466:                             false -&gt;
<a name="2467"/> 2467:                                 Acc1
<a name="2468"/> 2468:                         end
<a name="2469"/> 2469: 		end, Acc0, Opts);
<a name="2470"/> 2470: 	    false -&gt;
<a name="2471"/> 2471: 		Acc0
<a name="2472"/> 2472: 	end
<a name="2473"/> 2473:     end, [], Hashs).
<a name="2474"/> 2474: 
<a name="2475"/> 2475: 
<a name="gen_rsa_pub_priv_tests-4"/><a name="2476"/> 2476: <b>gen_rsa_pub_priv_tests</b>(Public, Private, Msg, OptsToTry) -&gt;
<a name="2477"/> 2477:     SupOpts = proplists:get_value(rsa_opts, crypto:supports(), []) --
<a name="2478"/> 2478:         [rsa_x931_padding],
<a name="gen_rsa_pub_priv_tests-last_expr"/><a name="2479"/> 2479: <b>    lists:foldr</b>(fun(Opt, Acc) -&gt;
<a name="2480"/> 2480:                         case rsa_opt_is_supported(Opt, SupOpts) of
<a name="2481"/> 2481:                             true -&gt;
<a name="2482"/> 2482:                                 [{rsa, Public, Private, Msg, Opt} | Acc];
<a name="2483"/> 2483:                              false -&gt;
<a name="2484"/> 2484:                                 Acc
<a name="2485"/> 2485:                         end
<a name="2486"/> 2486:                 end, [], OptsToTry).
<a name="2487"/> 2487: 
<a name="2488"/> 2488: 
<a name="rsa_opt_is_supported-2"/><a name="2489"/> 2489: <b>rsa_opt_is_supported</b>([_|_]=Opt, Sup) -&gt;
<a name="2490"/> 2490:     lists:all(fun(O) -&gt; rsa_opt_is_supported(O,Sup) end, Opt);
<a name="2491"/> 2491: <b>rsa_opt_is_supported</b>({A,B}, Sup) -&gt;
<a name="2492"/> 2492:     rsa_opt_is_supported(A,Sup) orelse rsa_opt_is_supported(B,Sup);
<a name="2493"/> 2493: <b>rsa_opt_is_supported</b>(Opt, Sup) -&gt;
<a name="rsa_opt_is_supported-last_expr"/><a name="2494"/> 2494: <b>    lists:member</b>(Opt, Sup).
<a name="2495"/> 2495: 
<a name="2496"/> 2496: 
<a name="rfc_1321_msgs-0"/><a name="2497"/> 2497: <b>rfc_1321_msgs</b>() -&gt;
<a name="rfc_1321_msgs-last_expr"/><a name="2498"/> 2498:     [&lt;&lt;&quot;&quot;&gt;&gt;, 
<a name="2499"/> 2499:      &lt;&lt;&quot;a&quot;&gt;&gt;,
<a name="2500"/> 2500:      &lt;&lt;&quot;abc&quot;&gt;&gt;, 
<a name="2501"/> 2501:      &lt;&lt;&quot;message digest&quot;&gt;&gt;,
<a name="2502"/> 2502:      &lt;&lt;&quot;abcdefghijklmnopqrstuvwxyz&quot;&gt;&gt;,
<a name="2503"/> 2503:      &lt;&lt;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;&gt;&gt;,
<a name="2504"/> 2504:      &lt;&lt;&quot;12345678901234567890123456789012345678901234567890123456789012345678901234567890&quot;&gt;&gt;
<a name="2505"/> 2505:     ].
<a name="2506"/> 2506: 
<a name="rfc_1321_md4_digests-0"/><a name="2507"/> 2507: <b>rfc_1321_md4_digests</b>() -&gt;
<a name="rfc_1321_md4_digests-last_expr"/><a name="2508"/> 2508: <b>    [hexstr2bin</b>(&quot;31d6cfe0d16ae931b73c59d7e0c089c0&quot;),
<a name="2509"/> 2509:      hexstr2bin(&quot;bde52cb31de33e46245e05fbdbd6fb24&quot;),
<a name="2510"/> 2510:      hexstr2bin(&quot;a448017aaf21d8525fc10ae87aa6729d&quot;),
<a name="2511"/> 2511:      hexstr2bin(&quot;d9130a8164549fe818874806e1c7014b&quot;),
<a name="2512"/> 2512:      hexstr2bin(&quot;d79e1c308aa5bbcdeea8ed63df412da9&quot;),
<a name="2513"/> 2513:      hexstr2bin(&quot;043f8582f241db351ce627e153e7f0e4&quot;),
<a name="2514"/> 2514:      hexstr2bin(&quot;e33b4ddc9c38f2199c3e7b164fcc0536&quot;)].
<a name="2515"/> 2515: 
<a name="rfc_1321_md5_digests-0"/><a name="2516"/> 2516: <b>rfc_1321_md5_digests</b>() -&gt;
<a name="rfc_1321_md5_digests-last_expr"/><a name="2517"/> 2517: <b>    [hexstr2bin</b>(&quot;d41d8cd98f00b204e9800998ecf8427e&quot;),
<a name="2518"/> 2518:      hexstr2bin(&quot;0cc175b9c0f1b6a831c399e269772661&quot;),
<a name="2519"/> 2519:      hexstr2bin(&quot;900150983cd24fb0d6963f7d28e17f72&quot;),
<a name="2520"/> 2520:      hexstr2bin(&quot;f96b697d7cb7938d525a2f31aaf161d0&quot;),
<a name="2521"/> 2521:      hexstr2bin(&quot;c3fcd3d76192e4007dfb496cca67e13b&quot;),
<a name="2522"/> 2522:      hexstr2bin(&quot;d174ab98d277d9f5a5611c2c9f419d9f&quot;),
<a name="2523"/> 2523:      hexstr2bin(&quot;57edf4a22be3c955ac49da2e2107b67a&quot;)].
<a name="2524"/> 2524: 
<a name="2525"/> 2525: 
<a name="2526"/> 2526: <i>%% BLAKE2 re-use SHA3 test vectors.</i>
<a name="blake2_test_vectors-1"/><a name="2527"/> 2527: <b>blake2_test_vectors</b>(blake2b) -&gt;
<a name="2528"/> 2528:     {sha3_msgs(),
<a name="2529"/> 2529:      [ &lt;&lt;186,128,165,63,152,28,77,13,106,39,151,182,159,18,246,233,76,33,47,20,104,90,196,183,75,18,187,111,219,255,162,209,125,135,197,57,42,171,121,45,194,82,213,222,69,51,204,149,24,211,138,168,219,241,146,90,185,35,134,237,212,0,153,35&gt;&gt;
<a name="2530"/> 2530:      , &lt;&lt;120,106,2,247,66,1,89,3,198,198,253,133,37,82,210,114,145,47,71,64,225,88,71,97,138,134,226,23,247,31,84,25,210,94,16,49,175,238,88,83,19,137,100,68,147,78,176,75,144,58,104,91,20,72,183,85,213,111,112,26,254,155,226,206&gt;&gt;
<a name="2531"/> 2531:      , &lt;&lt;114,133,255,62,139,215,104,214,155,230,43,59,241,135,101,163,37,145,127,169,116,74,194,245,130,162,8,80,188,43,17,65,237,27,62,69,40,89,90,204,144,119,43,223,45,55,220,138,71,19,11,68,243,58,2,232,115,14,90,216,225,102,232,136&gt;&gt;
<a name="2532"/> 2532:      , &lt;&lt;206,116,26,197,147,15,227,70,129,17,117,197,34,123,183,191,205,71,244,38,18,250,228,108,8,9,81,79,158,14,58,17,238,23,115,40,113,71,205,234,238,223,245,7,9,170,113,99,65,254,101,36,15,74,214,119,125,107,250,249,114,110,94,82&gt;&gt;
<a name="2533"/> 2533:      , &lt;&lt;152,251,62,251,114,6,253,25,235,246,155,111,49,44,247,182,78,59,148,219,225,161,113,7,145,57,117,167,147,241,119,225,208,119,96,157,127,186,54,60,187,160,13,5,247,170,78,79,168,113,93,100,40,16,76,10,117,100,59,15,243,253,62,175&gt;&gt;
<a name="2534"/> 2534:      ]};
<a name="2535"/> 2535: <b>blake2_test_vectors</b>(blake2s) -&gt;
<a name="blake2_test_vectors-last_expr"/><a name="2536"/> 2536: <b>    {sha3_msgs</b>(),
<a name="2537"/> 2537:      [ &lt;&lt;80,140,94,140,50,124,20,226,225,167,43,163,78,235,69,47,55,69,139,32,158,214,58,41,77,153,155,76,134,103,89,130&gt;&gt;
<a name="2538"/> 2538:      , &lt;&lt;105,33,122,48,121,144,128,148,225,17,33,208,66,53,74,124,31,85,182,72,44,161,165,30,27,37,13,253,30,208,238,249&gt;&gt;
<a name="2539"/> 2539:      , &lt;&lt;111,77,245,17,106,111,51,46,218,177,217,225,14,232,125,246,85,123,234,182,37,157,118,99,243,188,213,114,44,19,241,137&gt;&gt;
<a name="2540"/> 2540:      , &lt;&lt;53,141,210,237,7,128,212,5,78,118,203,111,58,91,206,40,65,232,226,245,71,67,29,77,9,219,33,182,109,148,31,199&gt;&gt;
<a name="2541"/> 2541:      , &lt;&lt;190,192,192,230,205,229,182,122,203,115,184,31,121,166,122,64,121,174,28,96,218,201,210,102,26,241,142,159,139,80,223,165&gt;&gt;
<a name="2542"/> 2542:      ]}.
<a name="2543"/> 2543: 
<a name="blake2_hmac-1"/><a name="2544"/> 2544: <b>blake2_hmac</b>(Type) -&gt;
<a name="blake2_hmac-last_expr"/><a name="2545"/> 2545: <b>    [{hmac, Type, hexstr2bin</b>(K), hexstr2bin(D), H}
<a name="2546"/> 2546:      || {{K, D}, H} &lt;- lists:zip(blake2_hmac_key_data(), blake2_hmac_hmac(Type)) ].
<a name="2547"/> 2547: 
<a name="blake2_hmac_key_data-0"/><a name="2548"/> 2548: <b>blake2_hmac_key_data</b>() -&gt;
<a name="blake2_hmac_key_data-last_expr"/><a name="2549"/> 2549:     [ {&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b 0b0b0b0b&quot;,
<a name="2550"/> 2550:        &quot;4869205468657265&quot;}
<a name="2551"/> 2551:     , {&quot;4a656665&quot;,
<a name="2552"/> 2552:       &quot;7768617420646f2079612077616e7420 666f72206e6f7468696e673f&quot;}
<a name="2553"/> 2553:     , {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaa&quot;,
<a name="2554"/> 2554:       &quot;dddddddddddddddddddddddddddddddd dddddddddddddddddddddddddddddddd dddddddddddddddddddddddddddddddd dddd&quot;}
<a name="2555"/> 2555:     , {&quot;0102030405060708090a0b0c0d0e0f10 111213141516171819&quot;,
<a name="2556"/> 2556:       &quot;cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd cdcd&quot;}
<a name="2557"/> 2557:     , {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2558"/> 2558:       &quot;54657374205573696e67204c61726765 72205468616e20426c6f636b2d53697a 65204b6579202d2048617368204b6579 204669727374&quot;}
<a name="2559"/> 2559:     , {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2560"/> 2560:       &quot;54657374205573696e67204c61726765 72205468616e20426c6f636b2d53697a 65204b6579202d2048617368204b6579 204669727374&quot;}
<a name="2561"/> 2561:     , {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2562"/> 2562:       &quot;54686973206973206120746573742075 73696e672061206c6172676572207468 616e20626c6f636b2d73697a65206b65 7920616e642061206c61726765722074 68616e20626c6f636b2d73697a652064 6174612e20546865206b6579206e6565 647320746f2062652068617368656420 6265666f7265206265696e6720757365 642062792074686520484d414320616c 676f726974686d2e&quot;}
<a name="2563"/> 2563:     , {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2564"/> 2564:       &quot;54686973206973206120746573742075 73696e672061206c6172676572207468 616e20626c6f636b2d73697a65206b65 7920616e642061206c61726765722074 68616e20626c6f636b2d73697a652064 6174612e20546865206b6579206e6565 647320746f2062652068617368656420 6265666f7265206265696e6720757365 642062792074686520484d414320616c 676f726974686d2e&quot;}
<a name="2565"/> 2565:     ].
<a name="2566"/> 2566: 
<a name="blake2_hmac_hmac-1"/><a name="2567"/> 2567: <b>blake2_hmac_hmac</b>(blake2b) -&gt;
<a name="2568"/> 2568:     [ &lt;&lt;53,138,106,24,73,36,137,79,195,75,238,86,128,238,223,87,216,74,55,187,56,131,47,40,142,59,39,220,99,169,140,200,201,30,118,218,71,107,80,139,198,178,212,8,162,72,133,116,82,144,110,74,32,180,140,107,75,85,210,223,15,225,221,36&gt;&gt;
<a name="2569"/> 2569:     , &lt;&lt;111,248,132,248,221,194,166,88,107,60,152,164,205,110,189,241,78,193,2,4,182,113,0,115,235,88,101,173,227,122,38,67,184,128,124,19,53,209,7,236,219,159,254,174,182,130,140,70,37,186,23,44,102,55,158,252,210,34,194,222,17,114,122,180&gt;&gt;
<a name="2570"/> 2570:     , &lt;&lt;244,59,198,44,122,153,53,60,59,44,96,232,239,36,251,189,66,233,84,120,102,220,156,91,228,237,198,244,167,212,188,10,198,32,194,198,0,52,208,64,240,219,175,134,249,233,205,120,145,160,149,89,94,237,85,226,169,150,33,95,12,21,192,24&gt;&gt;
<a name="2571"/> 2571:     , &lt;&lt;229,219,182,222,47,238,66,161,202,160,110,78,123,132,206,64,143,250,92,74,157,226,99,46,202,118,156,222,136,117,1,76,114,208,114,15,234,245,63,118,230,161,128,53,127,82,141,123,244,132,250,58,20,232,204,31,15,59,173,167,23,180,52,145&gt;&gt;
<a name="2572"/> 2572:     , &lt;&lt;165,75,41,67,178,162,2,39,212,28,164,108,9,69,175,9,188,31,174,251,47,73,137,76,35,174,188,85,127,183,156,72,137,220,167,68,8,220,134,80,134,102,122,237,238,74,49,133,197,58,73,200,11,129,76,76,88,19,234,12,139,56,168,248&gt;&gt;
<a name="2573"/> 2573:     , &lt;&lt;180,214,140,139,182,82,151,170,52,132,168,110,29,51,183,138,70,159,33,234,170,158,212,218,159,236,145,218,71,23,34,61,44,15,163,134,170,47,209,241,255,207,89,23,178,103,84,96,53,237,48,238,164,178,19,162,133,148,211,211,169,179,140,170&gt;&gt;
<a name="2574"/> 2574:     , &lt;&lt;171,52,121,128,166,75,94,130,93,209,14,125,50,253,67,160,26,142,109,234,38,122,185,173,125,145,53,36,82,102,24,146,83,17,175,188,176,196,149,25,203,235,221,112,149,64,168,215,37,251,145,26,194,174,233,178,163,170,67,215,150,18,51,147&gt;&gt;
<a name="2575"/> 2575:     , &lt;&lt;97,220,242,140,166,12,169,92,130,89,147,39,171,215,169,161,152,111,242,219,211,199,73,69,198,227,35,186,203,76,159,26,94,103,82,93,20,186,141,98,36,177,98,229,102,23,21,37,83,3,69,169,178,86,8,178,125,251,163,180,146,115,213,6&gt;&gt;
<a name="2576"/> 2576:     ];
<a name="2577"/> 2577: <b>blake2_hmac_hmac</b>(blake2s) -&gt;
<a name="blake2_hmac_hmac-last_expr"/><a name="2578"/> 2578:     [ &lt;&lt;101,168,183,197,204,145,54,212,36,232,44,55,226,112,126,116,233,19,192,101,91,153,199,95,64,237,243,135,69,58,50,96&gt;&gt;
<a name="2579"/> 2579:     , &lt;&lt;144,182,40,30,47,48,56,201,5,106,240,180,167,231,99,202,230,254,93,158,180,56,106,14,201,82,55,137,12,16,79,240&gt;&gt;
<a name="2580"/> 2580:     , &lt;&lt;252,196,245,149,41,80,46,52,195,216,218,63,253,171,130,150,106,44,182,55,255,94,155,215,1,19,92,46,148,105,231,144&gt;&gt;
<a name="2581"/> 2581:     , &lt;&lt;70,68,52,220,190,206,9,93,69,106,29,98,214,236,86,248,152,230,37,163,158,92,82,189,249,77,175,17,27,173,131,170&gt;&gt;
<a name="2582"/> 2582:     , &lt;&lt;210,61,121,57,79,83,213,54,160,150,230,81,68,71,238,170,187,5,222,208,27,227,44,25,55,218,106,143,113,3,188,78&gt;&gt;
<a name="2583"/> 2583:     , &lt;&lt;92,76,83,46,110,69,89,83,133,78,21,16,149,38,110,224,127,213,88,129,190,223,139,57,8,217,95,13,190,54,159,234&gt;&gt;
<a name="2584"/> 2584:     , &lt;&lt;203,96,246,167,145,241,64,191,138,162,229,31,243,88,205,178,204,92,3,51,4,91,127,183,122,186,122,179,176,207,178,55&gt;&gt;
<a name="2585"/> 2585:     , &lt;&lt;190,53,233,217,99,171,215,108,1,184,171,181,22,36,240,209,16,96,16,92,213,22,16,58,114,241,117,214,211,189,30,202&gt;&gt;
<a name="2586"/> 2586:     ].
<a name="2587"/> 2587: 
<a name="2588"/> 2588: <i>%%% https://www.di-mgt.com.au/sha_testvectors.html</i>
<a name="sha3_msgs-0"/><a name="2589"/> 2589: <b>sha3_msgs</b>() -&gt;
<a name="sha3_msgs-last_expr"/><a name="2590"/> 2590:     [&quot;abc&quot;,
<a name="2591"/> 2591:      &quot;&quot;,
<a name="2592"/> 2592:      &quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;, % length 448 bits
<a name="2593"/> 2593:      &quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;, % length 896 bits
<a name="2594"/> 2594:      lists:duplicate(1000000,$a)
<a name="2595"/> 2595:     ].
<a name="2596"/> 2596: 
<a name="sha3_test_vectors-1"/><a name="2597"/> 2597: <b>sha3_test_vectors</b>(sha3_224) -&gt;
<a name="2598"/> 2598:     {sha3_msgs(),
<a name="2599"/> 2599:      [hexstr2bin(&quot;e642824c3f8cf24a d09234ee7d3c766f c9a3a5168d0c94ad 73b46fdf&quot;),
<a name="2600"/> 2600:       hexstr2bin(&quot;6b4e03423667dbb7 3b6e15454f0eb1ab d4597f9a1b078e3f 5b5a6bc7&quot;),
<a name="2601"/> 2601:       hexstr2bin(&quot;8a24108b154ada21 c9fd5574494479ba 5c7e7ab76ef264ea d0fcce33&quot;),
<a name="2602"/> 2602:       hexstr2bin(&quot;543e6868e1666c1a 643630df77367ae5 a62a85070a51c14c bf665cbc&quot;),
<a name="2603"/> 2603:       hexstr2bin(&quot;d69335b93325192e 516a912e6d19a15c b51c6ed5c15243e7 a7fd653c&quot;)
<a name="2604"/> 2604:      ]
<a name="2605"/> 2605:     };
<a name="2606"/> 2606: <b>sha3_test_vectors</b>(sha3_256) -&gt;
<a name="2607"/> 2607:     {sha3_msgs(),
<a name="2608"/> 2608:      [hexstr2bin(&quot;3a985da74fe225b2 045c172d6bd390bd 855f086e3e9d525b 46bfe24511431532&quot;),
<a name="2609"/> 2609:       hexstr2bin(&quot;a7ffc6f8bf1ed766 51c14756a061d662 f580ff4de43b49fa 82d80a4b80f8434a&quot;),
<a name="2610"/> 2610:       hexstr2bin(&quot;41c0dba2a9d62408 49100376a8235e2c 82e1b9998a999e21 db32dd97496d3376&quot;),
<a name="2611"/> 2611:       hexstr2bin(&quot;916f6061fe879741 ca6469b43971dfdb 28b1a32dc36cb325 4e812be27aad1d18&quot;),
<a name="2612"/> 2612:       hexstr2bin(&quot;5c8875ae474a3634 ba4fd55ec85bffd6 61f32aca75c6d699 d0cdcb6c115891c1&quot;)
<a name="2613"/> 2613:      ]
<a name="2614"/> 2614:     };
<a name="2615"/> 2615: <b>sha3_test_vectors</b>(sha3_384) -&gt;
<a name="2616"/> 2616:     {sha3_msgs(),
<a name="2617"/> 2617:      [hexstr2bin(&quot;ec01498288516fc9 26459f58e2c6ad8d f9b473cb0fc08c25 96da7cf0e49be4b2 98d88cea927ac7f5 39f1edf228376d25&quot;),
<a name="2618"/> 2618:       hexstr2bin(&quot;0c63a75b845e4f7d 01107d852e4c2485 c51a50aaaa94fc61 995e71bbee983a2a c3713831264adb47 fb6bd1e058d5f004&quot;),
<a name="2619"/> 2619:       hexstr2bin(&quot;991c665755eb3a4b 6bbdfb75c78a492e 8c56a22c5c4d7e42 9bfdbc32b9d4ad5a a04a1f076e62fea1 9eef51acd0657c22&quot;),
<a name="2620"/> 2620:       hexstr2bin(&quot;79407d3b5916b59c 3e30b09822974791 c313fb9ecc849e40 6f23592d04f625dc 8c709b98b43b3852 b337216179aa7fc7&quot;),
<a name="2621"/> 2621:       hexstr2bin(&quot;eee9e24d78c18553 37983451df97c8ad 9eedf256c6334f8e 948d252d5e0e7684 7aa0774ddb90a842 190d2c558b4b8340&quot;)
<a name="2622"/> 2622:      ]
<a name="2623"/> 2623:     };
<a name="2624"/> 2624: <b>sha3_test_vectors</b>(sha3_512) -&gt;
<a name="sha3_test_vectors-last_expr"/><a name="2625"/> 2625: <b>    {sha3_msgs</b>(),
<a name="2626"/> 2626:      [hexstr2bin(&quot;b751850b1a57168a 5693cd924b6b096e 08f621827444f70d 884f5d0240d2712e 10e116e9192af3c9 1a7ec57647e39340 57340b4cf408d5a5 6592f8274eec53f0&quot;),
<a name="2627"/> 2627:       hexstr2bin(&quot;a69f73cca23a9ac5 c8b567dc185a756e 97c982164fe25859 e0d1dcc1475c80a6 15b2123af1f5f94c 11e3e9402c3ac558 f500199d95b6d3e3 01758586281dcd26&quot;),
<a name="2628"/> 2628:       hexstr2bin(&quot;04a371e84ecfb5b8 b77cb48610fca818 2dd457ce6f326a0f d3d7ec2f1e91636d ee691fbe0c985302 ba1b0d8dc78c0863 46b533b49c030d99 a27daf1139d6e75e&quot;),
<a name="2629"/> 2629:       hexstr2bin(&quot;afebb2ef542e6579 c50cad06d2e578f9 f8dd6881d7dc824d 26360feebf18a4fa 73e3261122948efc fd492e74e82e2189 ed0fb440d187f382 270cb455f21dd185&quot;),
<a name="2630"/> 2630:       hexstr2bin(&quot;3c3a876da14034ab 60627c077bb98f7e 120a2a5370212dff b3385a18d4f38859 ed311d0a9d5141ce 9cc5c66ee689b266 a8aa18ace8282a0e 0db596c90b0a7b87&quot;)
<a name="2631"/> 2631:      ]
<a name="2632"/> 2632:     }.
<a name="2633"/> 2633: 
<a name="2634"/> 2634: <i>%%% https://csrc.nist.gov/projects/cryptographic-algorithm-validation-program/secure-hashing</i>
<a name="sha3_shake128_test_vectors-1"/><a name="2635"/> 2635: <b>sha3_shake128_test_vectors</b>(shake128) -&gt;
<a name="sha3_shake128_test_vectors-last_expr"/><a name="2636"/> 2636:   {[%% SHAKE128 ShortMsg
<a name="2637"/> 2637:    hexstr2bin(&quot;&quot;),
<a name="2638"/> 2638:    hexstr2bin(&quot;0e&quot;),
<a name="2639"/> 2639:    hexstr2bin(&quot;d9e8&quot;),
<a name="2640"/> 2640:    hexstr2bin(&quot;4c386d97ace346b2a06faab35663ce8a4c54c295b5b9f6161efafce451ca8f617ab7d5ab88ffe117d6a67cdb0bc5250a3f2556c65f0c09b1d2577ba45cc930a443a33711b175af215a338a8d5e8b918a7176a8fb390e54e5f79f7a236a006a5bf1241b30efecb8b9733f5c32195d1bf22b70419d0c65de9bd7f982c94317456eca610a700a0d05c86bf27b3302e2c92ab53ba815a0b9afbcb88e1afe&quot;),
<a name="2641"/> 2641:    hexstr2bin(&quot;5d8f84b2f208b58a68e88ce8efb543a8404f0ec0c9805c760ad359d13faab84d3f8bb1d2a4bb45e72c0ec9245ffda2e572f94e466cffa44b876d5c5ed914d1ff338e06b74ad1e74d1405d23d759356661b7f3b03a7f7c2dc0d2c2dbe3d60822803408d472b752424ea76af1d79a0e7920388dde0c1903e9364b8d6d7b3b75430754b4d6b91cd83d5740866aab34bdbd0f1bd3dc504f1a1d753ba5f938241ce7f52544e0cc2018cc67b6401ce6abdbc8aafc5629bb643730fa3daced8f425787d61069910073ac760c631876fe81d1127034a544820ad3aa51cbf2d904f8cda936c063561a8a0bd0b1f1801777394630fb6f11cb68a588000861283a2dc9d7d2739ff2ae5ed5af5304cc176cd544a39a99064c1cb3b6bcc88a97ad9f6e381e8a3929781861e91f73516d3ee59d3661b5f584b4b717d0fa7a54da03674ac5fa36d3d76412a826c4c8445f7720337119198&quot;),
<a name="2642"/> 2642:    %% SHAKE128 LongMsg
<a name="2643"/> 2643:    hexstr2bin(&quot;a6fe00064257aa318b621c5eb311d32bb8004c2fa1a969d205d71762cc5d2e633907992629d1b69d9557ff6d5e8deb454ab00f6e497c89a4fea09e257a6fa2074bd818ceb5981b3e3faefd6e720f2d1edd9c5e4a5c51e5009abf636ed5bca53fe159c8287014a1bd904f5c8a7501625f79ac81eb618f478ce21cae6664acffb30572f059e1ad0fc2912264e8f1ca52af26c8bf78e09d75f3dd9fc734afa8770abe0bd78c90cc2ff448105fb16dd2c5b7edd8611a62e537db9331f5023e16d6ec150cc6e706d7c7fcbfff930c7281831fd5c4aff86ece57ed0db882f59a5fe403105d0592ca38a081fed84922873f538ee774f13b8cc09bd0521db4374aec69f4bae6dcb66455822c0b84c91a3474ffac2ad06f0a4423cd2c6a49d4f0d6242d6a1890937b5d9835a5f0ea5b1d01884d22a6c1718e1f60b3ab5e232947c76ef70b344171083c688093b5f1475377e3069863&quot;),
<a name="2644"/> 2644:    hexstr2bin(&quot;c747ee72b00680920ef1f2e16d32567e7d8900b76749832a61a3dc2a8126ec65ce872cc39d9e9c911bb2fcde26f63f2561533d2d8768a82effd04135b1a34bc9193f40cf9948c4ab14edd7a8b86d4e9a1bda84c28a1e4df19e3b2bf00fd7c520cdf7945e4d0be029212beb07cca06c24d4a63e3d19705abc646d032543ca40b015388f3861efd8536cf2a0c30a957f0db43dd467db68b7d77ced2f9af584a5c3178899247cfc94711acd5ea31956709be229ac08790d4c8a0c431918cc0edd9ffb721aeb463bfccb56418d70a2eb281787f230e89a67011d3df82766706fcf8cea7b7a5569b3f9a946d895f24c5a8ec9ca1ec7cee77fbfd73693c34e8aaf62d40c2d222a8a6c71521219def1c0ad89f8d437d883075c6c02209c5496c2d780be880f7832546f4e0fe38cd035a5ec03edccc5cdd0a306f2e4229b4207bfed109186a9e5356cc37628e1bad485a41de3f1db4e0d7b638637c56519f4692afcf9963084d2fa7d70d3e5332a50ab654a114a295c004ceee325ef109ed484aa092515ac27a54a2d7f4b8d0264ae6d8f7a7440dd760e0ded25a3a94cb0491fe81e7b55221ac8ed24f7c86a75f15494cab6f61d20259f840755983a41d9bb048b42e3a0bbe6a1ab0be031c2b558ace8c0057e2719ef1b7ae57aeeeb16a092f93c7e453c9e129a4c8a436edee9211c30166ff5a8f15feab82f9c8c04f48d37c7a3d98972f5261997482766063ad50e3677fc41e6cffa74038cc35acd02291036675b988ae5ab8855ee940382d0fbe9c089b54b2adc4a2226a4f8408d69fb860d310c58cc98284e4e23922c99d21b1597f4a1fbbb3fd65ae72042268e508c0216a8f5b2803625d34a902ac99468befa8361c83ae321268510a8aaf416e062ea17751d8eede62a7f11dd63c3bbbc6b004b7833eee8aac30c67e337926e4007a7d93f8cd55cd1c0ba6ab1460056f3aa8fb9e0e90013013455b57af1e8de9a03a224af4b6d151f6eec1fb4d969ad38030f9342f259ac4f01cac114e0dfad13dc42bf6d614060f7bd7df68f26e608b1ffe8a24557dffbbbb3d2555a0d5d25d51cee7420d635858134d5b8ea3560ae862582ae921f7c476ed1d437f47f4b8c084a100970b333cbe75b5c2d6c0cbde8e0fd457fd05217da90e33a30893e922bd3ef0f4707ff247c4eba7b1cbeb5e7fee7109adca8f998fa48716b08c153184a5f9253f68ac2efdee0da984e8838c438c2e5e78ec21be6f0be04cf8746c5c731d4bb44dea4047c3ac5421d8c719b3edd9a05955ec5c0eb041b23ce75bd9c862759f34ac6fbceb3d7257a709c21e83c3796f60d115af08e7d8757d099d1e13c7516c0cd7837277cff270bfb464127a58cdf42b67228b4b7a529273dbc289bd36434ad35ba0118bff8f37c2454795e63259c70f748d8134ec22a1b7da66ad2323adb3fea5501a8640bb255558c70975d4af6093a5a11163c1db1bbf81f408e413f32005411dedf53808c1ff5b8cfd97b431594e6717cc467fee79017ef52d8e8bd6277dbb540c5749fa8606c9e3d2da55720996355c025b8acf42140dd47b70ffa922ce80bd163afaf2fa321076399c3cf3fa118ce86411771fff6dcb3c7349e3feba8e1d936c0edfa486d7ebae828bdf39c336fa476216d93309854377c567dd4957230e81ae414c61c48ea8176df7b0b5cd7cf9e37cca05bb08e0e320b259501b7123b0023d80e5cd3bbcd22b2c8e65faa15a086724a9a11a760746b1fa9cc0e7a116ce8f9a3c104944f906646eae437ac764b22cea441fd3d97edac5eeb0b4205f62a6a454d1706878a9915da4d5eda8a81363bf4e17f6798bae0bb70f23be78149dc4cafdff7a9d5f751f715fa3d916dbfca988b093b96e351b761fec642431593ec57de604836a61b20d3a0f867a47db66f033c255dd344e5d966b0700a9eea5ac1537bd8f4f521806f73224fc65be1f08e42af3bcc66e3fdae922df779422729c3082d50e22e6fada49d440841fdc2f58d1e8b567297e9219ead1e637976f5855a3e9dcefa29b72a291aae2abfd4474bd65f797b36ae7ed9117e2abdf1817cf8eebc735d242d228064b207bd2a26997ccfcd20b400f2c9ae6fcefa0cc8ace309e74b56024884d836bf2cf8ca693cdf10e22f2908b8acf32720653558e83f5341adb3eec74e7400d4a0522857645e428d764f3b80472423cd8c0b84a93882f326a8bce4b31e46c3e271ea406f03d4ea7df2f3ff2293a282261c888f08a0bcec42412de0cea14248e999bde7172ee5fe67c0e41cf8856e38bc36a3fd7c0837651dded08921bdafb8718093c659cddaa6d447ea3b0a05cf6c174425770e5839873de96b88b35bd73a008e34843cc8fb0c4befcc045efc0f47bdacd7a4c5780b792cc8c7848d6400f7202b67cac80790555420541efe5074f038d87e2da951f56472e5ac26b5be731658bff5400672e1ac77424832f2eb478f102ee5b9c2c93e7095a6e216355378c030b2a78dfdf236373dbd71e740b3cf4ecb18d3f119c930c41f7530fb1509561d316c435ab66dd61e2dfa97e6f2925653f3fc0f7cb53a118998b95f7e5bca5754e256914e37cc0a8ad05f82d7106f22c60f4462049e022ae686d93746117dc18eccd65b128af81aa3ac55f960a0317cd0a857942edd0bc304733f80fc3e0addf27555674db7d84e904b45c62cacc2ac99459d6da4793b240be6520247eb58f3a9673c7ea8c453ed7a3595afe13b09fa486e7eb50e7a7c9422687a85d01f514bda2af168cbbb534188f0af7d2856eeae05ac623313e9b55d71801fd03ee2dc2cae44deed5da3bf90e306f9f8a804590ffa85b1b05ccdcec521b6a9ac3a3ce1e04d3f69d507857e23b2ffdde70a4d32664c83d3f4912eae155a9281e16c3649addea3fce770687a421e61c113f53961fb262e31c759143f94439d0d377bd7fadc89f6feec40549a354fb60f4512d1cf16ae0d31f15c88688c055eb6761028ddb478c2d7ad2152c6436c852e43091c62ff0ca83c3943911143c75de465d22fda7fd08eeeefb968e6b59d5786d5812203fd6987bb68b6382202b22300cd6af6da83bce3ad7db0a1e3d30cb37fc522ec9b5aed3314465c848411ee3770767f85c30a62487b1eaf02a3e5de2181da9581105cbf33b19bde7d1db8a2219e28bae27f5aea45c0995e950f333e29f4db82ea4c4c080ff82fe32bd63ff76af0abc317f4bb7d62e5b764610f0552544091902d3572ef5053ca149798ed1499d0c6412c0c77432850406a6e8ca24229cdc46854b5159d7d293319c8490c2136a543dc27add5631e6afc17c56c533731043bb266b37e391ee13399c6d2e248cad7e83d12c11c05cd9bb2146d996059f24bc0156c16f6ecbbe5923d9a1cb8afdcce7e0cf42f9553bb4c2c086ef911cff60b19396dc8c3dedd9c18ac4b0ed57ef4f1ccf0d6df887272e3309cd176adc2c5ad0fc771b02d360b6e8c8ee18f83de9aaa9c92bfb93c8d7aca87789df77e59e5976a6781b67e1dcec3b88d658908f75761b49ab7a5fbca5967f943da63cabde033f2c0a3c2fcbaad03624fdee3adf0b27cddafc78b0b5199244da590a4da153ee86f7be1bcf1363096537c5485baf13464df79f553b54bc1684d48c8a1f68a851da83f438ca3b8dfe553bdcf577724638182a24be541e05a9abfd18a4266443f3c66b5d01b5b6943562aba58402bafca3b8ecfd129f737eb246cebdc6f716af3ac7185904f6070e3529f1af62b20baeefbcaaa8e081f79fc6d1c3cc81060242ad591568b11fcf647427b85b2fd9c6e5927ffdb8a6800cd16dd966c550d7b9c6b1f8ed0ca4a7523f88c86a5939fe8f29229f50acd33e35cc0dca4248b4e0af73ef22f9c54e0141e7d9a881fa1f94c6f216774de604f104e82d20c0c73bc55602bb63d6231bd21105ed2499ee4f30f0d8f4b44ff4aa6cfcae42797cb143da4fdbbd381c96ac7e420249e90c865767bf3623b2c16931e68f86f430d0a77ba3ef675b1c07a06e8a477566527452b68d64a25a1f6cb44a12201aa8f3670a21c6c74e2b8c51d0d07ab3c7c8ed4be3eb369395de468c56316470d1d71daa69f49769f88515759880b3f981f8360dba73d7ce9946c4badfb641d435152c053762ba49ef1e23dd67edea9b3c6ab93436df0578251a1662a1175edcccd9bb1202da93d9aa5d5403df76731b4f96e349f98b2412b1deb83e5af30fed019b275b4ceaa8bba2a902836fb8e1ec440340d96316d840c7fb26885dc7d9a76be01d4b96018d4270a7dbd68933bba0a2465e4d13e08664eff5edeb3a14407e643ee96d4ecda6108cd02c67cc6564baf2c6982f7ca6b30192557ad17056d8e4930e382af79d87a86f9890d199dc71adae1a9afb1da7e29947a059d5810e177c70e4761f20ffa67c9187958e81e766fb4c98b32a778299be885d1761fca860a876482fb45b6286ff8b13a7091534c92656e78d580ab54cc3cce21ff133c458fb2bafc184e774adb3b4d341dbb442fca1458d95ee57ce705b9de5e01dd6d074d6f991c80b85948f3bc73cf260ef80860e90d14967df1ca8e873cf1452465b28de7874cfa29650affa0ab73553477c09c0d179345f115e5afcd704090912d2f97410ef45049a27847127e8870d2c93dc6a8febc33e8ed20b0b403b5adcccc67b3a6b67a48c2187b133872764093f76926e148f9270b8364d8637cb7627c4a41293e0647ab39cff9aa3a11a58d1c072b04e17fb1eb02de97710263ad7949b0a4403086c34059d0db5541e37d1f18046aa7d02a4b457406a3c1bb4101b8dd057a41a5be56d1c7220a5c756f67bd2df31058d5d231fe09046e11b49d1ae8dd51aa74c43769242ecd6d07fd3dc93103de045f18fecade6adfe2a815ff60d1f49c1c21b678620334daeb9d01d50c4143cc2e04c2367eac3f9fe6d007ef3b3ac8efb890a209ab3481506e68abc099b695c6768ffb03b5322f4d61cfb2f613ec01516609b173aa7fbe37ddae2185d757a0d3c447eaebd736e3ef3dee3d9b50b048cb0ed30b3dc9ae93971fb88bac2dee0dfb0075b8784c8103906175d0675a4c45649837d7ef6f87a7791ece12bd0541834612618c327ddb3635b5ac95e19a889f24ec7d3e1203d4a3e4c138de41c61aabbde2538fa0d00b24e821dab191762efe13f2ed672def5b2ee1f03d16c0d73f2d675993e94aaedb76b08d494fff57040c3a93ce7ac89ae5f1779326e2c0a278b04d5d68c1b88011d496e13f95b4a6d46ea0b56aa16b6c3994ae933b6bcb8e8fdc75d71c3f73ac76e5a00505ab37c964cf4d4107029fcd21be8ed6c4d968034a5be9b0f58d029cd252d8e1e3ba102a7cd54a20eec5eb25631720450954206973d2b1ce3cd0edb6edc2465e20eac82fe6289e386713d8dcc8486bc852037929d0ecd31b3833bd648edef1620662e64269715173b914ed5a18f97748e60efda92a4f597e33dbf90d7f4ee1d6db4bf2cacc586cb82eefb2081bd14dab0e9e345248a34ade73f3291886b91ea3e8cc742fd884f6ee0ccdaf4c9879f4db12dba58cf491af2541a1d5ef6cc8b1af750ef5d8559ef7ff9cd56d8f599974be3aecd8c0f4c08f3ae50d86f9f822a1e4ca39fd2f0b4d78d22630733a24d8d63ecdf9555411daf205a761c39ef46ff6292e74129bc13a7f4ff20549b3c2de2142152ca5b21384e16ecfc215462659b865ebe7be84410d175e477d7864fb545db158ab4f40c268625da45a03595886f08247bb8852516d45e76fc087b396e29375df9edb68e62e80ba6f51153f509ea6678b18f86eba0213d2b0f5fe0a5d2fca75f22ed191467e406d78cfd361d74ae0fcfe25973e43758807534466d016e40a99d982ba22abfeac5e07fbc625b432a829ea0bec2bb66eac6f9fd6456d8aa85bc9dbc41e85dd59cb7664fd75f4b1fd05d695f1809eda9488f0ded326498124c6ed41198321a435a59bd7fe6837945300eb4800d9fd7690237356638eccc30052ed54ab735ec83b43b6a726285426de9f504b6081b1530986e151ac075e17e308b159a275a41012acb01d9c3cb52f43eceee638002339a8b72015d918674675ee229b26125b4562e86f81892cc0772defab61b0dcbaef15c01aea104a4f195f0f26615dd0eb2fd500dd1b1481dfc542af7003f29fdd3ff7a8b51a79237e554970a6f2723abd9611fbe13266c279e22a34261623d0f6eff778dbec3e2d5cc5da1b8b978bd53742bee1620fa677f5978e86b3e06ef86cc8bc3773a784f05230bb17bb98d12bc2fb85bb4afbfd29bdaa16ae01aaf99ea792efed659476f3c65d946c203d6bc3c7880e90803c935f38e369b3f6bbec4a0f1537a399fb39be21150c23a1ce8125acb20068ec1a8fa1ce0c309d7c5d70850c183d60f624f8d9cc20cb4225923ddadb41034b76df1977e7eb12747ad6add50665a82c6656d9cd2d467ad496d2c569bafdc14206d15b6aeb4ab841d76fcac565c2210fd1da0420ae4fc1dedbd6415ab3addf54843a7a0142efc90c7d70efda91f850121df9a25db602476adce6da362c1b088ad860a1c555a2eedb5321469ef2cfdc3c33f8db09ac28b57f814ab7838f0de2eaea8cf63c8a2dcfb841c9f498f00e6e96fb22d6aefa89b226b24902cc434c157fa205a1f04a5713aa2fb22450f47fad265dbebcd307ede766572ce096b0a04a4ee915cb69fee763ba0522fc4f64e842f64213b4013b1cfb47583c7b6b3ed02961a5029c2d0ca666eeab62a41caa12d40e906ae7bffedd97d19dbefbd255a659bfc0153bc6de5cc5500aba453f2cc50c74310b7d95b8fa630d0efd88545de883702096d1bcdad027e80871074154c892320b3e9d0bd139060294404878be5f4e7dafcd85956acc35bc8ed111a989e50d50084b6faab16329b815ce66c6e0d363ed530180dbf51697d785208cff32e225d40f791cf9c14073387af008c62c0c69c8f67ce915e377f43ed3a79fccb98883c80712cc8167978d89acee570108d109167f84e9cc9bb7f4fb62ae7396859fcf33da5ca6c80c311eb392107afeddebebe0d662a887879e4014187d2fe8feefb01e6fa0d35819d7cfbf139e99451423b62ee35e4dce0ef48094df5bfc478c3fcf90ae257bb9f44f48b419dfde5f133f12068ebf012998805b809e92023d9759d4917f35c4710761309a8b1c6fd34407a972bfcfeb218d0b7ae23d68685187036629ca16d90ab9d7307a509d74290e4520795ed4343d565d85c1a326570cc4062d617711e00c7178ef5b52aa16ead8bf222353170306593e2326ba13f6f4b62ad3406e6e02fd990b1645788b7c9d0c3e557986e08103ff76fc1869796e93c636fdcf9875666798594c40aa87d0ca118a6182df77d5bcb0ccb99f989ee6715af45515db6e35d1d62a3a55d0e737f94f6bef47472329b9d50a02c32fcb8714dc2a831a20a096c4bb45878bd3f4dbb32ea9a7cea42da283d4f67e8d17487906b2a12fe65054b2c7af74dceb99f3e47f160b3021e0dd6aa11759d604365de3cf4621008251d2b0621a7de17b0b2f7ae66f5b3348e17ba99b04fab2317552edf5fe729ef50d62b91d64293d4511efc36fa15f5749914f86fa05a3b81abc6ec102445bb2476a4cf581f5409951947aeaa214e0452ed6a12a44811a93c9f4fb847e7fa5e48052d78b15358a9ca57a19150730a5a4ff9ab8bd04e028e946033f61ef1618dba9ac4ca4618dcfef4bad146d275e781dc2c4dd66bf89956397d3837edf737c40ca60f367ee63d6394b13b31989041f58813c584dffe629a8c64b0e03d5fd99bae95514fd43206823ab963e41b58c63fc43ea719b4b5eac61db522a195a1c37f21075f78de92d4d55751dfc0f345c0cb111b670782c59e535dcd21de8f5381d8f46a7e44066f04d76b18f36a98ddee221f2889c0b293f9dcdd3b230972eb9143a94d3223e44d32f2e65d634374878adf2ee483e7dca799cd0c7daab4e8d08e49b00e1faae0a3dbd279bd93ee2ee9434cc0dde9ef5976daae7c131d6379b8b555995bab4b84196bd065a809cd1069940585832049c19848fbac8a1f877dfab2e1d584498867045f876abb3952e18ef993dd62cb89ad72612f0e4125b39e1d0398e5368ed3d1fb4361d945a721eacfe07248fb5011659bcfd311d6a45a32a633c558d0ffd08d74a3fa3205d7ccb4b2d52b58cb3293828ac16277c92ffdd41ca00190e1f0e0d1e6fdab154a4f85d7ce64197d410762acb6026780872d110ae6f4d83df8269747f8bd1ef3a1831fcc8919d736fb23111ca3ef4cccaf20264fab8eb3b071e56667f06ea04d99f6eceb6942ef06683a118aeb04accc8fbdc00ac0fa1e88edd1c0ba849ee993922f6fece58bcb7c0691064fe1dee1f0c73a50d4cdb38327da5058a81baa455638a12b298450f6f854ec42042eda96e9e44a6b2638479c3db60570b92c2d6e15ebd0a139dc4eec1be190672038743618454271878722940b0f55bb864ca4ae432a52648643b235572b21e82c755849fc88d7066130c1354044c59b77e38c907e829ae79751374d2a901547919be34d172d5c8c5bcbcfea5e04d993068751bf28730e9d059b5aae16bedf07f7e2a1a9e8816795dfceab1db4be0624cabea084c17a4207297878d29c16039bb8001ffaf1437c9555afcf59f4eedfe32cefe58bda16c9b8ab7f3e453b2427856a6acabab1d2001d65f5b9299f05cb30c5918d2ef2b70a23e426079064779f6787891e63bacb96807916f50703915caffd5a24087c0987db6bf3612eb87eef8477f197807c8ea48117ba0f7cc31008a35c903683065cc731bb6dc78a97a89c9ee42ac28b6799be71ba2574e57e1063dd6bda3129024f4cd95afbc73e92833b0934ab3bff1c7b48f4e90fa1eb6500d290939ea084f04f8d44b333dca539ad2f45f1d94065fbb1d86d2ccf32f9486fe98f7c64011160ec0cd66c9c7478ed74fde7945b9c2a95cbe14cedea849978cc2d0c8eb0df48d4834030dfac2b043e793b6094a88be76b37f836a4f833467693f1aa331b97a5bbc3dbd694d96ce19d385c439b26bc16fc64919d0a5eab7ad255fbdb01fac6b2872c142a24aac69b9a20c4f2f07c9923c9f0220256b479c11c90903193d4e8f9e70a9dbdf796a49ca5c12a113d00afa844694de942601a93a5c2532031308ad63c0ded048633935f50a7e000e9695c1efc1e59c426080a7d1e69a93982a408f1f6a4769078f82f6e2b238b548e0d4af271adfa15aa02c5d7d70526e00095ffb7b74cbee4185ab54385f2707e8362e8bd1596937026f6d95e700340b6338ceba1ee854a621ce1e17a016354016200b1f98846aa46254ab15b7a128b1e840f494b2cdc9daccf14107c1e149a7fc27d33121a5cc31a4d74ea6945816a9b7a83850dc2c11d26d767eec44c74b83bfd2ef8a17c37626ed80be10262fe63cf9f804b8460c16d62ae63c8dd0d1241d8aaac5f220e750cb68d8631b162d80afd6b9bf929875bf2e2bc8e2b30e05babd8336be31e41842673a66a68f0c5acd4d7572d0a77970f42199a4da26a56df6aad2fe420e0d5e34448eb2ed33afbfb35dffaba1bf92039df89c038bae3e11c02ea08aba5240c10ea88a45a1d0a8631b269bec99a28b39a3fc5b6b5d1381f7018f15638cc5274ab8dc56a62b2e9e4feef172be20170b17ec72ff67b81c15299f165810222f6a001a281b5df1153a891206aca89ee7baa761a5af7c0493a3af840b9219e358b1ec1dd301f35d4d241b71ad70337bda42f0eadc9434a93ed28f96b6ea073608a314a7272fefd69d030cf22ee6e520b848fa705ed6160fe54bd3bf5e89608506e882a16aced9c3cf80657cd03749f34977ced9749caa9f52b683e64d96af371b293ef4e5053a8ea9422df9dd8be45d5574730f660e79bf4cbaa5f3c93a79b40f0e4e86e0fd999ef4f26c509b0940c7a3eaf1f87c560ad89aff43cd1b9d4863aa3ebc41a3dd7e5b77372b6953dae497fc7f517efe99e553052e645e8be6a3aeb362900c75ce712dfcba712c4c25583728db9a883302939655ef118d603e13fcf421d0cea0f8fb7c49224681d013250defa7d4fd64b69b0b52e95142e4cc1fb6332486716a82a3b02818b25025ccd283198b07c7d9e08519c3c52c655db94f423912b9dc1c95f2315e44be819477e7ff6d2e3ccddaa6da27722aaadf142c2b09ce9472f7fd586f68b64d71fc653decebb4397bf7af30219f25c1d496514e3c73b952b8aa57f4a2bbf7dcd4a9e0456aaeb653ca2d9fa7e2e8a532b1735c4609e9c4f393dd70901393e898ed704db8e9b03b253357f333a66aba24495e7c3d1ad1b5200b7892554b59532ac63af3bdef590b57bd5df4fbf38d2b3fa540fa5bf89455802963036bd173fe3967ed1b7d0611ed907027e72854b9c22cccff1ec72a9b6cbcf4870bf92d4bb16ed6730d1fb540ab78559e17e14e564593c68530aa384dc27b75caf427e84736711db211cc854e0bb873a8cb4f6bcc7d1b9cb8782bab111e66b215041f89d154e944946facfca3d6f8d32e4a9a3283326d55823e730a514a24b55185069850d27e51006ee6a4a7d3df7b19dde92be42c31f9cac9a9dd740c5e8664bd079d2c79d94edd57a305c3cc16754fcc64df55320e917862f6ade22dbc2b38f54721cc11a24215720aa55d8745c9ba5f35d53f0eac24735182000275e5aeb374f1ac9a6280368f07440edfce137d41de81950b86b4baa5de74613eab8216bf842bc4fd331c31335e78c8af67289bcb9073a81f63ce5bf551f555fd993a6c436b1df35d4d1e3be9bfcf59371a2d2a42be3095e56ca1104bf12c66a805b6b72672f1c023792d5c9971714bddb1ca338db0e3e4c36bd6e08f07421ba5b89eff52e1ccb3b57df19d2bbd85260bf2a6bd94aeb21e232614d4a9db5efc5d7a994dae00d8557c21140587eb337028a76ad03f00c5ca6c6704f382b5a99238124fa822163d2de02f3b9d9643a5b39c96bd7476ed457006f44e4500dd4b649f4a6918966d23c44a6d106c3e0c0076ce8848b221be5a99599599d20c9a6bfbf8e88fa5f24bb1a020a53b7a68906f422844b39128bc2bcccd148da38f3631ddacb568581ef90f4bcb9d64cffd15189e1194a51a732ce191ca38d3bf6ff7c69424799d3803bf664db41e3274e3e42312f13ec654ea59a370b8c8132e962652a8c7fcd54d87e4de2c42ef4d700445b926310bbf47768a9af2ff8df4f9ea0afc9ffc05b9a093b29e72dcda5ecb467f026337c338fbfd06ee9e074f1f2755eded032d5ef138106fcfa6eca50d8d93dc25506c2ed8796816c6fc38d53cc0be154d5bc1cd241ee4649851d91901bfd2a24a76381348c8a0024a95fbe9f2cd0ccb4330201bfa58f9d922fa0bfee369eb1a9b5b043c30f08c12a4f0b651e9542957f709b2101df035169429ea1c5a91c58c3d89366f36fa138ef996d3d6ca60fc01926ede7332ed82621767de3a0f414a405b88387505ed1fbd740db8403df66d113ce70f0ee458c707d33a4f22a980617d1bde701643d197e83adfcf57e92064ce1cfdaaa7d838ec4bef2da59ad157f28da515481999ae625776937ee377e5c9825b371807b995d87794c5486b2fcce6b622b52648ae8d6a524eb22fab8e4e8473201ec1f62d7875d2e98ca05d6aea2341ba4474692b759621eac34978d7617ee994380d3bdce8aaa6170916372bb69276944c9945b76fce0b734e3412fa289d2edf1065a070ed5f3945c410c3193a1b9cd954fda4fb82fa5911dc57419eabca89282b2feb8e8f7cd59c46f7c7dd7da7fcb0e5084e9eb60354ebf41ccd6bf1ee419713d4e5e0d7eac04416340c1e871cdf4286220a4913cf412a1eea7d0b02ef9f564fbd560ecc8f4264bc2d5a8561648bb7bfb3a1a4a2476bf5e22a1a23e6b7eb8a675106c07654a524c14c78ba126549361823dc566a531975c9426c5ea52c6d5ee3f7bc9dde212fadacf83064a20960e71ada810873dc92d25a9b3b6148386cf84c19424d0bdf2a270598482b1a361af34c415861c6c81f331e9d4fd7d7c232802a1e5e790574dcba559689b981d6bd8236be2b0a6a0108c09bb0706658b1051f036ed9c9d5ca8e8c2259bbb3dfd092bb61bac0aa676d95a35b3d65b6d5ef2efc61717ae482c887c8f749a6c43c0ce1c7549ee0eac6f60e01e6aaf7705563f441cb8f0b731455119459ce1192a172f2ce97d053728e83ba05c261ee3ce1f5a113ca30521d945b7218d250c6c515ea0cf7b3bae1e9c7fbe2d479c812c1808d7c9ce5bc198b09c1f37ee9378b06a15c786a2fc252f87a48ce9993492aa83a13cc04a49b26647b6fdceb27eb29fd4cb07f5093526d46ae51c67a964b0098176fda738f354151f34c758912d468511ece67d168d1fb7c6bfe129f0c365a3a208aee102ff234fa77420580345b0faa1f9e781435a7c441b937f9317c7101365c4a4f030b3bc6061238d6f815e6e8b25809fc42823b903ea1e4c4586f66bd33d4984775ab76be1ec9172e183bdfb90ed0f53982d8f7271a2aedbc3b6c7c55d98e5d1c8e980de5e9a6c5560830ac4b698f4c78fdbd42517e5d3a2603fb1b93d2947f177559660310b02b96f17cb766699ef401dabc84d51240b44dd7a4ab3dc3eee8805376ebe03aef3135fba566d1b604d71c425a267c7dde4178e0f0941c57a27e9f4f780243106cc07d4d352356f9c9db115d218e0e683ccaee46663ff834ba2bbb92e615f5392ebeb410b455bbdaf6ea27529825537a6438f8308f1299023dd51e43488bbf5e3d15236ba863c90092eba84a4753125c5d71dec6f176c66a34660e8b27cc6727a2ab12879bb74814a5c5da6cb78115b52f5fe83216d44913a6c5d4920940b53b646ac98b14b800bd386206e16f15222ee3e95e998692e8a79bdab87f794f73438b388fa09cceb9a451a973d0f779026f7ff68726c71a6ccb1c8d017afc6167e620ffaeeeba613a71fb826b62d8137d1f0e70acfe63d29c292fc6f9ad1cde5acd2aa66c9cf6d94ccb3bd534bf994d5ae6953e154ce2244269df6de63e602e15a0b11512d3d89fb75a1b8a170ec28e636e1e480a36ca772433316a115550b95d06be34e7bae91943c7a28a5c78dc3d5e5cb076d3e4a5320c2d2fa5c21b75e7fda757eb357ab0b0b7bad8bb4b246ec4145b54b0b77ffabfc002e00741b75621bb2c8722423ab5ccdddac6062c3a008a4d1111deff2f528508584c76d5527ccd613d53c1582381d67bd0735346e41af7d026efe8f41b34ecaed87cdbc7146d55b581c5b0bd5d9b345a43e88be24845736743f6b6db6c285c7829771f5f24b31f80a1e4d7b90f8b5042dc2b94488e0866d8102f30ff49b63d30f34528e5abd6958944b81e9661da91fb434658c0dfec38ec34a13fa7db67f79ce0efe0a1d05c1d9a134a6e9a7c0f5e4c1f40be926378516b5854c91a4ac2f285967c2edbbccf2179b6a1ad0f88b221fe1922ad0541341a1d2351b7a1bd5097b2bdf4f9da96b608efd4c5c53bac4c41d9d8f30f62a2a8f9ca3e9ff2845c974cedfe602be7879a3ac415bf9c67116426a505bbcbf1ad5d57395046610b50217afc01c7ab4ab7021fc023961cdadf82382a4783c9fa8bda9d33024feb7ec1768aa86d31614b4d761faba3522cde3d2edf304752f1c563a73180fcc17a24d61ce2b9eaa63532727ea24c40fcb3b953f1837eac302b9a5e4d7de8e5a4f546b89decf7222f0f464da3106ca09b9bb44a528cdd1f255fc0a453e7336501432c8f810f2abad3d7d0076cd1d36b37cb174ada6215483a75805c41d92826df4e1e824eb2195d9b7518c7624d494ad92b2a7a0f6deece765522aea0ba90cd46fd64b98e3f8db18dd166b60bec96e487a335037b15305ae2e7eec3f6f233053e38455dc81d4e5eb4d402fcf21781e34b1b7f0da6c3a29384142bc3cee9d974d0e70a9685b4240d156433c09c34d4ec2d7b51bf17dd0d2266c223d6ad064ac203f3fc8b4c6cd766ba6a432a93ad55aa34abf34156cd39ae90da1c221db34d98e0426065a5ad2e10aacf78635ee8cdc26893adbcebf9eee008455fd2a558ac9e6dbd814b18dff2b4ed791b93854f03dfd11cc7585fcbf460d8e9340cce5b2d7bb44ca6662e6aebf98c5273e19048c1a7782c883c38a912d508b0e2f81e2599d7bdd816de6eb6e1888e41ca76083dcdc264ac399101fd12e79e81b3c01f1eb75c8e471ada612b9c08fb2d667a7595f0d99d85227e3f2eba3fa443ed8959ae51b03183fa828d32e322db0090145db8f2942c9d8b2c7ca4d38521e0d97e533e2d7bae72feff7c31807e37a1906c4a0e9b9a18debcc23fc724611e3fbfc4953415660bfe6e79b69239c316f8aeabc3ffb394692ffc6911ff7779a248e786a7face18520e9117c1bbd79981ed32f951f301292877954979b49278b5e398ea12f6233a8b89b002271622aa7f68637d7a524e025ca0cd89ff4e3e045ff81c185d92db74bc5913627009e19b18518b60c98462c60d91ed522b3543c5a96fb9391035bd6def65025e22fede175490f0c9c3f1051e43323ccb86d169659a30b875b34693ce2b95c51ec75cdfc43c0ddae1f201ffb2076b041d978b78893b2461f3cf2f233e79d1a3cbe68bad4ad7b193d0dd1d172960248b6fe6c937db9231fbdceb573666e001e68d08f310522e6262bd0cab172c57451beafcf46f03aa40d057902693ee680dd48bb4fccf8447098ed00815c562f3b6fab56075e8a9883a268d4504047d19ddb6ee720eb4872c8f603358c1e9743c5f70fa9ab26a74360546a692594fbbfc5ad3ddca918504e5da200b84194d093a29c7de3315bd0cbb8b78c9ff8d3d52186a758145ed0ba278d416831583b8caf6fa458bb205a81a1fb2031e150896e775f6e2026a8a0e0aef6489c09269f15e77bc34299feaf5466a6431ce5b3322251ce76387c2d056e35171c3ed8332c16fc555dadf832b6a37a58848015a74a8b114234038d428aad6a7e50a307046f0a2e9af80d6e532d096d80691de9834f2366594c13e28f8d38bf8a7a7b1e20d46a1eab06d364d66ee0a09c6548e9fdcc65a18212ec146a99aa94c9fe29961ef8b14d042eb26432f8e3c42afd939f7d2edc534b1cee8b7a4c5d9acb50210735486a2a44c40ce50f576d38aab670526802f20c12eeadc02501cc21ed1513da2a400f46db5b557fb206f78eaa2471db64c5313c87fcac5af14690daddb15497547c1b2336792e9cd1841d3687ac2a72fa023454f8cb6ca465a72615ebb975c74a59183fe491fab4d46b48b0f1c1ecc17e3655f613df613508900673b591f9c2826380fd743a4c603109049e470a3b3f87de208037ad1c95508dbc64b9df43418337dffc53d686277df9cb4f15e9b8559d662e93f2b9114db41cb279670604acd3229fbd11fb4a5321ca1753dcf4c69c356adaa1c387c1b6c9b983225b8a907cd8d04aa02d1d0babb2d6733d0a9ff88bd658af2a389db078f7e098eff5f1892a2aad6b5603c04c79a7cb697b3d6fd09cf6bc269da06f5ffcd52e8e42c4bf514d3f367c3f34698f5586f5649ed3c8b1581d01db8cb98142cac80fbdbb56688b4e9ce7f7dc4d8d36b7c700ef086c5f4d45cfc63877e257eb6b66e0b1ca196189b6ba5e58bdadbfe528ee6a83487587e6de7575c7df9967cc47385df4ef8c5eff0e1df62943d3561d11639eabff7dc7309aa4ad04346d4567e6a2d411ac3da53dcd4e4be40f6d044119dd09d36de3b19cf2e3b86816dc6540d23cff72809bd8d87cb1cc1390c92ef39aa158944445cb9e8fa9347de7453be9926d1ca1fd256e5184eef32248765a972c66f758f32279a7b97bbdb026565db49fc9d82a8268da2b7e5c5dbac7030bce478462abfaf8406b18b190a9647e3f4462c99e76a0e4a0e8e19068277cedb6eb64803717dc45b43b260179c4223b451b83e2fc00e91756fc2711af02da94d0811be0c107178949aa59d1c58ad00c23ac6bac6d73bb8f60e7e7669ed770970d11c63cacf42d31753b2cb8f0780e6f4f79829c5f29a8ab533e8ae5c41fdf72b1300bea57898ddccb60371da7162de32cf571396dad20f9a2628a359b3667a6614e45806d11d9f9c0bbd17645efcee640c2bfea0578c4f8e2e67ddc90c5a9b091ef1b753a477206d990b469596f62172f43b744b3170537794cde315148361fd774e65f6b74e6829a91384d5e0f77c45d0b0fcff2f25223fa1813ca39386d4286725ea55d24b80b683fd5c8c06a709c3e7b11f241a54c4cc9aac73dd510efc73389bccdabf156ffe6ff25322ceafcfd583676322baa44208ca750d2a15c1e2c630da95eb45553de7b51af3ff01b7d664eafa5362d7bea3d9780594f1a9478d0a990accf22bb3f35b9c9cc38c676627566591744a3949ef29eb83909cd3490525b952fa563ad698416da04b2fc765c9953c545043a7ee2edf6c1887925c6f5301d9dba67f3a67348071501451ea5bc407b76c6eb6eb5569e343ec033b0c607e8540cd58d5f30dd002edd2a55b99f121961e015609cb25a81db8268bffaac58e98384f99c02c7172ae2c4e86b39acfe729b83a91a61007f17513efa84600458c240789efa8af3b256c75ed40c3b59c1ea7ce40a6f382a24ed39b6ee078d4897f10f6a4e5f54212ee240fd65af2b401cefaa83b1d5ae89fc61f99ccbefdef386f444dc8000fae9ed7be43335ca75da500098e527f410ba561415530c73d19fb64a7541cca5eba88e7235929cf4c7a31bcbcc8ad5212b45d282117c385a1197a672353c9ca4b3078263999e23a48d14c08fb9d752134a96e22a727ac7f8fb95c7f9f91f6883cd6159de94a8625032b9feeae57d2710fb38258bccc143d70bf4ab50457cc8d9a7608531cb63c18e54fd175bd3cebcc0b993ed046502348adf4eb1038ed7360ced6f850b8232d9c56078ba51095e9b990254c942ef90027ac20e898249b12893ebf8e9da6da8138be19758790a9f3c1061d54ac5d10d462d70be855b0a9d29154f87241cf235f75854e362223c2326ad54afd1ebadcc682957c9450c55edaff774b4b441a45efda136e777fb226ce3f6574f0f42ca7ff0e4d3d94904903535b0e7ec2af6e8a5befd041dfa4261eeec51f62d5369db7a78e69148f1d26e0642e835a7e89b538c83c258e179b65f2ba8669de53eaf456e58a50ca2d00423d36fe3da728dad698604a781fc66c59ea5b09acae121a19cae18b6a2717408762f056a42d67abb9f24ba032ba951de84ef9d6519bbbcdf35bc4181ff2f5e5db96bbbb20b3e403468eb1c6bc282cb8fc65bb76be6df60c6c53b6bad7f56ef82823bfb7190346ea65b3b9457c3132447c78ca705dec6ade6bf8def8faf62b7f554f23d1f7e33668feab8ba4dc9c50ca50cf4e4c95e0c04bd994655af0bed4854a631092221c5c86f9bc506b43332d5160b26e93cd109f5b9c6d72682115100fefa6ad8003765f4b3e2f302319bc72e1946952cc6f45b0179dcb2eabf6c287272c62232500b8e8c0b54c5253c500c682d43b237fe2479b86c4f8c1aad58fe2d4e9dd990982ac9eeb475adf83b1c7d23d087209348ede07b0fa3b52ed2742c91f0e6138b2f2182ad6daa3fe3b44d93d1918542b74dbd29c9e25db09fd55a4e30e833427aab6c53389576dd804e6fdb01fec2ab2c631ea03572e210f61c57dd9ac309e8f79387b620aa7019565fffdd3566c3bc5b3f8efe4e3fe558ca1e19552fefde998a5de015f63b0a75ce7f79f4dc681d18dc298aae64b7cbfa74610b3f70ed35b69b81221d19c5ca6551037acc7771132327b79e0b2968fa689d7b9a170e3983e2b3a3ba160bb9248a96b25ebe87205a7db66035cf0cc21545adc4625648536d805b1c04ab5ca3ad3807d2a2659be4678b00c9fe547f6190f41de1e087cfd937220a70be478d03b9001d0af23c163bbeddaf4b3425f1b5e206664a9115f529953a4a3833751d67fc755eb1aabc96a4b4e81a6a93ce143dacff2f64f0ab58c2ec5b82e900ae6e3edc0a356d48619dae0e2ccabe79b757674630d1c78b928b43c0e84cf9a27e2ff6dc2149a467c58bb61f2e48ad727c2bd1426de5f8ce85ed0aa77310e0954eb32e716d03ed7552e15b5c6f1cbdfa7711fa25e8e46f35dffeb6048e773465aa9854305fecaeed845f1c6a61af769e529a50754445a15e1b40a46c9cd87b701c6ff69d5c7c6f5cf42567bda8795dca79356295029215b3b253744420cd1c510e7a942ce52bb5300d04dbca9612da0b6573af19965252b35f97942facbd9d851b689b43ac831703395dd715dd0471dda1c5947791feeee95d8d9283a3328598adbaaa85f50aeb432390e823cfb6cbbda8abc143680020d246c5dde4a6c45ae84fe11078713bc87c465e8d88f0b23e2804a6a3e19afebeeaa5a0f4c729db84107c6c8b7f838e251b0c174599d27f5fa92046baf6ad431fbef4df75bfaef0a79dbdbd6a2fae8a97abff4b9eeb078696bd95fc84d71195a9bbaeb1cf12989c2bdc7e643aed74b976ab9a7bf800e26079d1d04880276a4f035d4dc86f748936877948f17c5d588368966818ff5005857f8269bb3b5c09d7b3306c93d569f37850e0a7d5bce3ec80e408d2b3037ce36e2e5bbcb524e982d81fc165a4af4769ba0eaf15917b15832a5f5f84caa2cc0e92fcaa63c6bb4467c8cf8cc36b4bb15e7417311ca51566cef85116d8d06be1e99c610ad9709d112b1238ff2068392c344f011327913a5c12636fdb5964bd42f6d30209984318c43f4cf294e71bf60cada362c1b0d6486a1003e20980e81553c8ef46031aaedcd236f162eaa20710f70d09a2c952f4de152a527e1dd9db12b8d249a3a3fb2447cf8478306ccbaa186fe4ea5796887d49e1d3c79aa4eece23d6a56ab1589433f820ba79b197ce855adbb7edd7b5cbc04a54aedbae2b1a31c731b4cae59d906e4c5a4b5e8d08452976cf186cc9a3877e2de21e274f0cf6a67b5e72f2b6df5a33d2e0b99f191ab9f6eabe68efa3fc65f7831ea402e3e70e7cceb1827aabba5c152a5877c3ec5b878e352e4bfeed0cc1dcd87ec3271335bc552fdf45bb4aab3082913618658d57484fc49314030b71358e9c670dec4375aaa02d3c4f4d0a2e522cc5ee2dec627a76cc378153a485a63b9d5d8be6cafb2333fe256cf19870b05b443704fad102518d740c8dad5bf2384e898a31e05ba0caf2bfd6c5ff3604ed969942ff31abf36916e7a1fc6381b793d8c3a11d8d16eae961658febaaae3d12ae6c985154e5ac1d8d97967238ce7c3574dc40933f752feb0aafdf5296598fdbfd6ea59fc706930b7bf458637f8a86b9bd53d72789fef65c58cf337f44c083a62dffd92f1a974eaf3c8e7664ba5e8d8cec9ad36f0f3cb4c9c6742ae6388baf1d9a90c1a3c210457579d66eda6bb2e72bbd41c3ce0187019fee1f340be413688eddd1ed825ffa0dfaae6ca05926103a1299c936c93396636b3a20cd74c9e056966233cb4f46cd1eab34a1b9555bfeecddfc919ae507c33098353985a56c8aefa0c226d96f08f1ee03b72628438fe775ea604b7ea5e0961fc369c9cb124e7b9a5a783b96662910f290a06a7bc834626bc46f5740806097875932422c4fe22afd1feed280c92992c2de8adf0247ebe844f874358f090a4fede6394317b2ca117e5da09c371c8d0fe559d0f47a4718f188031966b8b44017d9e6e93d2bef58d794b037f917b4c5d0c07f0d5b324a3e06ab50b98b6bf69497c1d7cca0c75a30e5d6a41f69a136569deacaba73d8c5dda0357deef407549a384c355e1e7887c4b4caa5c17e7225d1cfdad942cebc4e7a56acf724311962a381cf8c07f6bdfc96dce731b897f8e7a9df070740dc7b5896827848f3d32085530cc24874ca162d19b692d47f46b4105153f5f12f2d9458b4cc3ddfd84aab512b21caf70f290fadefea740a802b12145ab73e13881285d3478c54483c18183a9e695014416408d36be0f1506595b188488135dac65bce6cd14b520eb9cc05c61f5be82ca63ba042202291229a1700d08d3a73d37449dc69e4a1cd8fbbc6e2783071f9bcc7e0548eaf27ea0d983f9e71bb5b8e8a1c7d4e7ef4081d67cca93cc574341b210122940d6b79528dda6fd900356cdc6b295672f081e6c81356d383225d2ab3160c52fd32e79f610feb484ef08dd6e3f32576188300d6541f04e634335dce57e823f1eeb395f2ac1045297ec747323bbe8b4c7d9b135f57e73151fe6ce8878033e29fe6f4092b8a4b72a3c6f8d3f75a29d55a30ad1bda3a0876971033afeeb265e2bd8468b3a2820dee47d609d6aeb5c19e1fc02d9cdf80ff4f26383bf67c651a8ecb35a627d039c432862a7ea1b0e512401dbab118f7b348259fc4ca6eb92ebe61597920d86d082ac9cf22dbd7b64ea865d47ecc029b475f946444737b1d65cde4d8cd6d37b1739e2eb35d85db2778d069c48ad2fc32b3b2060445cb9e21a0b593d9b0efe856129adbb339114e7cfa36e66e6d6a78669efc050037476a5e7621e8dcb22d4cb34bad4b5f5412842f29584652a506e99f5f7a1bd8975b423c3c8f7e425fb9e761b54218082cee2ec6ac9113e1b01cc2557bd8b50df49bc8339a5aaeaaf7fa3ad9b5f5ac4e2228a0dbfa9dc9cc2d20b5218a746b10cd6d6eece62004873972d993e43482b1e2368cc779caf2525ab7247bf1f99871806498c0c65c1a6792c82618b68b35b3dbbc3521c0950814e75482dd48c4e7b0cbf5f847a17b5abc724eb2f0a3763fc47d1e5c7355a88594516d62bdf562b34efeb5effa0e0a3006769b02844161fb7454c14524bf61f551078646a69e4f95bc9718f240729554d61e11976c06eb0343e16991be545dd1cb9813912f9a07f97a3393a1c36589139bb766e4106a8df1a3a16bc4b8baf8a57481b9f4a18f18791842ba70eb5d7206c7f0ff6b09f2a72114134c40ac69cedadc32ddc3a4d3fd7f0742f1d230d0cca8fb593faec125e31c35c58fb7f1c74cfc7349f390b20f3395d7b2de683c561564a63ecc21de7abe6d5926aa7d3179ff84ca259fee519737280a20d4855653c8e4493019669a77857f2ec52112d3f8530e5164273efc1284d00f0b78cc2760738264cbabefbd92f4dc070f881b61b8f3f3a9744e0529f7a91866e13f9f17f291d9797ff81f9053790e728453e963323ecf22d468c353cd205b9220ad90a080a05407bb8298cb4f8e8101c1f92f40fab00b6e031c0c11e967342168272379912b8c800cdfcdb6cda1de35370c3f8388d442db9ebc41ecf30a1c852640e9ebba9fdd92e26430fb845f607d51e1acc35337d00bf5de073d70657f4dc99f367f5379d180eac454f1da13d25aa12df958e0376d6fb6f5ce8bc825f6ebe0869bbd024612fa7454cc42556b8e4db355a7ecc67f658730a7fa7080a80dd0098bac2d3d80ec601da9e9557cc30ed6e6ed3ac76c6c42e311492d5420881e9a8332ca386bc6f84255484eb3b6b6ce76ea4914a1487a9ff3d77dd9df3e32b3bc0c0098771364b121a9946ee5a9c367be0c1dd7e2e146d739d19a825a203467b4f2697951daf6917e8932cc53bc55451ceacff704dd4d8335be43b95d7d09a515e4f1ff61190923c98287e9967508f103f4d3f4af82fb1e77fbedd161bb2ee63f422e8d1d53f8e293142839164a3af603c8ce431b88dc2370f91d8d0f4110b5c19873c4ff2262585bbc884d6bc287cebcc51384f1456d1c9154472eaed55bae2d5666198efab1ff93fa2c98ff645be56f78481cc94f2a74898bff48c8be6c19d31a7a0d35438432cc3b89ae59b643c4cc50d08d0c0ca0c5aa1eaa6e0582ce83734334128aa345ac752f23f0032ecbf733fd415822144c8a737adcf0bdb90f955e7f08cc077072c71f138ff0743450f736cc2f00a3ec9a2d862f0b8389c78baa250c7c9c3461881d3aa72242357d6f4f555bde0919fc263952a9baa8d244df5c379a03f599cd121948488f47bf50936a100ae2e3fcd95d3859896eb32fa7870636a6437a80399d45d8862b838a5459c1e777e233b4facba51b3c9c350a65ff4282af9f9db02d861d6bce8b781eff3ef15c21305aead6de0a1841c7c0fb16c48bac049cd1822f791a62a033b7f5c79f72de7571cbf70420d1b11785d96a20636c2373bfb87e95c2c76da998a5973407c0ff031b2971f92086a64c3ad0e019484e894b6ca52e170faedd293ed38bcb04662e4880d5d42c49a3485e7b59e5780fbd3e1a4849e929bc2b41cdaac44c0311ccfcc46763a62428b227acabd6f2a31632c26ec6f9683464e72c0550fa4062cc8feaf5235560673a3db4d560ca9050f849a6976d35f3cd764d0c4eb5e8117071096959492d8b6bfa9080671ec736d8225c6b42afa2445b8cd763286e002792cbd4087f4d5e8fa8e6750ab05a3f5ecf210570ef02b0b274f510b110dde50b60197a38b5a45b05b48a35c46f97a5809c70bf680b0ad3c6906b7386a67a09256f06568acae2b55605526d3de35b9c44d69df4b1052c9e09344c9a4447e6ef1df60f136efd8cf02921eb85e7ca1a8603e4154fdc8bec71f2d704df7a7399095dbb901b65ec079dd770920a527258f5566b531b5b0dcef20c0f40cdb9c804da5d1625e8f004f710e997f284fe7a9b5ca4d2e401acf95880cd337cef6293bef4a4ac5d06add6bfebe80e99605c41563e8791547d52dcfdc0aefa15af05952bcabcd491eeffefd6a15b2ad336ec751e1d774d00f8dd27331439b9a7a7231aefdf1e25612c56aeefb3ab935c733f74577bec6c960ebc76ad0df5f8af424bb35f943115472952924fa561de71afb5dda6dc5f5660197139a0105c3d991adfed0facae3ab07064489af90642df36ffff60a168b11bc38beed0cdd50ef19b6026846addfc499c1c2046111186e1c36e78297d610315776d14a38908d3554e6d0e326158e05f06dab7c5900c0115bf91d675c300a2d9bfb5398ce4603110ae66f2be22a76d7d3b308dbe086e5807960a78ba14a036f506c4cc1162638ec025de726c21321a30b3be0083ccb0e223e128fd8ae4c825e3e74c4ac5859b62f05f441be0ef917cf61ac3bebb5f6c35f71b8dd35ca5f10622cb9c441dc070540db5384da0d03dec59aaf216c95308d9fdcf997893fab34e3e4e35368e956ab894c21b861085a00eb81eb9b7322a0f24a457ec7be535776492c9b7a09c97132702006e53d472505abdd09b0e8a66f7cc875ef74bb4f8b5efdcd89400cc27e225f1eac1455128d736c75b069b367c4b38234f3a7687b7175658f54ad591da601bd0fb84d91b1bad4951289ccbcaec81ede493267ad1e2e42ea39a4c9d9221059f2bbd596d96bd3af907c3be4ecc2a245457e55bc7281ed4df495239d7218e5b166eaa9f9158a018dc47b6fb629ed7bb0209904ae9fedd41fec6977300d494c928164dc7d2d546bf599d7cd4c5c757be8d563e6461ca80b3f387e488a93fb6e83abf0172a09123a6f7757fcad6ea3c974cea4a48bd1fabb35429c3fb4ea77720c4c580209920b9583c6c5a5e145bf8edc7124e586a72d0c8a718a03b5fc0581b5cc624421ae89a5baeee76ff1cb11f1a928aa523d848825c52c123d95afecc30793d7857b46d2919b578503e4e6e01b625a0093ba52522f6eddfa955ded765f89097e6f1d432f82af6a6908c28076348f6eec4f05f7d4510eeb0bb2149de97ec49621a8118be8a07c8d5a2793801963b8ce372e245d56b42cbe0d3dc2a78e473ea386d85f0845128c291f0860ce12d066e1a9da216a1f7f50bec8dd6ff2ade3819676a80da08e0167a781523052a9a4200f09f8030879db0253043b24688e7915d9b9bf253d0a94936d48ae0cf425076fc02133d31eaaf0cbe588ffe9f0783280d217c7aec602f49ae53cc3fb9cd020da5cb7309893fbe532dc1dd0c472b5364ceb5865b123be480476243a0532f018e94b949a5a51b4e3c0a08b56bfd78bac008b4343353c86b95787caba329ece1624f68017223f1d11fb999a3ae10543bc2519a20942f9a26f1d82f4ec8bc8b24314c3424ff7457e986d2f112432e5249042ff3b5fe0425991ddce6b771798e3c7401ba4ece14b1e9f9ecbbabbbb5f784ddfa4d6eb18fff54820d3f705dff7abc930676c93e839464f15d35ba8835c851e85703d58f118bcbb6df95f3be9cb50716d0d63ee15f73ed05ab1bd9392c29529bacb374c7475f7134ca86d&quot;),
<a name="2645"/> 2645:    %% SHAKE128 VariableOut
<a name="2646"/> 2646:    hexstr2bin(&quot;84e950051876050dc851fbd99e6247b8&quot;),
<a name="2647"/> 2647:    hexstr2bin(&quot;1822b7cc3c4ea4f2440a362b117f808a&quot;),
<a name="2648"/> 2648:    hexstr2bin(&quot;2ab3a70f3b01836d8efceb67490c3c38&quot;),
<a name="2649"/> 2649:    hexstr2bin(&quot;0a13ad2c7a239b4ba73ea6592ae84ea9&quot;)
<a name="2650"/> 2650:   ],
<a name="2651"/> 2651:   [%% SHAKE128 ShortMsg
<a name="2652"/> 2652:    hexstr2bin(&quot;7f9c2ba4e88f827d616045507605853e&quot;),
<a name="2653"/> 2653:    hexstr2bin(&quot;fa996dafaa208d72287c23bc4ed4bfd5&quot;),
<a name="2654"/> 2654:    hexstr2bin(&quot;c7211512340734235bb8d3c4651495aa&quot;),
<a name="2655"/> 2655:    hexstr2bin(&quot;ac71d8e087ae133f3da590e1a2b54d48&quot;),
<a name="2656"/> 2656:    hexstr2bin(&quot;b4813895ae01b43c9d9ed85a8b03aaf4&quot;),
<a name="2657"/> 2657:    %% SHAKE128 LongMsg
<a name="2658"/> 2658:    hexstr2bin(&quot;3109d9472ca436e805c6b3db2251a9bc&quot;),
<a name="2659"/> 2659:    hexstr2bin(&quot;0f994e4aa804282cff22ad7d6229ef2c&quot;),
<a name="2660"/> 2660:    %% SHAKE128 VariableOut
<a name="2661"/> 2661:    hexstr2bin(&quot;8599bd89f63a848c49ca593ec37a12c6&quot;),
<a name="2662"/> 2662:    hexstr2bin(&quot;19e740d7d87bc322edeee86a05eb59b64bb86f90dc7b98f781720b7cac37fdaf293ce6bd047a14fe&quot;),
<a name="2663"/> 2663:    hexstr2bin(&quot;ca7ca55bf123aba45287268c4050ab030b1415f4497d5fe8dbc5386ae37d24384a2fd6a715fcad48ff9e810c1d378fa70f1503767e9e338e33697206f863dc8015b4d1e9b8f81ddee22aac59d52055a1b0784a364369cc50f403045a1bdb25b639&quot;),
<a name="2664"/> 2664:    hexstr2bin(&quot;5feaf99c15f48851943ff9baa6e5055d8377f0dd347aa4dbece51ad3a6d9ce0c01aee9fe2260b80a4673a909b532adcdd1e421c32d6460535b5fe392a58d2634979a5a104d6c470aa3306c400b061db91c463b2848297bca2bc26d1864ba49d7ff949ebca50fbf79a5e63716dc82b600bd52ca7437ed774d169f6bf02e46487956fba2230f34cd2a0485484d&quot;)
<a name="2665"/> 2665:   ],
<a name="2666"/> 2666:   [%% SHAKE128 ShortMsg
<a name="2667"/> 2667:    128,
<a name="2668"/> 2668:    128,
<a name="2669"/> 2669:    128,
<a name="2670"/> 2670:    128,
<a name="2671"/> 2671:    128,
<a name="2672"/> 2672:    %% SHAKE128 LongMsg
<a name="2673"/> 2673:    128,
<a name="2674"/> 2674:    128,
<a name="2675"/> 2675:    %% SHAKE128 VariableOut
<a name="2676"/> 2676:    128,
<a name="2677"/> 2677:    320,
<a name="2678"/> 2678:    776,
<a name="2679"/> 2679:    1120
<a name="2680"/> 2680:   ]
<a name="2681"/> 2681:   }.
<a name="2682"/> 2682: 
<a name="2683"/> 2683: <i>%%% https://csrc.nist.gov/projects/cryptographic-algorithm-validation-program/secure-hashing</i>
<a name="sha3_shake256_test_vectors-1"/><a name="2684"/> 2684: <b>sha3_shake256_test_vectors</b>(shake256) -&gt;
<a name="sha3_shake256_test_vectors-last_expr"/><a name="2685"/> 2685:   {[%% SHAKE256 ShortMsg
<a name="2686"/> 2686:     hexstr2bin(&quot;&quot;),
<a name="2687"/> 2687:     hexstr2bin(&quot;0f&quot;),
<a name="2688"/> 2688:     hexstr2bin(&quot;0dc1&quot;),
<a name="2689"/> 2689:     hexstr2bin(&quot;a4d7897eaf5c49979b361c39a67f47e26c2f75e5ffe0645539d4de245138eb8cadaa45aef7fa0c7a732dbbce90c85be2bd4bf6e37dfb4fdebee4d0e0671fc45c3051c6ccb674799bcfda7a431a6e93b3db3e32f30636190a9a2e5620302876e0d4d2f6201353fac4554341df6efb591c6f100f5dc21a2aa176ba592bd7db69e14237bbf2371df6bbb072f9ecb1f714e621c97768d82eea6bf98ebf4a82c005262188ff894a5dd549866f88b00ee82bd99872515d71fac230ccb472c55a60&quot;),
<a name="2690"/> 2690:     hexstr2bin(&quot;104fefe89f08d15d36a2233f42a7defa917c5ad2642e06cac56d5cc51ad914ecfb7d984f4199b9cf5fa5a03bf69207b9a353a9681c9cf6437bea0c49d9c3e3db1f3fc76519c70c40cc1dfdd70a9c150943c272cf9eeb861f485f10100c8f4a3e259c6470501932782512225ba64d70b219cf9d5013a21d25d6d65062dcc6b3deb49d58b90d18933f118df70ff42c807ccc851233a34a221eca56b38971ef858475488988794a975d3894633a19c1ae2f05e9b9c0756affd3cfe823ccf29228f60fa7e025bc39a79943325126409460926b057a3fb28a1b098b938872883804fd2bc245d7fd6d29bcda6ca6198f2eff6ea7e03ef78133de8ba65fc8c45a688160719fa1e7646d878ea44c4b5c2e16f48b&quot;),
<a name="2691"/> 2691:     %% SHAKE256 LongMsg
<a name="2692"/> 2692:     hexstr2bin(&quot;dc5a100fa16df1583c79722a0d72833d3bf22c109b8889dbd35213c6bfce205813edae3242695cfd9f59b9a1c203c1b72ef1a5423147cb990b5316a85266675894e2644c3f9578cebe451a09e58c53788fe77a9e850943f8a275f830354b0593a762bac55e984db3e0661eca3cb83f67a6fb348e6177f7dee2df40c4322602f094953905681be3954fe44c4c902c8f6bba565a788b38f13411ba76ce0f9f6756a2a2687424c5435a51e62df7a8934b6e141f74c6ccf539e3782d22b5955d3baf1ab2cf7b5c3f74ec2f9447344e937957fd7f0bdfec56d5d25f61cde18c0986e244ecf780d6307e313117256948d4230ebb9ea62bb302cfe80d7dfebabc4a51d7687967ed5b416a139e974c005fff507a96&quot;),
<a name="2693"/> 2693:     hexstr2bin(&quot;8488b6b0a5cb3b778d9e6169cddfdd7468127361da571661589a51e95a0ae5c057ccb457cff0dd588fa4298131a7a6b3e201914668f279a06328a206d234a8b1da3f6425c3f913be44d3b58c006eb4615053c62743e41477e3939c68ba51d4a5954990c388cf25d13293cf30421b50a53a70daac74172f0f624207b81948b2c31153fed826585bb8e34d3d150096c2a729c0957c02711290679fab9df8018a34d5c3770da67efd9cdf67c8e442c75290a5abbf40f5dc05217b114fc05e64a4206903c30a0f2852a4ac4b38450e96488834991f9f553f4fea2500bdc8535947ae5679aa76693ea3f9d45f55df6eebebb660f27e422b813914edd4bb5ee0c8bc06238ff4f9bda738c2df0de75b69ae8443b01ea4d07e8c0bc75bf6122a0b994c5158ac683c124d592853bcb56007c75b56ac8559f257470d2af8cc8ad3deb43cb77e37d0e770174e53bad38897511eb818dd8f6550bd9a86664bbfea026101d75f1c9af2a2dfed5e6a9bbc28a84e9be3b1caa58f91b86dc0a2dc38fc5e9b696472ba3c961368b7d3957fde5d3a07272348fc2da05e50a80107349d869094d22a17e08586e5125df3feeda1eff582a8c205f991615e8e3492bdda57513f5426727717dd89bee6c807ca6d6da583c90806114b37973a79f7bbeb56cf2514e44b84b9e6ac6647eade562487aa4889e42d389479890d991adac3ba316cc9b74b2ba807d65ae62728882a32c4c0a0b2d9019fb50ced8a2477c5f451f29507cf91ac26866e4fd106a8afc91cab1875a3b26a859d8bcdd5839aa194d921b4a504bfb8456036f4ef8e71397c0bc5188f07775230747e90b75d8b54ec7947306c00db364fbdb6af07658a108b279829b6842ea0e9616e9ef85a50c8445aeb712468f00d8ac477e9e333fe1a3e97aeb4b1c2e13cf88ce25f6023f3e3e4a395df95e703273f9e000b49a1d241dd848f1f496a970da51e623bb6607c8f137dcde286231e6bb572d97b0256106baf15c1d3462459fd383f769ac4b8f1b31a101ce2c1c448c136698ba3d6fbc082fd73ce3970972ef3f816a7e450d45c37418309470c738a1108ab9dea8c38e86d0fc53eb88e6c1ed82fcc7c81235cc402d0fe1d7930d8eb43745f97b7eeb492142d3497b76a4b319223887ed905f732fe0fabdee0f59a7340c2ae0274c218c55f9fe863a0cada700a1c733354be4dad1246b0d6e422612aee3abf6488d10b8a36ac0829da77c4e22864b5255b15073d26bc358dee81d7193624bb485be336e8819ebc72cd39af8fd54275dc54d3cdea23ba638a64d8a24700c7c93355c041e728bb2ec5e1d74480f7fddbdfa9c046bdef886155b0f06abc356c12afde2fd38f134c83aa7e1b2abc77de11b6c0a41bbd736e58763891d881bb5bbd435ef994e92b98e6a90ccb094b3e2d3ce90347f4f397b470756682939d7cdcf3783de62efc56e97d4bf3b08b3633328700d871776544a1d0dba18d44185f37dcd4e3be46d07d8570179b9256843d341884a9e94f1d607ea130507893fb4bb39fe1b849876e89b5e8966d39123d467d17fddd782223d4930afadd0c274d2a996527254f96dd60c10d4ecf6c686a3553adf1dce6997d892834c3af11a916e331552d90971e25ecf106c92af5ff12f2ff02ea0efb5b35668547122e4fc05e5ec3987b62eac54f138dfc8fe79a813d64c83d6fdb7e115352f26a70c28e152e8397559904103362bfdc16266c2493f375f88609ab3962dd37b6c564d395508d3af5b510dcd11166d7277d18235adf3d0cd6073ee6f2f7ddfc1a8176c92d18846b24e06654f5076443b658ed72060d2211a9e599f472775a8966c62e0c1e151afe6dfd26d343bc62ebd1d02bc3eec5ab6dba4b9f3d818b5dc6e2bb150430f057db1834d5c084d96bb7c00d5c7ddbaedf06515fda2ae6dbed9bd589b21a2a5143ea6daffd858005848fca3607089670c6c5b549d1216b0e12f089578db4d6dfe714b3932589ffe9b75b3973b5cce4b4689230320c8bd6ccd4ad444e2f3cfa434a3f340bd634c92d0b0353eeed319022ce56084214d1f0bf3cba4f961f185f257454363c97eea578896f61cc379f6061fff786a07059818d51fff256e5b2cd2b6e3c0251f01f5d723787aa381b7e1e1a035ff275a88d51de1c6474b70a700c003fdde070692fb7c41f347858223690f4e37494e845d4275ba3d21fe015bce34aef2117c28b877c16495c1154d32f7f98a620b322ce95cdabf02f39f98efd1bb287eff16edd8d740fbbe8be55b7d1b2ad544a994acb3a09770b650b2cfe9a7cdf0e2eb49ce8aa66587fc1c7835485f3dcf6da8c89c42aa467fa5add9fecfdce7a8cc8a97632461b999dcd740535b108cd92b7d50742cd6622c7f8f77ae08dd92a0aa4182145ca5c791bf60d04dfbfba2733cbbcebcc8b16517a25a0e662b265988eaa49c8a99cefa00323d9a7dc15d192defd885eebcc7e9b19cb210bfbd4396b23c28391e4269cb75d3c2117b21d15b89d35838726f864a9aed1c210325b1e4cced410a480cf2d662f282d7bec3d4e3e775bf38f05779122401fcb1d90b0dce399c8362a05fe685483d145fc0fdf43cf7558219d10b1cdafd89d845c9c393bd78b863e4bf91d172a601eb1c2a56abd119d1255dad00fdff87d3335f3de5f03d1acf7702ee693008fcff7b8f4364684acf972d76dccf791a437c9250ade8afb78050113fc53c8ec2cd644a4ba48da60499160ee7f8cd2a95c0e479dca2523ec759d8d71dcc924a2a980edbb3d659019906bc5e3389909f0c70b95e55a3a909e6f7d84d0f7cf0fecadd2db46a514cf76289187febf7a022e8e359b45e3a53bd90fabcc7975edf190e0d6f48c1ade0040ba0b90873db7272b589542058def8a65fd314fb47dab3257eb9321d7c349893feddfc6c6d9d9dfaece31706c7f9fe709e017f3c837923a0976114b6dc8dfd33b6a171303bc67918198130ec3e23db98e6063a2ffcc29716e28595897522846fcd8bb5e850de9a76a5d430552dd5168bd261f439f64f8404daa72329d89ab4a49e0d18f95f5e88832c5c73b6199645c5cda52bef126880d70a364bfc794f048ec2a638d7b9ceb9ca17aa99a383efdfc332405fb3d3b60419dbc38e95d9b7fa6ab5d78427f297a4b7e21f1091ff3a5b20caa3fe1cbcb09459d9df596a6c8e1ce4f211995e9c51dfd9365a56f5de0e3e6ad17085ae2fd098038eda3b0eb419d26a0204d6e00975d1aa6ebcfb63b2e3ffedf11684ecbf9ea5935554b1e742e3b1865ff1cb50dc8c10a805e76c5010541636a4068a3cfe8333a5e7cf3c889b8430b68698e52587fd235e964a384f78c727d164e0f4234f26d8a790ba69672073e676f04ac2e29e51604a8a55ddb64ec59b4abe06613423e1fb04fa969707642b49343787d2fc82217dd87cbacb2924c7f71f0a173fe43f5d116a8ff463edf912bf9ac6e093e7c5d5d294c7b98f1c7d56a1aae3640ec7d3e0c234cb444e8f31d2d00718e59448fbe6e51c05f2a804cafa419ad4ad5c33942563f02716b56fb0e41105c7f7427476ed4bbab1f69476901b5d4b583386dbf283ad293dec4713e8cf09133ea62d1ed9517d1d5635e2f65f323b58e8973d057193d44c8a2561f06bec0ebbf762c28c85abdfa05d20f1e8aaf7822ff058ed6493de9fe67662a4999cc3b87c8ccd91622e6509d051486fd1e5a3b85d29f8f66dcbbc56638d146d840dfe9cb16937182416158249bd2cbb56a1ff545cdfe80675abc59e5058cb4b2431f51207074fd536ef25bf690b4e42cb6242dcab9cb68c309672ee4943e7cc1eab3fbef9f178473f1c1e37bab61db4c4a916b7c5dad506132e5cbc9ae90a4eb7dc36f9e6c230ec912f7771bb682b8fc6d8f38c3834d3f291c5db8fd1b2a361a437936979c41a43d19bca03e77be812368461a07f1523d0311f87ee9a3b3393585fbd740fa184cb74d37e44cb8be40ab83dd9bb0706553d757dea4f40ed4b6248b71da034d51101ff891cead3f29fc7b067c4326c82e878d3736b2852334b4cf9d04c8475c93f85d60f1e3c9d4a8be7b394d99d1c154e30df9283106ab7c3b1e03db2773f0870b5acd80ad0941e38d936475251a23806f3fe5dea8de6f5354f9042082f1d1d451fc8966b3d34d8171abce1f6f67b559320c437d9f7534620548eaf85e28c723d22cdbca7d90bf2b72abc07100214088345a5a309e33c55058f3fb8d45809a1c97d30ad494a96088997b82935fb18cb47d13731d2e80e9c655e28007be611166a7d75fae7f84f841ed045cae147d6186161dd66cd6c4676c03fdc08e5233f6aa0a22227dc68b4ffd762c96eaa8ef87a60662cb461f6708e96a2d0548875e0f8fc99a9b6cf2252c653ddc776ea26ec5bb55c89ad390d194e692589560e84a25beeb2911a08ab9582049fd48638a61e56d0b398a3ab16ad30a8467b9fcfa60ffde78b6ce4416b19cd7a37552f0e932ad66319ce4a40a9b8cfe4743b945470667987928187e1e74be32512eda3e4548e64bcfd8f13824ca8969e3d2dd6256a52394f56938762b6a86d85d0e2b75290b58c7ebd7f61f866190f461fe6d7bafa6fc79f4607656c4fbbe72ceff8cbc1ae3ca808f803e80b8c66a47c8aeb0badb6fbaf07ef51943728f2ca7ade8443ba238051ec2bb10844363df0920caef45616a25a09c106b67bc8e9a2001b09c1b4872d24a8d70b352ae9eb6e271397244c9fe04325599b2ea2a60ce85d241dc8494f9f7acf687701481e1b97cc4e581e09c92214db27837f4446d907d29824c9d0f363ceb08e98fef4593ae7c20b564406090429ab99642ab931eaab00d5b338f408f6bafc87c580d811b5e8d8e91628ea05f30c074d91a3a9ed9e2c786b4db81b06d4aa240291296bde391551561c5efe167b368eb2a09c7ed07026a9c758a9ce539a36a77d907b281520e7cbd0dd38dad10923a2572557b0911d0405887890869593caf75727d8756d09fab8e7ed5908bc297dd2a97477d795d15f2c1d020ecc437dd1a43ddbd40c3c50a8a919a122004e588fa028327f6c5559827df3996707c395052e8030f03519918c0cd4ad4639fe12e38b61c3d0d76602388bbaa35be1bc95c006ccbbaf886b591f64a776184e41e51404c4cd0eb13e57cbd5c0c43fb294ec8ccd81c0849ed7f3dd3110703a95b05b9b9cff92ab7244e6c6dcb4509522c305d5d33e03f1b0b60e40029e4fffb8dfc2d4c440d919a3202bb400e3fcfe9aed6e35c85fea8996ac14d249af4a0a1016c77a1b56f4ebcc46931e02fe0dde836aa2270d65e8be8910841e86d212dc33fbe5d5f2907a94462eb96f235127a784d13e1422fe83033089f88f4a951ed8bd058a82fa9bde95a94f0b12129bcefc17979ea7a9784dea058eceaef566e291f3ba420b83c795828e3e04b1212c685ea454403bf171adf5708592f817d5f2aa708088ca3ea233cd3d6232c70f817811b36ddf5b9b6927981a04c1e53250c354cc0eeb597bba3de86f6211ce1e4992e7ed6aa87117cd4f546a82f800d565d9535eabd643db8e18667c943e30ddc33d338ac14836f71c89bcda9691d57183a908c0edd5f3de8c67c9ed9ef489eebcdb7744084af7a9e57b23f2b62bdd7748b7076b4b66e3e54380754ae8e1539165023581b60d5db0a6784c3b482283871387b1d65b05be8022070b1ce89108867a25f0cc411bb3abde15782ce3125201829faa9a833ede4fc6700dcc3460233e5acb3b9c3002a3dc0ae74a400d77e387047344206a7ebda4af3fcfe152fb2e298566787a194e98f1ab42350d2dcf9278178730e06741e71f2aeaf3e4aabea3c8989c29de534c2d6d3ddabaecda85f9553a5fd3830024e52fe7f60c5ec2170e9bf2b0d24174a7bbbf41056e778a3772cefb71ce60cb94225754d56ba83fb0d9242259143c03ddde584356a235c360b915c9415412302c4916002da4695a089df1b6093236775b0fd8b333089ffc7e16fa2263370fc439a3ec6853491ac78ac7751c35eeb945abcaa12f4f042ebc0c36cca53bd9b1fe58dd5afbeacc24feb3e03ec3539c4cf54c8951f5ff275a8877730da05faec155165fe24958a020761062af5a06bd6a1cb9e65bd5c7d4bbc86c564dd23338965eeea602bf215785a42cd9573eb3d48912704c3f1d3daecb12377b0d895b19a9723e4a4cfbd964dd2f65beb6efef74328d0c357c5ac527f0fc853bbd543b948345a1a7115de55a8f7e578d5efc1e1eeec2ea3c840cf2b2d5cdc232edb1596bac3fa5570073d9ab25078ecfbfc1c427267a96bbf6a25ad1d22c7adb0f3f38e1acc6b5d49acc3ad9265157e04a0f764f621aae5e34c942278e8f0baea24c5eb8dd714faa30c56d571be26f899e03a8da3a197d7dded05d06537c111847673f33d6d5ff42630df5c77e4112061c6cd06a16fda0a545661000d96a17c25f1e5ef5215b3127b1f4788cb5e40bf055998171713d946f18d8efb978df8c1759e0326f458781d4ae174a296b4199c2ca183072d15fe525c9c76062ca42fa91e84b6e249bd17de3a7f50f1ff6f06817fa777200dfeb0f83c8aff6cf464acfcc5abe4697cccf61af400c2bf2f166d34a5725aa8dc5656fe396013731654d882151c7605b30d7e9c206cb1524e31b87e470a16e8c5a35a2dfc259965bbfd1b02b3de55fb1609172b65cc07f483484e270d789128ee6f234d2de179880ae5de464af96796cf472a8e6b27abeaf6e497f79ec3b5b07f411926749d9b252c9687148076961d034f1d8edb85857fd08cfbb6a3f368c7a1a2a47f7760e78348988035fd5cc9d7ddaa5af35dee7dfa39c9e22bc31194b67b192c22e13245ec87712f716ab3e80d82df4785986b7ba25822b41fa72420c6372e19d5581b9da611abfe8f6f84da081d764e0b350367c1561fd95af734f43cfa69d3618424d7fa0dcd5459b3d6890dd4f8d64fdbbf299d5a48baa45a4af863ef53c28e0f54db30a3609895dfb1dc67cfec461733a5a97e8d26bdc5786c14823b734f239eb49190fdeb340c9a1dbb5c37da082ce5c0d0ae17404b84faa530e00951e0eadc4ae16240f68f868d230e36344a8356981584741f1ecdaa88fa34c67f76dfa96e20b4ed970a11cb60cabd3bedc51f5cf4aeae17cd49a9ffc975087cc569b229ff3ef07a28ae22a2ba1bb1b48bd24408a39237e04a48494b661d944a04b2c33235aa7f511b6a2ad4431cd0e835fa5a204ac90517bea3135606fac17864da788cb86e47ba99c6912aa4d7032114c4c96d945c020451e371e85215754d0c683bfe319232fdca4bbf69855433a550b8fab7265214ee298fcac8f275991225e47351481c2761d5801d5c8d9a46be105e53c6abb3251f712f85bf8d221610d6d7874da4160d2fe2ed11ca65b126b17c3f3d61c9871cdd4f4c0c95cb25d28c48c8e1baee87ceb01b1b047ab5a1b9c9bee2215228d7e171eb6dc6125685b7d1a23fe860cd785129a6915f352472e94dfbcf655f71aa5c236e1a1bfdd34aac260dc40407eaf07ee5abd788c35a2d9c845e8f73514c09753a00db7320ed7d98d2b1e09d76ecf73d2b5376e9ec00dabcb70ca9b1ef60fb1400c83936414a25651eb51a1b767c957642c5f5e878be7f302f30a58903568821bbefbbcc29924afa5242fbe7cf42d311732adcef2e3b26e031f00c6253d5b884b49cea9ea06ef43fb67f0a6749e5b8f606aab465d720d6b4087465a3a986942533f84c126e862c1c9195cf04ab0e4d0e436c04b23b149894fbe538b6cb1123ec7f2b6b915a81f9792dabd226bf64993f7199543d22c07368516b0e02811d6ec2e25ccf842d07643ed0ea9c364b90a472da582d7054cb6f18532d6def95527b8da2b4fe51afc27453c37ab49a18397690c4d215b298de948c4954e0e5cd5a5437085a8262a85731a04e82a2bcee08187f782f966cb8a1ebad7b07ec4cf3da01a65c76e31de071a30eb82aef0395a591293e9638047abb7b61306f1b8ccd7d88c4e632a7ec1fb6d3834b9c22d6d4b7e9745d2f82e3a7d54c91b1b4f40d24e8f377edb458362ccec8e84dfdc39f74e6284a1f23fc710796672647fdff38bfc64aa9bb247d62d0628a2607785ac53edc5792ca9a2e1661a7d3063872c57368bd934196ab9fdad31a2223c13270b0f73e7e34a7bba13b7eaf981bcc3dcd27e575d827c7714505fd9d97c9c3568cc76ab7a317feafdc462757bf4b4d839fbdff982043969df74b1594f1ff540a37745eedd025179e67a122474f80016fc49b7ecb747d4a573e14e5a639acbd76f81f9a880c4539afcbb2372650a13226c32b2ab8dbbd2dc9a0c8337c76ba47c4572ee731605fae0a8fe3309dcb9626d324d4cb075deb8518a7cfc8bdb0103719dc0a0d90d25cbcd83b9bd453c647259c70fd286002ef9b6fdb926c12ef96d8a0101bd44c6d22ac415841eaf14c9c79a92e100a69d3b1b7f4c377e6233c34717e7ac9040d369ac66c6d3f3b1e627d6923e67439cdd71921cfe7e700979ed249dea37d647d37ac518202fc8f8312d23c3221917d3216102029cf4b80171e58a9e6119dbd42774197aa9fe0adc763833bfd65cf9e41997cfd2a04092f4ac3aed9be4e93d704fe3fde0dcd535f935e78aead3d9663a1674701f90d8bd5d995bd218fe2c57a6cd5906fd213bd6b8f0999dd692e4e95fa885771bf72373a6b9c6bc981539d6e21031a9222fa869a626ecf0f5ac25ffcf6059698a3bc7725a9e1a118bb2b817acc90c78e250916b4b595008da88031603be5eabdce72b2603a6b485766f1db6815857dad02c8d6812f8415a07af02c8971303d27671c4fb1c84246cfa92e12fea3e92635e2bf2cc97945f78ef89bb93f41ef761f9742b8e1f86f85c5ad698e051fc4a96fec7781533ae08c9f4c083e4953297ded866d54b874f9eb84992ab744301eeea349773ee81b5bbe1d9bbf25704ee63ad95b248bfde4e8625396faf5857f00dd192047c950c4c0744e1049d47cda2e952b3ff0c57aef45d179cc5fb08eb4715e189a708c53dc17967cd02db535a00a762a59586af53e171f3f62e35028767a59e9df79edb80c660bed06f32e624881c51fd2e4e237796636ed810e3d1b6d22b6d516ea5649fbb7bde9d824a9cd7a9c6a52d11c9608473afdcb5067df2f42715d22684c2ecc511193ba6e478d3cdd624d0b7f89ec2f509c5c20f8769f2c9d6f3618fc25dd0ab87d75a7f1e4427819db569203b24d763d933b36a0c3e3d925252a01fb00cbcbd6014bf789843049d70f6e2e861f22a3b628825371d714ff839a1f238c6260d753a8fdf35daebf76bf077b293059d17f626219c093399b665fd6fec8d8d504f5d87774e396ea57c978ca66c928e7c4d2ea49e9c52d71ded65fe2b03606e01fef0d78960f5bc06008ab60185797516164f5e5d8a9670847172ec51cb53f0c198b99b24cbed5b942fcffd2781aa42012fc2c3fcfb66a853df07287298fabdf5a92252d7f392c5c656d1d276d5c78db3e64375eb7325e70272bd431c10a71e34acb58f215c987313123ac67e1633a0a4c62bd4a76666b526f8efbcacb70baa05100db08f8b40ec10fe5559abb791336a6bf660cf69ab7b17ce2905a2e07ad9dd8f755770e42eb93657cc0c9e3e42be6b342dcab1d166d18b6ee3aead418736245796f4841bd43309cb194fc40eca9a2dbb5c42fd521b30c857ca280a4ea3377024ed182776b411e1d4a7939bcdbb6f286dec9a10504b11751526f2786c71665753e222d9a960ae74f0f198a3ef7795f1c879108950891c082394ae462f544b308110a529184c91299ca19f6af8a1b700576c46c6c72788f80f9dbc120bde4e9228e33f7447da42865412485f5dac3aeaa740bd5748d900db45ac9c5a9671e8f2a7f42279bcbc3b01a3de040f9309a9f71480e4c94a001c18424bdf8e33b1c2e8aaae2e77eb54f321f86f52ea3d3c8cdc3bc74d8b4f2f334591e5e63b781034da9d7b941d5827037dee40c58dc0d74c00996e582bccc8dec9c12550d0d80fe75efd06f3c887b4d46be1fcdc48a24c6fea99f0b519576f773b3c649ffce81322dc45cade07fe80fe727fedf7c9661e7110d9f8b4d25385a510802e33fe0cccafd90421b36a311dda2814beb88e90cff819b5e107e555ade0c0190cbd72da9ec6dbb4b6045da3de00035cc98ee6a6d35d4bda340ed0e23aa2e0837a8ce9c60c106ad3f24160db54088a94a8fb800cbb294da37c3a136dde73f84be222d1438704fcfe611af25c224c3468c77ee95709e4859e342a2b6cebcc5ddeee2fb7f7a21d18707cd1a08aab437745cf99610a22079a46d65f9773e524a7a8f9040c46ffe123e6c005fa0b51a6e9c80bdba58aa60ae229dd3ad6077d055c569d405cb5c2c9c5ddb5384d32d7bf024c16a6157d0876f3b3d35c658c05f6f254354517c8cd6f74a1d6d938b58024376e7a894f45bbd455713324d4960271e02e6bb2cbf4622a96ffaf893af80d4f1f8ba215a179529b6dee973491aa04fedc51baf9e7cd1383c3339998d27eb1c8214027abba8c4f44c38859fc2b3c80061d4a8d8b09b764138fda4fa88dbe1007c31865ebf9031458fceaf5fc0fc2061049855e069047d65233701c38cb3aca869b60f736fb524450606315b4cddef9b5d79ec6cd29f2ecb8748199ca297933dd00d6561d200e41c3949d23a6d3e7fd5f4e03327f155d09ceb98b42bd06fdde73a9d50d1f059bbf1b00059a52c0716385233f4b6d00cadffd88f9a1b2023d3cd2ece986bd2a9efecf4918f438f20fdecfedbf5c477ad0b1dd59592129a9bbd18340804d67fd6c9378c663cbda1717c188041fff7ec21331e6a1265b845bfe3efd4b35dbbffca91f700e528ba67e2dae461ccd9f7394e6d291f6edbb729788c7b97376bc15b6b8f57d9781ae3eb5c617928e34d6d661e01667d11bcb44eac01e404fdf6919aa30b7d9e86dbe034c557ff5df02101797836fe0b63d05abd448b51a46bc6d2c4594c91d77734584a07059d895a1e5a7c43551951cddf4e7d2970eafdeaa22de2759bbc0cb2eaf33608b37c33890c217669a6ded8b5b03b9641f8d999e3544afbde4025c6a1c85affb2a9c4e3e5b3fd70d1717627840cc711766d4300bca2d0177e83f68cab9535adeb2e9c21d6da977163fe09c7a3bb9af5af1553b8df55683e3cab54e738182b499d8b2c76c44b96810794be3e78855d4ad43a2e4bb235b9790002695eb01ae5d9af099d6917cca3a8a57dbd166d32b818cc22ff419f096ccfb2ce5d797c630b6809ee1783372666ef25ff2fd6e98952688115ec200c9b28493b5858c002bb44fb9382c14a8c21865d6f633c075453d441da5d1d7263b196ee81e881bcabea389c350fc4487f84acfb6cf10b301558e5acbf41bbbe0b145dc66dc600f4dfb79052d7db480576197fd002f0c5d996602eb01808ee8d6c8c26d9e739fef007ecf426612f7408daa6a8e41aaa918b3e335755cdfbdd66eee09930d88aa339894f0b1ebb5370d914f4ce3f9d6598cc759807a3c762b1d1f9da5dd226021656cfa97e45cd8f65008acb9aea716a0127a359e6a3ec859156f5401bc7bbe780cf3fc1f4a0802b7b05a6f2b4ec8001f521303c9d5c25aba67e4adb7a187d81082d43611639ba6ed971cf33c34db0719c44850ad4d65b1d18d0607323cc561ad7f7424f8c1764a2a8cc6c546f15eb041d17088a321a74240ed5a0d0bdeb2df814b5a454fd42670d0f9ce71e624d1800a1222286602f5a06b01370b9f17ee964e8f0d03812c3a9f7376ba75941fd1fae4fee3bc4061df30b271439f7678b74a67b2e30c372a114aa47c014cdb72be8565002bc0ecbed297d9b606453c61db506f4fa2bbdc5e48f6d682496416ae15a40cbe60b2a57a6e2a2337d5792b73994cc7bd929edb5950187c21e957f02265fb3e92392e0535008c418f57c7fe1e9f93f3a55921ce8ba54417c36794d2803def9d240b8fa67f4822972503ae1ed34cca856f5cf12065e6fe3bff4aa74847ec058adc5e43e3a9938196814f87f8223f54ffa414697b8863ab5b2e191bcbda2eb19a23b8076754712de22cb202249bc5d7c4cc26073a63c9dfe7e8494ec7b744883db29f368bf06f8bfc9fc1992e909ea7774ff856d778780084a651cce68febfe07d17a5ddc1dfd20385304b970b1285879b811e4fd370cb193f0d92282a473976b38dfe9c23d988f37dee1ef957de17f6e9ce91df64fd667a85035cc369579c8fa314666f8cfd02d7dabefa7f7475860a857048e6cf38397343cfe467ce37d2717533451ca45229f7c32847f30bdfbc0c98efa92bbf292d4ba1fa90db00eec1645273036c14e0e39a61b56d1bc3249f4349d11e78dad7284cc80bcae9a88453b2625b082784af1909dcecd4bf454d19f9c1a00e93c84a13bce08af9576e026ea1cc73bc159bc8b48d5b56e4a93962117427e3e145328ad7e4100084eef96ffc7bb94388fd02329a6c067906a045696efea423fe56c0a05a0c81f4d576f2d3e4865054d2a961f5b5ee06dfa06b146c1add60e7cf8e1993867c5bee53b700360e0bba2d03df5f1aeb5d83101cd34c72fc5982b7bbb5e66b427bc5766679cca162511e568468a4a726ffa493e0a09684fcbc331b2a92ce307552e7157683fe1bc8a2a558bc0cd9a74d1e92ef569a99a9024c9a9c84ee7aeb094aea52eb9e3dad284476ba1292a61f480075afe488fee9f653e0c1329191a4e5a9f6b62e92315e6a80bb04f0c4b219ffed7458f4346c4cc0172c139a43bc61f1b732c8a5278336769e99bfbd68a69c5a2fb774ed648cdb49e1a71925cca32c15bec710b924db3d34e63a72e04729b1410d678a37e1069d77f8785b3bf3ed0c3904dd16d253e07c8da0c6a5c329e45f9cceac233a73819b33a6c9614581430a45d29a63597a3bfa671364e0cdd67eae53bbadc65de1a5db6631bfb4a93f4c2c2170297eb46294bfac883dac6615a0a64e1c93fb0bf51b67f6e284dbd1f2b17cb626b0ef4dd391d442477990f6aff2507539854ba9758b47cd01405e23651902ea3c583f8b95dd4013983f15e56d1bb3b159ac3ca02a9c81d1d61ac6095f2dc5a6f948f5d56f1e0b05c3b7c19c15c4d7e8c5305858dcf71feca83b99eaa795cdd3a7a999952afd3e020f0b1f816f94c503c638273953442805c1cb622e06f822578ca2b3328e21e0f1c660b4fd453484eba2ec30ac562aa50367f1a63c44fecd1cf05ccc146333f9b92ee10a795d4b1c86a175fb17af519dd0e3d5ef7e2950d5081dfe6ba371da92448fb3a85b808296be0dfb10e3246218537da0c45b7c9642055ab1194780bfb1793301160c7681f97a2ca5f8797e051f747c7aae3b07771cfaee9d5d685789614061f1ddf507ef4da2489c3a3f84e1b81b2a8a3486909c6cce22e9bf6ebfe1a78160ab847dfb759b1da7085e9f009fee30cdf9dea5e0ad3a6b3ebec7c1806f8d247958930b19baead59110ec00b8e6c69baeee34febf518cb88a43fec962da1a12f42092092a6742b150dc6dca765f4a441592bffaf5306c9d4da1ebee2dcb5631192a0adef623ab992b95696400b28114490d060149f3e102d1ff1799a8e94a6a2f9f83f245972e75696366381e8673f19486917c8442f3cf5c8608309cddfda680a683addf6ad22d536deead9a8329c43c25e9d16ec4abec375d481dd14e77cb526894778c45a0aa31dc882b3b52aa768a14956acf221042aaae5fc60fe5c1c2ee0d3db813d09ed24bd7bd1ac89bfeedc6781dad6f042bb7fc9ed3951e4ae2749cbc07d83db2d68ee88713e30a052e13387c0a041610023477572ef0c524e2c8a49d783fd29450c7511414ecc93941cf2845e3d68bf1a0a26101f741cd1bcaa54dd91a559a1d1363cfa5489eccdf3f08ddfe308b974d0ae703c3b7efffd8a1f5e09875835cf6274ca8623661dd9e31a8a0cd7a8b02cd4aeda5c6f56221036f9fa5010f2fe2c694682474669ec21e1e96b9da473d9418669a8f323902fb443d8be43d72c3f23662a18d0360bb44080eba704e220b14d769d8082e0c37574112a1e57326a555ee9add2936ad222b0409fc0c51905c4cb1588e59e2f469fba5f6c9efccb13fd39544064236d4393fb91844d70a1b99024f3da4cb777b00b016f1eb4c709df733d366031e2b5d6a48d0427a17a24a28ff581f01a41529643e3c0cef428672373f520abc053cd11c0df090861541a5720b75078f2ce385fd6dc14ebd1a37b666bdb737194191b6b657c20850190db5dfed4efc35ad0a1734054ac03d1caaf3eb76adf602195397a2eeeeb5c16b3101d86f8a06db6db2676fcd8268588f08b03032da4e5fd4aaf9479a1b9cbf52d312c357d12d69b501fe178e0e50f4bd78769cb8e64718bbbd660d23f1c733181c6e096ecd7ac8cd226395109980faec23cc97d27ae91516b5655c501a3d0603339f137c24f4defd3b1e4f1bc9fe5365303a89463e3d3f2db97f9cea3b061e5c402d48497ea4948d75b8af7746d4e570c848daddd94a7c47f23a35b9ff2b656a6d9e0f9c8490d3c4f7b81cebb90a9a54137ff35ff418b5ad882190850bb3c277e07cd23fddc281eceaa6fe41caa6595b38663a9436b0d3a8a2b913160aa61cc9c14ef8f83242874b750bbc3f20b209cb608618444819bc7e688c2734a20c5da9399de9902b16ce29c16dc0ae643594edb265f636d15b5a77032135a67bee6c5f70f00ccf6f483dd0f55771553d38e109578d3a337a7f93dd9b00a3353e5331338dcfcb7ca7e0bb873a4e37fe54c2d86776864e03eb8c51f657b2daa99344946db8c28d617ae43295b8dc7a6f50db614e38d6986ecb8a7b0c60be43ca21c87d541b52bb44915e89439688a271db8b6408c507823cc282f965deac455f91e7d431db06bbee9355a8d9fdda17cc9adbc9db44a172347a7bb349f80547328aa9814c2367f62729d2779f145b424837d27810dd2ad21f987d9002d64fb309b5176ced19fcd4b6fbdcdddc049289ad5a795aeeba2c09c5c7907bd7a115f0adba387e5ce54dbe65b07bc5daf40855c2aad655bf002e7feeadbd590f81dc66e640159de0b0e21afaf1b714df0d430f50d0f452c9dab99c62f20b13f39d2e7d7befb4b2c3a244513e6599b33476cd1d1f73d83a566e54c8e83f8391cb1e929d36711fa64be2faccf9b5288a21582ee9f73c8cf3ace4876b4a3c2bbbdf2b912edd6b5e5fc1998cf2f3886d81eddbecd9a0d317671365daed4e900d7976edb298398877c76dee832af3876e81e2269157e1df817cd519d6b6bde331b4d98c7d43126d74c5960a65dec35a35704662a5ca8409d21c3927022e5edf9d52512f7a9830c55c408514bd7529a8ca3862b6ae9a4ff8132e86b7e6befb2a5b3d24fe32fd5a36382283351057ee1933bf7e4b362e0b544c9a05f30bcc5a6c735b9a222cdb5a680f52d695e8ebda567aefe249c4f080c78348fe01f8c2444eeb96fdc3f09bf605e9b8c65bcc9bb407a7aed5d7e14775f7c220b80935068177cdd5930807a3f7b2cf3c9db045cf46d4c0e6a01d139bb38c10097d344b02d9912100a61af85d2419c7c6a1bbdaed5663cf7e8c44e555032f76ee93a9c11c1441edfe7c214b2f47e2dc3e1ca5135ead5fdb5edf74dcdb2b88fab443911fbef9313bb95d44898326b5138c5495788a136eed6ee1d48296f33ea744d514ee4f5209121893ab39c08b38769892b492d94f380c96dc8d5eee25fa82869159b537e5707b03657fe34e3c160c4a1d29e8b42b6640be16c6f84c87639562bf89fcdd7b0f7c621ae80f9501f5dd8b3f1d02816da091ced8a8d916e322e7c1a6cb4cabdb8e201dfb0d46fda47ef2413eb869a9de8d08ae6a5b88b6ffde80898f482b08cf946c1d50170feeeb5852566321a49546d6ac4614068d92a34069a4c228245c1dc96a48612df3d0a02b05b0f6813bac6d23867e1ed2711499efa9f88792bc108ed721877578790b89a114393fffb7551a1b9c3fcfe6bba2a894486f26ae7d8aea6399c3d52029076f6086d785c49ffa1766f86f716bf3a697d74ff0e6a5ee33f918dbe2ca4c8b2c1910637412f87b022aada2f84a88a2872f5fc562119f9773829beece9a2428e3515ab4f72cc1d4d51c98a0c0a3664fad38d5b2afedc301b34f97da6d8dd18792dde680481c4a30dbb4cefcb1c32c82807ae01ebec33ab35926b2a8a9ed7b30a3865bcf4f2ab91a7cbcf8beb2f403c368bc291277da2c35cfd0945f680049ac7c1461a9f49d371720fabdecaa7c139bcdc85895c27cc0107b15e60794106482874fa2171fbfebb12f38c69083a48391176414b087ef1ecbc7bc50a91463f43a2affc320b8d6fe6f113cbab124b47c2eae59056aae7c6fee1a8f794bd041205dcfeb6fcda72b97d92ece425875f425f8fa6ed4cb1f6bdb02db540af8b0f41072dddc4c25d406df78eeb8068c5eaba779646d29dbc304898e74d4aab59cc3ed01bc9a023027aefed3bac1ad55c7232939521caba3808fa21a4cd7028c7cf5df92d3ed3af6896d1b73f8b0e0bb98a2d4bf2d45032a3f534d2ecb25ba8438d30dae8c9d9c80e0895ede124e46c7b971cf935eaed978e999b353598579a5b8a5a0dc4e71cfd5164bf09e6e63888012d8433d4b20d49664a9fb105ec0e7f8e5b3bfa582327cfd11fbf93b76b74def8c1e58455e629c8b9acb4eee429ead84a54493908ea84a01bbe1a03b90113e1a0d8d3534fe3eda5f7147d4746de77352e1a14425db9be2e8fa450e28263a020b7e6b0392927a361bd364b42a4863e0688213f9ecd1d3ebbab86e6b899ffb42cac801e9e584df57c6a76b179839da9dd06ee0da6ed8170e7fdca5dee7631aa65dd19710b73b35e668d5a42447a91352928f5010325931f3404e328fc9da5fd5ce8375a08f1f448a0a445704be01d7a6b4cbadc3c0bae74105f65da7b76c947825c5e2c0f698d3ecb2deccde85a7ee41400c3d1aa16502a0d4bc6e4e39817f36687e2898730eacb36b8a4bdb250520cc3d394a3e5cc04abab788acabd881eab8a1988d518ee995883a301b23258135efb43a1a5779358634b54260e71bd49ba6d7fa5a13cf91571329b985dd0d85f451acf7f58c812b80b9d6d2d2298be25aa7138cd605bf6fbafb3f0bd1326678269b2d572505fb0afeef23204a9aae13f1635c364b50e5e985e9840f4749b6c293744045f1eb6f39c97ea31410620fd02683bae0ff1bc968828401ad2e4b88cb0385eba6a0666522a90f5f976ba8337fc3af35723b8ff4557775bdced05f61fa3e7638637b9d662c654a5d8fa594a48a8e8ed6d447d4ed162d63c05873aecbb90bee2f64cab9f9bfc7d6a7e60450e95750c9a4ef6b113c156cf71335605f4d703495d791d5e1a743955c4582d1018a50d007a7a9ef6f6ab8fbd9bd4bdf9b70857f1438d2e33ef72098833d4d53d20fdbd8f1e8eb1a15fe69a4b0c684378aba61b5135a103df871bf98f4992dd4e901622e2f6e9e362b808f2d2437c6b253b56c9e3946312c369d865d56610c9a6ee84c9b6842a889db79915fdf17fb961fe90e012f031ff62004deae529bd1ee8a4a01e7446af35c4b70d902866e0a2c15ddb0a79d99c0e3df2d30549051641864b1e9da6df065f6a3edcedec445dbbc5e19b8592911fe3d9ba0e218b78aad6026a46c3c88dbe8a10c78d8ba3ea3568e212590dd7e72c04a7be65ec06f4f930ef5acf2d4403463a3ae9a5f609f9063e9878a9efb42c4ed54a8860a1462a70169fc50e36b3a02bd45b0dacb968d14ea17b8cf4c7d1e0f6fa14a0850de369adcba6018a7c9214de0cf3ac18525b038d35edb7c0129b95c2d7988f597e493300d494c8ca6b69b1eb38976d6f3d5b2030607181924c9bcb20f268ad446ef22727c5ee63548fa507c1eba8aa17e6d387e6b59982f1f23ce1afdef792dc7c78a671141569af65cea6f09ac9eaa8eb7edafeb9e83455900989bdf1b7d8981347417b539c54316a60eff5ca5db7a8c7976a06c1c01e43a27c13d9df3bd6edcfe888b4e905bb9129e6635ffee6898de7c7e59d71d38932a62f20820bf626740ec6dcac58c3f83500d9a18dbcf6e8cee88abe015e753da9177d3054ec793f915c8ccdc03769a293aba52b0d68f15df2365a53f0dc27841d72f0b3b105279aec3584ccaef969334366f3506d9788418e4da157ea6f8d051645243b34fa93b0db265969b7033532baef2eb21cdd0e4bf9bb0a3a3cad08291a1a82273f115039e4bb6515770960196090c1d0a98e05c5cafaff6b86091b68af4f85185dfdcf6eaf4152607d608c6feaf8573c724f01578889fb7c44f8496c2c60c77f002463e781648bdb28acfcae9082594625748379a8e488dd081f147c380aa3dbd419d03d01a18bd60733334e27cb429e21b2fe94b297221e3dd20f415889b4bf383276c7b664dcf197b7e2c6e73f9d95057ef5312c1e41b054b58c33e48a7489ab22ea20064af9ae689f6dc1755bd4db3f3ce9e77be67223eb3e2dcc82695ddbbb5f8cde77b05c7ce86e56a648ac82c13d615f20288c3de97fd06683b8c2fb15d74cd13b91219fdda5891fedd7ae21f79ea0b763c87c0f817120c8f1de13b6d88d7f79ffd93b1e511e843c10b8dd3ceeb16fa53ac232518c7d83c78f88d82b844c6bd973b6596267b1e42da752c62e0744228b0dbc5bce5ad38de4c53f8cc3b9a296624fcf0906920e2d872a4bd59fe1956deb64fd34b08d31a3932b78ae19d91e83b6dc69c6756091d4bb11eaa7ecfe43b648d92b79b2841679653abab888732eb849b24d1e2943db5e4be6d599afcdcd7025c2cd774eefe053dd7b7c38ba1841a89d59bf7caccc494ebc21834742c0913004ba39d9e0212de76e5633ab0928f5e9144b576e7a5a7a0a8e4a8a1d60874d8a5848170e00b85d989a53878c0035b9de50ff9b601c8edc3624da40a8637240c3b2c4db703b25fddbd40bde5829bf1c1ce60ef20e0dc9ee4632494d64d622198086e90dcd09ea9d45cde7be9c00358b0925c201a4b8ac3ebf192016df33174655570d1460c776ba5aca6f8ed40e29854792d130d0c7a62bf55bf7237404b245a695a985d82e7ab38f6c1be57cbe1ba93cdfb5062e953864ad7d26f9cfc59395e8e556e89f99473758157559129a8c457d4ed607fabbe3473bef48004ee02bc5b0a89d9323826ca44978f430122dec187d82ccace1a627622544c2ed7dfefb438261d63c00846b98d7e9112117e2bb60b1fdf16b5fde8533fdf03007d97c829dd2a39949b319c46387f8649280439adcbf12fcd9e1df7d4b3a8407f5ede3424325e07f32b7bcf7c2de29671ad7dadadae984476f04338ff64f72c31e27cdbab1e09ac08d9ae886054efe8110ab232bf9e5b4599133552de3b14efa0723866c98c75535b0b916efc95eea5b1a6686eea83815bbf6fbcee792046b05474db7d8361e822752aed2a57d926f4dae96a09364353ad6f6c9fb4d6fcd697d4522dc7e386ab41dd9f8a637906e0fe123b7facabc719643172a84bffb50ccda872f6edf0e306d91bd130c26b0664eae4046eff52f71ba78de99d5cfc35307a583efe96b2604012b827a7ee34bffae1d5ac00a932bba09f0c39478e&quot;),
<a name="2694"/> 2694:     %% SHAKE256 VariableOut
<a name="2695"/> 2695:     hexstr2bin(&quot;3e20cf32669fa3fd6e94e519b52a1dba33cd1f3a6947975e9829e4db326d2a18&quot;),
<a name="2696"/> 2696:     hexstr2bin(&quot;6ae23f058f0f2264a18cd609acc26dd4dbc00f5c3ee9e13ecaea2bb5a2f0bb6b&quot;),
<a name="2697"/> 2697:     hexstr2bin(&quot;e3ef127eadfafaf40408cebb28705df30b68d99dfa1893507ef3062d85461715&quot;),
<a name="2698"/> 2698:     hexstr2bin(&quot;afc9ef4e2e46c719120b68a65aa872273d0873fc6ea353859ff6f034443005e6&quot;),
<a name="2699"/> 2699:     hexstr2bin(&quot;8d8001e2c096f1b88e7c9224a086efd4797fbf74a8033a2d422a2b6b8f6747e4&quot;)
<a name="2700"/> 2700:    ],
<a name="2701"/> 2701:    [%% SHAKE256 ShortMsg
<a name="2702"/> 2702:     hexstr2bin(&quot;46b9dd2b0ba88d13233b3feb743eeb243fcd52ea62b81b82b50c27646ed5762f&quot;),
<a name="2703"/> 2703:     hexstr2bin(&quot;aabb07488ff9edd05d6a603b7791b60a16d45093608f1badc0c9cc9a9154f215&quot;),
<a name="2704"/> 2704:     hexstr2bin(&quot;8e2df9d379bb034aee064e965f960ebb418a9bb535025fb96427f678cf207877&quot;),
<a name="2705"/> 2705:     hexstr2bin(&quot;9510ff5231813a865918badd0011f05915364165492ef17b85929a63e4951589&quot;),
<a name="2706"/> 2706:     hexstr2bin(&quot;46293a63c235750d58a24edca5ba637b96cae74325c6c8122c4155c0d15805e6&quot;),
<a name="2707"/> 2707:     %% SHAKE256 LongMsg
<a name="2708"/> 2708:     hexstr2bin(&quot;2bac5716803a9cda8f9e84365ab0a681327b5ba34fdedfb1c12e6e807f45284b&quot;),
<a name="2709"/> 2709:     hexstr2bin(&quot;51b560fe5c3cc4c9e457e65f15f1b1619d18dbac916ca83a67a4d022301d5229&quot;),
<a name="2710"/> 2710:     %% SHAKE256 VariableOut
<a name="2711"/> 2711:     hexstr2bin(&quot;3389aea66244b91428f089&quot;),
<a name="2712"/> 2712:     hexstr2bin(&quot;b9b92544fb25cfe4ec6fe437d8da2bbe00f7bdaface3de97b8775a44d753c3adca3f7c6f183cc864&quot;),
<a name="2713"/> 2713:     hexstr2bin(&quot;7314002948c057006d4fc21e3e19c258fb5bdd57728fe93c9c6ef265b6d9f559ca73da32c427e135ba0db900d9003b19c9cf116f542a760418b1a435ac75ed5ab4ef151808c3849c3bce11c3cd285dd75e5c9fd0a0b32a89640a68e6e5b270f966f33911cfdffd03488b52b4c7fd1b2219de133e77519c426a63b9d8afac2ccab273ebd23765616b04446d6ac403f46ac0c147eda629eb7583c8bd00dc7c30fcd6711b36f99f80ac&quot;),
<a name="2714"/> 2714:     hexstr2bin(&quot;45c65255731e3679b4662f55b02bc5d1c8038a1d778fe91144a5c7d3a286c78c54f52135134a3c6a19a9e6e546de21b2e8a7e280290709f0e482a51bffa95137a381268d10195862818309b2a4954c656d1725c7ad1a29973162832d62afd538cf74e1b70d1775a9f77dc7c7380ea034f5b1869af46c1c26bce29e1980f0de9e55543e7eda19a56453c8b7d58a28ad7a33bc243c7242ffda5409cfd8f8ffd4b350c6d0023f27f93e9eb46a871367706170074d8a2080f0a8b68b8fc6b14b8b4da256e9e64dcb7771640e992eea2334e641&quot;),
<a name="2715"/> 2715:     hexstr2bin(&quot;2e975f6a8a14f0704d51b13667d8195c219f71e6345696c49fa4b9d08e9225d3d39393425152c97e71dd24601c11abcfa0f12f53c680bd3ae757b8134a9c10d429615869217fdd5885c4db174985703a6d6de94a667eac3023443a8337ae1bc601b76d7d38ec3c34463105f0d3949d78e562a039e4469548b609395de5a4fd43c46ca9fd6ee29ada5efc07d84d553249450dab4a49c483ded250c9338f85cd937ae66bb436f3b4026e859fda1ca571432f3bfc09e7c03ca4d183b741111ca0483d0edabc03feb23b17ee48e844ba2408d9dcfd0139d2e8c7310125aee801c61ab7900d1efc47c078281766f361c5e6111346235e1dc38325666c&quot;)
<a name="2716"/> 2716:    ],
<a name="2717"/> 2717:    [%% SHAKE256 ShortMsg
<a name="2718"/> 2718:     256,
<a name="2719"/> 2719:     256,
<a name="2720"/> 2720:     256,
<a name="2721"/> 2721:     256,
<a name="2722"/> 2722:     256,
<a name="2723"/> 2723:     %% SHAKE256 LongMsg
<a name="2724"/> 2724:     256,
<a name="2725"/> 2725:     256,
<a name="2726"/> 2726:     %% SHAKE256 VariableOut
<a name="2727"/> 2727:     88,
<a name="2728"/> 2728:     320,
<a name="2729"/> 2729:     1344,
<a name="2730"/> 2730:     1672,
<a name="2731"/> 2731:     2000
<a name="2732"/> 2732:    ]
<a name="2733"/> 2733:   }.
<a name="2734"/> 2734: 
<a name="sm3_test_vectors-0"/><a name="2735"/> 2735: <b>sm3_test_vectors</b>() -&gt;
<a name="2736"/> 2736:     %% test vectors comes from Examples (A.1 A.2) of GM/T 0004-2012
<a name="sm3_test_vectors-last_expr"/><a name="2737"/> 2737: <b>    {[&lt;&lt;&quot;abc&quot;&gt;&gt;, binary:copy</b>(&lt;&lt;&quot;abcd&quot;&gt;&gt;, 16)],
<a name="2738"/> 2738:      [hexstr2bin(&quot;66c7f0f462eeedd9d1f2d46bdc10e4e24167c4875cf2f7a2297da02b8f4ba8e0&quot;),
<a name="2739"/> 2739:       hexstr2bin(&quot;debe9ff92275b8a138604889c18e5a4d6fdb70e5387e5765293dcba39c0c5732&quot;)
<a name="2740"/> 2740:      ]}.
<a name="2741"/> 2741: 
<a name="2742"/> 2742: <i>%%% http://www.wolfgang-ehrhardt.de/hmac-sha3-testvectors.html</i>
<a name="2743"/> 2743: 
<a name="hmac_sha3-1"/><a name="2744"/> 2744: <b>hmac_sha3</b>(Type) -&gt;
<a name="2745"/> 2745:     N = case Type of
<a name="2746"/> 2746:             sha3_224 -&gt; 1;
<a name="2747"/> 2747:             sha3_256 -&gt; 2;
<a name="2748"/> 2748:             sha3_384 -&gt; 3;
<a name="2749"/> 2749:             sha3_512 -&gt; 4
<a name="2750"/> 2750:         end,
<a name="hmac_sha3-last_expr"/><a name="2751"/> 2751: <b>    [{hmac, Type, hexstr2bin</b>(Key), hexstr2bin(Data), hexstr2bin(element(N,Hmacs))} 
<a name="2752"/> 2752:      || {Key,Data,Hmacs} &lt;- hmac_sha3_data()].
<a name="2753"/> 2753: 
<a name="hmac_sha3_data-0"/><a name="2754"/> 2754: <b>hmac_sha3_data</b>() -&gt;    
<a name="hmac_sha3_data-last_expr"/><a name="2755"/> 2755:     [
<a name="2756"/> 2756:      {&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b 0b0b0b0b&quot;,
<a name="2757"/> 2757:       &quot;4869205468657265&quot;,
<a name="2758"/> 2758:       {&quot;3b16546bbc7be2706a031dcafd56373d 9884367641d8c59af3c860f7&quot;,
<a name="2759"/> 2759:        &quot;ba85192310dffa96e2a3a40e69774351 140bb7185e1202cdcc917589f95e16bb&quot;,
<a name="2760"/> 2760:        &quot;68d2dcf7fd4ddd0a2240c8a437305f61 fb7334cfb5d0226e1bc27dc10a2e723a 20d370b47743130e26ac7e3d532886bd&quot;,
<a name="2761"/> 2761:        &quot;eb3fbd4b2eaab8f5c504bd3a41465aac ec15770a7cabac531e482f860b5ec7ba 47ccb2c6f2afce8f88d22b6dc61380f2 3a668fd3888bb80537c0a0b86407689e&quot;
<a name="2762"/> 2762:       }},
<a name="2763"/> 2763: 
<a name="2764"/> 2764:      {&quot;4a656665&quot;,
<a name="2765"/> 2765:       &quot;7768617420646f2079612077616e7420 666f72206e6f7468696e673f&quot;,
<a name="2766"/> 2766:       {&quot;7fdb8dd88bd2f60d1b798634ad386811 c2cfc85bfaf5d52bbace5e66&quot;,
<a name="2767"/> 2767:        &quot;c7d4072e788877ae3596bbb0da73b887 c9171f93095b294ae857fbe2645e1ba5&quot;,
<a name="2768"/> 2768:        &quot;f1101f8cbf9766fd6764d2ed61903f21 ca9b18f57cf3e1a23ca13508a93243ce 48c045dc007f26a21b3f5e0e9df4c20a&quot;,
<a name="2769"/> 2769:        &quot;5a4bfeab6166427c7a3647b747292b83 84537cdb89afb3bf5665e4c5e709350b 287baec921fd7ca0ee7a0c31d022a95e 1fc92ba9d77df883960275beb4e62024&quot;
<a name="2770"/> 2770:        }},
<a name="2771"/> 2771: 
<a name="2772"/> 2772:      {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaa&quot;,
<a name="2773"/> 2773:       &quot;dddddddddddddddddddddddddddddddd dddddddddddddddddddddddddddddddd dddddddddddddddddddddddddddddddd dddd&quot;,
<a name="2774"/> 2774:       {&quot;676cfc7d16153638780390692be142d2 df7ce924b909c0c08dbfdc1a&quot;,
<a name="2775"/> 2775:        &quot;84ec79124a27107865cedd8bd82da996 5e5ed8c37b0ac98005a7f39ed58a4207&quot;,
<a name="2776"/> 2776:        &quot;275cd0e661bb8b151c64d288f1f782fb 91a8abd56858d72babb2d476f0458373 b41b6ab5bf174bec422e53fc3135ac6e&quot;,
<a name="2777"/> 2777:        &quot;309e99f9ec075ec6c6d475eda1180687 fcf1531195802a99b5677449a8625182 851cb332afb6a89c411325fbcbcd42af cb7b6e5aab7ea42c660f97fd8584bf03&quot;
<a name="2778"/> 2778:        }},
<a name="2779"/> 2779: 
<a name="2780"/> 2780:      {&quot;0102030405060708090a0b0c0d0e0f10 111213141516171819&quot;,
<a name="2781"/> 2781:       &quot;cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd cdcd&quot;,
<a name="2782"/> 2782:       {&quot;a9d7685a19c4e0dbd9df2556cc8a7d2a 7733b67625ce594c78270eeb&quot;,
<a name="2783"/> 2783:        &quot;57366a45e2305321a4bc5aa5fe2ef8a9 21f6af8273d7fe7be6cfedb3f0aea6d7&quot;,
<a name="2784"/> 2784:        &quot;3a5d7a879702c086bc96d1dd8aa15d9c 46446b95521311c606fdc4e308f4b984 da2d0f9449b3ba8425ec7fb8c31bc136&quot;,
<a name="2785"/> 2785:        &quot;b27eab1d6e8d87461c29f7f5739dd58e 98aa35f8e823ad38c5492a2088fa0281 993bbfff9a0e9c6bf121ae9ec9bb09d8 4a5ebac817182ea974673fb133ca0d1d&quot;
<a name="2786"/> 2786:        }},
<a name="2787"/> 2787: 
<a name="2788"/> 2788:      %% {&quot;0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c 0c0c0c0c&quot;,
<a name="2789"/> 2789:      %%  &quot;546573742057697468205472756e6361 74696f6e&quot;,
<a name="2790"/> 2790:      %%  {&quot;49fdd3abd005ebb8ae63fea946d1883c&quot;,
<a name="2791"/> 2791:      %%   &quot;6e02c64537fb118057abb7fb66a23b3c&quot;,
<a name="2792"/> 2792:      %%   &quot;47c51ace1ffacffd7494724682615783&quot;,
<a name="2793"/> 2793:      %%   &quot;0fa7475948f43f48ca0516671e18978c&quot;
<a name="2794"/> 2794:      %%   }},
<a name="2795"/> 2795: 
<a name="2796"/> 2796:      {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2797"/> 2797:       &quot;54657374205573696e67204c61726765 72205468616e20426c6f636b2d53697a 65204b6579202d2048617368204b6579 204669727374&quot;,
<a name="2798"/> 2798:       {&quot;b4a1f04c00287a9b7f6075b313d279b8 33bc8f75124352d05fb9995f&quot;,
<a name="2799"/> 2799:        &quot;ed73a374b96c005235f948032f09674a 58c0ce555cfc1f223b02356560312c3b&quot;,
<a name="2800"/> 2800:        &quot;0fc19513bf6bd878037016706a0e57bc 528139836b9a42c3d419e498e0e1fb96 16fd669138d33a1105e07c72b6953bcc&quot;,
<a name="2801"/> 2801:        &quot;00f751a9e50695b090ed6911a4b65524 951cdc15a73a5d58bb55215ea2cd839a c79d2b44a39bafab27e83fde9e11f634 0b11d991b1b91bf2eee7fc872426c3a4&quot;
<a name="2802"/> 2802:        }},
<a name="2803"/> 2803: 
<a name="2804"/> 2804:      {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2805"/> 2805:       &quot;54657374205573696e67204c61726765 72205468616e20426c6f636b2d53697a 65204b6579202d2048617368204b6579 204669727374&quot;,
<a name="2806"/> 2806:       {
<a name="2807"/> 2807:        &quot;b96d730c148c2daad8649d83defaa371 9738d34775397b7571c38515&quot;,
<a name="2808"/> 2808:        &quot;a6072f86de52b38bb349fe84cd6d97fb 6a37c4c0f62aae93981193a7229d3467&quot;,
<a name="2809"/> 2809:        &quot;713dff0302c85086ec5ad0768dd65a13 ddd79068d8d4c6212b712e4164944911 1480230044185a99103ed82004ddbfcc&quot;,
<a name="2810"/> 2810:        &quot;b14835c819a290efb010ace6d8568dc6 b84de60bc49b004c3b13eda763589451 e5dd74292884d1bdce64e6b919dd61dc 9c56a282a81c0bd14f1f365b49b83a5b&quot;
<a name="2811"/> 2811:       }},
<a name="2812"/> 2812: 
<a name="2813"/> 2813:      {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2814"/> 2814:       &quot;54686973206973206120746573742075 73696e672061206c6172676572207468 616e20626c6f636b2d73697a65206b65 7920616e642061206c61726765722074 68616e20626c6f636b2d73697a652064 6174612e20546865206b6579206e6565 647320746f2062652068617368656420 6265666f7265206265696e6720757365 642062792074686520484d414320616c 676f726974686d2e&quot;,
<a name="2815"/> 2815:       {
<a name="2816"/> 2816:        &quot;05d8cd6d00faea8d1eb68ade28730bbd 3cbab6929f0a086b29cd62a0&quot;,
<a name="2817"/> 2817:        &quot;65c5b06d4c3de32a7aef8763261e49ad b6e2293ec8e7c61e8de61701fc63e123&quot;,
<a name="2818"/> 2818:        &quot;026fdf6b50741e373899c9f7d5406d4e b09fc6665636fc1a530029ddf5cf3ca5 a900edce01f5f61e2f408cdf2fd3e7e8&quot;,
<a name="2819"/> 2819:        &quot;38a456a004bd10d32c9ab83366841128 62c3db61adcca31829355eaf46fd5c73 d06a1f0d13fec9a652fb3811b577b1b1 d1b9789f97ae5b83c6f44dfcf1d67eba&quot;
<a name="2820"/> 2820:        }},
<a name="2821"/> 2821: 
<a name="2822"/> 2822:      {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaa&quot;,
<a name="2823"/> 2823:       &quot;54686973206973206120746573742075 73696e672061206c6172676572207468 616e20626c6f636b2d73697a65206b65 7920616e642061206c61726765722074 68616e20626c6f636b2d73697a652064 6174612e20546865206b6579206e6565 647320746f2062652068617368656420 6265666f7265206265696e6720757365 642062792074686520484d414320616c 676f726974686d2e&quot;,
<a name="2824"/> 2824:       {
<a name="2825"/> 2825:        &quot;c79c9b093424e588a9878bbcb089e018 270096e9b4b1a9e8220c866a&quot;,
<a name="2826"/> 2826:        &quot;e6a36d9b915f86a093cac7d110e9e04c f1d6100d30475509c2475f571b758b5a&quot;,
<a name="2827"/> 2827:        &quot;cad18a8ff6c4cc3ad487b95f9769e9b6 1c062aefd6952569e6e6421897054cfc 70b5fdc6605c18457112fc6aaad45585&quot;,
<a name="2828"/> 2828:        &quot;dc030ee7887034f32cf402df34622f31 1f3e6cf04860c6bbd7fa488674782b46 59fdbdf3fd877852885cfe6e22185fe7 b2ee952043629bc9d5f3298a41d02c66&quot;
<a name="2829"/> 2829:        }}
<a name="2830"/> 2830:     %%,
<a name="2831"/> 2831: 
<a name="2832"/> 2832:     %%  {&quot;4a656665&quot;,
<a name="2833"/> 2833:     %%   &quot;'11001' or LSB 13 or MSB c8&quot;,
<a name="2834"/> 2834:     %%   {
<a name="2835"/> 2835:      %% &quot;5f8c0ea7fafecd0c3463aad09742cece  b142fe0ab6f4539438c59de8&quot;,
<a name="2836"/> 2836:      %% &quot;ec8222773fac68b3d3dcb182aec8b050  7ace4448d20a1147e682118da4e3f44c&quot;,
<a name="2837"/> 2837:      %% &quot;21fbd3bf3ebba3cfc9ef64c0591c92c5  acb265e92d8761d1f91a52a103a6c796  94cfd67a9a2ac1324f02fea63b81effc&quot;,
<a name="2838"/> 2838:      %% &quot;27f9388c1567ef4ef200602a6cf871d6  8a6fb048d4737ac4418a2f021289d13d  1fd1120fecb9cf964c5b117ab5b11c61  4b2da39dadd51f2f5e22aaccec7d576e&quot;
<a name="2839"/> 2839:      %%   }}
<a name="2840"/> 2840:     ].
<a name="2841"/> 2841: 
<a name="2842"/> 2842: 
<a name="2843"/> 2843: 
<a name="rfc_4634_test1-0"/><a name="2844"/> 2844: <b>rfc_4634_test1</b>() -&gt;
<a name="rfc_4634_test1-last_expr"/><a name="2845"/> 2845:     &lt;&lt;&quot;abc&quot;&gt;&gt;.
<a name="rfc_4634_test2_1-0"/><a name="2846"/> 2846: <b>rfc_4634_test2_1</b>() -&gt;
<a name="rfc_4634_test2_1-last_expr"/><a name="2847"/> 2847:     &lt;&lt;&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;&gt;&gt;.
<a name="rfc_4634_test2_2a-0"/><a name="2848"/> 2848: <b>rfc_4634_test2_2a</b>() -&gt;
<a name="rfc_4634_test2_2a-last_expr"/><a name="2849"/> 2849:     &lt;&lt;&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn&quot;&gt;&gt;.
<a name="rfc_4634_test2_2b-0"/><a name="2850"/> 2850: <b>rfc_4634_test2_2b</b>() -&gt;
<a name="rfc_4634_test2_2b-last_expr"/><a name="2851"/> 2851:     &lt;&lt;&quot;hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;&gt;&gt;.
<a name="rfc_4634_test2-0"/><a name="2852"/> 2852: <b>rfc_4634_test2</b>() -&gt;
<a name="2853"/> 2853:     A2 =rfc_4634_test2_2a(),
<a name="2854"/> 2854:     B2 = rfc_4634_test2_2b(),
<a name="rfc_4634_test2-last_expr"/><a name="2855"/> 2855:     &lt;&lt;A2/binary, B2/binary&gt;&gt;.
<a name="2856"/> 2856:  
<a name="rfc_4634_sha_digests-0"/><a name="2857"/> 2857: <b>rfc_4634_sha_digests</b>()-&gt;
<a name="rfc_4634_sha_digests-last_expr"/><a name="2858"/> 2858: <b>     [hexstr2bin</b>(&quot;A9993E364706816ABA3E25717850C26C9CD0D89D&quot;),
<a name="2859"/> 2859:       hexstr2bin(&quot;84983E441C3BD26EBAAE4AA1F95129E5E54670F1&quot;)].
<a name="rfc_4634_sha224_digests-0"/><a name="2860"/> 2860: <b>rfc_4634_sha224_digests</b>() -&gt;
<a name="rfc_4634_sha224_digests-last_expr"/><a name="2861"/> 2861: <b>     [hexstr2bin</b>(&quot;23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7E36C9DA7&quot;),
<a name="2862"/> 2862:       hexstr2bin(&quot;75388B16512776CC5DBA5DA1FD890150B0C6455CB4F58B1952522525&quot;)].
<a name="rfc_4634_sha256_digests-0"/><a name="2863"/> 2863: <b>rfc_4634_sha256_digests</b>() -&gt;
<a name="rfc_4634_sha256_digests-last_expr"/><a name="2864"/> 2864:     [
<a name="2865"/> 2865:      hexstr2bin(&quot;BA7816BF8F01CFEA4141&quot;
<a name="2866"/> 2866: 		&quot;40DE5DAE2223B00361A396177A9CB410FF61F20015AD&quot;),
<a name="2867"/> 2867:      hexstr2bin(&quot;248D6A61D20638B8&quot;
<a name="2868"/> 2868: 		&quot;E5C026930C3E6039A33CE45964FF2167F6ECEDD419DB06C1&quot;)
<a name="2869"/> 2869:     ].
<a name="rfc_4634_sha384_digests-0"/><a name="2870"/> 2870: <b>rfc_4634_sha384_digests</b>() -&gt;
<a name="rfc_4634_sha384_digests-last_expr"/><a name="2871"/> 2871: <b>    [hexstr2bin</b>(&quot;CB00753F45A35E8BB5A03D699AC65007272C32AB0EDED1631A8B605A43FF5BED8086072BA1E7CC2358BAECA134C825A7&quot;),
<a name="2872"/> 2872:      hexstr2bin(&quot;09330C33F71147E83D192FC782CD1B4753111B173B3B05D22FA08086E3B0F712FCC7C71A557E2DB966C3E9FA91746039&quot;)
<a name="2873"/> 2873:     ].
<a name="rfc_4634_sha512_digests-0"/><a name="2874"/> 2874: <b>rfc_4634_sha512_digests</b>() -&gt; 
<a name="rfc_4634_sha512_digests-last_expr"/><a name="2875"/> 2875: <b>    [hexstr2bin</b>(&quot;DDAF35A193617ABACC417349AE20413112E6FA4E89A97EA2&quot;
<a name="2876"/> 2876: 		&quot;0A9EEEE64B55D39A2192992A274FC1A836BA3C23A3FEEBBD&quot;
<a name="2877"/> 2877: 		&quot;454D4423643CE80E2A9AC94FA54CA49F&quot;),
<a name="2878"/> 2878:      hexstr2bin(&quot;8E959B75DAE313DA8CF4F72814FC143F8F7779C6EB9F7FA17299AEADB6889018501D289E4900F7E4331B99DEC4B5433AC7D329EEB6DD26545E96E55B874BE909&quot;)].
<a name="2879"/> 2879: 
<a name="long_msg-0"/><a name="2880"/> 2880: <b>long_msg</b>() -&gt;
<a name="long_msg-last_expr"/><a name="2881"/> 2881: <b>    fun</b>() -&gt; lists:duplicate(1000000, $a) end.
<a name="2882"/> 2882: 
<a name="2883"/> 2883: <i>%% Passing huge terms (like long_msg/0) through config causes excessive memory</i>
<a name="2884"/> 2884: <i>%% consumption and long runtimes in the test server. This results in test_server</i>
<a name="2885"/> 2885: <i>%% crash with 'no_answer_from_tc_supervisor' sometimes on some machines.</i>
<a name="2886"/> 2886: <i>%% Therefore lazy evaluation when test case has started.</i>
<a name="lazy_eval-1"/><a name="2887"/> 2887: <b>lazy_eval</b>(F) when is_function(F) -&gt; F();
<a name="2888"/> 2888: <b>lazy_eval</b>(Lst)  when is_list(Lst) -&gt; lists:map(fun lazy_eval/1, Lst);
<a name="2889"/> 2889: <b>lazy_eval</b>(Tpl) when is_tuple(Tpl) -&gt; list_to_tuple(lists:map(fun lazy_eval/1, tuple_to_list(Tpl)));
<a name="lazy_eval-last_expr"/><a name="2890"/> 2890: <b>lazy_eval</b>(Term) -&gt; Term.
<a name="2891"/> 2891: 
<a name="long_sha_digest-0"/><a name="2892"/> 2892: <b>long_sha_digest</b>() -&gt;
<a name="long_sha_digest-last_expr"/><a name="2893"/> 2893: <b>    hexstr2bin</b>(&quot;34aa973c&quot; &quot;d4c4daa4&quot; &quot;f61eeb2b&quot; &quot;dbad2731&quot; &quot;6534016f&quot;).
<a name="2894"/> 2894: 
<a name="long_sha256_digest-0"/><a name="2895"/> 2895: <b>long_sha256_digest</b>() -&gt;
<a name="long_sha256_digest-last_expr"/><a name="2896"/> 2896: <b>    hexstr2bin</b>(&quot;cdc76e5c&quot; &quot;9914fb92&quot; &quot;81a1c7e2&quot; &quot;84d73e67&quot; &quot;f1809a48&quot; &quot;a497200e&quot; &quot;046d39cc&quot; &quot;c7112cd0&quot;).
<a name="2897"/> 2897: 
<a name="long_sha384_digest-0"/><a name="2898"/> 2898: <b>long_sha384_digest</b>() -&gt;
<a name="long_sha384_digest-last_expr"/><a name="2899"/> 2899: <b>    hexstr2bin</b>(&quot;9d0e1809716474cb&quot; &quot;086e834e310a4a1c&quot; &quot;ed149e9c00f24852&quot; &quot;7972cec5704c2a5b&quot;
<a name="2900"/> 2900: 	       &quot;07b8b3dc38ecc4eb&quot; &quot;ae97ddd87f3d8985&quot;).
<a name="2901"/> 2901: 
<a name="long_sha512_digest-0"/><a name="2902"/> 2902: <b>long_sha512_digest</b>() -&gt;
<a name="long_sha512_digest-last_expr"/><a name="2903"/> 2903: <b>    hexstr2bin</b>(&quot;e718483d0ce76964&quot; &quot;4e2e42c7bc15b463&quot; &quot;8e1f98b13b204428&quot; &quot;5632a803afa973eb&quot;
<a name="2904"/> 2904: 	       &quot;de0ff244877ea60a&quot; &quot;4cb0432ce577c31b&quot; &quot;eb009c5c2c49aa2e&quot; &quot;4eadb217ad8cc09b&quot;).
<a name="2905"/> 2905: 
<a name="ripemd160_msgs-0"/><a name="2906"/> 2906: <b>ripemd160_msgs</b>() -&gt;
<a name="ripemd160_msgs-last_expr"/><a name="2907"/> 2907:     [&lt;&lt;&quot;&quot;&gt;&gt;,
<a name="2908"/> 2908:      &lt;&lt;&quot;a&quot;&gt;&gt;,
<a name="2909"/> 2909:      &lt;&lt;&quot;abc&quot;&gt;&gt;,
<a name="2910"/> 2910:      &lt;&lt;&quot;message digest&quot;&gt;&gt;,
<a name="2911"/> 2911:      &lt;&lt;&quot;abcdefghijklmnopqrstuvwxyz&quot;&gt;&gt;,
<a name="2912"/> 2912:      &lt;&lt;&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;&gt;&gt;,
<a name="2913"/> 2913:      &lt;&lt;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;&gt;&gt;
<a name="2914"/> 2914:     ].
<a name="2915"/> 2915: 
<a name="ripemd160_digests-0"/><a name="2916"/> 2916: <b>ripemd160_digests</b>() -&gt;
<a name="ripemd160_digests-last_expr"/><a name="2917"/> 2917: <b>    [hexstr2bin</b>(&quot;9c1185a5c5e9fc54612808977ee8f548b2258d31&quot;),
<a name="2918"/> 2918:      hexstr2bin(&quot;0bdc9d2d256b3ee9daae347be6f4dc835a467ffe&quot;),
<a name="2919"/> 2919:      hexstr2bin(&quot;8eb208f7e05d987a9b044a8e98c6b087f15a0bfc&quot;),
<a name="2920"/> 2920:      hexstr2bin(&quot;5d0689ef49d2fae572b881b123a85ffa21595f36&quot;),
<a name="2921"/> 2921:      hexstr2bin(&quot;f71c27109c692c1b56bbdceb5b9d2865b3708dbc&quot;),
<a name="2922"/> 2922:      hexstr2bin(&quot;12a053384a9c0c88e405a06c27dcf49ada62eb2b&quot;),
<a name="2923"/> 2923:      hexstr2bin(&quot;b0e20b6e3116640286ed3a87a5713079b21f5189&quot;)
<a name="2924"/> 2924:     ].
<a name="2925"/> 2925: 
<a name="ripemd160_incr_msgs-0"/><a name="2926"/> 2926: <b>ripemd160_incr_msgs</b>() -&gt;
<a name="ripemd160_incr_msgs-last_expr"/><a name="2927"/> 2927:      [&lt;&lt;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefg&quot;&gt;&gt;,&lt;&lt;&quot;hijklmnopqrstuvwxyz0123456789&quot;&gt;&gt;].
<a name="ripemd160_incr_digest-0"/><a name="2928"/> 2928: <b>ripemd160_incr_digest</b>() -&gt;
<a name="ripemd160_incr_digest-last_expr"/><a name="2929"/> 2929: <b>    hexstr2bin</b>(&quot;b0e20b6e3116640286ed3a87a5713079b21f5189&quot;).
<a name="2930"/> 2930: 
<a name="rfc_2202_md5_keys-0"/><a name="2931"/> 2931: <b>rfc_2202_md5_keys</b>() -&gt;
<a name="rfc_2202_md5_keys-last_expr"/><a name="2932"/> 2932: <b>    [binary:copy</b>(&lt;&lt;16#0b&gt;&gt;, 16),
<a name="2933"/> 2933:      &lt;&lt;&quot;Jefe&quot;&gt;&gt;,
<a name="2934"/> 2934:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 16),
<a name="2935"/> 2935:      list_to_binary(lists:seq(1, 16#19)),
<a name="2936"/> 2936:      binary:copy(&lt;&lt;16#0c&gt;&gt;, 16),
<a name="2937"/> 2937:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 80),
<a name="2938"/> 2938:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 80)].
<a name="2939"/> 2939: 
<a name="rfc_2202_sha_keys-0"/><a name="2940"/> 2940: <b>rfc_2202_sha_keys</b>() -&gt;
<a name="rfc_2202_sha_keys-last_expr"/><a name="2941"/> 2941: <b>    [binary:copy</b>(&lt;&lt;16#0b&gt;&gt;, 20),
<a name="2942"/> 2942:      &lt;&lt;&quot;Jefe&quot;&gt;&gt;,
<a name="2943"/> 2943:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 20),
<a name="2944"/> 2944:      list_to_binary(lists:seq(1, 16#19)),
<a name="2945"/> 2945:      binary:copy(&lt;&lt;16#0c&gt;&gt;, 20),
<a name="2946"/> 2946:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 80),
<a name="2947"/> 2947:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 80)].
<a name="2948"/> 2948: 
<a name="rfc_2202_msgs-0"/><a name="2949"/> 2949: <b>rfc_2202_msgs</b>()-&gt;
<a name="rfc_2202_msgs-last_expr"/><a name="2950"/> 2950:     [&lt;&lt;&quot;Hi There&quot;&gt;&gt;,
<a name="2951"/> 2951:      &lt;&lt;&quot;what do ya want for nothing?&quot;&gt;&gt;,
<a name="2952"/> 2952:      binary:copy(&lt;&lt;16#dd&gt;&gt;, 50),
<a name="2953"/> 2953:      binary:copy(&lt;&lt;16#cd&gt;&gt;, 50),
<a name="2954"/> 2954:      &lt;&lt;&quot;Test With Truncation&quot;&gt;&gt;,
<a name="2955"/> 2955:      &lt;&lt;&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;&gt;&gt;,
<a name="2956"/> 2956:      &lt;&lt;&quot;Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data&quot;&gt;&gt;
<a name="2957"/> 2957:     ].
<a name="2958"/> 2958: 
<a name="hmac_key-1"/><a name="2959"/> 2959: <b>hmac_key</b>(md5) -&gt;
<a name="2960"/> 2960:     [&lt;&lt;&quot;A fine speach&quot;&gt;&gt;, &lt;&lt;&quot;by a fine man!&quot;&gt;&gt;];
<a name="2961"/> 2961: <b>hmac_key</b>(_) -&gt;
<a name="hmac_key-last_expr"/><a name="2962"/> 2962: <b>    hexstr2bin</b>(&quot;00010203101112132021222330313233&quot;
<a name="2963"/> 2963: 	       &quot;04050607141516172425262734353637&quot;
<a name="2964"/> 2964: 	       &quot;08090a0b18191a1b28292a2b38393a3b&quot;
<a name="2965"/> 2965: 	       &quot;0c0d0e0f1c1d1e1f2c2d2e2f3c3d3e3f&quot;).
<a name="hmac_inc-1"/><a name="2966"/> 2966: <b>hmac_inc</b>(_) -&gt;
<a name="hmac_inc-last_expr"/><a name="2967"/> 2967:     [&lt;&lt;&quot;Sampl&quot;&gt;&gt;, &lt;&lt;&quot;e #1&quot;&gt;&gt;].
<a name="2968"/> 2968: 
<a name="2969"/> 2969: 
<a name="cmac_key-1"/><a name="2970"/> 2970: <b>cmac_key</b>(SubType) -&gt;
<a name="cmac_key-last_expr"/><a name="2971"/> 2971: <b>    rand:bytes</b>(
<a name="2972"/> 2972:       maps:get(key_length, crypto:cipher_info(SubType))).
<a name="2973"/> 2973: 
<a name="cmac_inc-1"/><a name="2974"/> 2974: <b>cmac_inc</b>(_) -&gt;
<a name="cmac_inc-last_expr"/><a name="2975"/> 2975:     [&lt;&lt;&quot;Sampl&quot;&gt;&gt;, &lt;&lt;&quot;e #1&quot;&gt;&gt;].
<a name="2976"/> 2976: 
<a name="2977"/> 2977: 
<a name="2978"/> 2978: <i>%% https://www.cosic.esat.kuleuven.be/nessie/testvectors/</i>
<a name="long_hmac_key-1"/><a name="2979"/> 2979: <b>long_hmac_key</b>(Type) when Type == sha384;
<a name="2980"/> 2980: 			 Type == sha512 -&gt;
<a name="2981"/> 2981:     hexstr2bin(&quot;00112233445566778899AABBCCDDEEFF&quot;
<a name="2982"/> 2982: 	       &quot;0123456789ABCDEF0011223344556677&quot;
<a name="2983"/> 2983: 	       &quot;8899AABBCCDDEEFF0123456789ABCDEF&quot;
<a name="2984"/> 2984: 	       &quot;00112233445566778899AABBCCDDEEFF&quot;);
<a name="2985"/> 2985: <b>long_hmac_key</b>(_) -&gt;
<a name="long_hmac_key-last_expr"/><a name="2986"/> 2986: <b>    hexstr2bin</b>(&quot;0123456789ABCDEF0123456789ABCDEF&quot;
<a name="2987"/> 2987: 	       &quot;0123456789ABCDEF0123456789ABCDEF&quot;
<a name="2988"/> 2988: 	       &quot;0123456789ABCDEF0123456789ABCDEF&quot;
<a name="2989"/> 2989: 	       &quot;0123456789ABCDEF0123456789ABCDEF&quot;).
<a name="long_hmac-1"/><a name="2990"/> 2990: <b>long_hmac</b>(md5) -&gt;
<a name="2991"/> 2991:     hexstr2bin(&quot;82FDDA30202CB6ACC6F24D4F8A50EB7A&quot;);
<a name="2992"/> 2992: <b>long_hmac</b>(sha) -&gt;
<a name="2993"/> 2993:     hexstr2bin(&quot;61D1D0B6459860755FDA892938C23DD401E54A7E&quot;);
<a name="2994"/> 2994: <b>long_hmac</b>(sha256) -&gt;
<a name="2995"/> 2995:     hexstr2bin(&quot;50008B8DC7ED3926936347FDC1A01E9D&quot;
<a name="2996"/> 2996: 	       &quot;5220C6CC4B038B482C0F28A4CD88CA37&quot;);
<a name="2997"/> 2997: <b>long_hmac</b>(sha384) -&gt;
<a name="2998"/> 2998:     hexstr2bin(&quot;C1EB08DAFA015833D3FC6B29A387558B&quot;
<a name="2999"/> 2999: 	       &quot;3F6FA1524AA1A8EB64798D5A76A39D6E&quot;
<a name="3000"/> 3000: 	       &quot;A1465525342E060EE996277B4FFCDDC9&quot;);
<a name="3001"/> 3001: <b>long_hmac</b>(sha512) -&gt;
<a name="long_hmac-last_expr"/><a name="3002"/> 3002: <b>    hexstr2bin</b>(&quot;D116BF471AAE1264854F1906025E846A&quot;
<a name="3003"/> 3003: 	       &quot;61618A965FCA30B695220EA2D6E547E3&quot;
<a name="3004"/> 3004: 	       &quot;F3B5A4B54E6778928C26D5D3D810498E&quot;
<a name="3005"/> 3005: 	       &quot;8DF86CB3CC1E9F66A00419B13B6B0C9A&quot;).
<a name="3006"/> 3006: 
<a name="rfc_2202_hmac_md5-0"/><a name="3007"/> 3007: <b>rfc_2202_hmac_md5</b>() -&gt;
<a name="rfc_2202_hmac_md5-last_expr"/><a name="3008"/> 3008:     [
<a name="3009"/> 3009:      hexstr2bin(&quot;9294727a3638bb1c13f48ef8158bfc9d&quot;),
<a name="3010"/> 3010:      hexstr2bin(&quot;750c783e6ab0b503eaa86e310a5db738&quot;),
<a name="3011"/> 3011:      hexstr2bin(&quot;56be34521d144c88dbb8c733f0e8b3f6&quot;),
<a name="3012"/> 3012:      hexstr2bin(&quot;697eaf0aca3a3aea3a75164746ffaa79&quot;),
<a name="3013"/> 3013:      hexstr2bin(&quot;56461ef2342edc00f9bab995690efd4c&quot;),
<a name="3014"/> 3014:      hexstr2bin(&quot;6b1ab7fe4bd7bf8f0b62e6ce61b9d0cd&quot;),
<a name="3015"/> 3015:      hexstr2bin(&quot;6f630fad67cda0ee1fb1f562db3aa53e&quot;)
<a name="3016"/> 3016:     ].
<a name="3017"/> 3017: 
<a name="rfc_2202_hmac_sha-0"/><a name="3018"/> 3018: <b>rfc_2202_hmac_sha</b>() -&gt;
<a name="rfc_2202_hmac_sha-last_expr"/><a name="3019"/> 3019:     [
<a name="3020"/> 3020:      hexstr2bin(&quot;b617318655057264e28bc0b6fb378c8ef146be00&quot;),
<a name="3021"/> 3021:      hexstr2bin(&quot;effcdf6ae5eb2fa2d27416d5f184df9c259a7c79&quot;),
<a name="3022"/> 3022:      hexstr2bin(&quot;125d7342b9ac11cd91a39af48aa17b4f63f175d3&quot;),
<a name="3023"/> 3023:      hexstr2bin(&quot;4c9007f4026250c6bc8414f9bf50c86c2d7235da&quot;),
<a name="3024"/> 3024:      hexstr2bin(&quot;4c1a03424b55e07fe7f27be1d58bb9324a9a5a04&quot;),
<a name="3025"/> 3025:      hexstr2bin(&quot;aa4ae5e15272d00e95705637ce8a3b55ed402112&quot;),
<a name="3026"/> 3026:      hexstr2bin(&quot;e8e99d0f45237d786d6bbaa7965c7808bbff1a91&quot;)
<a name="3027"/> 3027:     ].
<a name="3028"/> 3028: 
<a name="3029"/> 3029: 
<a name="rfc_4231_keys-0"/><a name="3030"/> 3030: <b>rfc_4231_keys</b>() -&gt;
<a name="rfc_4231_keys-last_expr"/><a name="3031"/> 3031: <b>    [binary:copy</b>(&lt;&lt;16#0b&gt;&gt;, 20),
<a name="3032"/> 3032:      &lt;&lt;&quot;Jefe&quot;&gt;&gt;,
<a name="3033"/> 3033:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 20),
<a name="3034"/> 3034:      list_to_binary(lists:seq(1, 16#19)),
<a name="3035"/> 3035:      binary:copy(&lt;&lt;16#0c&gt;&gt;, 20),
<a name="3036"/> 3036:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 131),
<a name="3037"/> 3037:      binary:copy(&lt;&lt;16#aa&gt;&gt;, 131)
<a name="3038"/> 3038:     ].
<a name="3039"/> 3039:     
<a name="rfc_4231_msgs-0"/><a name="3040"/> 3040: <b>rfc_4231_msgs</b>() -&gt;
<a name="rfc_4231_msgs-last_expr"/><a name="3041"/> 3041:     [&lt;&lt;&quot;Hi There&quot;&gt;&gt;,
<a name="3042"/> 3042:      &lt;&lt;&quot;what do ya want for nothing?&quot;&gt;&gt;,
<a name="3043"/> 3043:      binary:copy(&lt;&lt;16#dd&gt;&gt;, 50),
<a name="3044"/> 3044:      binary:copy(&lt;&lt;16#cd&gt;&gt;, 50),
<a name="3045"/> 3045:      &lt;&lt;&quot;Test With Truncation&quot;&gt;&gt;,
<a name="3046"/> 3046:      &lt;&lt;&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;&gt;&gt;,
<a name="3047"/> 3047:      &lt;&lt;&quot;This is a test using a larger than block-size key and a larger t&quot;,
<a name="3048"/> 3048:        &quot;han block-size data. The key needs to be hashed before being use&quot;,
<a name="3049"/> 3049:        &quot;d by the HMAC algorithm.&quot;&gt;&gt;
<a name="3050"/> 3050:     ].
<a name="3051"/> 3051:     
<a name="rfc4231_hmac_sha224-0"/><a name="3052"/> 3052: <b>rfc4231_hmac_sha224</b>() -&gt;
<a name="rfc4231_hmac_sha224-last_expr"/><a name="3053"/> 3053: <b>    [hexstr2bin</b>(&quot;896fb1128abbdf196832107cd49df33f&quot;
<a name="3054"/> 3054: 		       &quot;47b4b1169912ba4f53684b22&quot;),
<a name="3055"/> 3055:      hexstr2bin(&quot;a30e01098bc6dbbf45690f3a7e9e6d0f&quot;
<a name="3056"/> 3056: 		       &quot;8bbea2a39e6148008fd05e44&quot;),
<a name="3057"/> 3057:      hexstr2bin(&quot;7fb3cb3588c6c1f6ffa9694d7d6ad264&quot;
<a name="3058"/> 3058: 		       &quot;9365b0c1f65d69d1ec8333ea&quot;),
<a name="3059"/> 3059:      hexstr2bin(&quot;6c11506874013cac6a2abc1bb382627c&quot;
<a name="3060"/> 3060: 		       &quot;ec6a90d86efc012de7afec5a&quot;),
<a name="3061"/> 3061:      hexstr2bin(&quot;0e2aea68a90c8d37c988bcdb9fca6fa8&quot;),
<a name="3062"/> 3062:      hexstr2bin(&quot;95e9a0db962095adaebe9b2d6f0dbce2&quot;
<a name="3063"/> 3063: 		       &quot;d499f112f2d2b7273fa6870e&quot;),
<a name="3064"/> 3064:      hexstr2bin(&quot;3a854166ac5d9f023f54d517d0b39dbd&quot;
<a name="3065"/> 3065: 		&quot;946770db9c2b95c9f6f565d1&quot;)].
<a name="rfc4231_hmac_sha256-0"/><a name="3066"/> 3066: <b>rfc4231_hmac_sha256</b>() -&gt;
<a name="rfc4231_hmac_sha256-last_expr"/><a name="3067"/> 3067: <b>    [hexstr2bin</b>(&quot;b0344c61d8db38535ca8afceaf0bf12b&quot;
<a name="3068"/> 3068: 		&quot;881dc200c9833da726e9376c2e32cff7&quot;),
<a name="3069"/> 3069:      hexstr2bin(&quot;5bdcc146bf60754e6a042426089575c7&quot;
<a name="3070"/> 3070: 		&quot;5a003f089d2739839dec58b964ec3843&quot;),
<a name="3071"/> 3071:      hexstr2bin(&quot;773ea91e36800e46854db8ebd09181a7&quot;
<a name="3072"/> 3072: 		&quot;2959098b3ef8c122d9635514ced565fe&quot;),
<a name="3073"/> 3073:     hexstr2bin(&quot;82558a389a443c0ea4cc819899f2083a&quot;
<a name="3074"/> 3074: 	       &quot;85f0faa3e578f8077a2e3ff46729665b&quot;),
<a name="3075"/> 3075:      hexstr2bin(&quot;a3b6167473100ee06e0c796c2955552b&quot;),
<a name="3076"/> 3076:      hexstr2bin(&quot;60e431591ee0b67f0d8a26aacbf5b77f&quot;
<a name="3077"/> 3077: 		&quot;8e0bc6213728c5140546040f0ee37f54&quot;),
<a name="3078"/> 3078:      hexstr2bin(&quot;9b09ffa71b942fcb27635fbcd5b0e944&quot;
<a name="3079"/> 3079: 		&quot;bfdc63644f0713938a7f51535c3a35e2&quot;)].
<a name="3080"/> 3080: 
<a name="rfc4231_hmac_sha384-0"/><a name="3081"/> 3081: <b>rfc4231_hmac_sha384</b>() -&gt;
<a name="rfc4231_hmac_sha384-last_expr"/><a name="3082"/> 3082: <b>    [hexstr2bin</b>(&quot;afd03944d84895626b0825f4ab46907f&quot;
<a name="3083"/> 3083: 		&quot;15f9dadbe4101ec682aa034c7cebc59c&quot;
<a name="3084"/> 3084: 		&quot;faea9ea9076ede7f4af152e8b2fa9cb6&quot;),
<a name="3085"/> 3085:      hexstr2bin(&quot;af45d2e376484031617f78d2b58a6b1b&quot;
<a name="3086"/> 3086: 		&quot;9c7ef464f5a01b47e42ec3736322445e&quot;
<a name="3087"/> 3087: 	       &quot;8e2240ca5e69e2c78b3239ecfab21649&quot;),
<a name="3088"/> 3088:      hexstr2bin(&quot;88062608d3e6ad8a0aa2ace014c8a86f&quot;
<a name="3089"/> 3089: 	       &quot;0aa635d947ac9febe83ef4e55966144b&quot;
<a name="3090"/> 3090: 		&quot;2a5ab39dc13814b94e3ab6e101a34f27&quot;),
<a name="3091"/> 3091:      hexstr2bin(&quot;3e8a69b7783c25851933ab6290af6ca7&quot;
<a name="3092"/> 3092: 		&quot;7a9981480850009cc5577c6e1f573b4e&quot;
<a name="3093"/> 3093: 		&quot;6801dd23c4a7d679ccf8a386c674cffb&quot;),
<a name="3094"/> 3094:      hexstr2bin(&quot;3abf34c3503b2a23a46efc619baef897&quot;),
<a name="3095"/> 3095:      hexstr2bin(&quot;4ece084485813e9088d2c63a041bc5b4&quot;
<a name="3096"/> 3096: 		&quot;4f9ef1012a2b588f3cd11f05033ac4c6&quot;
<a name="3097"/> 3097: 		&quot;0c2ef6ab4030fe8296248df163f44952&quot;),
<a name="3098"/> 3098:      hexstr2bin(&quot;6617178e941f020d351e2f254e8fd32c&quot;
<a name="3099"/> 3099: 		&quot;602420feb0b8fb9adccebb82461e99c5&quot;
<a name="3100"/> 3100: 		&quot;a678cc31e799176d3860e6110c46523e&quot;)].
<a name="rfc4231_hmac_sha512-0"/><a name="3101"/> 3101: <b>rfc4231_hmac_sha512</b>() -&gt;
<a name="rfc4231_hmac_sha512-last_expr"/><a name="3102"/> 3102: <b>    [hexstr2bin</b>(&quot;87aa7cdea5ef619d4ff0b4241a1d6cb0&quot;
<a name="3103"/> 3103: 		&quot;2379f4e2ce4ec2787ad0b30545e17cde&quot;
<a name="3104"/> 3104: 		&quot;daa833b7d6b8a702038b274eaea3f4e4&quot;
<a name="3105"/> 3105: 		&quot;be9d914eeb61f1702e696c203a126854&quot;),
<a name="3106"/> 3106:      hexstr2bin(&quot;164b7a7bfcf819e2e395fbe73b56e0a3&quot;
<a name="3107"/> 3107: 		&quot;87bd64222e831fd610270cd7ea250554&quot;
<a name="3108"/> 3108: 		&quot;9758bf75c05a994a6d034f65f8f0e6fd&quot;
<a name="3109"/> 3109: 		&quot;caeab1a34d4a6b4b636e070a38bce737&quot;),
<a name="3110"/> 3110:      hexstr2bin(&quot;fa73b0089d56a284efb0f0756c890be9&quot;
<a name="3111"/> 3111: 		&quot;b1b5dbdd8ee81a3655f83e33b2279d39&quot;
<a name="3112"/> 3112: 		&quot;bf3e848279a722c806b485a47e67c807&quot;
<a name="3113"/> 3113: 		&quot;b946a337bee8942674278859e13292fb&quot;),
<a name="3114"/> 3114:      hexstr2bin(&quot;b0ba465637458c6990e5a8c5f61d4af7&quot;
<a name="3115"/> 3115: 		&quot;e576d97ff94b872de76f8050361ee3db&quot;
<a name="3116"/> 3116: 		&quot;a91ca5c11aa25eb4d679275cc5788063&quot;
<a name="3117"/> 3117: 		&quot;a5f19741120c4f2de2adebeb10a298dd&quot;),
<a name="3118"/> 3118:      hexstr2bin(&quot;415fad6271580a531d4179bc891d87a6&quot;),
<a name="3119"/> 3119:      hexstr2bin(&quot;80b24263c7c1a3ebb71493c1dd7be8b4&quot;
<a name="3120"/> 3120: 		&quot;9b46d1f41b4aeec1121b013783f8f352&quot;
<a name="3121"/> 3121: 		&quot;6b56d037e05f2598bd0fd2215d6a1e52&quot;
<a name="3122"/> 3122: 		&quot;95e64f73f63f0aec8b915a985d786598&quot;),
<a name="3123"/> 3123:      hexstr2bin(&quot;e37b6a775dc87dbaa4dfa9f96e5e3ffd&quot;
<a name="3124"/> 3124: 		&quot;debd71f8867289865df5a32d20cdc944&quot;
<a name="3125"/> 3125: 		&quot;b6022cac3c4982b10d5eeb55c3e4de15&quot;
<a name="3126"/> 3126: 		&quot;134676fb6de0446065c97440fa8c6a58&quot;)].
<a name="3127"/> 3127: 
<a name="3128"/> 3128: <i>%% HMAC-SM3 from GM/T 0042-2015 Appendix D.3</i>
<a name="3129"/> 3129: <i>%% https://github.com/openssl/openssl/pull/18714</i>
<a name="sm3_keys-0"/><a name="3130"/> 3130: <b>sm3_keys</b>() -&gt;
<a name="sm3_keys-last_expr"/><a name="3131"/> 3131: <b>    [hexstr2bin</b>(&quot;0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20&quot;),
<a name="3132"/> 3132:      hexstr2bin(&quot;0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425&quot;),
<a name="3133"/> 3133:      binary:copy(&lt;&lt;16#0b&gt;&gt;, 32),
<a name="3134"/> 3134:      &lt;&lt;&quot;Jefe&quot;&gt;&gt;
<a name="3135"/> 3135:     ].
<a name="3136"/> 3136:     
<a name="sm3_msgs-0"/><a name="3137"/> 3137: <b>sm3_msgs</b>() -&gt;
<a name="sm3_msgs-last_expr"/><a name="3138"/> 3138:     [&lt;&lt;&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopqabcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;&gt;&gt;,
<a name="3139"/> 3139:      binary:copy(&lt;&lt;16#cd&gt;&gt;, 50),
<a name="3140"/> 3140:      &lt;&lt;&quot;Hi There&quot;&gt;&gt;,
<a name="3141"/> 3141:      &lt;&lt;&quot;what do ya want for nothing?&quot;&gt;&gt;
<a name="3142"/> 3142:     ].
<a name="3143"/> 3143:     
<a name="sm3_hmac-0"/><a name="3144"/> 3144: <b>sm3_hmac</b>() -&gt;
<a name="sm3_hmac-last_expr"/><a name="3145"/> 3145: <b>    [hexstr2bin</b>(&quot;ca05e144ed05d1857840d1f318a4a8669e559fc8391f414485bfdf7bb408963a&quot;),
<a name="3146"/> 3146:      hexstr2bin(&quot;220bf579ded555393f0159f66c99877822a3ecf610d1552154b41d44b94db3ae&quot;),
<a name="3147"/> 3147:      hexstr2bin(&quot;c0ba18c68b90c88bc07de794bfc7d2c8d19ec31ed8773bc2b390c9604e0be11e&quot;),
<a name="3148"/> 3148:      hexstr2bin(&quot;2e87f1d16862e6d964b50a5200bf2b10b764faa9680a296a2405f24bec39f882&quot;)
<a name="3149"/> 3149:     ].
<a name="des_cbc-1"/><a name="3150"/> 3150: <b>des_cbc</b>(_) -&gt;
<a name="des_cbc-last_expr"/><a name="3151"/> 3151:     [{des_cbc, 
<a name="3152"/> 3152:      hexstr2bin(&quot;0123456789abcdef&quot;), 
<a name="3153"/> 3153:      hexstr2bin(&quot;1234567890abcdef&quot;),
<a name="3154"/> 3154:      &lt;&lt;&quot;Now is the time for all &quot;&gt;&gt; }].
<a name="3155"/> 3155:       
<a name="des_cfb-1"/><a name="3156"/> 3156: <b>des_cfb</b>(_) -&gt;
<a name="des_cfb-last_expr"/><a name="3157"/> 3157:     [{des_cfb, 
<a name="3158"/> 3158:      hexstr2bin(&quot;0123456789abcdef&quot;),
<a name="3159"/> 3159:      hexstr2bin(&quot;1234567890abcdef&quot;),
<a name="3160"/> 3160:      &lt;&lt;&quot;Now is the&quot;&gt;&gt;}].
<a name="3161"/> 3161: 
<a name="des3_cbc-1"/><a name="3162"/> 3162: <b>des3_cbc</b>(_) -&gt;
<a name="des3_cbc-last_expr"/><a name="3163"/> 3163:     [{des3_cbc,
<a name="3164"/> 3164:      [hexstr2bin(&quot;0123456789abcdef&quot;), 
<a name="3165"/> 3165:       hexstr2bin(&quot;fedcba9876543210&quot;),
<a name="3166"/> 3166:       hexstr2bin(&quot;0f2d4b6987a5c3e1&quot;)],
<a name="3167"/> 3167:      hexstr2bin(&quot;1234567890abcdef&quot;),
<a name="3168"/> 3168:      &lt;&lt;&quot;Now is the time for all &quot;&gt;&gt;
<a name="3169"/> 3169:      }].
<a name="3170"/> 3170: 
<a name="des_ede3-1"/><a name="3171"/> 3171: <b>des_ede3</b>(_) -&gt;
<a name="des_ede3-last_expr"/><a name="3172"/> 3172:     [{des_ede3,
<a name="3173"/> 3173:      [hexstr2bin(&quot;8000000000000000&quot;),
<a name="3174"/> 3174:       hexstr2bin(&quot;4000000000000000&quot;),
<a name="3175"/> 3175:       hexstr2bin(&quot;2000000000000000&quot;)],
<a name="3176"/> 3176:       hexstr2bin(&quot;7AD16FFB79C45926&quot;),
<a name="3177"/> 3177:       hexstr2bin(&quot;0000000000000000&quot;)
<a name="3178"/> 3178:      }].
<a name="3179"/> 3179: 
<a name="des_ede3_cbc-1"/><a name="3180"/> 3180: <b>des_ede3_cbc</b>(_) -&gt;
<a name="des_ede3_cbc-last_expr"/><a name="3181"/> 3181:     [{des_ede3_cbc,
<a name="3182"/> 3182:      [hexstr2bin(&quot;0123456789abcdef&quot;), 
<a name="3183"/> 3183:       hexstr2bin(&quot;fedcba9876543210&quot;),
<a name="3184"/> 3184:       hexstr2bin(&quot;0f2d4b6987a5c3e1&quot;)],
<a name="3185"/> 3185:      hexstr2bin(&quot;1234567890abcdef&quot;),
<a name="3186"/> 3186:      &lt;&lt;&quot;Now is the time for all &quot;&gt;&gt;
<a name="3187"/> 3187:      },
<a name="3188"/> 3188:      {des_ede3_cbc,
<a name="3189"/> 3189:      [hexstr2bin(&quot;8000000000000000&quot;),
<a name="3190"/> 3190:       hexstr2bin(&quot;4000000000000000&quot;),
<a name="3191"/> 3191:       hexstr2bin(&quot;2000000000000000&quot;)],
<a name="3192"/> 3192:       hexstr2bin(&quot;7AD16FFB79C45926&quot;),
<a name="3193"/> 3193:       hexstr2bin(&quot;0000000000000000&quot;)
<a name="3194"/> 3194:      }].
<a name="3195"/> 3195: 
<a name="des3_cbf-1"/><a name="3196"/> 3196: <b>des3_cbf</b>(_) -&gt;
<a name="des3_cbf-last_expr"/><a name="3197"/> 3197:     [{des3_cbf,
<a name="3198"/> 3198:      [hexstr2bin(&quot;0123456789abcdef&quot;),
<a name="3199"/> 3199:       hexstr2bin(&quot;fedcba9876543210&quot;),
<a name="3200"/> 3200:       hexstr2bin(&quot;0f2d4b6987a5c3e1&quot;)],
<a name="3201"/> 3201:      hexstr2bin(&quot;1234567890abcdef&quot;),
<a name="3202"/> 3202:      &lt;&lt;&quot;Now is the time for all &quot;&gt;&gt;
<a name="3203"/> 3203:      }].
<a name="3204"/> 3204: 
<a name="des3_cfb-1"/><a name="3205"/> 3205: <b>des3_cfb</b>(_) -&gt;
<a name="des3_cfb-last_expr"/><a name="3206"/> 3206:     [{des3_cfb,
<a name="3207"/> 3207:      [hexstr2bin(&quot;0123456789abcdef&quot;),
<a name="3208"/> 3208:       hexstr2bin(&quot;fedcba9876543210&quot;),
<a name="3209"/> 3209:       hexstr2bin(&quot;0f2d4b6987a5c3e1&quot;)],
<a name="3210"/> 3210:      hexstr2bin(&quot;1234567890abcdef&quot;),
<a name="3211"/> 3211:      &lt;&lt;&quot;Now is the time for all &quot;&gt;&gt;
<a name="3212"/> 3212:      }].
<a name="3213"/> 3213: 
<a name="des_ede3_cfb-1"/><a name="3214"/> 3214: <b>des_ede3_cfb</b>(_) -&gt;
<a name="des_ede3_cfb-last_expr"/><a name="3215"/> 3215:     [{des_ede3_cfb,
<a name="3216"/> 3216:      [hexstr2bin(&quot;0123456789abcdef&quot;),
<a name="3217"/> 3217:       hexstr2bin(&quot;fedcba9876543210&quot;),
<a name="3218"/> 3218:       hexstr2bin(&quot;0f2d4b6987a5c3e1&quot;)],
<a name="3219"/> 3219:      hexstr2bin(&quot;1234567890abcdef&quot;),
<a name="3220"/> 3220:      &lt;&lt;&quot;Now is the time for all &quot;&gt;&gt;
<a name="3221"/> 3221:      }].
<a name="3222"/> 3222: 
<a name="rc2_cbc-1"/><a name="3223"/> 3223: <b>rc2_cbc</b>(_) -&gt;
<a name="rc2_cbc-last_expr"/><a name="3224"/> 3224:     [{rc2_cbc,
<a name="3225"/> 3225:      &lt;&lt;146,210,160,124,215,227,153,239,227,17,222,140,3,93,27,191&gt;&gt;,
<a name="3226"/> 3226:       &lt;&lt;72,91,135,182,25,42,35,210&gt;&gt;,
<a name="3227"/> 3227:      &lt;&lt;36,245,206,158,168,230,58,69,148,137,32,192,250,41,237,181,181,251, 192,2,175,135,177,171,57,30,111,117,159,149,15,28,88,158,28,81,28,115, 85,219,241,82,117,222,91,85,73,117,164,25,182,52,191,64,123,57,26,19, 211,27,253,31,194,219,231,104,247,240,172,130,119,21,225,154,101,247, 32,216,42,216,133,169,78,22,97,27,227,26,196,224,172,168,17,9,148,55, 203,91,252,40,61,226,236,221,215,160,78,63,13,181,68,57,196,241,185, 207, 116,129,152,237,60,139,247,153,27,146,161,246,222,98,185,222,152, 187,135, 236,86,34,7,110,91,230,173,34,160,242,202,222,121,127,181,140, 101,203,195, 190,88,250,86,147,127,87,72,126,171,16,71,47,110,248,88, 14,29,143,161,152, 129,236,148,22,152,186,208,119,70,8,174,193,203,100, 193,203,200,117,102,242, 134,142,96,125,135,200,217,190,76,117,50,70, 209,186,101,241,200,91,40,193,54, 90,195,38,47,59,197,38,234,86,223,16, 51,253,204,129,20,171,66,21,241,26,135,216, 196,114,110,91,15,53,40, 164,201,136,113,95,247,51,181,208,241,68,168,98,151,36, 155,72,24,57, 42,191,14,125,204,10,167,214,233,138,115,125,234,121,134,227,26,247, 77,200,117,110,117,111,168,156,206,67,159,149,189,173,150,193,91,199, 216,153,22, 189,137,185,89,160,13,131,132,58,109,28,110,246,252,251,14, 232,91,38,52,29,101,188,69,123,50,0,130,178,93,73,239,118,7,77,35,59, 253,10,159,45,86,142,37,78,232,48&gt;&gt;
<a name="3228"/> 3228:      }].
<a name="3229"/> 3229: 
<a name="3230"/> 3230: <i>%% AES CBC test vectors from http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf</i>
<a name="aes_cbc-1"/><a name="3231"/> 3231: <b>aes_cbc</b>(Config) -&gt;
<a name="3232"/> 3232:     %% RETIRED aes_*_cbc
<a name="aes_cbc-last_expr"/><a name="3233"/> 3233: <b>    read_rsp</b>(Config, aes_cbc,
<a name="3234"/> 3234:             [&quot;CBCVarTxt128.rsp&quot;, &quot;CBCVarKey128.rsp&quot;, &quot;CBCGFSbox128.rsp&quot;, &quot;CBCKeySbox128.rsp&quot;,
<a name="3235"/> 3235:              &quot;CBCVarTxt192.rsp&quot;, &quot;CBCVarKey192.rsp&quot;, &quot;CBCGFSbox192.rsp&quot;, &quot;CBCKeySbox192.rsp&quot;,
<a name="3236"/> 3236:              &quot;CBCVarTxt256.rsp&quot;, &quot;CBCVarKey256.rsp&quot;, &quot;CBCGFSbox256.rsp&quot;, &quot;CBCKeySbox256.rsp&quot;,
<a name="3237"/> 3237:              &quot;CBCMMT128.rsp&quot;, &quot;CBCMMT192.rsp&quot;, &quot;CBCMMT256.rsp&quot;
<a name="3238"/> 3238:             ]).
<a name="3239"/> 3239: 
<a name="aes_cbc128-1"/><a name="3240"/> 3240: <b>aes_cbc128</b>(Config) -&gt;
<a name="3241"/> 3241:     %% RETIRED aes_128_cbc
<a name="aes_cbc128-last_expr"/><a name="3242"/> 3242: <b>    read_rsp</b>(Config, aes_cbc128,
<a name="3243"/> 3243:              [&quot;CBCVarTxt128.rsp&quot;, &quot;CBCVarKey128.rsp&quot;, &quot;CBCGFSbox128.rsp&quot;, &quot;CBCKeySbox128.rsp&quot;,
<a name="3244"/> 3244:               &quot;CBCMMT128.rsp&quot;]).
<a name="3245"/> 3245: 
<a name="aes_cbc256-1"/><a name="3246"/> 3246: <b>aes_cbc256</b>(Config) -&gt;
<a name="3247"/> 3247:     %% RETIRED aes_256_cbc
<a name="aes_cbc256-last_expr"/><a name="3248"/> 3248: <b>    read_rsp</b>(Config, aes_cbc256,
<a name="3249"/> 3249:              [&quot;CBCVarTxt256.rsp&quot;, &quot;CBCVarKey256.rsp&quot;, &quot;CBCGFSbox256.rsp&quot;, &quot;CBCKeySbox256.rsp&quot;,
<a name="3250"/> 3250:               &quot;CBCMMT256.rsp&quot;]).
<a name="3251"/> 3251: 
<a name="aes_128_cbc-1"/><a name="3252"/> 3252: <b>aes_128_cbc</b>(Config) -&gt;
<a name="aes_128_cbc-last_expr"/><a name="3253"/> 3253: <b>    read_rsp</b>(Config, aes_128_cbc,
<a name="3254"/> 3254:              [&quot;CBCVarTxt128.rsp&quot;, &quot;CBCVarKey128.rsp&quot;, &quot;CBCGFSbox128.rsp&quot;, &quot;CBCKeySbox128.rsp&quot;,
<a name="3255"/> 3255:               &quot;CBCMMT128.rsp&quot;]).
<a name="3256"/> 3256: 
<a name="aes_192_cbc-1"/><a name="3257"/> 3257: <b>aes_192_cbc</b>(Config) -&gt;
<a name="aes_192_cbc-last_expr"/><a name="3258"/> 3258: <b>    read_rsp</b>(Config, aes_192_cbc,
<a name="3259"/> 3259:              [&quot;CBCVarTxt192.rsp&quot;, &quot;CBCVarKey192.rsp&quot;, &quot;CBCGFSbox192.rsp&quot;, &quot;CBCKeySbox192.rsp&quot;,
<a name="3260"/> 3260:               &quot;CBCMMT192.rsp&quot;]).
<a name="3261"/> 3261: 
<a name="aes_256_cbc-1"/><a name="3262"/> 3262: <b>aes_256_cbc</b>(Config) -&gt;
<a name="aes_256_cbc-last_expr"/><a name="3263"/> 3263: <b>    read_rsp</b>(Config, aes_256_cbc,
<a name="3264"/> 3264:              [&quot;CBCVarTxt256.rsp&quot;, &quot;CBCVarKey256.rsp&quot;, &quot;CBCGFSbox256.rsp&quot;, &quot;CBCKeySbox256.rsp&quot;,
<a name="3265"/> 3265:               &quot;CBCMMT256.rsp&quot;]).
<a name="3266"/> 3266: 
<a name="aes_128_ofb-1"/><a name="3267"/> 3267: <b>aes_128_ofb</b>(Config) -&gt;
<a name="aes_128_ofb-last_expr"/><a name="3268"/> 3268: <b>    read_rsp</b>(Config, aes_128_ofb,
<a name="3269"/> 3269:              [&quot;OFBVarTxt128.rsp&quot;, &quot;OFBVarKey128.rsp&quot;, &quot;OFBGFSbox128.rsp&quot;, &quot;OFBKeySbox128.rsp&quot;,
<a name="3270"/> 3270:               &quot;OFBMMT128.rsp&quot;]).
<a name="3271"/> 3271: 
<a name="aes_192_ofb-1"/><a name="3272"/> 3272: <b>aes_192_ofb</b>(Config) -&gt;
<a name="aes_192_ofb-last_expr"/><a name="3273"/> 3273: <b>    read_rsp</b>(Config, aes_192_ofb,
<a name="3274"/> 3274:              [&quot;OFBVarTxt192.rsp&quot;, &quot;OFBVarKey192.rsp&quot;, &quot;OFBGFSbox192.rsp&quot;, &quot;OFBKeySbox192.rsp&quot;,
<a name="3275"/> 3275:               &quot;OFBMMT192.rsp&quot;]).
<a name="3276"/> 3276: 
<a name="aes_256_ofb-1"/><a name="3277"/> 3277: <b>aes_256_ofb</b>(Config) -&gt;
<a name="aes_256_ofb-last_expr"/><a name="3278"/> 3278: <b>    read_rsp</b>(Config, aes_256_ofb,
<a name="3279"/> 3279:              [&quot;OFBVarTxt256.rsp&quot;, &quot;OFBVarKey256.rsp&quot;, &quot;OFBGFSbox256.rsp&quot;, &quot;OFBKeySbox256.rsp&quot;,
<a name="3280"/> 3280:               &quot;OFBMMT256.rsp&quot;]).
<a name="3281"/> 3281: 
<a name="aes_ecb-1"/><a name="3282"/> 3282: <b>aes_ecb</b>(Config) -&gt;
<a name="aes_ecb-last_expr"/><a name="3283"/> 3283: <b>    read_rsp</b>(Config, aes_ecb,
<a name="3284"/> 3284:              [&quot;ECBVarTxt128.rsp&quot;, &quot;ECBVarKey128.rsp&quot;, &quot;ECBGFSbox128.rsp&quot;, &quot;ECBKeySbox128.rsp&quot;,
<a name="3285"/> 3285:               &quot;ECBVarTxt192.rsp&quot;, &quot;ECBVarKey192.rsp&quot;, &quot;ECBGFSbox192.rsp&quot;, &quot;ECBKeySbox192.rsp&quot;,
<a name="3286"/> 3286:               &quot;ECBVarTxt256.rsp&quot;, &quot;ECBVarKey256.rsp&quot;, &quot;ECBGFSbox256.rsp&quot;, &quot;ECBKeySbox256.rsp&quot;,
<a name="3287"/> 3287:               &quot;ECBMMT128.rsp&quot;, &quot;ECBMMT192.rsp&quot;, &quot;ECBMMT256.rsp&quot;]).
<a name="3288"/> 3288: 
<a name="aes_128_ecb-1"/><a name="3289"/> 3289: <b>aes_128_ecb</b>(Config) -&gt;
<a name="aes_128_ecb-last_expr"/><a name="3290"/> 3290: <b>    read_rsp</b>(Config, aes_128_ecb,
<a name="3291"/> 3291:              [&quot;ECBVarTxt128.rsp&quot;, &quot;ECBVarKey128.rsp&quot;, &quot;ECBGFSbox128.rsp&quot;, &quot;ECBKeySbox128.rsp&quot;,
<a name="3292"/> 3292:               &quot;ECBMMT128.rsp&quot;]).
<a name="3293"/> 3293: 
<a name="aes_192_ecb-1"/><a name="3294"/> 3294: <b>aes_192_ecb</b>(Config) -&gt;
<a name="aes_192_ecb-last_expr"/><a name="3295"/> 3295: <b>    read_rsp</b>(Config, aes_192_ecb,
<a name="3296"/> 3296:              [&quot;ECBVarTxt192.rsp&quot;, &quot;ECBVarKey192.rsp&quot;, &quot;ECBGFSbox192.rsp&quot;, &quot;ECBKeySbox192.rsp&quot;,
<a name="3297"/> 3297:               &quot;ECBMMT192.rsp&quot;]).
<a name="3298"/> 3298: 
<a name="aes_256_ecb-1"/><a name="3299"/> 3299: <b>aes_256_ecb</b>(Config) -&gt;
<a name="aes_256_ecb-last_expr"/><a name="3300"/> 3300: <b>    read_rsp</b>(Config, aes_256_ecb,
<a name="3301"/> 3301:              [&quot;ECBVarTxt256.rsp&quot;, &quot;ECBVarKey256.rsp&quot;, &quot;ECBGFSbox256.rsp&quot;, &quot;ECBKeySbox256.rsp&quot;,
<a name="3302"/> 3302:               &quot;ECBMMT256.rsp&quot;]).
<a name="3303"/> 3303: 
<a name="aes_cfb8-1"/><a name="3304"/> 3304: <b>aes_cfb8</b>(Config) -&gt;
<a name="aes_cfb8-last_expr"/><a name="3305"/> 3305: <b>    read_rsp</b>(Config, aes_cfb8,
<a name="3306"/> 3306:              [&quot;CFB8VarTxt128.rsp&quot;, &quot;CFB8VarKey128.rsp&quot;, &quot;CFB8GFSbox128.rsp&quot;, &quot;CFB8KeySbox128.rsp&quot;,
<a name="3307"/> 3307:               &quot;CFB8VarTxt192.rsp&quot;, &quot;CFB8VarKey192.rsp&quot;, &quot;CFB8GFSbox192.rsp&quot;, &quot;CFB8KeySbox192.rsp&quot;,
<a name="3308"/> 3308:               &quot;CFB8VarTxt256.rsp&quot;, &quot;CFB8VarKey256.rsp&quot;, &quot;CFB8GFSbox256.rsp&quot;, &quot;CFB8KeySbox256.rsp&quot;,
<a name="3309"/> 3309:               &quot;CFB8MMT128.rsp&quot;, &quot;CFB8MMT192.rsp&quot;, &quot;CFB8MMT256.rsp&quot;]).
<a name="3310"/> 3310: 
<a name="aes_128_cfb8-1"/><a name="3311"/> 3311: <b>aes_128_cfb8</b>(Config) -&gt;
<a name="aes_128_cfb8-last_expr"/><a name="3312"/> 3312: <b>    read_rsp</b>(Config, aes_128_cfb8,
<a name="3313"/> 3313:              [&quot;CFB8VarTxt128.rsp&quot;, &quot;CFB8VarKey128.rsp&quot;, &quot;CFB8GFSbox128.rsp&quot;, &quot;CFB8KeySbox128.rsp&quot;,
<a name="3314"/> 3314:               &quot;CFB8MMT128.rsp&quot;]).
<a name="3315"/> 3315: 
<a name="aes_192_cfb8-1"/><a name="3316"/> 3316: <b>aes_192_cfb8</b>(Config) -&gt;
<a name="aes_192_cfb8-last_expr"/><a name="3317"/> 3317: <b>    read_rsp</b>(Config, aes_192_cfb8,
<a name="3318"/> 3318:              [&quot;CFB8VarTxt192.rsp&quot;, &quot;CFB8VarKey192.rsp&quot;, &quot;CFB8GFSbox192.rsp&quot;, &quot;CFB8KeySbox192.rsp&quot;,
<a name="3319"/> 3319:               &quot;CFB8MMT192.rsp&quot;]).
<a name="3320"/> 3320: 
<a name="aes_256_cfb8-1"/><a name="3321"/> 3321: <b>aes_256_cfb8</b>(Config) -&gt;
<a name="aes_256_cfb8-last_expr"/><a name="3322"/> 3322: <b>    read_rsp</b>(Config, aes_256_cfb8,
<a name="3323"/> 3323:              [&quot;CFB8VarTxt256.rsp&quot;, &quot;CFB8VarKey256.rsp&quot;, &quot;CFB8GFSbox256.rsp&quot;, &quot;CFB8KeySbox256.rsp&quot;,
<a name="3324"/> 3324:               &quot;CFB8MMT256.rsp&quot;]).
<a name="3325"/> 3325: 
<a name="3326"/> 3326: 
<a name="aes_cfb128-1"/><a name="3327"/> 3327: <b>aes_cfb128</b>(Config) -&gt;
<a name="aes_cfb128-last_expr"/><a name="3328"/> 3328: <b>    read_rsp</b>(Config, aes_cfb128,
<a name="3329"/> 3329:              [&quot;CFB128VarTxt128.rsp&quot;, &quot;CFB128VarKey128.rsp&quot;, &quot;CFB128GFSbox128.rsp&quot;, &quot;CFB128KeySbox128.rsp&quot;,
<a name="3330"/> 3330:               &quot;CFB128VarTxt192.rsp&quot;, &quot;CFB128VarKey192.rsp&quot;, &quot;CFB128GFSbox192.rsp&quot;, &quot;CFB128KeySbox192.rsp&quot;,
<a name="3331"/> 3331:               &quot;CFB128VarTxt256.rsp&quot;, &quot;CFB128VarKey256.rsp&quot;, &quot;CFB128GFSbox256.rsp&quot;, &quot;CFB128KeySbox256.rsp&quot;,
<a name="3332"/> 3332:               &quot;CFB128MMT128.rsp&quot;, &quot;CFB128MMT192.rsp&quot;, &quot;CFB128MMT256.rsp&quot;]).
<a name="3333"/> 3333: 
<a name="aes_128_cfb128-1"/><a name="3334"/> 3334: <b>aes_128_cfb128</b>(Config) -&gt;
<a name="aes_128_cfb128-last_expr"/><a name="3335"/> 3335: <b>    read_rsp</b>(Config, aes_128_cfb128,
<a name="3336"/> 3336:              [&quot;CFB128VarTxt128.rsp&quot;, &quot;CFB128VarKey128.rsp&quot;, &quot;CFB128GFSbox128.rsp&quot;, &quot;CFB128KeySbox128.rsp&quot;,
<a name="3337"/> 3337:               &quot;CFB128MMT128.rsp&quot;]).
<a name="3338"/> 3338: 
<a name="aes_192_cfb128-1"/><a name="3339"/> 3339: <b>aes_192_cfb128</b>(Config) -&gt;
<a name="aes_192_cfb128-last_expr"/><a name="3340"/> 3340: <b>    read_rsp</b>(Config, aes_192_cfb128,
<a name="3341"/> 3341:              [&quot;CFB128VarTxt192.rsp&quot;, &quot;CFB128VarKey192.rsp&quot;, &quot;CFB128GFSbox192.rsp&quot;, &quot;CFB128KeySbox192.rsp&quot;,
<a name="3342"/> 3342:               &quot;CFB128MMT192.rsp&quot;]).
<a name="3343"/> 3343: 
<a name="aes_256_cfb128-1"/><a name="3344"/> 3344: <b>aes_256_cfb128</b>(Config) -&gt;
<a name="aes_256_cfb128-last_expr"/><a name="3345"/> 3345: <b>    read_rsp</b>(Config, aes_256_cfb128,
<a name="3346"/> 3346:              [&quot;CFB128VarTxt256.rsp&quot;, &quot;CFB128VarKey256.rsp&quot;, &quot;CFB128GFSbox256.rsp&quot;, &quot;CFB128KeySbox256.rsp&quot;,
<a name="3347"/> 3347:               &quot;CFB128MMT256.rsp&quot;]).
<a name="3348"/> 3348: 
<a name="3349"/> 3349: 
<a name="blowfish_cbc-1"/><a name="3350"/> 3350: <b>blowfish_cbc</b>(_) -&gt;
<a name="blowfish_cbc-last_expr"/><a name="3351"/> 3351:     [{blowfish_cbc,
<a name="3352"/> 3352:       hexstr2bin(&quot;0123456789ABCDEFF0E1D2C3B4A59687&quot;), 
<a name="3353"/> 3353:       hexstr2bin(&quot;FEDCBA9876543210&quot;),
<a name="3354"/> 3354:       hexstr2bin(&quot;37363534333231204E6F77206973207468652074696D6520666F722000000000&quot;)
<a name="3355"/> 3355:      }].
<a name="3356"/> 3356: 
<a name="blowfish_ecb-1"/><a name="3357"/> 3357: <b>blowfish_ecb</b>(_) -&gt;
<a name="blowfish_ecb-last_expr"/><a name="3358"/> 3358:     [
<a name="3359"/> 3359:      {blowfish_ecb,
<a name="3360"/> 3360:       hexstr2bin(&quot;0000000000000000&quot;), 
<a name="3361"/> 3361:       hexstr2bin(&quot;0000000000000000&quot;)},
<a name="3362"/> 3362:      {blowfish_ecb,
<a name="3363"/> 3363:       hexstr2bin(&quot;FFFFFFFFFFFFFFFF&quot;), 
<a name="3364"/> 3364:       hexstr2bin(&quot;FFFFFFFFFFFFFFFF&quot;)},
<a name="3365"/> 3365:      {blowfish_ecb,
<a name="3366"/> 3366:       hexstr2bin(&quot;3000000000000000&quot;), 
<a name="3367"/> 3367:       hexstr2bin(&quot;1000000000000001&quot;)},
<a name="3368"/> 3368:      {blowfish_ecb,
<a name="3369"/> 3369:       hexstr2bin(&quot;1111111111111111&quot;), 
<a name="3370"/> 3370:       hexstr2bin(&quot;1111111111111111&quot;)},
<a name="3371"/> 3371:      {blowfish_ecb,
<a name="3372"/> 3372:       hexstr2bin(&quot;0123456789ABCDEF&quot;), 
<a name="3373"/> 3373:       hexstr2bin(&quot;1111111111111111&quot;)},
<a name="3374"/> 3374:      {blowfish_ecb,
<a name="3375"/> 3375:       hexstr2bin(&quot;0000000000000000&quot;), 
<a name="3376"/> 3376:       hexstr2bin(&quot;0000000000000000&quot;)},
<a name="3377"/> 3377:      {blowfish_ecb,
<a name="3378"/> 3378:       hexstr2bin(&quot;FEDCBA9876543210&quot;), 
<a name="3379"/> 3379:       hexstr2bin(&quot;0123456789ABCDEF&quot;)},
<a name="3380"/> 3380:      {blowfish_ecb,
<a name="3381"/> 3381:       hexstr2bin(&quot;7CA110454A1A6E57&quot;), 
<a name="3382"/> 3382:       hexstr2bin(&quot;01A1D6D039776742&quot;)},
<a name="3383"/> 3383:      {blowfish_ecb,
<a name="3384"/> 3384:       hexstr2bin(&quot;0131D9619DC1376E&quot;), 
<a name="3385"/> 3385:       hexstr2bin(&quot;5CD54CA83DEF57DA&quot;)},
<a name="3386"/> 3386:      {blowfish_ecb,
<a name="3387"/> 3387:       hexstr2bin(&quot;07A1133E4A0B2686&quot;), 
<a name="3388"/> 3388:       hexstr2bin(&quot;0248D43806F67172&quot;)},
<a name="3389"/> 3389:      {blowfish_ecb,
<a name="3390"/> 3390:       hexstr2bin(&quot;3849674C2602319E&quot;), 
<a name="3391"/> 3391:       hexstr2bin(&quot;51454B582DDF440A&quot;)},
<a name="3392"/> 3392:      {blowfish_ecb,
<a name="3393"/> 3393:       hexstr2bin(&quot;04B915BA43FEB5B6&quot;), 
<a name="3394"/> 3394:       hexstr2bin(&quot;42FD443059577FA2&quot;)},
<a name="3395"/> 3395:      {blowfish_ecb,
<a name="3396"/> 3396:       hexstr2bin(&quot;0113B970FD34F2CE&quot;), 
<a name="3397"/> 3397:       hexstr2bin(&quot;059B5E0851CF143A&quot;)},
<a name="3398"/> 3398:      {blowfish_ecb,
<a name="3399"/> 3399:       hexstr2bin(&quot;0170F175468FB5E6&quot;), 
<a name="3400"/> 3400:       hexstr2bin(&quot;0756D8E0774761D2&quot;)},
<a name="3401"/> 3401:      {blowfish_ecb,
<a name="3402"/> 3402:       hexstr2bin(&quot;43297FAD38E373FE&quot;), 
<a name="3403"/> 3403:       hexstr2bin(&quot;762514B829BF486A&quot;)},
<a name="3404"/> 3404:      {blowfish_ecb,
<a name="3405"/> 3405:       hexstr2bin(&quot;07A7137045DA2A16&quot;), 
<a name="3406"/> 3406:       hexstr2bin(&quot;3BDD119049372802&quot;)},
<a name="3407"/> 3407:      {blowfish_ecb,
<a name="3408"/> 3408:       hexstr2bin(&quot;04689104C2FD3B2F&quot;), 
<a name="3409"/> 3409:       hexstr2bin(&quot;26955F6835AF609A&quot;)},
<a name="3410"/> 3410:      {blowfish_ecb,
<a name="3411"/> 3411:       hexstr2bin(&quot;37D06BB516CB7546&quot;), 
<a name="3412"/> 3412:       hexstr2bin(&quot;164D5E404F275232&quot;)},
<a name="3413"/> 3413:      {blowfish_ecb,
<a name="3414"/> 3414:       hexstr2bin(&quot;1F08260D1AC2465E&quot;), 
<a name="3415"/> 3415:       hexstr2bin(&quot;6B056E18759F5CCA&quot;)},
<a name="3416"/> 3416:      {blowfish_ecb,
<a name="3417"/> 3417:       hexstr2bin(&quot;584023641ABA6176&quot;), 
<a name="3418"/> 3418:       hexstr2bin(&quot;004BD6EF09176062&quot;)},
<a name="3419"/> 3419:      {blowfish_ecb,
<a name="3420"/> 3420:       hexstr2bin(&quot;025816164629B007&quot;), 
<a name="3421"/> 3421:       hexstr2bin(&quot;480D39006EE762F2&quot;)},
<a name="3422"/> 3422:      {blowfish_ecb,
<a name="3423"/> 3423:       hexstr2bin(&quot;49793EBC79B3258F&quot;), 
<a name="3424"/> 3424:       hexstr2bin(&quot;437540C8698F3CFA&quot;)},
<a name="3425"/> 3425:      {blowfish_ecb,
<a name="3426"/> 3426:       hexstr2bin(&quot;018310DC409B26D6&quot;), 
<a name="3427"/> 3427:       hexstr2bin(&quot;1D9D5C5018F728C2&quot;)},
<a name="3428"/> 3428:      {blowfish_ecb,
<a name="3429"/> 3429:       hexstr2bin(&quot;1C587F1C13924FEF&quot;), 
<a name="3430"/> 3430:       hexstr2bin(&quot;305532286D6F295A&quot;)},
<a name="3431"/> 3431:      {blowfish_ecb,
<a name="3432"/> 3432:       hexstr2bin(&quot;0101010101010101&quot;), 
<a name="3433"/> 3433:       hexstr2bin(&quot;0123456789ABCDEF&quot;)},
<a name="3434"/> 3434:      {blowfish_ecb,
<a name="3435"/> 3435:       hexstr2bin(&quot;1F1F1F1F0E0E0E0E&quot;), 
<a name="3436"/> 3436:       hexstr2bin(&quot;0123456789ABCDEF&quot;)},
<a name="3437"/> 3437:      {blowfish_ecb,
<a name="3438"/> 3438:       hexstr2bin(&quot;E0FEE0FEF1FEF1FE&quot;), 
<a name="3439"/> 3439:       hexstr2bin(&quot;0123456789ABCDEF&quot;)},
<a name="3440"/> 3440:      {blowfish_ecb,
<a name="3441"/> 3441:       hexstr2bin(&quot;0000000000000000&quot;), 
<a name="3442"/> 3442:       hexstr2bin(&quot;FFFFFFFFFFFFFFFF&quot;)},
<a name="3443"/> 3443:      {blowfish_ecb,
<a name="3444"/> 3444:       hexstr2bin(&quot;FFFFFFFFFFFFFFFF&quot;), 
<a name="3445"/> 3445:       hexstr2bin(&quot;0000000000000000&quot;)},
<a name="3446"/> 3446:      {blowfish_ecb,
<a name="3447"/> 3447:       hexstr2bin(&quot;0123456789ABCDEF&quot;), 
<a name="3448"/> 3448:       hexstr2bin(&quot;0000000000000000&quot;)},
<a name="3449"/> 3449:      {blowfish_ecb,
<a name="3450"/> 3450:       hexstr2bin(&quot;FEDCBA9876543210&quot;), 
<a name="3451"/> 3451:       hexstr2bin(&quot;FFFFFFFFFFFFFFFF&quot;)}
<a name="3452"/> 3452:     ].
<a name="3453"/> 3453: 
<a name="blowfish_cfb64-1"/><a name="3454"/> 3454: <b>blowfish_cfb64</b>(_) -&gt;
<a name="blowfish_cfb64-last_expr"/><a name="3455"/> 3455:     [{blowfish_cfb64,
<a name="3456"/> 3456:       hexstr2bin(&quot;0123456789ABCDEFF0E1D2C3B4A59687&quot;), 
<a name="3457"/> 3457:       hexstr2bin(&quot;FEDCBA9876543210&quot;),
<a name="3458"/> 3458:       hexstr2bin(&quot;37363534333231204E6F77206973207468652074696D6520666F722000&quot;)
<a name="3459"/> 3459:      }].
<a name="blowfish_ofb64-1"/><a name="3460"/> 3460: <b>blowfish_ofb64</b>(_) -&gt;
<a name="blowfish_ofb64-last_expr"/><a name="3461"/> 3461:     [{blowfish_ofb64,
<a name="3462"/> 3462:       hexstr2bin(&quot;0123456789ABCDEFF0E1D2C3B4A59687&quot;), 
<a name="3463"/> 3463:       hexstr2bin(&quot;FEDCBA9876543210&quot;),
<a name="3464"/> 3464:       hexstr2bin(&quot;37363534333231204E6F77206973207468652074696D6520666F722000&quot;)
<a name="3465"/> 3465:      }].
<a name="3466"/> 3466: 
<a name="rc4-1"/><a name="3467"/> 3467: <b>rc4</b>(_) -&gt;
<a name="rc4-last_expr"/><a name="3468"/> 3468:     [{rc4, &lt;&lt;&quot;apaapa&quot;&gt;&gt;, &lt;&lt;&quot;Yo baby yo&quot;&gt;&gt;},
<a name="3469"/> 3469:      {rc4, &lt;&lt;&quot;apaapa&quot;&gt;&gt;, list_to_binary(lists:seq(0, 255))},
<a name="3470"/> 3470:      {rc4, &lt;&lt;&quot;apaapa&quot;&gt;&gt;, long_msg()}
<a name="3471"/> 3471:     ].
<a name="3472"/> 3472: 
<a name="3473"/> 3473: <i>%% Test Data from https://github.com/openssl/openssl/pull/9935</i>
<a name="sm4_ecb-1"/><a name="3474"/> 3474: <b>sm4_ecb</b>(_) -&gt;
<a name="sm4_ecb-last_expr"/><a name="3475"/> 3475: <b>    [{sm4_ecb, hexstr2bin</b>(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), &lt;&lt;&gt;&gt;,
<a name="3476"/> 3476: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3477"/> 3477:     hexstr2bin(&quot;681EDF34D206965E86B3E94F536E4246&quot;)}].
<a name="sm4_cbc-1"/><a name="3478"/> 3478: <b>sm4_cbc</b>(_) -&gt;
<a name="sm4_cbc-last_expr"/><a name="3479"/> 3479: <b>    [{sm4_cbc, hexstr2bin</b>(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3480"/> 3480: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3481"/> 3481: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA98765432100123456789ABCDEFFEDCBA9876543210&quot;),
<a name="3482"/> 3482:     hexstr2bin(&quot;2677F46B09C122CC975533105BD4A22AF6125F7275CE552C3A2BBCF533DE8A3B&quot;)}].
<a name="sm4_ofb-1"/><a name="3483"/> 3483: <b>sm4_ofb</b>(_) -&gt;
<a name="sm4_ofb-last_expr"/><a name="3484"/> 3484: <b>    [{sm4_ofb, hexstr2bin</b>(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3485"/> 3485: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3486"/> 3486: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA98765432100123456789ABCDEFFEDCBA9876543210&quot;),
<a name="3487"/> 3487:     hexstr2bin(&quot;693D9A535BAD5BB1786F53D7253A7056F2075D28B5235F58D50027E4177D2BCE&quot;)}].
<a name="sm4_cfb-1"/><a name="3488"/> 3488: <b>sm4_cfb</b>(_) -&gt;
<a name="sm4_cfb-last_expr"/><a name="3489"/> 3489: <b>    [{sm4_cfb, hexstr2bin</b>(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3490"/> 3490: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3491"/> 3491: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA98765432100123456789ABCDEFFEDCBA9876543210&quot;),
<a name="3492"/> 3492:     hexstr2bin(&quot;693D9A535BAD5BB1786F53D7253A70569ED258A85A0467CC92AAB393DD978995&quot;)}].
<a name="sm4_ctr-1"/><a name="3493"/> 3493: <b>sm4_ctr</b>(_) -&gt;
<a name="sm4_ctr-last_expr"/><a name="3494"/> 3494: <b>    [{sm4_ctr, hexstr2bin</b>(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3495"/> 3495: 	hexstr2bin(&quot;0123456789ABCDEFFEDCBA9876543210&quot;), 
<a name="3496"/> 3496: 	hexstr2bin(&quot;AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBCCCCCCCCCCCCCCCCDDDDDDDDDDDDDDDD&quot;
<a name="3497"/> 3497:                &quot;EEEEEEEEEEEEEEEEFFFFFFFFFFFFFFFFEEEEEEEEEEEEEEEEAAAAAAAAAAAAAAAA&quot;),
<a name="3498"/> 3498:     hexstr2bin(&quot;C2B4759E78AC3CF43D0852F4E8D5F9FD7256E8A5FCB65A350EE00630912E4449&quot;
<a name="3499"/> 3499:                &quot;2A0B17E1B85B060D0FBA612D8A95831638B361FD5FFACD942F081485A83CA35D&quot;)}
<a name="3500"/> 3500:     ].
<a name="3501"/> 3501: 
<a name="3502"/> 3502: <i>%% https://datatracker.ietf.org/doc/rfc8998 appendix A.1</i>
<a name="sm4_gcm-1"/><a name="3503"/> 3503: <b>sm4_gcm</b>(_) -&gt;
<a name="sm4_gcm-last_expr"/><a name="3504"/> 3504:     [
<a name="3505"/> 3505:      {sm4_gcm,
<a name="3506"/> 3506:       hexstr2bin(&quot;0123456789ABCDEFFEDCBA9876543210&quot;),
<a name="3507"/> 3507:       hexstr2bin(&quot;AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBB&quot;                      %% PlainText
<a name="3508"/> 3508:       &quot;CCCCCCCCCCCCCCCCDDDDDDDDDDDDDDDD&quot;
<a name="3509"/> 3509:       &quot;EEEEEEEEEEEEEEEEFFFFFFFFFFFFFFFF&quot;
<a name="3510"/> 3510:       &quot;EEEEEEEEEEEEEEEEAAAAAAAAAAAAAAAA&quot;),
<a name="3511"/> 3511:       hexstr2bin(&quot;00001234567800000000ABCD&quot;),                            %% Nonce
<a name="3512"/> 3512:       hexstr2bin(&quot;FEEDFACEDEADBEEFFEEDFACEDEADBEEFABADDAD2&quot;),            %% AAD
<a name="3513"/> 3513:       hexstr2bin(&quot;17F399F08C67D5EE19D0DC9969C4BB7D&quot;                      %% CipherText
<a name="3514"/> 3514:       &quot;5FD46FD3756489069157B282BB200735&quot;
<a name="3515"/> 3515:       &quot;D82710CA5C22F0CCFA7CBF93D496AC15&quot;
<a name="3516"/> 3516:       &quot;A56834CBCF98C397B4024A2691233B8D&quot;),
<a name="3517"/> 3517:       hexstr2bin(&quot;83DE3541E4C2B58177E065A9BF7B62EC&quot;),                    %% CipherTag
<a name="3518"/> 3518:       no_info
<a name="3519"/> 3519:       }
<a name="3520"/> 3520:     ].
<a name="3521"/> 3521: 
<a name="3522"/> 3522: <i>%% https://datatracker.ietf.org/doc/rfc8998 appendix A.2</i>
<a name="sm4_ccm-1"/><a name="3523"/> 3523: <b>sm4_ccm</b>(_) -&gt;
<a name="sm4_ccm-last_expr"/><a name="3524"/> 3524:     [
<a name="3525"/> 3525:      {sm4_ccm,
<a name="3526"/> 3526:       hexstr2bin(&quot;0123456789ABCDEFFEDCBA9876543210&quot;),
<a name="3527"/> 3527:       hexstr2bin(&quot;AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBB&quot;                      %% PlainText
<a name="3528"/> 3528:       &quot;CCCCCCCCCCCCCCCCDDDDDDDDDDDDDDDD&quot;
<a name="3529"/> 3529:       &quot;EEEEEEEEEEEEEEEEFFFFFFFFFFFFFFFF&quot;
<a name="3530"/> 3530:       &quot;EEEEEEEEEEEEEEEEAAAAAAAAAAAAAAAA&quot;),
<a name="3531"/> 3531:       hexstr2bin(&quot;00001234567800000000ABCD&quot;),                            %% Nonce
<a name="3532"/> 3532:       hexstr2bin(&quot;FEEDFACEDEADBEEFFEEDFACEDEADBEEFABADDAD2&quot;),            %% AAD
<a name="3533"/> 3533:       hexstr2bin(&quot;48AF93501FA62ADBCD414CCE6034D895&quot;                      %% CipherText
<a name="3534"/> 3534:       &quot;DDA1BF8F132F042098661572E7483094&quot;
<a name="3535"/> 3535:       &quot;FD12E518CE062C98ACEE28D95DF4416B&quot;
<a name="3536"/> 3536:       &quot;ED31A2F04476C18BB40C84A74B97DC5B&quot;),
<a name="3537"/> 3537:       hexstr2bin(&quot;16842D4FA186F56AB33256971FA110F4&quot;),                    %% CipherTag
<a name="3538"/> 3538:       no_info
<a name="3539"/> 3539:       }
<a name="3540"/> 3540:     ].
<a name="3541"/> 3541: 
<a name="aes_128_ctr-1"/><a name="3542"/> 3542: <b>aes_128_ctr</b>(_) -&gt;
<a name="aes_128_ctr-last_expr"/><a name="3543"/> 3543:     [  %% F.5.3  CTR-AES192.Encrypt
<a name="3544"/> 3544:        {aes_128_ctr, hexstr2bin(&quot;2b7e151628aed2a6abf7158809cf4f3c&quot;), 
<a name="3545"/> 3545: 	hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff&quot;), 
<a name="3546"/> 3546: 	hexstr2bin(&quot;6bc1bee22e409f96e93d7e117393172a&quot;)},
<a name="3547"/> 3547:        {aes_128_ctr, hexstr2bin(&quot;2b7e151628aed2a6abf7158809cf4f3c&quot;), 
<a name="3548"/> 3548: 	hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff00&quot;), 
<a name="3549"/> 3549: 	hexstr2bin(&quot;ae2d8a571e03ac9c9eb76fac45af8e51&quot;)},
<a name="3550"/> 3550:        {aes_128_ctr, hexstr2bin(&quot;2b7e151628aed2a6abf7158809cf4f3c&quot;), 
<a name="3551"/> 3551: 	hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff01&quot;), 
<a name="3552"/> 3552: 	hexstr2bin(&quot;30c81c46a35ce411e5fbc1191a0a52ef&quot;) },
<a name="3553"/> 3553:        {aes_128_ctr, hexstr2bin(&quot;2b7e151628aed2a6abf7158809cf4f3c&quot;), 
<a name="3554"/> 3554: 	hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff02&quot;), 
<a name="3555"/> 3555: 	hexstr2bin(&quot;f69f2445df4f9b17ad2b417be66c3710&quot;)}
<a name="3556"/> 3556:     ].
<a name="3557"/> 3557:        
<a name="aes_192_ctr-1"/><a name="3558"/> 3558: <b>aes_192_ctr</b>(_) -&gt;
<a name="aes_192_ctr-last_expr"/><a name="3559"/> 3559:     [ %% F.5.3  CTR-AES192.Encrypt
<a name="3560"/> 3560:       {aes_192_ctr, hexstr2bin(&quot;8e73b0f7da0e6452c810f32b809079e562f8ead2522c6b7b&quot;), 
<a name="3561"/> 3561:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff&quot;), 
<a name="3562"/> 3562:        hexstr2bin(&quot;6bc1bee22e409f96e93d7e117393172a&quot;)},
<a name="3563"/> 3563:       {aes_192_ctr, hexstr2bin(&quot;8e73b0f7da0e6452c810f32b809079e562f8ead2522c6b7b&quot;), 
<a name="3564"/> 3564:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff00&quot;), 
<a name="3565"/> 3565:        hexstr2bin(&quot;ae2d8a571e03ac9c9eb76fac45af8e51&quot;)},
<a name="3566"/> 3566:       {aes_192_ctr, hexstr2bin(&quot;8e73b0f7da0e6452c810f32b809079e562f8ead2522c6b7b&quot;), 
<a name="3567"/> 3567:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff01&quot;), 
<a name="3568"/> 3568: 	hexstr2bin(&quot;30c81c46a35ce411e5fbc1191a0a52ef&quot;)},
<a name="3569"/> 3569:       {aes_192_ctr, hexstr2bin(&quot;8e73b0f7da0e6452c810f32b809079e562f8ead2522c6b7b&quot;), 
<a name="3570"/> 3570:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff02&quot;), 
<a name="3571"/> 3571:        hexstr2bin(&quot;f69f2445df4f9b17ad2b417be66c3710&quot;)}
<a name="3572"/> 3572:     ].
<a name="3573"/> 3573:        
<a name="aes_256_ctr-1"/><a name="3574"/> 3574: <b>aes_256_ctr</b>(_) -&gt;
<a name="aes_256_ctr-last_expr"/><a name="3575"/> 3575:     [ %% F.5.5  CTR-AES256.Encrypt
<a name="3576"/> 3576:       {aes_256_ctr, hexstr2bin(&quot;603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4&quot;), 
<a name="3577"/> 3577:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff&quot;), 
<a name="3578"/> 3578:        hexstr2bin(&quot;6bc1bee22e409f96e93d7e117393172a&quot;)},
<a name="3579"/> 3579:       {aes_256_ctr, hexstr2bin(&quot;603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4&quot;), 
<a name="3580"/> 3580:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff00&quot;), 
<a name="3581"/> 3581:        hexstr2bin(&quot;ae2d8a571e03ac9c9eb76fac45af8e51&quot;)},
<a name="3582"/> 3582:       {aes_256_ctr, hexstr2bin(&quot;603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4&quot;), 
<a name="3583"/> 3583:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff01&quot;), 
<a name="3584"/> 3584:        hexstr2bin(&quot;30c81c46a35ce411e5fbc1191a0a52ef&quot;)},
<a name="3585"/> 3585:       {aes_256_ctr, hexstr2bin(&quot;603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4&quot;), 
<a name="3586"/> 3586:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdff02&quot;), 
<a name="3587"/> 3587:        hexstr2bin(&quot;f69f2445df4f9b17ad2b417be66c3710&quot;)},
<a name="3588"/> 3588: 
<a name="3589"/> 3589:       {aes_256_ctr,  hexstr2bin(&quot;603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4&quot;),
<a name="3590"/> 3590:        hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff&quot;),
<a name="3591"/> 3591:        long_msg()}
<a name="3592"/> 3592:     ].
<a name="3593"/> 3593: 
<a name="3594"/> 3594: 
<a name="aes_gcm-1"/><a name="3595"/> 3595: <b>aes_gcm</b>(Config) -&gt;
<a name="3596"/> 3596:     %% RETIRED aes_*_gcm
<a name="aes_gcm-last_expr"/><a name="3597"/> 3597: <b>    read_rsp</b>(Config, aes_gcm,
<a name="3598"/> 3598:              [&quot;gcmDecrypt128.rsp&quot;,
<a name="3599"/> 3599:               &quot;gcmDecrypt192.rsp&quot;,
<a name="3600"/> 3600:               &quot;gcmDecrypt256.rsp&quot;,
<a name="3601"/> 3601:               &quot;gcmEncryptExtIV128.rsp&quot;,
<a name="3602"/> 3602:               &quot;gcmEncryptExtIV192.rsp&quot;,
<a name="3603"/> 3603:               &quot;gcmEncryptExtIV256.rsp&quot;]).
<a name="3604"/> 3604: 
<a name="aes_128_gcm-1"/><a name="3605"/> 3605: <b>aes_128_gcm</b>(Config) -&gt;
<a name="aes_128_gcm-last_expr"/><a name="3606"/> 3606: <b>   read_rsp</b>(Config, aes_128_gcm,
<a name="3607"/> 3607:             [&quot;gcmDecrypt128.rsp&quot;,
<a name="3608"/> 3608:              &quot;gcmEncryptExtIV128.rsp&quot;]).
<a name="3609"/> 3609: 
<a name="aes_192_gcm-1"/><a name="3610"/> 3610: <b>aes_192_gcm</b>(Config) -&gt;
<a name="aes_192_gcm-last_expr"/><a name="3611"/> 3611: <b>   read_rsp</b>(Config, aes_192_gcm,
<a name="3612"/> 3612:             [&quot;gcmDecrypt192.rsp&quot;,
<a name="3613"/> 3613:              &quot;gcmEncryptExtIV192.rsp&quot;]).
<a name="3614"/> 3614: 
<a name="aes_256_gcm-1"/><a name="3615"/> 3615: <b>aes_256_gcm</b>(Config) -&gt;
<a name="aes_256_gcm-last_expr"/><a name="3616"/> 3616: <b>   read_rsp</b>(Config, aes_256_gcm,
<a name="3617"/> 3617:             [&quot;gcmDecrypt256.rsp&quot;,
<a name="3618"/> 3618:              &quot;gcmEncryptExtIV256.rsp&quot;]).
<a name="3619"/> 3619: 
<a name="3620"/> 3620: 
<a name="aes_ccm-1"/><a name="3621"/> 3621: <b>aes_ccm</b>(Config) -&gt;
<a name="3622"/> 3622:     %% RETIRED aes_*_ccm
<a name="aes_ccm-last_expr"/><a name="3623"/> 3623: <b>    read_rsp</b>(Config, aes_ccm,
<a name="3624"/> 3624:              [&quot;VADT128.rsp&quot;, &quot;VADT192.rsp&quot;, &quot;VADT256.rsp&quot;,
<a name="3625"/> 3625:               &quot;VNT128.rsp&quot;,  &quot;VNT192.rsp&quot;,  &quot;VNT256.rsp&quot;,
<a name="3626"/> 3626:               &quot;VPT128.rsp&quot;,  &quot;VPT192.rsp&quot;,  &quot;VPT256.rsp&quot;
<a name="3627"/> 3627:              ]).
<a name="3628"/> 3628: 
<a name="aes_128_ccm-1"/><a name="3629"/> 3629: <b>aes_128_ccm</b>(Config) -&gt;
<a name="aes_128_ccm-last_expr"/><a name="3630"/> 3630: <b>    read_rsp</b>(Config, aes_128_ccm,
<a name="3631"/> 3631:             [&quot;VADT128.rsp&quot;, &quot;VNT128.rsp&quot;, &quot;VPT128.rsp&quot;]).
<a name="3632"/> 3632: 
<a name="aes_192_ccm-1"/><a name="3633"/> 3633: <b>aes_192_ccm</b>(Config) -&gt;
<a name="aes_192_ccm-last_expr"/><a name="3634"/> 3634: <b>   read_rsp</b>(Config, aes_192_ccm,
<a name="3635"/> 3635:             [&quot;VADT192.rsp&quot;, &quot;VNT192.rsp&quot;, &quot;VPT192.rsp&quot;]).
<a name="3636"/> 3636: 
<a name="aes_256_ccm-1"/><a name="3637"/> 3637: <b>aes_256_ccm</b>(Config) -&gt;
<a name="aes_256_ccm-last_expr"/><a name="3638"/> 3638: <b>   read_rsp</b>(Config, aes_256_ccm,
<a name="3639"/> 3639:             [&quot;VADT256.rsp&quot;, &quot;VNT256.rsp&quot;, &quot;VPT256.rsp&quot;]).
<a name="3640"/> 3640: 
<a name="3641"/> 3641: 
<a name="3642"/> 3642: 
<a name="3643"/> 3643: <i>%% https://tools.ietf.org/html/rfc7539#appendix-A.5</i>
<a name="chacha20_poly1305-1"/><a name="3644"/> 3644: <b>chacha20_poly1305</b>(_) -&gt;
<a name="chacha20_poly1305-last_expr"/><a name="3645"/> 3645:     [
<a name="3646"/> 3646:      {chacha20_poly1305,
<a name="3647"/> 3647:       hexstr2bin(&quot;1c9240a5eb55d38af333888604f6b5f0&quot;                      %% Key
<a name="3648"/> 3648: 			&quot;473917c1402b80099dca5cbc207075c0&quot;),
<a name="3649"/> 3649:       hexstr2bin(&quot;496e7465726e65742d44726166747320&quot;                      %% PlainText
<a name="3650"/> 3650:       &quot;61726520647261667420646f63756d65&quot;
<a name="3651"/> 3651:       &quot;6e74732076616c696420666f72206120&quot;
<a name="3652"/> 3652:       &quot;6d6178696d756d206f6620736978206d&quot;
<a name="3653"/> 3653:       &quot;6f6e74687320616e64206d6179206265&quot;
<a name="3654"/> 3654:       &quot;20757064617465642c207265706c6163&quot;
<a name="3655"/> 3655:       &quot;65642c206f72206f62736f6c65746564&quot;
<a name="3656"/> 3656:       &quot;206279206f7468657220646f63756d65&quot;
<a name="3657"/> 3657:       &quot;6e747320617420616e792074696d652e&quot;
<a name="3658"/> 3658:       &quot;20497420697320696e617070726f7072&quot;
<a name="3659"/> 3659:       &quot;6961746520746f2075736520496e7465&quot;
<a name="3660"/> 3660:       &quot;726e65742d4472616674732061732072&quot;
<a name="3661"/> 3661:       &quot;65666572656e6365206d617465726961&quot;
<a name="3662"/> 3662:       &quot;6c206f7220746f206369746520746865&quot;
<a name="3663"/> 3663:       &quot;6d206f74686572207468616e20617320&quot;
<a name="3664"/> 3664:       &quot;2fe2809c776f726b20696e2070726f67&quot;
<a name="3665"/> 3665:       &quot;726573732e2fe2809d&quot;),
<a name="3666"/> 3666:       hexstr2bin(&quot;000000000102030405060708&quot;),                            %% Nonce
<a name="3667"/> 3667:       hexstr2bin(&quot;f33388860000000000004e91&quot;),                            %% AAD
<a name="3668"/> 3668:       hexstr2bin(&quot;64a0861575861af460f062c79be643bd&quot;                      %% CipherText
<a name="3669"/> 3669:       &quot;5e805cfd345cf389f108670ac76c8cb2&quot;
<a name="3670"/> 3670:       &quot;4c6cfc18755d43eea09ee94e382d26b0&quot;
<a name="3671"/> 3671:       &quot;bdb7b73c321b0100d4f03b7f355894cf&quot;
<a name="3672"/> 3672:       &quot;332f830e710b97ce98c8a84abd0b9481&quot;
<a name="3673"/> 3673:       &quot;14ad176e008d33bd60f982b1ff37c855&quot;
<a name="3674"/> 3674:       &quot;9797a06ef4f0ef61c186324e2b350638&quot;
<a name="3675"/> 3675:       &quot;3606907b6a7c02b0f9f6157b53c867e4&quot;
<a name="3676"/> 3676:       &quot;b9166c767b804d46a59b5216cde7a4e9&quot;
<a name="3677"/> 3677:       &quot;9040c5a40433225ee282a1b0a06c523e&quot;
<a name="3678"/> 3678:       &quot;af4534d7f83fa1155b0047718cbc546a&quot;
<a name="3679"/> 3679:       &quot;0d072b04b3564eea1b422273f548271a&quot;
<a name="3680"/> 3680:       &quot;0bb2316053fa76991955ebd63159434e&quot;
<a name="3681"/> 3681:       &quot;cebb4e466dae5a1073a6727627097a10&quot;
<a name="3682"/> 3682:       &quot;49e617d91d361094fa68f0ff77987130&quot;
<a name="3683"/> 3683:       &quot;305beaba2eda04df997b714d6c6f2c29&quot;
<a name="3684"/> 3684:       &quot;a6ad5cb4022b02709b&quot;),
<a name="3685"/> 3685:       hexstr2bin(&quot;eead9d67890cbb22392336fea1851f38&quot;),                    %% CipherTag
<a name="3686"/> 3686:       no_info
<a name="3687"/> 3687:       }
<a name="3688"/> 3688:     ].
<a name="3689"/> 3689: 
<a name="3690"/> 3690: 
<a name="chacha20-1"/><a name="3691"/> 3691: <b>chacha20</b>(_) -&gt;
<a name="3692"/> 3692: <i>%%% chacha20 (no mode) test vectors from RFC 7539 A.2</i>
<a name="chacha20-last_expr"/><a name="3693"/> 3693:     [
<a name="3694"/> 3694:      %% Test Vector #1:
<a name="3695"/> 3695:      {chacha20,
<a name="3696"/> 3696:       hexstr2bin(&quot;00000000000000000000000000000000&quot;
<a name="3697"/> 3697:                  &quot;00000000000000000000000000000000&quot;),                    %% Key
<a name="3698"/> 3698:       hexstr2bin(&quot;00000000&quot; % Initial counter = 0, little-endian
<a name="3699"/> 3699:                  &quot;000000000000000000000000&quot;),                            %% IV
<a name="3700"/> 3700:       hexstr2bin(&quot;00000000000000000000000000000000&quot;                      %% PlainText
<a name="3701"/> 3701:                  &quot;00000000000000000000000000000000&quot;
<a name="3702"/> 3702:                  &quot;00000000000000000000000000000000&quot;
<a name="3703"/> 3703:                  &quot;00000000000000000000000000000000&quot;),
<a name="3704"/> 3704:       hexstr2bin(&quot;76b8e0ada0f13d90405d6ae55386bd28&quot;                      %% CipherText
<a name="3705"/> 3705:                  &quot;bdd219b8a08ded1aa836efcc8b770dc7&quot;
<a name="3706"/> 3706:                  &quot;da41597c5157488d7724e03fb8d84a37&quot;
<a name="3707"/> 3707:                  &quot;6a43b8f41518a11cc387b669b2ee6586&quot;)},
<a name="3708"/> 3708:      %% Test Vector #2:
<a name="3709"/> 3709:      {chacha20,
<a name="3710"/> 3710:       hexstr2bin(&quot;00000000000000000000000000000000&quot;
<a name="3711"/> 3711:                  &quot;00000000000000000000000000000001&quot;),                    %% Key
<a name="3712"/> 3712:       hexstr2bin(&quot;01000000&quot; % Initial counter = 1, little-endian
<a name="3713"/> 3713:                  &quot;000000000000000000000002&quot;),                            %% IV
<a name="3714"/> 3714:       hexstr2bin(&quot;416e79207375626d697373696f6e2074&quot;                      %% PlainText
<a name="3715"/> 3715:                  &quot;6f20746865204945544620696e74656e&quot;
<a name="3716"/> 3716:                  &quot;6465642062792074686520436f6e7472&quot;
<a name="3717"/> 3717:                  &quot;696275746f7220666f72207075626c69&quot;
<a name="3718"/> 3718:                  &quot;636174696f6e20617320616c6c206f72&quot;
<a name="3719"/> 3719:                  &quot;2070617274206f6620616e2049455446&quot;
<a name="3720"/> 3720:                  &quot;20496e7465726e65742d447261667420&quot;
<a name="3721"/> 3721:                  &quot;6f722052464320616e6420616e792073&quot;
<a name="3722"/> 3722:                  &quot;746174656d656e74206d616465207769&quot;
<a name="3723"/> 3723:                  &quot;7468696e2074686520636f6e74657874&quot;
<a name="3724"/> 3724:                  &quot;206f6620616e20494554462061637469&quot;
<a name="3725"/> 3725:                  &quot;7669747920697320636f6e7369646572&quot;
<a name="3726"/> 3726:                  &quot;656420616e20224945544620436f6e74&quot;
<a name="3727"/> 3727:                  &quot;7269627574696f6e222e205375636820&quot;
<a name="3728"/> 3728:                  &quot;73746174656d656e747320696e636c75&quot;
<a name="3729"/> 3729:                  &quot;6465206f72616c2073746174656d656e&quot;
<a name="3730"/> 3730:                  &quot;747320696e2049455446207365737369&quot;
<a name="3731"/> 3731:                  &quot;6f6e732c2061732077656c6c20617320&quot;
<a name="3732"/> 3732:                  &quot;7772697474656e20616e6420656c6563&quot;
<a name="3733"/> 3733:                  &quot;74726f6e696320636f6d6d756e696361&quot;
<a name="3734"/> 3734:                  &quot;74696f6e73206d61646520617420616e&quot;
<a name="3735"/> 3735:                  &quot;792074696d65206f7220706c6163652c&quot;
<a name="3736"/> 3736:                  &quot;20776869636820617265206164647265&quot;
<a name="3737"/> 3737:                  &quot;7373656420746f&quot;),
<a name="3738"/> 3738:       hexstr2bin(&quot;a3fbf07df3fa2fde4f376ca23e827370&quot;                      %% CipherText
<a name="3739"/> 3739:                  &quot;41605d9f4f4f57bd8cff2c1d4b7955ec&quot;
<a name="3740"/> 3740:                  &quot;2a97948bd3722915c8f3d337f7d37005&quot;
<a name="3741"/> 3741:                  &quot;0e9e96d647b7c39f56e031ca5eb6250d&quot;
<a name="3742"/> 3742:                  &quot;4042e02785ececfa4b4bb5e8ead0440e&quot;
<a name="3743"/> 3743:                  &quot;20b6e8db09d881a7c6132f420e527950&quot;
<a name="3744"/> 3744:                  &quot;42bdfa7773d8a9051447b3291ce1411c&quot;
<a name="3745"/> 3745:                  &quot;680465552aa6c405b7764d5e87bea85a&quot;
<a name="3746"/> 3746:                  &quot;d00f8449ed8f72d0d662ab052691ca66&quot;
<a name="3747"/> 3747:                  &quot;424bc86d2df80ea41f43abf937d3259d&quot;
<a name="3748"/> 3748:                  &quot;c4b2d0dfb48a6c9139ddd7f76966e928&quot;
<a name="3749"/> 3749:                  &quot;e635553ba76c5c879d7b35d49eb2e62b&quot;
<a name="3750"/> 3750:                  &quot;0871cdac638939e25e8a1e0ef9d5280f&quot;
<a name="3751"/> 3751:                  &quot;a8ca328b351c3c765989cbcf3daa8b6c&quot;
<a name="3752"/> 3752:                  &quot;cc3aaf9f3979c92b3720fc88dc95ed84&quot;
<a name="3753"/> 3753:                  &quot;a1be059c6499b9fda236e7e818b04b0b&quot;
<a name="3754"/> 3754:                  &quot;c39c1e876b193bfe5569753f88128cc0&quot;
<a name="3755"/> 3755:                  &quot;8aaa9b63d1a16f80ef2554d7189c411f&quot;
<a name="3756"/> 3756:                  &quot;5869ca52c5b83fa36ff216b9c1d30062&quot;
<a name="3757"/> 3757:                  &quot;bebcfd2dc5bce0911934fda79a86f6e6&quot;
<a name="3758"/> 3758:                  &quot;98ced759c3ff9b6477338f3da4f9cd85&quot;
<a name="3759"/> 3759:                  &quot;14ea9982ccafb341b2384dd902f3d1ab&quot;
<a name="3760"/> 3760:                  &quot;7ac61dd29c6f21ba5b862f3730e37cfd&quot;
<a name="3761"/> 3761:                  &quot;c4fd806c22f221&quot;)},
<a name="3762"/> 3762:      %%Test Vector #3:
<a name="3763"/> 3763:      {chacha20,
<a name="3764"/> 3764:       hexstr2bin(&quot;1c9240a5eb55d38af333888604f6b5f0&quot;
<a name="3765"/> 3765:                  &quot;473917c1402b80099dca5cbc207075c0&quot;),                    %% Key
<a name="3766"/> 3766:       hexstr2bin(&quot;2a000000&quot; % Initial counter = 42 (decimal), little-endian
<a name="3767"/> 3767:                  &quot;000000000000000000000002&quot;),                            %% IV
<a name="3768"/> 3768:       hexstr2bin(&quot;2754776173206272696c6c69672c2061&quot;                      %% PlainText
<a name="3769"/> 3769:                  &quot;6e642074686520736c6974687920746f&quot;
<a name="3770"/> 3770:                  &quot;7665730a446964206779726520616e64&quot;
<a name="3771"/> 3771:                  &quot;2067696d626c6520696e207468652077&quot;
<a name="3772"/> 3772:                  &quot;6162653a0a416c6c206d696d73792077&quot;
<a name="3773"/> 3773:                  &quot;6572652074686520626f726f676f7665&quot;
<a name="3774"/> 3774:                  &quot;732c0a416e6420746865206d6f6d6520&quot;
<a name="3775"/> 3775:                  &quot;7261746873206f757467726162652e&quot;),
<a name="3776"/> 3776:       hexstr2bin(&quot;62e6347f95ed87a45ffae7426f27a1df&quot;                      %% CipherText
<a name="3777"/> 3777:                  &quot;5fb69110044c0d73118effa95b01e5cf&quot;
<a name="3778"/> 3778:                  &quot;166d3df2d721caf9b21e5fb14c616871&quot;
<a name="3779"/> 3779:                  &quot;fd84c54f9d65b283196c7fe4f60553eb&quot;
<a name="3780"/> 3780:                  &quot;f39c6402c42234e32a356b3e764312a6&quot;
<a name="3781"/> 3781:                  &quot;1a5532055716ead6962568f87d3f3f77&quot;
<a name="3782"/> 3782:                  &quot;04c6a8d1bcd1bf4d50d6154b6da731b1&quot;
<a name="3783"/> 3783:                  &quot;87b58dfd728afa36757a797ac188d1&quot;)}
<a name="3784"/> 3784:     ].
<a name="3785"/> 3785: 
<a name="3786"/> 3786: 
<a name="rsa_plain-0"/><a name="3787"/> 3787: <b>rsa_plain</b>() -&gt;
<a name="rsa_plain-last_expr"/><a name="3788"/> 3788:     &lt;&lt;&quot;7896345786348756234 Hejsan Svejsan, erlang crypto debugger&quot;
<a name="3789"/> 3789:       &quot;09812312908312378623487263487623412039812 huagasd&quot;&gt;&gt;.
<a name="rsa_public-0"/><a name="3790"/> 3790: <b>rsa_public</b>() -&gt;
<a name="rsa_public-last_expr"/><a name="3791"/> 3791:     [65537, 7919488123861148172698919999061127847747888703039837999377650217570191053151807772962118671509138346758471459464133273114654252861270845708312601272799123].
<a name="rsa_private-0"/><a name="3792"/> 3792: <b>rsa_private</b>() -&gt;
<a name="rsa_private-last_expr"/><a name="3793"/> 3793: <b>    rsa_public</b>() ++ [7531712708607620783801185371644749935066152052780368689827275932079815492940396744378735701395659435842364793962992309884847527234216715366607660219930945].
<a name="3794"/> 3794: 
<a name="rsa_public_stronger-0"/><a name="3795"/> 3795: <b>rsa_public_stronger</b>() -&gt;
<a name="rsa_public_stronger-last_expr"/><a name="3796"/> 3796:     [65537, 24629450921918866883077380602720734920775458960049554761386137065662137652635369332143446151320538248280934442179850504891395344346514465469955766163141133564033962851182759993807898821114734943339732032639891483186089941567854227407119560631150779000222837755424893038740314247760600374970909894211201220612920040986106639419467243909950276018045907029941478599124238353052062083560294570722081552510960894164859765695309596889747541376908786225647625736062865138957717982693312699025417086612046330464651009693307624955796202070510577399561730651967517158452930742355327167632521808183383868100102455048819375344881].
<a name="3797"/> 3797: 
<a name="rsa_private_stronger-0"/><a name="3798"/> 3798: <b>rsa_private_stronger</b>() -&gt;
<a name="rsa_private_stronger-last_expr"/><a name="3799"/> 3799: <b>    rsa_public_stronger</b>() ++ [13565232776562604620467234237694854016819673873109064019820773052201665024482754648718278717031083946624786145611240731564761987114634269887293030432042088547345315212418830656522115993209293567218379960177754901461542373481136856927955012596579314262051109321754382091434920473734937991286600905464814063189230779981494358415076362038786197620360127262110530926733754185204773610295221669711309000953136320804528874719105049753061737780710448207922456570922652651354760939379096788728229638142403068102990416717272880560951246813789730402978652924934794503277969128609831043469924881848849409122972426787999886557185].
<a name="3800"/> 3800: 
<a name="dss_plain-0"/><a name="3801"/> 3801: <b>dss_plain</b>() -&gt;
<a name="dss_plain-last_expr"/><a name="3802"/> 3802: <b>    rsa_plain</b>().
<a name="dss_public-0"/><a name="3803"/> 3803: <b>dss_public</b>() -&gt;
<a name="dss_public-last_expr"/><a name="3804"/> 3804:     16#289ff18c32a56bb0b8839370647683a38a5a7e291410b93207212adc8088d30f93e9e4abc523f3d46936e7d5c90d88742b36afd37563408f15c8c1a4f7ac24bf05f01008ffee70c8825d57c3a9308bad8a095af2b53b2dda3cbed846d95e301eb9b84766415d11f6c33209a0d28571096ab04a79aa0dc465997529686b68e887cd8a205c2dc8195aef0422eba9979f549ac85548e419413643b7244361153ada1480d238cd00dc16527938955548dd5d027ded1029eeeb8ed6c61b4cd59341d8b15466e9da890a989996f4d7691e6072de136af28b5874bf08bd1f8a60cfb1c00888132909f515e04bce81b02951aa41baac68ffdb8c5dc77a1d32d8f2c10dd7.
<a name="dss_private-0"/><a name="3805"/> 3805: <b>dss_private</b>() -&gt;
<a name="dss_private-last_expr"/><a name="3806"/> 3806:     16#6132e551cdac88409183bd37ee1452cd247d4834b08814b275be3ff5.
<a name="dss_params-0"/><a name="3807"/> 3807: <b>dss_params</b>() -&gt;
<a name="dss_params-last_expr"/><a name="3808"/> 3808:     [16#f2d39ed3062b13c916273600a0f2a029e86d7a4b9217b4f1815bf2b24d9710a57ab33f997294b014585b8d0198dfdccbcd75314da5ff85aa344b45adaeaa979b51a312a7bfa94472fb633f1a6f156bb4458867dfd38403f06b851f00fe2d3484077bded71ab7513d04a140220575fb693395480e4c8402b7a46cec2d37a778c305accd1f13e9f62e865315f4b22cc467c8986ec8e4961ddf810566b0c4ee369ac6aa15e43f4744005826f5bde8071a19e30b6909aac4b3d174237270dad02799d09b8a2cc5f22e66894b5422228b2c234f11f5a771c5b89cf465a2acecbbeeaa1725fe8f9b59422be8991052cb556ddf2c8ce8fa9206dbf39feadc194e00f8e5,
<a name="3809"/> 3809:      16#8000000000000000c118f49835e4ef733c4d15800fcf059e884d31b1,
<a name="3810"/> 3810:      16#e3a93c09da6f560e4d483a382a4c546f2335c36a4c35ac1463c08a3e6dd415df56fdc537f25fd5372be63e4f5300780b782f1acd01c8b4eb33414615fd0ea82573acba7ef83f5a943854151afc2d7dfe121fb8cd03335b065b549c5dcc606be9052483bc284e12ac3c8dba09b426e08402030e70bc1cc2bf8957c4ba0630f3f32ad689389ac47443176063f247d9e2296b3ea5b5bc2335828ea1a080ed35918dee212fd031279d1b894f01afec523833669eac031a420e540ba1320a59c424a3e5849a460a56bcb001647885b1433c4f992971746bfe2977ce7259c550b551a6c35761e4a41af764e8d92132fcc0a59d1684eab90d863f29f41cf7578faa908c].
<a name="3811"/> 3811: 
<a name="ec_key_named-0"/><a name="3812"/> 3812: <b>ec_key_named</b>() -&gt;
<a name="3813"/> 3813:     Curve = secp224r1, %hd(crypto:ec_curves()),
<a name="3814"/> 3814:     {D2_pub, D2_priv} = crypto:generate_key(ecdh, Curve),
<a name="ec_key_named-last_expr"/><a name="3815"/> 3815:     {[D2_priv, Curve], [D2_pub, Curve]}.
<a name="3816"/> 3816: 
<a name="ec_msg-0"/><a name="3817"/> 3817: <b>ec_msg</b>() -&gt;
<a name="ec_msg-last_expr"/><a name="3818"/> 3818:     &lt;&lt;99,234,6,64,190,237,201,99,80,248,58,40,70,45,149,218,5,246,242,63&gt;&gt;.
<a name="3819"/> 3819: 
<a name="srp3-0"/><a name="3820"/> 3820: <b>srp3</b>() -&gt;
<a name="3821"/> 3821:     Username = &lt;&lt;&quot;alice&quot;&gt;&gt;,
<a name="3822"/> 3822:     Password = &lt;&lt;&quot;password123&quot;&gt;&gt;,
<a name="3823"/> 3823:     Salt = hexstr2bin(&quot;2857827A19266A1F2BC6&quot;),
<a name="3824"/> 3824:     Prime = hexstr2bin(&quot;EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C&quot;
<a name="3825"/> 3825: 		       &quot;9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE4&quot;
<a name="3826"/> 3826: 		       &quot;8E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B29&quot;
<a name="3827"/> 3827: 		       &quot;7BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9A&quot;
<a name="3828"/> 3828: 		       &quot;FD5138FE8376435B9FC61D2FC0EB06E3&quot;),
<a name="3829"/> 3829:     Generator = &lt;&lt;2&gt;&gt;,
<a name="3830"/> 3830:     Version = '3',
<a name="3831"/> 3831:     Scrambler = hexstr2bin(&quot;02E2476A&quot;),
<a name="3832"/> 3832: 
<a name="3833"/> 3833:     %% X = hexstr2bin(&quot;96E54AB0CD4C5123EDCFA4A1502918AAD3C9E2A8&quot;),
<a name="3834"/> 3834:     Verifier = hexstr2bin(&quot;96EB5F13621D911AA1CA405DE9C64217D4108EEEECAFFE500034FE0E&quot;
<a name="3835"/> 3835: 			  &quot;C031E42C8714667C161BCE0E7996F7DDE1B63824C130D2D7286C08C0&quot;
<a name="3836"/> 3836: 			  &quot;49758420735961347112AE102A3F23B3F687F8FEE0DF2BFAF933C608&quot;
<a name="3837"/> 3837: 			  &quot;D6FE5B5EEE3116FE54016E065BF8E8C9FDBBC08719231AC215149140&quot;
<a name="3838"/> 3838: 			  &quot;519E8FDD9AA4F410C28A58AF42974D2D&quot;),
<a name="3839"/> 3839:     ClientPrivate = hexstr2bin(&quot;6411DE75538BED8170677D577D0608F39112BC95B503C447EB6AC945&quot;
<a name="3840"/> 3840: 			  &quot;49C75C7B&quot;),
<a name="3841"/> 3841:     ServerPrivate = hexstr2bin(&quot;85E44A6F694DBE676145DB245A045CD37C99F05C562C7840A31F270D&quot;
<a name="3842"/> 3842: 			  &quot;9AADCF8B&quot;),
<a name="3843"/> 3843:     ClientPublic = hexstr2bin(&quot;B22B1FFA2244B8CB94F3A9080F419CAEAB0DBA93EA1965B5E84587EE&quot;
<a name="3844"/> 3844: 			 &quot;55C79E7A118865DC59B9D0353362C2A8261E7C1B0D221A0E233C2AD1&quot;
<a name="3845"/> 3845: 			 &quot;640DACBB8664CBC9733EAC392DA7800142860380C3FC573C3C064329&quot;
<a name="3846"/> 3846: 			 &quot;CF54063FD114C7210E9CB3A611EA8002B1844B698F930D95D143899B&quot;
<a name="3847"/> 3847: 			 &quot;948A090E0C25938E5F84067D1883DC63&quot;),
<a name="3848"/> 3848:     ServerPublic = hexstr2bin(&quot;93A8C4D8B7F7395ADCFD4ABA37B015124513D3F37B3E85EB23064BE5&quot;
<a name="3849"/> 3849: 			 &quot;F53C0AE32FFB9D8C0AA0DCFFA74D632DD67DEBB5C35AAE9812286CC8&quot;
<a name="3850"/> 3850: 			 &quot;C43CC176ECBC6D3F447594D9554E995B2509127BF88FADDDA4982D03&quot;
<a name="3851"/> 3851: 			 &quot;8EC3001320712D3B1269308CE70F319B2295FA57674F03A2D993CFB1&quot;
<a name="3852"/> 3852: 			 &quot;F84C35B7D0C012FA73CD4C8F7D5A71C7&quot;),
<a name="3853"/> 3853: 
<a name="3854"/> 3854:     SessionKey = hexstr2bin(&quot;C29A986C4D521BBC66428ED11D994CD7431574A6184B83CDCC345092&quot;
<a name="3855"/> 3855: 			    &quot;791E75748A1D38CAC4BD14760F0D2694B711236419240FF2F172454C&quot;
<a name="3856"/> 3856: 			    &quot;46ABF4FF39498DAFDD2C82924F7D7BD76CDFCE688C77D93F18A65409&quot;
<a name="3857"/> 3857: 			    &quot;9176A9192615DC0277AE7C12F1F6A7F6563FCA11675D809AF578BDE5&quot;
<a name="3858"/> 3858: 			    &quot;2B51E05D440B63099A017A0B45044801&quot;),
<a name="3859"/> 3859:     UserPassHash = crypto:hash(sha, [Salt, crypto:hash(sha, [Username, &lt;&lt;$:&gt;&gt;, Password])]),
<a name="3860"/> 3860:     Verifier = crypto:mod_pow(Generator, UserPassHash, Prime), 
<a name="3861"/> 3861:     ClientPublic = crypto:mod_pow(Generator, ClientPrivate, Prime), 
<a name="srp3-last_expr"/><a name="3862"/> 3862: <b>    srp</b>(ClientPrivate, Generator, Prime, Version, Verifier, ServerPublic, ServerPrivate, UserPassHash, Scrambler, SessionKey).
<a name="3863"/> 3863: 
<a name="srp6-0"/><a name="3864"/> 3864: <b>srp6</b>() -&gt;
<a name="3865"/> 3865:     Username = &lt;&lt;&quot;alice&quot;&gt;&gt;,
<a name="3866"/> 3866:     Password = &lt;&lt;&quot;password123&quot;&gt;&gt;,
<a name="3867"/> 3867:     Salt = hexstr2bin(&quot;2857827A19266A1F2BC6&quot;),
<a name="3868"/> 3868:     Prime = hexstr2bin(&quot;EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C&quot;
<a name="3869"/> 3869: 		       &quot;9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE4&quot;
<a name="3870"/> 3870: 		       &quot;8E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B29&quot;
<a name="3871"/> 3871: 		       &quot;7BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9A&quot;
<a name="3872"/> 3872: 		       &quot;FD5138FE8376435B9FC61D2FC0EB06E3&quot;),
<a name="3873"/> 3873:     Generator = &lt;&lt;2&gt;&gt;,
<a name="3874"/> 3874:     Version = '6',
<a name="3875"/> 3875:     Scrambler = hexstr2bin(&quot;0A2534C0BF52A0DA9001EEC62CF2A546AB0908A7&quot;),
<a name="3876"/> 3876:     Verifier = hexstr2bin(&quot;96EB5F13621D911AA1CA405DE9C64217D4108EEEECAFFE500034FE0E&quot;
<a name="3877"/> 3877: 			  &quot;C031E42C8714667C161BCE0E7996F7DDE1B63824C130D2D7286C08C0&quot;
<a name="3878"/> 3878: 			  &quot;49758420735961347112AE102A3F23B3F687F8FEE0DF2BFAF933C608&quot;
<a name="3879"/> 3879: 			  &quot;D6FE5B5EEE3116FE54016E065BF8E8C9FDBBC08719231AC215149140&quot;
<a name="3880"/> 3880: 			  &quot;519E8FDD9AA4F410C28A58AF42974D2D&quot;),
<a name="3881"/> 3881:     ClientPrivate = hexstr2bin(&quot;6411DE75538BED8170677D577D0608F39112BC95B503C447EB6AC945&quot;
<a name="3882"/> 3882: 			  &quot;49C75C7B&quot;),
<a name="3883"/> 3883:     ServerPrivate = hexstr2bin(&quot;85E44A6F694DBE676145DB245A045CD37C99F05C562C7840A31F270D&quot;
<a name="3884"/> 3884: 			  &quot;9AADCF8B&quot;),
<a name="3885"/> 3885:     ClientPublic = hexstr2bin(&quot;B22B1FFA2244B8CB94F3A9080F419CAEAB0DBA93EA1965B5E84587EE&quot;
<a name="3886"/> 3886: 			 &quot;55C79E7A118865DC59B9D0353362C2A8261E7C1B0D221A0E233C2AD1&quot;
<a name="3887"/> 3887: 			 &quot;640DACBB8664CBC9733EAC392DA7800142860380C3FC573C3C064329&quot;
<a name="3888"/> 3888: 			 &quot;CF54063FD114C7210E9CB3A611EA8002B1844B698F930D95D143899B&quot;
<a name="3889"/> 3889: 			 &quot;948A090E0C25938E5F84067D1883DC63&quot;),
<a name="3890"/> 3890:     ServerPublic = hexstr2bin(&quot;D2D07845CE7ECDB9845DD36B10ACD3598CC29049DE9F467F84CE16B6&quot;
<a name="3891"/> 3891: 			 &quot;D97A6DC567AF8B0F9FEDF74962400AD5C357951E64E67B641246F264&quot;
<a name="3892"/> 3892: 			 &quot;C8DE6D9A72E554D6C8D3194548780A0C438A0FCC509CA88A14AA1DEB&quot;
<a name="3893"/> 3893: 			 &quot;C0F09E4B37A965D1545DB4AD361346F3189B0EA569C06D326C4E4797&quot;
<a name="3894"/> 3894: 			 &quot;9E381C748293B7C0591BE0BE419E053E&quot;),
<a name="3895"/> 3895: 
<a name="3896"/> 3896:     SessionKey = hexstr2bin(&quot;19D22C19612874EBF1F2581F8EFCFDC44C6FDA3B87B0A73823D7E962&quot;
<a name="3897"/> 3897: 				 &quot;554295D4E48D3A336523ADBDDD0EC8FB0F02687109E97E01C17C93CC&quot;
<a name="3898"/> 3898: 				 &quot;7216F9CD8A4AC39F0429857D8D1023066614BDFCBCB89F59A0FEB81C&quot;
<a name="3899"/> 3899: 				 &quot;72E992AAD89095A84B6A5FADA152369AB1E350A03693BEF044DF3EDF&quot;
<a name="3900"/> 3900: 				 &quot;0C34741F4696C30E9F675D09F58ACBEB&quot;),
<a name="3901"/> 3901:     UserPassHash = crypto:hash(sha, [Salt, crypto:hash(sha, [Username, &lt;&lt;$:&gt;&gt;, Password])]),
<a name="3902"/> 3902:     Verifier = crypto:mod_pow(Generator, UserPassHash, Prime), 
<a name="3903"/> 3903:     ClientPublic = crypto:mod_pow(Generator, ClientPrivate, Prime),
<a name="srp6-last_expr"/><a name="3904"/> 3904: <b>    srp</b>(ClientPrivate, Generator, Prime, Version, Verifier, ServerPublic, ServerPrivate, UserPassHash, Scrambler, SessionKey).
<a name="3905"/> 3905: 
<a name="3906"/> 3906: 
<a name="srp6a_smaller_prime-0"/><a name="3907"/> 3907: <b>srp6a_smaller_prime</b>() -&gt;
<a name="3908"/> 3908:     Username = &lt;&lt;&quot;alice&quot;&gt;&gt;,
<a name="3909"/> 3909:     Password = &lt;&lt;&quot;password123&quot;&gt;&gt;,
<a name="3910"/> 3910:     Salt = &lt;&lt;&quot;mystrongsalt&quot;&gt;&gt;,
<a name="3911"/> 3911:     Prime = hexstr2bin(&quot;894B645E89E1535BBDAD5B8B290650530801B18EBFBF5E8FAB3C82872A3E9BB7&quot;),
<a name="3912"/> 3912:     Generator = &lt;&lt;7&gt;&gt;,
<a name="3913"/> 3913:     Version = '6a',
<a name="3914"/> 3914:     Scrambler = hexstr2bin(&quot;18DE4A002AD05EF464B19AE2B6929F9B1319C7AA&quot;),
<a name="3915"/> 3915:     Verifier = hexstr2bin(&quot;867401D5DE10964768184EAF246B322760C847604075FA66A4423907&quot;
<a name="3916"/> 3916: 			  &quot;8428BCA5&quot;),
<a name="3917"/> 3917:     ClientPrivate = hexstr2bin(&quot;C49F832EE8D67ECF9E7F2785EB0622D8B3FE2344C00F96E1AEF4103C&quot;
<a name="3918"/> 3918: 			  &quot;A44D51F9&quot;),
<a name="3919"/> 3919:     ServerPrivate = hexstr2bin(&quot;6C78CCEAAEC15E69068A87795B2A20ED7B45CFC5A254EBE2F17F144A&quot;
<a name="3920"/> 3920: 			  &quot;4D99DB18&quot;),
<a name="3921"/> 3921:     ClientPublic = hexstr2bin(&quot;2452A57166BBBF690DB77539BAF9C57CD1ED99D5AA15ED925AD9B5C3&quot;
<a name="3922"/> 3922: 			  &quot;64BBEDFF&quot;),
<a name="3923"/> 3923:     ServerPublic = hexstr2bin(&quot;2C0464DE84B91E4963A3546CAC0EFE55F31F49208C3F0AD7EE55F444&quot;
<a name="3924"/> 3924: 			  &quot;8F38BA7F&quot;),
<a name="3925"/> 3925: 
<a name="3926"/> 3926:     SessionKey = hexstr2bin(&quot;65581B2302580BD26F522A5A421CF969B9CCBCE4051196B034A2A9D22065D848&quot;),
<a name="3927"/> 3927:     UserPassHash = crypto:hash(sha, [Salt, crypto:hash(sha, [Username, &lt;&lt;$:&gt;&gt;, Password])]),
<a name="3928"/> 3928:     Verifier = crypto:mod_pow(Generator, UserPassHash, Prime), 
<a name="3929"/> 3929:     ClientPublic = crypto:mod_pow(Generator, ClientPrivate, Prime),
<a name="srp6a_smaller_prime-last_expr"/><a name="3930"/> 3930: <b>    srp</b>(ClientPrivate, Generator, Prime, Version, Verifier, ServerPublic, ServerPrivate, UserPassHash, Scrambler, SessionKey).
<a name="3931"/> 3931: 
<a name="srp6a-0"/><a name="3932"/> 3932: <b>srp6a</b>() -&gt;
<a name="3933"/> 3933:     Username = &lt;&lt;&quot;alice&quot;&gt;&gt;,
<a name="3934"/> 3934:     Password = &lt;&lt;&quot;password123&quot;&gt;&gt;,
<a name="3935"/> 3935:     Salt = hexstr2bin(&quot;BEB25379D1A8581EB5A727673A2441EE&quot;),
<a name="3936"/> 3936:     Prime = hexstr2bin(&quot;EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C&quot;
<a name="3937"/> 3937: 		       &quot;9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE4&quot;
<a name="3938"/> 3938: 		       &quot;8E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B29&quot;
<a name="3939"/> 3939: 		       &quot;7BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9A&quot;
<a name="3940"/> 3940: 		       &quot;FD5138FE8376435B9FC61D2FC0EB06E3&quot;),
<a name="3941"/> 3941:     Generator = &lt;&lt;2&gt;&gt;,
<a name="3942"/> 3942:     Version = '6a',
<a name="3943"/> 3943:     Scrambler = hexstr2bin(&quot;CE38B9593487DA98554ED47D70A7AE5F462EF019&quot;),
<a name="3944"/> 3944:     Verifier = hexstr2bin(&quot;7E273DE8696FFC4F4E337D05B4B375BEB0DDE1569E8FA00A9886D812&quot;
<a name="3945"/> 3945: 			  &quot;9BADA1F1822223CA1A605B530E379BA4729FDC59F105B4787E5186F5&quot;
<a name="3946"/> 3946: 			  &quot;C671085A1447B52A48CF1970B4FB6F8400BBF4CEBFBB168152E08AB5&quot;
<a name="3947"/> 3947: 			  &quot;EA53D15C1AFF87B2B9DA6E04E058AD51CC72BFC9033B564E26480D78&quot;
<a name="3948"/> 3948: 			  &quot;E955A5E29E7AB245DB2BE315E2099AFB&quot;),
<a name="3949"/> 3949:     ClientPrivate = hexstr2bin(&quot;60975527035CF2AD1989806F0407210BC81EDC04E2762A56AFD529DD&quot;
<a name="3950"/> 3950: 			  &quot;DA2D4393&quot;),
<a name="3951"/> 3951:     ServerPrivate = hexstr2bin(&quot;E487CB59D31AC550471E81F00F6928E01DDA08E974A004F49E61F5D1&quot;
<a name="3952"/> 3952: 			  &quot;05284D20&quot;),
<a name="3953"/> 3953:     ClientPublic = hexstr2bin(&quot;61D5E490F6F1B79547B0704C436F523DD0E560F0C64115BB72557EC4&quot;
<a name="3954"/> 3954: 			      &quot;4352E8903211C04692272D8B2D1A5358A2CF1B6E0BFCF99F921530EC&quot;
<a name="3955"/> 3955: 			      &quot;8E39356179EAE45E42BA92AEACED825171E1E8B9AF6D9C03E1327F44&quot;
<a name="3956"/> 3956: 			      &quot;BE087EF06530E69F66615261EEF54073CA11CF5858F0EDFDFE15EFEA&quot;
<a name="3957"/> 3957: 			      &quot;B349EF5D76988A3672FAC47B0769447B&quot;),
<a name="3958"/> 3958:     ServerPublic = hexstr2bin(&quot;BD0C61512C692C0CB6D041FA01BB152D4916A1E77AF46AE105393011&quot;
<a name="3959"/> 3959: 			      &quot;BAF38964DC46A0670DD125B95A981652236F99D9B681CBF87837EC99&quot;
<a name="3960"/> 3960: 			      &quot;6C6DA04453728610D0C6DDB58B318885D7D82C7F8DEB75CE7BD4FBAA&quot;
<a name="3961"/> 3961: 			      &quot;37089E6F9C6059F388838E7A00030B331EB76840910440B1B27AAEAE&quot;
<a name="3962"/> 3962: 			      &quot;EB4012B7D7665238A8E3FB004B117B58&quot;),
<a name="3963"/> 3963:     
<a name="3964"/> 3964:     SessionKey = hexstr2bin(&quot;B0DC82BABCF30674AE450C0287745E7990A3381F63B387AAF271A10D&quot;
<a name="3965"/> 3965: 			    &quot;233861E359B48220F7C4693C9AE12B0A6F67809F0876E2D013800D6C&quot;
<a name="3966"/> 3966: 			    &quot;41BB59B6D5979B5C00A172B4A2A5903A0BDCAF8A709585EB2AFAFA8F&quot;
<a name="3967"/> 3967: 			    &quot;3499B200210DCC1F10EB33943CD67FC88A2F39A4BE5BEC4EC0A3212D&quot;
<a name="3968"/> 3968: 			    &quot;C346D7E474B29EDE8A469FFECA686E5A&quot;),
<a name="3969"/> 3969:     UserPassHash = crypto:hash(sha, [Salt, crypto:hash(sha, [Username, &lt;&lt;$:&gt;&gt;, Password])]),
<a name="3970"/> 3970:     Verifier = crypto:mod_pow(Generator, UserPassHash, Prime), 
<a name="3971"/> 3971:     ClientPublic = crypto:mod_pow(Generator, ClientPrivate, Prime), 
<a name="srp6a-last_expr"/><a name="3972"/> 3972: <b>    srp</b>(ClientPrivate, Generator, Prime, Version, Verifier, ServerPublic, ServerPrivate, UserPassHash, Scrambler, SessionKey).
<a name="3973"/> 3973: 
<a name="srp-10"/><a name="3974"/> 3974: <b>srp</b>(ClientPrivate, Generator, Prime, Version, Verifier, ServerPublic, ServerPrivate, UserPassHash, Scrambler, SessionKey)-&gt;
<a name="srp-last_expr"/><a name="3975"/> 3975:     {srp, ClientPrivate, 
<a name="3976"/> 3976:      {user, [Generator, Prime, Version]}, {user, [UserPassHash, Prime, Generator, Version, Scrambler]}, 
<a name="3977"/> 3977:      ServerPublic, ServerPrivate, {host, [Verifier, Generator, Prime, Version]},
<a name="3978"/> 3978:      {host, [Verifier, Prime, Version, Scrambler]},
<a name="3979"/> 3979:      SessionKey}.
<a name="3980"/> 3980: 
<a name="eddsa-1"/><a name="3981"/> 3981: <b>eddsa</b>(ed25519) -&gt;
<a name="3982"/> 3982:     %% https://tools.ietf.org/html/rfc8032#section-7.1
<a name="3983"/> 3983:     %% {ALGORITHM, (SHA), SECRET KEY, PUBLIC KEY,  MESSAGE, SIGNATURE}
<a name="3984"/> 3984:     [
<a name="3985"/> 3985:      %% TEST 1
<a name="3986"/> 3986:      {ed25519, undefined,
<a name="3987"/> 3987:       hexstr2bin(&quot;9d61b19deffd5a60ba844af492ec2cc4&quot;
<a name="3988"/> 3988:                  &quot;4449c5697b326919703bac031cae7f60&quot;),
<a name="3989"/> 3989:       hexstr2bin(&quot;d75a980182b10ab7d54bfed3c964073a&quot;
<a name="3990"/> 3990:                  &quot;0ee172f3daa62325af021a68f707511a&quot;),
<a name="3991"/> 3991:       hexstr2bin(&quot;&quot;),
<a name="3992"/> 3992:       hexstr2bin(&quot;e5564300c360ac729086e2cc806e828a&quot;
<a name="3993"/> 3993:                  &quot;84877f1eb8e5d974d873e06522490155&quot;
<a name="3994"/> 3994:                  &quot;5fb8821590a33bacc61e39701cf9b46b&quot;
<a name="3995"/> 3995:                  &quot;d25bf5f0595bbe24655141438e7a100b&quot;)},
<a name="3996"/> 3996:      %% TEST 2
<a name="3997"/> 3997:      {ed25519, undefined,
<a name="3998"/> 3998:       hexstr2bin(&quot;4ccd089b28ff96da9db6c346ec114e0f&quot;
<a name="3999"/> 3999:                  &quot;5b8a319f35aba624da8cf6ed4fb8a6fb&quot;),
<a name="4000"/> 4000:       hexstr2bin(&quot;3d4017c3e843895a92b70aa74d1b7ebc&quot;
<a name="4001"/> 4001:                  &quot;9c982ccf2ec4968cc0cd55f12af4660c&quot;),
<a name="4002"/> 4002:       hexstr2bin(&quot;72&quot;),
<a name="4003"/> 4003:       hexstr2bin(&quot;92a009a9f0d4cab8720e820b5f642540&quot;
<a name="4004"/> 4004:                  &quot;a2b27b5416503f8fb3762223ebdb69da&quot;
<a name="4005"/> 4005:                  &quot;085ac1e43e15996e458f3613d0f11d8c&quot;
<a name="4006"/> 4006:                  &quot;387b2eaeb4302aeeb00d291612bb0c00&quot;)},
<a name="4007"/> 4007:      %% TEST 3
<a name="4008"/> 4008:      {ed25519, undefined,
<a name="4009"/> 4009:       hexstr2bin(&quot;c5aa8df43f9f837bedb7442f31dcb7b1&quot;
<a name="4010"/> 4010:                  &quot;66d38535076f094b85ce3a2e0b4458f7&quot;),
<a name="4011"/> 4011:       hexstr2bin(&quot;fc51cd8e6218a1a38da47ed00230f058&quot;
<a name="4012"/> 4012:                  &quot;0816ed13ba3303ac5deb911548908025&quot;),
<a name="4013"/> 4013:       hexstr2bin(&quot;af82&quot;),
<a name="4014"/> 4014:       hexstr2bin(&quot;6291d657deec24024827e69c3abe01a3&quot;
<a name="4015"/> 4015:                  &quot;0ce548a284743a445e3680d7db5ac3ac&quot;
<a name="4016"/> 4016:                  &quot;18ff9b538d16f290ae67f760984dc659&quot;
<a name="4017"/> 4017:                  &quot;4a7c15e9716ed28dc027beceea1ec40a&quot;)},
<a name="4018"/> 4018:      %% TEST 1024
<a name="4019"/> 4019:      {ed25519, undefined,
<a name="4020"/> 4020:       hexstr2bin(&quot;f5e5767cf153319517630f226876b86c&quot;
<a name="4021"/> 4021:                  &quot;8160cc583bc013744c6bf255f5cc0ee5&quot;),
<a name="4022"/> 4022:       hexstr2bin(&quot;278117fc144c72340f67d0f2316e8386&quot;
<a name="4023"/> 4023:                  &quot;ceffbf2b2428c9c51fef7c597f1d426e&quot;),
<a name="4024"/> 4024:       hexstr2bin(&quot;08b8b2b733424243760fe426a4b54908&quot;
<a name="4025"/> 4025:                  &quot;632110a66c2f6591eabd3345e3e4eb98&quot;
<a name="4026"/> 4026:                  &quot;fa6e264bf09efe12ee50f8f54e9f77b1&quot;
<a name="4027"/> 4027:                  &quot;e355f6c50544e23fb1433ddf73be84d8&quot;
<a name="4028"/> 4028:                  &quot;79de7c0046dc4996d9e773f4bc9efe57&quot;
<a name="4029"/> 4029:                  &quot;38829adb26c81b37c93a1b270b20329d&quot;
<a name="4030"/> 4030:                  &quot;658675fc6ea534e0810a4432826bf58c&quot;
<a name="4031"/> 4031:                  &quot;941efb65d57a338bbd2e26640f89ffbc&quot;
<a name="4032"/> 4032:                  &quot;1a858efcb8550ee3a5e1998bd177e93a&quot;
<a name="4033"/> 4033:                  &quot;7363c344fe6b199ee5d02e82d522c4fe&quot;
<a name="4034"/> 4034:                  &quot;ba15452f80288a821a579116ec6dad2b&quot;
<a name="4035"/> 4035:                  &quot;3b310da903401aa62100ab5d1a36553e&quot;
<a name="4036"/> 4036:                  &quot;06203b33890cc9b832f79ef80560ccb9&quot;
<a name="4037"/> 4037:                  &quot;a39ce767967ed628c6ad573cb116dbef&quot;
<a name="4038"/> 4038:                  &quot;efd75499da96bd68a8a97b928a8bbc10&quot;
<a name="4039"/> 4039:                  &quot;3b6621fcde2beca1231d206be6cd9ec7&quot;
<a name="4040"/> 4040:                  &quot;aff6f6c94fcd7204ed3455c68c83f4a4&quot;
<a name="4041"/> 4041:                  &quot;1da4af2b74ef5c53f1d8ac70bdcb7ed1&quot;
<a name="4042"/> 4042:                  &quot;85ce81bd84359d44254d95629e9855a9&quot;
<a name="4043"/> 4043:                  &quot;4a7c1958d1f8ada5d0532ed8a5aa3fb2&quot;
<a name="4044"/> 4044:                  &quot;d17ba70eb6248e594e1a2297acbbb39d&quot;
<a name="4045"/> 4045:                  &quot;502f1a8c6eb6f1ce22b3de1a1f40cc24&quot;
<a name="4046"/> 4046:                  &quot;554119a831a9aad6079cad88425de6bd&quot;
<a name="4047"/> 4047:                  &quot;e1a9187ebb6092cf67bf2b13fd65f270&quot;
<a name="4048"/> 4048:                  &quot;88d78b7e883c8759d2c4f5c65adb7553&quot;
<a name="4049"/> 4049:                  &quot;878ad575f9fad878e80a0c9ba63bcbcc&quot;
<a name="4050"/> 4050:                  &quot;2732e69485bbc9c90bfbd62481d9089b&quot;
<a name="4051"/> 4051:                  &quot;eccf80cfe2df16a2cf65bd92dd597b07&quot;
<a name="4052"/> 4052:                  &quot;07e0917af48bbb75fed413d238f5555a&quot;
<a name="4053"/> 4053:                  &quot;7a569d80c3414a8d0859dc65a46128ba&quot;
<a name="4054"/> 4054:                  &quot;b27af87a71314f318c782b23ebfe808b&quot;
<a name="4055"/> 4055:                  &quot;82b0ce26401d2e22f04d83d1255dc51a&quot;
<a name="4056"/> 4056:                  &quot;ddd3b75a2b1ae0784504df543af8969b&quot;
<a name="4057"/> 4057:                  &quot;e3ea7082ff7fc9888c144da2af58429e&quot;
<a name="4058"/> 4058:                  &quot;c96031dbcad3dad9af0dcbaaaf268cb8&quot;
<a name="4059"/> 4059:                  &quot;fcffead94f3c7ca495e056a9b47acdb7&quot;
<a name="4060"/> 4060:                  &quot;51fb73e666c6c655ade8297297d07ad1&quot;
<a name="4061"/> 4061:                  &quot;ba5e43f1bca32301651339e22904cc8c&quot;
<a name="4062"/> 4062:                  &quot;42f58c30c04aafdb038dda0847dd988d&quot;
<a name="4063"/> 4063:                  &quot;cda6f3bfd15c4b4c4525004aa06eeff8&quot;
<a name="4064"/> 4064:                  &quot;ca61783aacec57fb3d1f92b0fe2fd1a8&quot;
<a name="4065"/> 4065:                  &quot;5f6724517b65e614ad6808d6f6ee34df&quot;
<a name="4066"/> 4066:                  &quot;f7310fdc82aebfd904b01e1dc54b2927&quot;
<a name="4067"/> 4067:                  &quot;094b2db68d6f903b68401adebf5a7e08&quot;
<a name="4068"/> 4068:                  &quot;d78ff4ef5d63653a65040cf9bfd4aca7&quot;
<a name="4069"/> 4069:                  &quot;984a74d37145986780fc0b16ac451649&quot;
<a name="4070"/> 4070:                  &quot;de6188a7dbdf191f64b5fc5e2ab47b57&quot;
<a name="4071"/> 4071:                  &quot;f7f7276cd419c17a3ca8e1b939ae49e4&quot;
<a name="4072"/> 4072:                  &quot;88acba6b965610b5480109c8b17b80e1&quot;
<a name="4073"/> 4073:                  &quot;b7b750dfc7598d5d5011fd2dcc5600a3&quot;
<a name="4074"/> 4074:                  &quot;2ef5b52a1ecc820e308aa342721aac09&quot;
<a name="4075"/> 4075:                  &quot;43bf6686b64b2579376504ccc493d97e&quot;
<a name="4076"/> 4076:                  &quot;6aed3fb0f9cd71a43dd497f01f17c0e2&quot;
<a name="4077"/> 4077:                  &quot;cb3797aa2a2f256656168e6c496afc5f&quot;
<a name="4078"/> 4078:                  &quot;b93246f6b1116398a346f1a641f3b041&quot;
<a name="4079"/> 4079:                  &quot;e989f7914f90cc2c7fff357876e506b5&quot;
<a name="4080"/> 4080:                  &quot;0d334ba77c225bc307ba537152f3f161&quot;
<a name="4081"/> 4081:                  &quot;0e4eafe595f6d9d90d11faa933a15ef1&quot;
<a name="4082"/> 4082:                  &quot;369546868a7f3a45a96768d40fd9d034&quot;
<a name="4083"/> 4083:                  &quot;12c091c6315cf4fde7cb68606937380d&quot;
<a name="4084"/> 4084:                  &quot;b2eaaa707b4c4185c32eddcdd306705e&quot;
<a name="4085"/> 4085:                  &quot;4dc1ffc872eeee475a64dfac86aba41c&quot;
<a name="4086"/> 4086:                  &quot;0618983f8741c5ef68d3a101e8a3b8ca&quot;
<a name="4087"/> 4087:                  &quot;c60c905c15fc910840b94c00a0b9d0&quot;),
<a name="4088"/> 4088:       hexstr2bin(&quot;0aab4c900501b3e24d7cdf4663326a3a&quot;
<a name="4089"/> 4089:                  &quot;87df5e4843b2cbdb67cbf6e460fec350&quot;
<a name="4090"/> 4090:                  &quot;aa5371b1508f9f4528ecea23c436d94b&quot;
<a name="4091"/> 4091:                  &quot;5e8fcd4f681e30a6ac00a9704a188a03&quot;)},
<a name="4092"/> 4092:      %% TEST SHA(abc)
<a name="4093"/> 4093:      {ed25519, undefined,
<a name="4094"/> 4094:       hexstr2bin(&quot;833fe62409237b9d62ec77587520911e&quot;
<a name="4095"/> 4095:                  &quot;9a759cec1d19755b7da901b96dca3d42&quot;),
<a name="4096"/> 4096:       hexstr2bin(&quot;ec172b93ad5e563bf4932c70e1245034&quot;
<a name="4097"/> 4097:                  &quot;c35467ef2efd4d64ebf819683467e2bf&quot;),
<a name="4098"/> 4098:       hexstr2bin(&quot;ddaf35a193617abacc417349ae204131&quot;
<a name="4099"/> 4099:                  &quot;12e6fa4e89a97ea20a9eeee64b55d39a&quot;
<a name="4100"/> 4100:                  &quot;2192992a274fc1a836ba3c23a3feebbd&quot;
<a name="4101"/> 4101:                  &quot;454d4423643ce80e2a9ac94fa54ca49f&quot;),
<a name="4102"/> 4102:       hexstr2bin(&quot;dc2a4459e7369633a52b1bf277839a00&quot;
<a name="4103"/> 4103:                  &quot;201009a3efbf3ecb69bea2186c26b589&quot;
<a name="4104"/> 4104:                  &quot;09351fc9ac90b3ecfdfbc7c66431e030&quot;
<a name="4105"/> 4105:                  &quot;3dca179c138ac17ad9bef1177331a704&quot;)}
<a name="4106"/> 4106:     ];
<a name="4107"/> 4107: 
<a name="4108"/> 4108: <b>eddsa</b>(ed448) -&gt;
<a name="4109"/> 4109:     %% https://tools.ietf.org/html/rfc8032#section-7.4
<a name="eddsa-last_expr"/><a name="4110"/> 4110:     [{ed448, undefined,
<a name="4111"/> 4111:       hexstr2bin(&quot;6c82a562cb808d10d632be89c8513ebf&quot;
<a name="4112"/> 4112:                  &quot;6c929f34ddfa8c9f63c9960ef6e348a3&quot;
<a name="4113"/> 4113:                  &quot;528c8a3fcc2f044e39a3fc5b94492f8f&quot;
<a name="4114"/> 4114:                  &quot;032e7549a20098f95b&quot;),
<a name="4115"/> 4115:       hexstr2bin(&quot;5fd7449b59b461fd2ce787ec616ad46a&quot;
<a name="4116"/> 4116:                  &quot;1da1342485a70e1f8a0ea75d80e96778&quot;
<a name="4117"/> 4117:                  &quot;edf124769b46c7061bd6783df1e50f6c&quot;
<a name="4118"/> 4118:                  &quot;d1fa1abeafe8256180&quot;),
<a name="4119"/> 4119:       hexstr2bin(&quot;&quot;),
<a name="4120"/> 4120:       hexstr2bin(&quot;533a37f6bbe457251f023c0d88f976ae&quot;
<a name="4121"/> 4121:                  &quot;2dfb504a843e34d2074fd823d41a591f&quot;
<a name="4122"/> 4122:                  &quot;2b233f034f628281f2fd7a22ddd47d78&quot;
<a name="4123"/> 4123:                  &quot;28c59bd0a21bfd3980ff0d2028d4b18a&quot;
<a name="4124"/> 4124:                  &quot;9df63e006c5d1c2d345b925d8dc00b41&quot;
<a name="4125"/> 4125:                  &quot;04852db99ac5c7cdda8530a113a0f4db&quot;
<a name="4126"/> 4126:                  &quot;b61149f05a7363268c71d95808ff2e65&quot;
<a name="4127"/> 4127:                  &quot;2600&quot;)},
<a name="4128"/> 4128:      %% 1 octet
<a name="4129"/> 4129:      {ed448, undefined,
<a name="4130"/> 4130:       hexstr2bin(&quot;c4eab05d357007c632f3dbb48489924d&quot;
<a name="4131"/> 4131:                  &quot;552b08fe0c353a0d4a1f00acda2c463a&quot;
<a name="4132"/> 4132:                  &quot;fbea67c5e8d2877c5e3bc397a659949e&quot;
<a name="4133"/> 4133:                  &quot;f8021e954e0a12274e&quot;),
<a name="4134"/> 4134:       hexstr2bin(&quot;43ba28f430cdff456ae531545f7ecd0a&quot;
<a name="4135"/> 4135:                  &quot;c834a55d9358c0372bfa0c6c6798c086&quot;
<a name="4136"/> 4136:                  &quot;6aea01eb00742802b8438ea4cb82169c&quot;
<a name="4137"/> 4137:                  &quot;235160627b4c3a9480&quot;),
<a name="4138"/> 4138:       hexstr2bin(&quot;03&quot;),
<a name="4139"/> 4139:       hexstr2bin(&quot;26b8f91727bd62897af15e41eb43c377&quot;
<a name="4140"/> 4140:                  &quot;efb9c610d48f2335cb0bd0087810f435&quot;
<a name="4141"/> 4141:                  &quot;2541b143c4b981b7e18f62de8ccdf633&quot;
<a name="4142"/> 4142:                  &quot;fc1bf037ab7cd779805e0dbcc0aae1cb&quot;
<a name="4143"/> 4143:                  &quot;cee1afb2e027df36bc04dcecbf154336&quot;
<a name="4144"/> 4144:                  &quot;c19f0af7e0a6472905e799f1953d2a0f&quot;
<a name="4145"/> 4145:                  &quot;f3348ab21aa4adafd1d234441cf807c0&quot;
<a name="4146"/> 4146:                  &quot;3a00&quot;)},
<a name="4147"/> 4147: 
<a name="4148"/> 4148:      %% %% 1 octet (with context)
<a name="4149"/> 4149:      %% {ed448, undefined,
<a name="4150"/> 4150:      %%  hexstr2bin(&quot;c4eab05d357007c632f3dbb48489924d&quot;
<a name="4151"/> 4151:      %%             &quot;552b08fe0c353a0d4a1f00acda2c463a&quot;
<a name="4152"/> 4152:      %%             &quot;fbea67c5e8d2877c5e3bc397a659949e&quot;
<a name="4153"/> 4153:      %%             &quot;f8021e954e0a12274e&quot;),
<a name="4154"/> 4154:      %%  hexstr2bin(&quot;43ba28f430cdff456ae531545f7ecd0a&quot;
<a name="4155"/> 4155:      %%             &quot;c834a55d9358c0372bfa0c6c6798c086&quot;
<a name="4156"/> 4156:      %%             &quot;6aea01eb00742802b8438ea4cb82169c&quot;
<a name="4157"/> 4157:      %%             &quot;235160627b4c3a9480&quot;),
<a name="4158"/> 4158:      %%  hexstr2bin(&quot;03&quot;),
<a name="4159"/> 4159:      %%  hexstr2bin(&quot;666f6f&quot;), % Context
<a name="4160"/> 4160:      %%  hexstr2bin(&quot;d4f8f6131770dd46f40867d6fd5d5055&quot;
<a name="4161"/> 4161:      %%             &quot;de43541f8c5e35abbcd001b32a89f7d2&quot;
<a name="4162"/> 4162:      %%             &quot;151f7647f11d8ca2ae279fb842d60721&quot;
<a name="4163"/> 4163:      %%             &quot;7fce6e042f6815ea000c85741de5c8da&quot;
<a name="4164"/> 4164:      %%             &quot;1144a6a1aba7f96de42505d7a7298524&quot;
<a name="4165"/> 4165:      %%             &quot;fda538fccbbb754f578c1cad10d54d0d&quot;
<a name="4166"/> 4166:      %%             &quot;5428407e85dcbc98a49155c13764e66c&quot;
<a name="4167"/> 4167:      %%             &quot;3c00&quot;)},
<a name="4168"/> 4168: 
<a name="4169"/> 4169:      %% 11 octets
<a name="4170"/> 4170:      {ed448, undefined,
<a name="4171"/> 4171:       hexstr2bin(&quot;cd23d24f714274e744343237b93290f5&quot;
<a name="4172"/> 4172:                  &quot;11f6425f98e64459ff203e8985083ffd&quot;
<a name="4173"/> 4173:                  &quot;f60500553abc0e05cd02184bdb89c4cc&quot;
<a name="4174"/> 4174:                  &quot;d67e187951267eb328&quot;),
<a name="4175"/> 4175:       hexstr2bin(&quot;dcea9e78f35a1bf3499a831b10b86c90&quot;
<a name="4176"/> 4176:                  &quot;aac01cd84b67a0109b55a36e9328b1e3&quot;
<a name="4177"/> 4177:                  &quot;65fce161d71ce7131a543ea4cb5f7e9f&quot;
<a name="4178"/> 4178:                  &quot;1d8b00696447001400&quot;),
<a name="4179"/> 4179:       hexstr2bin(&quot;0c3e544074ec63b0265e0c&quot;),
<a name="4180"/> 4180:       hexstr2bin(&quot;1f0a8888ce25e8d458a21130879b840a&quot;
<a name="4181"/> 4181:                  &quot;9089d999aaba039eaf3e3afa090a09d3&quot;
<a name="4182"/> 4182:                  &quot;89dba82c4ff2ae8ac5cdfb7c55e94d5d&quot;
<a name="4183"/> 4183:                  &quot;961a29fe0109941e00b8dbdeea6d3b05&quot;
<a name="4184"/> 4184:                  &quot;1068df7254c0cdc129cbe62db2dc957d&quot;
<a name="4185"/> 4185:                  &quot;bb47b51fd3f213fb8698f064774250a5&quot;
<a name="4186"/> 4186:                  &quot;028961c9bf8ffd973fe5d5c206492b14&quot;
<a name="4187"/> 4187:                  &quot;0e00&quot;)},
<a name="4188"/> 4188:      %% 12 octets
<a name="4189"/> 4189:      {ed448, undefined,
<a name="4190"/> 4190:       hexstr2bin(&quot;258cdd4ada32ed9c9ff54e63756ae582&quot;
<a name="4191"/> 4191:                  &quot;fb8fab2ac721f2c8e676a72768513d93&quot;
<a name="4192"/> 4192:                  &quot;9f63dddb55609133f29adf86ec9929dc&quot;
<a name="4193"/> 4193:                  &quot;cb52c1c5fd2ff7e21b&quot;),
<a name="4194"/> 4194:       hexstr2bin(&quot;3ba16da0c6f2cc1f30187740756f5e79&quot;
<a name="4195"/> 4195:                  &quot;8d6bc5fc015d7c63cc9510ee3fd44adc&quot;
<a name="4196"/> 4196:                  &quot;24d8e968b6e46e6f94d19b945361726b&quot;
<a name="4197"/> 4197:                  &quot;d75e149ef09817f580&quot;),
<a name="4198"/> 4198:       hexstr2bin(&quot;64a65f3cdedcdd66811e2915&quot;),
<a name="4199"/> 4199:       hexstr2bin(&quot;7eeeab7c4e50fb799b418ee5e3197ff6&quot;
<a name="4200"/> 4200:                  &quot;bf15d43a14c34389b59dd1a7b1b85b4a&quot;
<a name="4201"/> 4201:                  &quot;e90438aca634bea45e3a2695f1270f07&quot;
<a name="4202"/> 4202:                  &quot;fdcdf7c62b8efeaf00b45c2c96ba457e&quot;
<a name="4203"/> 4203:                  &quot;b1a8bf075a3db28e5c24f6b923ed4ad7&quot;
<a name="4204"/> 4204:                  &quot;47c3c9e03c7079efb87cb110d3a99861&quot;
<a name="4205"/> 4205:                  &quot;e72003cbae6d6b8b827e4e6c143064ff&quot;
<a name="4206"/> 4206:                  &quot;3c00&quot;)},
<a name="4207"/> 4207:      %% 13 octets
<a name="4208"/> 4208:      {ed448, undefined,
<a name="4209"/> 4209:       hexstr2bin(&quot;7ef4e84544236752fbb56b8f31a23a10&quot;
<a name="4210"/> 4210:                  &quot;e42814f5f55ca037cdcc11c64c9a3b29&quot;
<a name="4211"/> 4211:                  &quot;49c1bb60700314611732a6c2fea98eeb&quot;
<a name="4212"/> 4212:                  &quot;c0266a11a93970100e&quot;),
<a name="4213"/> 4213:       hexstr2bin(&quot;b3da079b0aa493a5772029f0467baebe&quot;
<a name="4214"/> 4214:                  &quot;e5a8112d9d3a22532361da294f7bb381&quot;
<a name="4215"/> 4215:                  &quot;5c5dc59e176b4d9f381ca0938e13c6c0&quot;
<a name="4216"/> 4216:                  &quot;7b174be65dfa578e80&quot;),
<a name="4217"/> 4217:       hexstr2bin(&quot;64a65f3cdedcdd66811e2915e7&quot;),
<a name="4218"/> 4218:       hexstr2bin(&quot;6a12066f55331b6c22acd5d5bfc5d712&quot;
<a name="4219"/> 4219:                  &quot;28fbda80ae8dec26bdd306743c5027cb&quot;
<a name="4220"/> 4220:                  &quot;4890810c162c027468675ecf645a8317&quot;
<a name="4221"/> 4221:                  &quot;6c0d7323a2ccde2d80efe5a1268e8aca&quot;
<a name="4222"/> 4222:                  &quot;1d6fbc194d3f77c44986eb4ab4177919&quot;
<a name="4223"/> 4223:                  &quot;ad8bec33eb47bbb5fc6e28196fd1caf5&quot;
<a name="4224"/> 4224:                  &quot;6b4e7e0ba5519234d047155ac727a105&quot;
<a name="4225"/> 4225:                  &quot;3100&quot;)},
<a name="4226"/> 4226:      %% 64 octets
<a name="4227"/> 4227:      {ed448, undefined,
<a name="4228"/> 4228:       hexstr2bin(&quot;d65df341ad13e008567688baedda8e9d&quot;
<a name="4229"/> 4229:                  &quot;cdc17dc024974ea5b4227b6530e339bf&quot;
<a name="4230"/> 4230:                  &quot;f21f99e68ca6968f3cca6dfe0fb9f4fa&quot;
<a name="4231"/> 4231:                  &quot;b4fa135d5542ea3f01&quot;),
<a name="4232"/> 4232:       hexstr2bin(&quot;df9705f58edbab802c7f8363cfe5560a&quot;
<a name="4233"/> 4233:                  &quot;b1c6132c20a9f1dd163483a26f8ac53a&quot;
<a name="4234"/> 4234:                  &quot;39d6808bf4a1dfbd261b099bb03b3fb5&quot;
<a name="4235"/> 4235:                  &quot;0906cb28bd8a081f00&quot;),
<a name="4236"/> 4236:       hexstr2bin(&quot;bd0f6a3747cd561bdddf4640a332461a&quot;
<a name="4237"/> 4237:                  &quot;4a30a12a434cd0bf40d766d9c6d458e5&quot;
<a name="4238"/> 4238:                  &quot;512204a30c17d1f50b5079631f64eb31&quot;
<a name="4239"/> 4239:                  &quot;12182da3005835461113718d1a5ef944&quot;),
<a name="4240"/> 4240:       hexstr2bin(&quot;554bc2480860b49eab8532d2a533b7d5&quot;
<a name="4241"/> 4241:                  &quot;78ef473eeb58c98bb2d0e1ce488a98b1&quot;
<a name="4242"/> 4242:                  &quot;8dfde9b9b90775e67f47d4a1c3482058&quot;
<a name="4243"/> 4243:                  &quot;efc9f40d2ca033a0801b63d45b3b722e&quot;
<a name="4244"/> 4244:                  &quot;f552bad3b4ccb667da350192b61c508c&quot;
<a name="4245"/> 4245:                  &quot;f7b6b5adadc2c8d9a446ef003fb05cba&quot;
<a name="4246"/> 4246:                  &quot;5f30e88e36ec2703b349ca229c267083&quot;
<a name="4247"/> 4247:                  &quot;3900&quot;)},
<a name="4248"/> 4248:      %% 256 octets
<a name="4249"/> 4249:      {ed448, undefined,
<a name="4250"/> 4250:       hexstr2bin(&quot;2ec5fe3c17045abdb136a5e6a913e32a&quot;
<a name="4251"/> 4251:                  &quot;b75ae68b53d2fc149b77e504132d3756&quot;
<a name="4252"/> 4252:                  &quot;9b7e766ba74a19bd6162343a21c8590a&quot;
<a name="4253"/> 4253:                  &quot;a9cebca9014c636df5&quot;),
<a name="4254"/> 4254:       hexstr2bin(&quot;79756f014dcfe2079f5dd9e718be4171&quot;
<a name="4255"/> 4255:                  &quot;e2ef2486a08f25186f6bff43a9936b9b&quot;
<a name="4256"/> 4256:                  &quot;fe12402b08ae65798a3d81e22e9ec80e&quot;
<a name="4257"/> 4257:                  &quot;7690862ef3d4ed3a00&quot;),
<a name="4258"/> 4258:       hexstr2bin(&quot;15777532b0bdd0d1389f636c5f6b9ba7&quot;
<a name="4259"/> 4259:                  &quot;34c90af572877e2d272dd078aa1e567c&quot;
<a name="4260"/> 4260:                  &quot;fa80e12928bb542330e8409f31745041&quot;
<a name="4261"/> 4261:                  &quot;07ecd5efac61ae7504dabe2a602ede89&quot;
<a name="4262"/> 4262:                  &quot;e5cca6257a7c77e27a702b3ae39fc769&quot;
<a name="4263"/> 4263:                  &quot;fc54f2395ae6a1178cab4738e543072f&quot;
<a name="4264"/> 4264:                  &quot;c1c177fe71e92e25bf03e4ecb72f47b6&quot;
<a name="4265"/> 4265:                  &quot;4d0465aaea4c7fad372536c8ba516a60&quot;
<a name="4266"/> 4266:                  &quot;39c3c2a39f0e4d832be432dfa9a706a6&quot;
<a name="4267"/> 4267:                  &quot;e5c7e19f397964ca4258002f7c0541b5&quot;
<a name="4268"/> 4268:                  &quot;90316dbc5622b6b2a6fe7a4abffd9610&quot;
<a name="4269"/> 4269:                  &quot;5eca76ea7b98816af0748c10df048ce0&quot;
<a name="4270"/> 4270:                  &quot;12d901015a51f189f3888145c03650aa&quot;
<a name="4271"/> 4271:                  &quot;23ce894c3bd889e030d565071c59f409&quot;
<a name="4272"/> 4272:                  &quot;a9981b51878fd6fc110624dcbcde0bf7&quot;
<a name="4273"/> 4273:                  &quot;a69ccce38fabdf86f3bef6044819de11&quot;),
<a name="4274"/> 4274:       hexstr2bin(&quot;c650ddbb0601c19ca11439e1640dd931&quot;
<a name="4275"/> 4275:                  &quot;f43c518ea5bea70d3dcde5f4191fe53f&quot;
<a name="4276"/> 4276:                  &quot;00cf966546b72bcc7d58be2b9badef28&quot;
<a name="4277"/> 4277:                  &quot;743954e3a44a23f880e8d4f1cfce2d7a&quot;
<a name="4278"/> 4278:                  &quot;61452d26da05896f0a50da66a239a8a1&quot;
<a name="4279"/> 4279:                  &quot;88b6d825b3305ad77b73fbac0836ecc6&quot;
<a name="4280"/> 4280:                  &quot;0987fd08527c1a8e80d5823e65cafe2a&quot;
<a name="4281"/> 4281:                  &quot;3d00&quot;)},
<a name="4282"/> 4282:      %% 1023 octets
<a name="4283"/> 4283:      {ed448, undefined,
<a name="4284"/> 4284:       hexstr2bin(&quot;872d093780f5d3730df7c212664b37b8&quot;
<a name="4285"/> 4285:                  &quot;a0f24f56810daa8382cd4fa3f77634ec&quot;
<a name="4286"/> 4286:                  &quot;44dc54f1c2ed9bea86fafb7632d8be19&quot;
<a name="4287"/> 4287:                  &quot;9ea165f5ad55dd9ce8&quot;),
<a name="4288"/> 4288:       hexstr2bin(&quot;a81b2e8a70a5ac94ffdbcc9badfc3feb&quot;
<a name="4289"/> 4289:                  &quot;0801f258578bb114ad44ece1ec0e799d&quot;
<a name="4290"/> 4290:                  &quot;a08effb81c5d685c0c56f64eecaef8cd&quot;
<a name="4291"/> 4291:                  &quot;f11cc38737838cf400&quot;),
<a name="4292"/> 4292:       hexstr2bin(&quot;6ddf802e1aae4986935f7f981ba3f035&quot;
<a name="4293"/> 4293:                  &quot;1d6273c0a0c22c9c0e8339168e675412&quot;
<a name="4294"/> 4294:                  &quot;a3debfaf435ed651558007db4384b650&quot;
<a name="4295"/> 4295:                  &quot;fcc07e3b586a27a4f7a00ac8a6fec2cd&quot;
<a name="4296"/> 4296:                  &quot;86ae4bf1570c41e6a40c931db27b2faa&quot;
<a name="4297"/> 4297:                  &quot;15a8cedd52cff7362c4e6e23daec0fbc&quot;
<a name="4298"/> 4298:                  &quot;3a79b6806e316efcc7b68119bf46bc76&quot;
<a name="4299"/> 4299:                  &quot;a26067a53f296dafdbdc11c77f7777e9&quot;
<a name="4300"/> 4300:                  &quot;72660cf4b6a9b369a6665f02e0cc9b6e&quot;
<a name="4301"/> 4301:                  &quot;dfad136b4fabe723d2813db3136cfde9&quot;
<a name="4302"/> 4302:                  &quot;b6d044322fee2947952e031b73ab5c60&quot;
<a name="4303"/> 4303:                  &quot;3349b307bdc27bc6cb8b8bbd7bd32321&quot;
<a name="4304"/> 4304:                  &quot;9b8033a581b59eadebb09b3c4f3d2277&quot;
<a name="4305"/> 4305:                  &quot;d4f0343624acc817804728b25ab79717&quot;
<a name="4306"/> 4306:                  &quot;2b4c5c21a22f9c7839d64300232eb66e&quot;
<a name="4307"/> 4307:                  &quot;53f31c723fa37fe387c7d3e50bdf9813&quot;
<a name="4308"/> 4308:                  &quot;a30e5bb12cf4cd930c40cfb4e1fc6225&quot;
<a name="4309"/> 4309:                  &quot;92a49588794494d56d24ea4b40c89fc0&quot;
<a name="4310"/> 4310:                  &quot;596cc9ebb961c8cb10adde976a5d602b&quot;
<a name="4311"/> 4311:                  &quot;1c3f85b9b9a001ed3c6a4d3b1437f520&quot;
<a name="4312"/> 4312:                  &quot;96cd1956d042a597d561a596ecd3d173&quot;
<a name="4313"/> 4313:                  &quot;5a8d570ea0ec27225a2c4aaff26306d1&quot;
<a name="4314"/> 4314:                  &quot;526c1af3ca6d9cf5a2c98f47e1c46db9&quot;
<a name="4315"/> 4315:                  &quot;a33234cfd4d81f2c98538a09ebe76998&quot;
<a name="4316"/> 4316:                  &quot;d0d8fd25997c7d255c6d66ece6fa56f1&quot;
<a name="4317"/> 4317:                  &quot;1144950f027795e653008f4bd7ca2dee&quot;
<a name="4318"/> 4318:                  &quot;85d8e90f3dc315130ce2a00375a318c7&quot;
<a name="4319"/> 4319:                  &quot;c3d97be2c8ce5b6db41a6254ff264fa6&quot;
<a name="4320"/> 4320:                  &quot;155baee3b0773c0f497c573f19bb4f42&quot;
<a name="4321"/> 4321:                  &quot;40281f0b1f4f7be857a4e59d416c06b4&quot;
<a name="4322"/> 4322:                  &quot;c50fa09e1810ddc6b1467baeac5a3668&quot;
<a name="4323"/> 4323:                  &quot;d11b6ecaa901440016f389f80acc4db9&quot;
<a name="4324"/> 4324:                  &quot;77025e7f5924388c7e340a732e554440&quot;
<a name="4325"/> 4325:                  &quot;e76570f8dd71b7d640b3450d1fd5f041&quot;
<a name="4326"/> 4326:                  &quot;0a18f9a3494f707c717b79b4bf75c984&quot;
<a name="4327"/> 4327:                  &quot;00b096b21653b5d217cf3565c9597456&quot;
<a name="4328"/> 4328:                  &quot;f70703497a078763829bc01bb1cbc8fa&quot;
<a name="4329"/> 4329:                  &quot;04eadc9a6e3f6699587a9e75c94e5bab&quot;
<a name="4330"/> 4330:                  &quot;0036e0b2e711392cff0047d0d6b05bd2&quot;
<a name="4331"/> 4331:                  &quot;a588bc109718954259f1d86678a579a3&quot;
<a name="4332"/> 4332:                  &quot;120f19cfb2963f177aeb70f2d4844826&quot;
<a name="4333"/> 4333:                  &quot;262e51b80271272068ef5b3856fa8535&quot;
<a name="4334"/> 4334:                  &quot;aa2a88b2d41f2a0e2fda7624c2850272&quot;
<a name="4335"/> 4335:                  &quot;ac4a2f561f8f2f7a318bfd5caf969614&quot;
<a name="4336"/> 4336:                  &quot;9e4ac824ad3460538fdc25421beec2cc&quot;
<a name="4337"/> 4337:                  &quot;6818162d06bbed0c40a387192349db67&quot;
<a name="4338"/> 4338:                  &quot;a118bada6cd5ab0140ee273204f628aa&quot;
<a name="4339"/> 4339:                  &quot;d1c135f770279a651e24d8c14d75a605&quot;
<a name="4340"/> 4340:                  &quot;9d76b96a6fd857def5e0b354b27ab937&quot;
<a name="4341"/> 4341:                  &quot;a5815d16b5fae407ff18222c6d1ed263&quot;
<a name="4342"/> 4342:                  &quot;be68c95f32d908bd895cd76207ae7264&quot;
<a name="4343"/> 4343:                  &quot;87567f9a67dad79abec316f683b17f2d&quot;
<a name="4344"/> 4344:                  &quot;02bf07e0ac8b5bc6162cf94697b3c27c&quot;
<a name="4345"/> 4345:                  &quot;d1fea49b27f23ba2901871962506520c&quot;
<a name="4346"/> 4346:                  &quot;392da8b6ad0d99f7013fbc06c2c17a56&quot;
<a name="4347"/> 4347:                  &quot;9500c8a7696481c1cd33e9b14e40b82e&quot;
<a name="4348"/> 4348:                  &quot;79a5f5db82571ba97bae3ad3e0479515&quot;
<a name="4349"/> 4349:                  &quot;bb0e2b0f3bfcd1fd33034efc6245eddd&quot;
<a name="4350"/> 4350:                  &quot;7ee2086ddae2600d8ca73e214e8c2b0b&quot;
<a name="4351"/> 4351:                  &quot;db2b047c6a464a562ed77b73d2d841c4&quot;
<a name="4352"/> 4352:                  &quot;b34973551257713b753632efba348169&quot;
<a name="4353"/> 4353:                  &quot;abc90a68f42611a40126d7cb21b58695&quot;
<a name="4354"/> 4354:                  &quot;568186f7e569d2ff0f9e745d0487dd2e&quot;
<a name="4355"/> 4355:                  &quot;b997cafc5abf9dd102e62ff66cba87&quot;),
<a name="4356"/> 4356:       hexstr2bin(&quot;e301345a41a39a4d72fff8df69c98075&quot;
<a name="4357"/> 4357:                  &quot;a0cc082b802fc9b2b6bc503f926b65bd&quot;
<a name="4358"/> 4358:                  &quot;df7f4c8f1cb49f6396afc8a70abe6d8a&quot;
<a name="4359"/> 4359:                  &quot;ef0db478d4c6b2970076c6a0484fe76d&quot;
<a name="4360"/> 4360:                  &quot;76b3a97625d79f1ce240e7c576750d29&quot;
<a name="4361"/> 4361:                  &quot;5528286f719b413de9ada3e8eb78ed57&quot;
<a name="4362"/> 4362:                  &quot;3603ce30d8bb761785dc30dbc320869e&quot;
<a name="4363"/> 4363:                  &quot;1a00&quot;)}
<a name="4364"/> 4364:     ].
<a name="4365"/> 4365: 
<a name="ecdh-0"/><a name="4366"/> 4366: <b>ecdh</b>() -&gt;
<a name="4367"/> 4367:     %% http://csrc.nist.gov/groups/STM/cavp/
<a name="4368"/> 4368:     Curves = crypto:supports(curves),
<a name="ecdh-last_expr"/><a name="4369"/> 4369: <b>    lists:filter</b>(
<a name="4370"/> 4370:       fun ({_Type, _Pub, _Priv, Curve, _SharedSecret}) -&gt;
<a name="4371"/> 4371:               lists:member(Curve, Curves)
<a name="4372"/> 4372:       end,
<a name="4373"/> 4373: 
<a name="4374"/> 4374:       [{ecdh, hexstr2point(&quot;42ea6dd9969dd2a61fea1aac7f8e98edcc896c6e55857cc0&quot;, &quot;dfbe5d7c61fac88b11811bde328e8a0d12bf01a9d204b523&quot;),
<a name="4375"/> 4375:           hexstr2bin(&quot;f17d3fea367b74d340851ca4270dcb24c271f445bed9d527&quot;),
<a name="4376"/> 4376:           secp192r1,
<a name="4377"/> 4377:           hexstr2bin(&quot;803d8ab2e5b6e6fca715737c3a82f7ce3c783124f6d51cd0&quot;)},
<a name="4378"/> 4378:          {ecdh, hexstr2point(&quot;deb5712fa027ac8d2f22c455ccb73a91e17b6512b5e030e7&quot;, &quot;7e2690a02cc9b28708431a29fb54b87b1f0c14e011ac2125&quot;),
<a name="4379"/> 4379:           hexstr2bin(&quot;56e853349d96fe4c442448dacb7cf92bb7a95dcf574a9bd5&quot;),
<a name="4380"/> 4380:           secp192r1,
<a name="4381"/> 4381:           hexstr2bin(&quot;c208847568b98835d7312cef1f97f7aa298283152313c29d&quot;)},
<a name="4382"/> 4382:          {ecdh, hexstr2point(&quot;af33cd0629bc7e996320a3f40368f74de8704fa37b8fab69abaae280&quot;, &quot;882092ccbba7930f419a8a4f9bb16978bbc3838729992559a6f2e2d7&quot;),
<a name="4383"/> 4383:           hexstr2bin(&quot;8346a60fc6f293ca5a0d2af68ba71d1dd389e5e40837942df3e43cbd&quot;),
<a name="4384"/> 4384:           secp224r1,
<a name="4385"/> 4385:           hexstr2bin(&quot;7d96f9a3bd3c05cf5cc37feb8b9d5209d5c2597464dec3e9983743e8&quot;)},
<a name="4386"/> 4386:          {ecdh, hexstr2point(&quot;13bfcd4f8e9442393cab8fb46b9f0566c226b22b37076976f0617a46&quot;, &quot;eeb2427529b288c63c2f8963c1e473df2fca6caa90d52e2f8db56dd4&quot;),
<a name="4387"/> 4387:           hexstr2bin(&quot;043cb216f4b72cdf7629d63720a54aee0c99eb32d74477dac0c2f73d&quot;),
<a name="4388"/> 4388:           secp224r1,
<a name="4389"/> 4389:           hexstr2bin(&quot;ee93ce06b89ff72009e858c68eb708e7bc79ee0300f73bed69bbca09&quot;)},
<a name="4390"/> 4390:          {ecdh, hexstr2point(&quot;700c48f77f56584c5cc632ca65640db91b6bacce3a4df6b42ce7cc838833d287&quot;, &quot;db71e509e3fd9b060ddb20ba5c51dcc5948d46fbf640dfe0441782cab85fa4ac&quot;),
<a name="4391"/> 4391:           hexstr2bin(&quot;7d7dc5f71eb29ddaf80d6214632eeae03d9058af1fb6d22ed80badb62bc1a534&quot;),
<a name="4392"/> 4392:           secp256r1,
<a name="4393"/> 4393:           hexstr2bin(&quot;46fc62106420ff012e54a434fbdd2d25ccc5852060561e68040dd7778997bd7b&quot;)},
<a name="4394"/> 4394:          {ecdh, hexstr2point(&quot;809f04289c64348c01515eb03d5ce7ac1a8cb9498f5caa50197e58d43a86a7ae&quot;, &quot;b29d84e811197f25eba8f5194092cb6ff440e26d4421011372461f579271cda3&quot;),
<a name="4395"/> 4395:           hexstr2bin(&quot;38f65d6dce47676044d58ce5139582d568f64bb16098d179dbab07741dd5caf5&quot;),
<a name="4396"/> 4396:           secp256r1,
<a name="4397"/> 4397:           hexstr2bin(&quot;057d636096cb80b67a8c038c890e887d1adfa4195e9b3ce241c8a778c59cda67&quot;)},
<a name="4398"/> 4398:          {ecdh, hexstr2point(&quot;a7c76b970c3b5fe8b05d2838ae04ab47697b9eaf52e764592efda27fe7513272734466b400091adbf2d68c58e0c50066&quot;, &quot;ac68f19f2e1cb879aed43a9969b91a0839c4c38a49749b661efedf243451915ed0905a32b060992b468c64766fc8437a&quot;),
<a name="4399"/> 4399:           hexstr2bin(&quot;3cc3122a68f0d95027ad38c067916ba0eb8c38894d22e1b15618b6818a661774ad463b205da88cf699ab4d43c9cf98a1&quot;),
<a name="4400"/> 4400:           secp384r1,
<a name="4401"/> 4401:           hexstr2bin(&quot;5f9d29dc5e31a163060356213669c8ce132e22f57c9a04f40ba7fcead493b457e5621e766c40a2e3d4d6a04b25e533f1&quot;)},
<a name="4402"/> 4402:          {ecdh, hexstr2point(&quot;30f43fcf2b6b00de53f624f1543090681839717d53c7c955d1d69efaf0349b7363acb447240101cbb3af6641ce4b88e0&quot;, &quot;25e46c0c54f0162a77efcc27b6ea792002ae2ba82714299c860857a68153ab62e525ec0530d81b5aa15897981e858757&quot;),
<a name="4403"/> 4403:           hexstr2bin(&quot;92860c21bde06165f8e900c687f8ef0a05d14f290b3f07d8b3a8cc6404366e5d5119cd6d03fb12dc58e89f13df9cd783&quot;),
<a name="4404"/> 4404:           secp384r1,
<a name="4405"/> 4405:           hexstr2bin(&quot;a23742a2c267d7425fda94b93f93bbcc24791ac51cd8fd501a238d40812f4cbfc59aac9520d758cf789c76300c69d2ff&quot;)},
<a name="4406"/> 4406:          {ecdh, hexstr2point(&quot;00685a48e86c79f0f0875f7bc18d25eb5fc8c0b07e5da4f4370f3a9490340854334b1e1b87fa395464c60626124a4e70d0f785601d37c09870ebf176666877a2046d&quot;, &quot;01ba52c56fc8776d9e8f5db4f0cc27636d0b741bbe05400697942e80b739884a83bde99e0f6716939e632bc8986fa18dccd443a348b6c3e522497955a4f3c302f676&quot;),
<a name="4407"/> 4407:           hexstr2bin(&quot;017eecc07ab4b329068fba65e56a1f8890aa935e57134ae0ffcce802735151f4eac6564f6ee9974c5e6887a1fefee5743ae2241bfeb95d5ce31ddcb6f9edb4d6fc47&quot;),
<a name="4408"/> 4408:           secp521r1,
<a name="4409"/> 4409:           hexstr2bin(&quot;005fc70477c3e63bc3954bd0df3ea0d1f41ee21746ed95fc5e1fdf90930d5e136672d72cc770742d1711c3c3a4c334a0ad9759436a4d3c5bf6e74b9578fac148c831&quot;)},
<a name="4410"/> 4410:          {ecdh, hexstr2point(&quot;01df277c152108349bc34d539ee0cf06b24f5d3500677b4445453ccc21409453aafb8a72a0be9ebe54d12270aa51b3ab7f316aa5e74a951c5e53f74cd95fc29aee7a&quot;, &quot;013d52f33a9f3c14384d1587fa8abe7aed74bc33749ad9c570b471776422c7d4505d9b0a96b3bfac041e4c6a6990ae7f700e5b4a6640229112deafa0cd8bb0d089b0&quot;),
<a name="4411"/> 4411:           hexstr2bin(&quot;00816f19c1fb10ef94d4a1d81c156ec3d1de08b66761f03f06ee4bb9dcebbbfe1eaa1ed49a6a990838d8ed318c14d74cc872f95d05d07ad50f621ceb620cd905cfb8&quot;),
<a name="4412"/> 4412:           secp521r1,
<a name="4413"/> 4413:           hexstr2bin(&quot;000b3920ac830ade812c8f96805da2236e002acbbf13596a9ab254d44d0e91b6255ebf1229f366fb5a05c5884ef46032c26d42189273ca4efa4c3db6bd12a6853759&quot;)},
<a name="4414"/> 4414: 
<a name="4415"/> 4415:          %% RFC-6954, Appendix A
<a name="4416"/> 4416:          {ecdh, hexstr2point(&quot;A9C21A569759DA95E0387041184261440327AFE33141CA04B82DC92E&quot;,
<a name="4417"/> 4417:                              &quot;98A0F75FBBF61D8E58AE5511B2BCDBE8E549B31E37069A2825F590C1&quot;),
<a name="4418"/> 4418:           hexstr2bin(&quot;6060552303899E2140715816C45B57D9B42204FB6A5BF5BEAC10DB00&quot;),
<a name="4419"/> 4419:           brainpoolP224r1,
<a name="4420"/> 4420:           hexstr2bin(&quot;1A4BFE705445120C8E3E026699054104510D119757B74D5FE2462C66&quot;)},
<a name="4421"/> 4421:          {ecdh, hexstr2point(&quot;034A56C550FF88056144E6DD56070F54B0135976B5BF77827313F36B&quot;,
<a name="4422"/> 4422:                              &quot;75165AD99347DC86CAAB1CBB579E198EAF88DC35F927B358AA683681&quot;),
<a name="4423"/> 4423:           hexstr2bin(&quot;39F155483CEE191FBECFE9C81D8AB1A03CDA6790E7184ACE44BCA161&quot;),
<a name="4424"/> 4424:           brainpoolP224r1,
<a name="4425"/> 4425:           hexstr2bin(&quot;1A4BFE705445120C8E3E026699054104510D119757B74D5FE2462C66&quot;)},
<a name="4426"/> 4426:          {ecdh, hexstr2point(&quot;44106E913F92BC02A1705D9953A8414DB95E1AAA49E81D9E85F929A8E3100BE5&quot;,
<a name="4427"/> 4427:                              &quot;8AB4846F11CACCB73CE49CBDD120F5A900A69FD32C272223F789EF10EB089BDC&quot;),
<a name="4428"/> 4428:           hexstr2bin(&quot;55E40BC41E37E3E2AD25C3C6654511FFA8474A91A0032087593852D3E7D76BD3&quot;),
<a name="4429"/> 4429:           brainpoolP256r1,
<a name="4430"/> 4430:           hexstr2bin(&quot;89AFC39D41D3B327814B80940B042590F96556EC91E6AE7939BCE31F3A18BF2B&quot;)},
<a name="4431"/> 4431:          {ecdh, hexstr2point(&quot;8D2D688C6CF93E1160AD04CC4429117DC2C41825E1E9FCA0ADDD34E6F1B39F7B&quot;,
<a name="4432"/> 4432:                              &quot;990C57520812BE512641E47034832106BC7D3E8DD0E4C7F1136D7006547CEC6A&quot;),
<a name="4433"/> 4433:           hexstr2bin(&quot;81DB1EE100150FF2EA338D708271BE38300CB54241D79950F77B063039804F1D&quot;),
<a name="4434"/> 4434:           brainpoolP256r1,
<a name="4435"/> 4435:           hexstr2bin(&quot;89AFC39D41D3B327814B80940B042590F96556EC91E6AE7939BCE31F3A18BF2B&quot;)},
<a name="4436"/> 4436:          {ecdh, hexstr2point(&quot;68B665DD91C195800650CDD363C625F4E742E8134667B767B1B476793588F885AB698C852D4A6E77A252D6380FCAF068&quot;,
<a name="4437"/> 4437:                              &quot;55BC91A39C9EC01DEE36017B7D673A931236D2F1F5C83942D049E3FA20607493E0D038FF2FD30C2AB67D15C85F7FAA59&quot;),
<a name="4438"/> 4438:           hexstr2bin(&quot;032640BC6003C59260F7250C3DB58CE647F98E1260ACCE4ACDA3DD869F74E01F8BA5E0324309DB6A9831497ABAC96670&quot;),
<a name="4439"/> 4439:           brainpoolP384r1,
<a name="4440"/> 4440:           hexstr2bin(&quot;0BD9D3A7EA0B3D519D09D8E48D0785FB744A6B355E6304BC51C229FBBCE239BBADF6403715C35D4FB2A5444F575D4F42&quot;)},
<a name="4441"/> 4441:          {ecdh, hexstr2point(&quot;4D44326F269A597A5B58BBA565DA5556ED7FD9A8A9EB76C25F46DB69D19DC8CE6AD18E404B15738B2086DF37E71D1EB4&quot;,
<a name="4442"/> 4442:                              &quot;62D692136DE56CBE93BF5FA3188EF58BC8A3A0EC6C1E151A21038A42E9185329B5B275903D192F8D4E1F32FE9CC78C48&quot;),
<a name="4443"/> 4443:           hexstr2bin(&quot;1E20F5E048A5886F1F157C74E91BDE2B98C8B52D58E5003D57053FC4B0BD65D6F15EB5D1EE1610DF870795143627D042&quot;),
<a name="4444"/> 4444:           brainpoolP384r1,
<a name="4445"/> 4445:           hexstr2bin(&quot;0BD9D3A7EA0B3D519D09D8E48D0785FB744A6B355E6304BC51C229FBBCE239BBADF6403715C35D4FB2A5444F575D4F42&quot;)},
<a name="4446"/> 4446:          {ecdh, hexstr2point(&quot;0A420517E406AAC0ACDCE90FCD71487718D3B953EFD7FBEC5F7F27E28C6149999397E91E029E06457DB2D3E640668B392C2A7E737A7F0BF04436D11640FD09FD&quot;,
<a name="4447"/> 4447:                              &quot;72E6882E8DB28AAD36237CD25D580DB23783961C8DC52DFA2EC138AD472A0FCEF3887CF62B623B2A87DE5C588301EA3E5FC269B373B60724F5E82A6AD147FDE7&quot;),
<a name="4448"/> 4448:           hexstr2bin(&quot;230E18E1BCC88A362FA54E4EA3902009292F7F8033624FD471B5D8ACE49D12CFABBC19963DAB8E2F1EBA00BFFB29E4D72D13F2224562F405CB80503666B25429&quot;),
<a name="4449"/> 4449:           brainpoolP512r1,
<a name="4450"/> 4450:           hexstr2bin(&quot;A7927098655F1F9976FA50A9D566865DC530331846381C87256BAF3226244B76D36403C024D7BBF0AA0803EAFF405D3D24F11A9B5C0BEF679FE1454B21C4CD1F&quot;)},
<a name="4451"/> 4451:          {ecdh, hexstr2point(&quot;9D45F66DE5D67E2E6DB6E93A59CE0BB48106097FF78A081DE781CDB31FCE8CCBAAEA8DD4320C4119F1E9CD437A2EAB3731FA9668AB268D871DEDA55A5473199F&quot;,
<a name="4452"/> 4452:                              &quot;2FDC313095BCDD5FB3A91636F07A959C8E86B5636A1E930E8396049CB481961D365CC11453A06C719835475B12CB52FC3C383BCE35E27EF194512B71876285FA&quot;),
<a name="4453"/> 4453:           hexstr2bin(&quot;16302FF0DBBB5A8D733DAB7141C1B45ACBC8715939677F6A56850A38BD87BD59B09E80279609FF333EB9D4C061231FB26F92EEB04982A5F1D1764CAD57665422&quot;),
<a name="4454"/> 4454:           brainpoolP512r1,
<a name="4455"/> 4455:           hexstr2bin(&quot;A7927098655F1F9976FA50A9D566865DC530331846381C87256BAF3226244B76D36403C024D7BBF0AA0803EAFF405D3D24F11A9B5C0BEF679FE1454B21C4CD1F&quot;)},
<a name="4456"/> 4456: 
<a name="4457"/> 4457:          %% RFC 7748, 6.1
<a name="4458"/> 4458:          {ecdh,
<a name="4459"/> 4459:           16#8520f0098930a754748b7ddcb43ef75a0dbf3a0d26381af4eba4a98eaa9b4e6a,
<a name="4460"/> 4460:           16#5dab087e624a8a4b79e17f8b83800ee66f3bb1292618b6fd1c2f8b27ff88e0eb,
<a name="4461"/> 4461:           x25519,
<a name="4462"/> 4462:           hexstr2bin(&quot;4a5d9d5ba4ce2de1728e3bf480350f25e07e21c947d19e3376f09b3c1e161742&quot;)},
<a name="4463"/> 4463:          {ecdh,
<a name="4464"/> 4464:           16#de9edb7d7b7dc1b4d35b61c2ece435373f8343c85b78674dadfc7e146f882b4f,
<a name="4465"/> 4465:           16#77076d0a7318a57d3c16c17251b26645df4c2f87ebc0992ab177fba51db92c2a,
<a name="4466"/> 4466:           x25519,
<a name="4467"/> 4467:           hexstr2bin(&quot;4a5d9d5ba4ce2de1728e3bf480350f25e07e21c947d19e3376f09b3c1e161742&quot;)},
<a name="4468"/> 4468: 
<a name="4469"/> 4469:          %% RFC 7748, 6.2
<a name="4470"/> 4470:          {ecdh,
<a name="4471"/> 4471:           16#9b08f7cc31b7e3e67d22d5aea121074a273bd2b83de09c63faa73d2c22c5d9bbc836647241d953d40c5b12da88120d53177f80e532c41fa0,
<a name="4472"/> 4472:           16#1c306a7ac2a0e2e0990b294470cba339e6453772b075811d8fad0d1d6927c120bb5ee8972b0d3e21374c9c921b09d1b0366f10b65173992d,
<a name="4473"/> 4473:           x448,
<a name="4474"/> 4474:           hexstr2bin(&quot;07fff4181ac6cc95ec1c16a94a0f74d12da232ce40a77552281d282bb60c0b56fd2464c335543936521c24403085d59a449a5037514a879d&quot;)},
<a name="4475"/> 4475:          {ecdh,
<a name="4476"/> 4476:           16#3eb7a829b0cd20f5bcfc0b599b6feccf6da4627107bdb0d4f345b43027d8b972fc3e34fb4232a13ca706dcb57aec3dae07bdc1c67bf33609,
<a name="4477"/> 4477:           16#9a8f4925d1519f5775cf46b04b5800d4ee9ee8bae8bc5565d498c28dd9c9baf574a9419744897391006382a6f127ab1d9ac2d8c0a598726b,
<a name="4478"/> 4478:           x448,
<a name="4479"/> 4479:           hexstr2bin(&quot;07fff4181ac6cc95ec1c16a94a0f74d12da232ce40a77552281d282bb60c0b56fd2464c335543936521c24403085d59a449a5037514a879d&quot;)}
<a name="4480"/> 4480:         ]
<a name="4481"/> 4481:         ).
<a name="4482"/> 4482: 
<a name="dh-0"/><a name="4483"/> 4483: <b>dh</b>() -&gt;
<a name="dh-last_expr"/><a name="4484"/> 4484:     {dh, 16#FFFFFFFFFFFFFFFFADF85458A2BB4A9AAFDC5620273D3CF1D8B9C583CE2D3695A9E13641146433FBCC939DCE249B3EF97D2FE363630C75D8F681B202AEC4617AD3DF1ED5D5FD65612433F51F5F066ED0856365553DED1AF3B557135E7F57C935984F0C70E0E68B77E2A689DAF3EFE8721DF158A136ADE73530ACCA4F483A797ABC0AB182B324FB61D108A94BB2C8E3FBB96ADAB760D7F4681D4F42A3DE394DF4AE56EDE76372BB190B07A7C8EE0A6D709E02FCE1CDF7E2ECC03404CD28342F619172FE9CE98583FF8E4F1232EEF28183C3FE3B1B4C6FAD733BB5FCBC2EC22005C58EF1837D1683B2C6F34A26C1B2EFFA886B423861285C97FFFFFFFFFFFFFFFF, 2}.
<a name="4485"/> 4485: 
<a name="4486"/> 4486: 
<a name="rsa_oaep-0"/><a name="4487"/> 4487: <b>rsa_oaep</b>() -&gt;
<a name="4488"/> 4488:     %% ftp://ftp.rsa.com/pub/rsalabs/tmp/pkcs1v15crypt-vectors.txt
<a name="4489"/> 4489:     Public = [hexstr2bin(&quot;010001&quot;),
<a name="4490"/> 4490: 	      hexstr2bin(&quot;a8b3b284af8eb50b387034a860f146c4919f318763cd6c5598c8ae4811a1e0abc4c7e0b082d693a5e7fced675cf4668512772c0cbc64a742c6c630f533c8cc72f62ae833c40bf25842e984bb78bdbf97c0107d55bdb662f5c4e0fab9845cb5148ef7392dd3aaff93ae1e6b667bb3d4247616d4f5ba10d4cfd226de88d39f16fb&quot;)],
<a name="4491"/> 4491:     Private = Public ++ [hexstr2bin(&quot;53339cfdb79fc8466a655c7316aca85c55fd8f6dd898fdaf119517ef4f52e8fd8e258df93fee180fa0e4ab29693cd83b152a553d4ac4d1812b8b9fa5af0e7f55fe7304df41570926f3311f15c4d65a732c483116ee3d3d2d0af3549ad9bf7cbfb78ad884f84d5beb04724dc7369b31def37d0cf539e9cfcdd3de653729ead5d1&quot;),
<a name="4492"/> 4492: 			 hexstr2bin(&quot;d32737e7267ffe1341b2d5c0d150a81b586fb3132bed2f8d5262864a9cb9f30af38be448598d413a172efb802c21acf1c11c520c2f26a471dcad212eac7ca39d&quot;),
<a name="4493"/> 4493: 			 hexstr2bin(&quot;cc8853d1d54da630fac004f471f281c7b8982d8224a490edbeb33d3e3d5cc93c4765703d1dd791642f1f116a0dd852be2419b2af72bfe9a030e860b0288b5d77&quot;),
<a name="4494"/> 4494: 			 hexstr2bin(&quot;0e12bf1718e9cef5599ba1c3882fe8046a90874eefce8f2ccc20e4f2741fb0a33a3848aec9c9305fbecbd2d76819967d4671acc6431e4037968db37878e695c1&quot;),
<a name="4495"/> 4495: 			 hexstr2bin(&quot;95297b0f95a2fa67d00707d609dfd4fc05c89dafc2ef6d6ea55bec771ea333734d9251e79082ecda866efef13c459e1a631386b7e354c899f5f112ca85d71583&quot;),
<a name="4496"/> 4496: 			 hexstr2bin(&quot;4f456c502493bdc0ed2ab756a3a6ed4d67352a697d4216e93212b127a63d5411ce6fa98d5dbefd73263e3728142743818166ed7dd63687dd2a8ca1d2f4fbd8e1&quot;)],
<a name="4497"/> 4497:     %%Msg = hexstr2bin(&quot;6628194e12073db03ba94cda9ef9532397d50dba79b987004afefe34&quot;),
<a name="4498"/> 4498:     Msg =  hexstr2bin(&quot;750c4047f547e8e41411856523298ac9bae245efaf1397fbe56f9dd5&quot;),
<a name="rsa_oaep-last_expr"/><a name="4499"/> 4499:     {rsa, Public, Private, Msg, [{rsa_padding, rsa_pkcs1_oaep_padding}]}.
<a name="4500"/> 4500: 
<a name="rsa_oaep_label-0"/><a name="4501"/> 4501: <b>rsa_oaep_label</b>() -&gt;
<a name="4502"/> 4502:     Public = [hexstr2bin(&quot;010001&quot;),
<a name="4503"/> 4503: 	      hexstr2bin(&quot;a8b3b284af8eb50b387034a860f146c4919f318763cd6c5598c8ae4811a1e0abc4c7e0b082d693a5e7fced675cf4668512772c0cbc64a742c6c630f533c8cc72f62ae833c40bf25842e984bb78bdbf97c0107d55bdb662f5c4e0fab9845cb5148ef7392dd3aaff93ae1e6b667bb3d4247616d4f5ba10d4cfd226de88d39f16fb&quot;)],
<a name="4504"/> 4504:     Private = Public ++ [hexstr2bin(&quot;53339cfdb79fc8466a655c7316aca85c55fd8f6dd898fdaf119517ef4f52e8fd8e258df93fee180fa0e4ab29693cd83b152a553d4ac4d1812b8b9fa5af0e7f55fe7304df41570926f3311f15c4d65a732c483116ee3d3d2d0af3549ad9bf7cbfb78ad884f84d5beb04724dc7369b31def37d0cf539e9cfcdd3de653729ead5d1&quot;),
<a name="4505"/> 4505: 			 hexstr2bin(&quot;d32737e7267ffe1341b2d5c0d150a81b586fb3132bed2f8d5262864a9cb9f30af38be448598d413a172efb802c21acf1c11c520c2f26a471dcad212eac7ca39d&quot;),
<a name="4506"/> 4506: 			 hexstr2bin(&quot;cc8853d1d54da630fac004f471f281c7b8982d8224a490edbeb33d3e3d5cc93c4765703d1dd791642f1f116a0dd852be2419b2af72bfe9a030e860b0288b5d77&quot;),
<a name="4507"/> 4507: 			 hexstr2bin(&quot;0e12bf1718e9cef5599ba1c3882fe8046a90874eefce8f2ccc20e4f2741fb0a33a3848aec9c9305fbecbd2d76819967d4671acc6431e4037968db37878e695c1&quot;),
<a name="4508"/> 4508: 			 hexstr2bin(&quot;95297b0f95a2fa67d00707d609dfd4fc05c89dafc2ef6d6ea55bec771ea333734d9251e79082ecda866efef13c459e1a631386b7e354c899f5f112ca85d71583&quot;),
<a name="4509"/> 4509: 			 hexstr2bin(&quot;4f456c502493bdc0ed2ab756a3a6ed4d67352a697d4216e93212b127a63d5411ce6fa98d5dbefd73263e3728142743818166ed7dd63687dd2a8ca1d2f4fbd8e1&quot;)],
<a name="4510"/> 4510:     Msg = hexstr2bin(&quot;750c4047f547e8e41411856523298ac9bae245efaf1397fbe56f9dd5&quot;),
<a name="4511"/> 4511:     Lbl = hexstr2bin(&quot;1332a67ca7088f75c9b8fb5e3d072882&quot;),
<a name="rsa_oaep_label-last_expr"/><a name="4512"/> 4512:     {rsa, Public, Private, Msg, [{rsa_padding, rsa_pkcs1_oaep_padding}, {rsa_oaep_label, Lbl}]}.
<a name="4513"/> 4513: 
<a name="rsa_oaep256-0"/><a name="4514"/> 4514: <b>rsa_oaep256</b>() -&gt;
<a name="4515"/> 4515:     Public = [hexstr2bin(&quot;010001&quot;),
<a name="4516"/> 4516: 	      hexstr2bin(&quot;a8b3b284af8eb50b387034a860f146c4919f318763cd6c5598c8ae4811a1e0abc4c7e0b082d693a5e7fced675cf4668512772c0cbc64a742c6c630f533c8cc72f62ae833c40bf25842e984bb78bdbf97c0107d55bdb662f5c4e0fab9845cb5148ef7392dd3aaff93ae1e6b667bb3d4247616d4f5ba10d4cfd226de88d39f16fb&quot;)],
<a name="4517"/> 4517:     Private = Public ++ [hexstr2bin(&quot;53339cfdb79fc8466a655c7316aca85c55fd8f6dd898fdaf119517ef4f52e8fd8e258df93fee180fa0e4ab29693cd83b152a553d4ac4d1812b8b9fa5af0e7f55fe7304df41570926f3311f15c4d65a732c483116ee3d3d2d0af3549ad9bf7cbfb78ad884f84d5beb04724dc7369b31def37d0cf539e9cfcdd3de653729ead5d1&quot;),
<a name="4518"/> 4518: 			 hexstr2bin(&quot;d32737e7267ffe1341b2d5c0d150a81b586fb3132bed2f8d5262864a9cb9f30af38be448598d413a172efb802c21acf1c11c520c2f26a471dcad212eac7ca39d&quot;),
<a name="4519"/> 4519: 			 hexstr2bin(&quot;cc8853d1d54da630fac004f471f281c7b8982d8224a490edbeb33d3e3d5cc93c4765703d1dd791642f1f116a0dd852be2419b2af72bfe9a030e860b0288b5d77&quot;),
<a name="4520"/> 4520: 			 hexstr2bin(&quot;0e12bf1718e9cef5599ba1c3882fe8046a90874eefce8f2ccc20e4f2741fb0a33a3848aec9c9305fbecbd2d76819967d4671acc6431e4037968db37878e695c1&quot;),
<a name="4521"/> 4521: 			 hexstr2bin(&quot;95297b0f95a2fa67d00707d609dfd4fc05c89dafc2ef6d6ea55bec771ea333734d9251e79082ecda866efef13c459e1a631386b7e354c899f5f112ca85d71583&quot;),
<a name="4522"/> 4522: 			 hexstr2bin(&quot;4f456c502493bdc0ed2ab756a3a6ed4d67352a697d4216e93212b127a63d5411ce6fa98d5dbefd73263e3728142743818166ed7dd63687dd2a8ca1d2f4fbd8e1&quot;)],
<a name="4523"/> 4523:     Msg = hexstr2bin(&quot;750c4047f547e8e41411856523298ac9bae245efaf1397fbe56f9dd5&quot;),
<a name="rsa_oaep256-last_expr"/><a name="4524"/> 4524:     {rsa, Public, Private, Msg, [{rsa_padding, rsa_pkcs1_oaep_padding}, {rsa_oaep_md, sha256}]}.
<a name="4525"/> 4525: 
<a name="ecc-0"/><a name="4526"/> 4526: <b>ecc</b>() -&gt;
<a name="4527"/> 4527: <i>%%               http://point-at-infinity.org/ecc/nisttv</i>
<a name="4528"/> 4528: <i>%%</i>
<a name="4529"/> 4529: <i>%% Test vectors for the NIST elliptic curves P192, P224, P256, P384, P521,</i>
<a name="4530"/> 4530: <i>%% B163, B233, B283, B409, B571, K163, K233, K283, K409 and K571. For more</i>
<a name="4531"/> 4531: <i>%% information about the curves see</i>
<a name="4532"/> 4532: <i>%%       http://csrc.nist.gov/encryption/dss/ecdsa/NISTReCur.pdf</i>
<a name="4533"/> 4533: <i>%%</i>
<a name="4534"/> 4534:     Curves = crypto:supports(curves),
<a name="ecc-last_expr"/><a name="4535"/> 4535: <b>    lists:filter</b>(
<a name="4536"/> 4536:       fun ({_Type, Curve, _Priv, _Pub}) -&gt;
<a name="4537"/> 4537:               lists:member(Curve, Curves)
<a name="4538"/> 4538:       end,
<a name="4539"/> 4539:         [{ecdh,secp192r1,1,
<a name="4540"/> 4540:           hexstr2point(&quot;188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012&quot;,
<a name="4541"/> 4541:                        &quot;07192B95FFC8DA78631011ED6B24CDD573F977A11E794811&quot;)},
<a name="4542"/> 4542:          {ecdh,secp192r1,2,
<a name="4543"/> 4543:           hexstr2point(&quot;DAFEBF5828783F2AD35534631588A3F629A70FB16982A888&quot;,
<a name="4544"/> 4544:                        &quot;DD6BDA0D993DA0FA46B27BBC141B868F59331AFA5C7E93AB&quot;)},
<a name="4545"/> 4545:          {ecdh,secp192r1,3,
<a name="4546"/> 4546:           hexstr2point(&quot;76E32A2557599E6EDCD283201FB2B9AADFD0D359CBB263DA&quot;,
<a name="4547"/> 4547:                        &quot;782C37E372BA4520AA62E0FED121D49EF3B543660CFD05FD&quot;)},
<a name="4548"/> 4548:          {ecdh,secp192r1,4,
<a name="4549"/> 4549:           hexstr2point(&quot;35433907297CC378B0015703374729D7A4FE46647084E4BA&quot;,
<a name="4550"/> 4550:                        &quot;A2649984F2135C301EA3ACB0776CD4F125389B311DB3BE32&quot;)},
<a name="4551"/> 4551:          %% RFC 7748, 6.2
<a name="4552"/> 4552:          {ecdh, x448,
<a name="4553"/> 4553:           hexstr2bin(&quot;9a8f4925d1519f5775cf46b04b5800d4ee9ee8bae8bc5565d498c28d&quot;
<a name="4554"/> 4554:                      &quot;d9c9baf574a9419744897391006382a6f127ab1d9ac2d8c0a598726b&quot;),
<a name="4555"/> 4555:           hexstr2bin(&quot;9b08f7cc31b7e3e67d22d5aea121074a273bd2b83de09c63faa73d2c&quot;
<a name="4556"/> 4556:                      &quot;22c5d9bbc836647241d953d40c5b12da88120d53177f80e532c41fa0&quot;)},
<a name="4557"/> 4557:          {ecdh, x448,
<a name="4558"/> 4558:           hexstr2bin(&quot;1c306a7ac2a0e2e0990b294470cba339e6453772b075811d8fad0d1d&quot;
<a name="4559"/> 4559:                      &quot;6927c120bb5ee8972b0d3e21374c9c921b09d1b0366f10b65173992d&quot;),
<a name="4560"/> 4560:           hexstr2bin(&quot;3eb7a829b0cd20f5bcfc0b599b6feccf6da4627107bdb0d4f345b430&quot;
<a name="4561"/> 4561:                      &quot;27d8b972fc3e34fb4232a13ca706dcb57aec3dae07bdc1c67bf33609&quot;)},
<a name="4562"/> 4562:          %% RFC 7748, 6.1
<a name="4563"/> 4563:          {ecdh, x25519,
<a name="4564"/> 4564:           hexstr2bin(&quot;77076d0a7318a57d3c16c17251b26645df4c2f87ebc0992ab177fba51db92c2a&quot;),
<a name="4565"/> 4565:           hexstr2bin(&quot;8520f0098930a754748b7ddcb43ef75a0dbf3a0d26381af4eba4a98eaa9b4e6a&quot;)},
<a name="4566"/> 4566:          {ecdh, x25519,
<a name="4567"/> 4567:           hexstr2bin(&quot;5dab087e624a8a4b79e17f8b83800ee66f3bb1292618b6fd1c2f8b27ff88e0eb&quot;),
<a name="4568"/> 4568:           hexstr2bin(&quot;de9edb7d7b7dc1b4d35b61c2ece435373f8343c85b78674dadfc7e146f882b4f&quot;)}
<a name="4569"/> 4569:         ]
<a name="4570"/> 4570:      ).
<a name="4571"/> 4571: 
<a name="datadir-1"/><a name="4572"/> 4572: <b>datadir</b>(Config) -&gt;
<a name="datadir-last_expr"/><a name="4573"/> 4573: <b>    proplists:get_value</b>(data_dir, Config).
<a name="4574"/> 4574: 
<a name="4575"/> 4575: <b>-define</b>(KiB, 1024).
<a name="4576"/> 4576: <b>-define</b>(MiB, (1024 * 1024)).
<a name="4577"/> 4577: <b>-define</b>(GiB, (1024 * 1024 * 1024)).
<a name="4578"/> 4578: 
<a name="fmt_words-1"/><a name="4579"/> 4579: <b>fmt_words</b>(Words) -&gt;
<a name="4580"/> 4580:     BSize = Words * erlang:system_info(wordsize),
<a name="fmt_words-last_expr"/><a name="4581"/> 4581:     if BSize &lt; ?KiB -&gt;
<a name="4582"/> 4582:             integer_to_list(BSize);
<a name="4583"/> 4583:        BSize &lt; ?MiB -&gt;
<a name="4584"/> 4584:             io_lib:format(&quot;~8.2fKiB (~8w)&quot;, [BSize / ?KiB, BSize]);
<a name="4585"/> 4585:        BSize &lt; ?GiB -&gt;
<a name="4586"/> 4586:             io_lib:format(&quot;~8.2fMiB (~8w)&quot;, [BSize / ?MiB, BSize]);
<a name="4587"/> 4587:        true -&gt;
<a name="4588"/> 4588:             io_lib:format(&quot;~8.2fGiB (~8w)&quot;, [BSize / ?GiB, BSize])
<a name="4589"/> 4589:     end.
<a name="4590"/> 4590: 
<a name="log_rsp_size-2"/><a name="4591"/> 4591: <b>log_rsp_size</b>(Label, Term) -&gt;
<a name="4592"/> 4592:     S = erts_debug:size(Term),
<a name="log_rsp_size-last_expr"/><a name="4593"/> 4593: <b>    ct:log</b>(&quot;~s: ~w test(s), Memory used: ~s&quot;,
<a name="4594"/> 4594:            [Label, length(Term), fmt_words(S)]).
<a name="4595"/> 4595: 
<a name="read_rsp-3"/><a name="4596"/> 4596: <b>read_rsp</b>(Config, Type, Files) -&gt;
<a name="4597"/> 4597:     Tests =
<a name="4598"/> 4598:         lists:foldl(
<a name="4599"/> 4599:           fun(FileName, Acc) -&gt;
<a name="4600"/> 4600:                   NewAcc = read_rsp_file(filename:join(datadir(Config), FileName),
<a name="4601"/> 4601:                                          Type, Acc),
<a name="4602"/> 4602:                   ct:log(&quot;~p: ~p tests read.~n&quot;,[FileName,length(NewAcc)-length(Acc)]),
<a name="4603"/> 4603:                   NewAcc
<a name="4604"/> 4604:           end, [], Files),
<a name="4605"/> 4605:     log_rsp_size(Type, Tests),
<a name="read_rsp-last_expr"/><a name="4606"/> 4606:     Tests.
<a name="4607"/> 4607: 
<a name="read_rsp_file-3"/><a name="4608"/> 4608: <b>read_rsp_file</b>(FileName, Type, Acc) -&gt;
<a name="read_rsp_file-last_expr"/><a name="4609"/> 4609: <b>    case file:read_file</b>(FileName) of
<a name="4610"/> 4610:         {ok, Raw} -&gt;
<a name="4611"/> 4611:             Split = binary:split(Raw, [&lt;&lt;&quot;\r&quot;&gt;&gt;, &lt;&lt;&quot;\n&quot;&gt;&gt;], [global, trim_all]),
<a name="4612"/> 4612:             parse_rsp(Type, Split, #{file =&gt; FileName}, Acc);
<a name="4613"/> 4613:         Other -&gt;
<a name="4614"/> 4614:             ct:fail(&quot;~p ~p&quot;,[FileName, Other])
<a name="4615"/> 4615:     end.
<a name="4616"/> 4616: 
<a name="parse_rsp-4"/><a name="4617"/> 4617: <b>parse_rsp</b>(_Type, [], _State, Acc) -&gt;
<a name="4618"/> 4618:     Acc;
<a name="4619"/> 4619: <b>parse_rsp</b>(_Type, [&lt;&lt;&quot;DECRYPT&quot;&gt;&gt;|_], _State, Acc) -&gt;
<a name="4620"/> 4620:     Acc;
<a name="4621"/> 4621: <b>parse_rsp</b>(_Type, [&lt;&lt;&quot;ENCRYPT&quot;&gt;&gt;|_], _State, Acc) -&gt;
<a name="4622"/> 4622:     Acc;
<a name="4623"/> 4623: <i>%% AES format</i>
<a name="4624"/> 4624: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;COUNT = &quot;, _/binary&gt;&gt;,
<a name="4625"/> 4625:                  &lt;&lt;&quot;KEY = &quot;, Key/binary&gt;&gt;,
<a name="4626"/> 4626:                  &lt;&lt;&quot;PLAINTEXT = &quot;, PlainText/binary&gt;&gt;,
<a name="4627"/> 4627:                  &lt;&lt;&quot;CIPHERTEXT = &quot;, CipherText/binary&gt;&gt;|Next], State, Acc) -&gt;
<a name="4628"/> 4628:     parse_rsp(Type, Next, State,
<a name="4629"/> 4629:               [{Type, hexstr2bin(Key), 
<a name="4630"/> 4630:                 hexstr2bin(PlainText), hexstr2bin(CipherText)}|Acc]);
<a name="4631"/> 4631: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;COUNT = &quot;, _/binary&gt;&gt;,
<a name="4632"/> 4632:                  &lt;&lt;&quot;KEY = &quot;, Key/binary&gt;&gt;,
<a name="4633"/> 4633:                  &lt;&lt;&quot;IV = &quot;, IV/binary&gt;&gt;,
<a name="4634"/> 4634:                  &lt;&lt;&quot;PLAINTEXT = &quot;, PlainText/binary&gt;&gt;,
<a name="4635"/> 4635:                  &lt;&lt;&quot;CIPHERTEXT = &quot;, CipherText/binary&gt;&gt;|Next], State, Acc) -&gt;
<a name="4636"/> 4636:     parse_rsp(Type, Next, State,
<a name="4637"/> 4637:               [{Type, hexstr2bin(Key), hexstr2bin(IV),
<a name="4638"/> 4638:                 hexstr2bin(PlainText), hexstr2bin(CipherText)}|Acc]);
<a name="4639"/> 4639: <i>%% CMAC format</i>
<a name="4640"/> 4640: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Count = &quot;, _/binary&gt;&gt;,
<a name="4641"/> 4641:                  &lt;&lt;&quot;Klen = &quot;, _/binary&gt;&gt;,
<a name="4642"/> 4642:                  &lt;&lt;&quot;Mlen = &quot;, Mlen/binary&gt;&gt;,
<a name="4643"/> 4643:                  &lt;&lt;&quot;Tlen = &quot;, Tlen/binary&gt;&gt;,
<a name="4644"/> 4644:                  &lt;&lt;&quot;Key = &quot;, Key/binary&gt;&gt;,
<a name="4645"/> 4645:                  &lt;&lt;&quot;Msg = &quot;, Msg/binary&gt;&gt;,
<a name="4646"/> 4646:                  &lt;&lt;&quot;Mac = &quot;, MAC/binary&gt;&gt;|Rest], State, Acc) -&gt;
<a name="4647"/> 4647:     case Rest of
<a name="4648"/> 4648:         [&lt;&lt;&quot;Result = P&quot;&gt;&gt;|Next] -&gt;
<a name="4649"/> 4649:             parse_rsp_cmac(Type, Key, Msg, Mlen, Tlen, MAC, Next, State, Acc);
<a name="4650"/> 4650:         [&lt;&lt;&quot;Result = &quot;, _/binary&gt;&gt;|Next] -&gt;
<a name="4651"/> 4651:             parse_rsp(Type, Next, State, Acc);
<a name="4652"/> 4652:         _ -&gt;
<a name="4653"/> 4653:             parse_rsp_cmac(Type, Key, Msg, Mlen, Tlen, MAC, Rest, State, Acc)
<a name="4654"/> 4654:     end;
<a name="4655"/> 4655: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Count = &quot;, _/binary&gt;&gt;,
<a name="4656"/> 4656:                  &lt;&lt;&quot;Klen = &quot;, _/binary&gt;&gt;,
<a name="4657"/> 4657:                  &lt;&lt;&quot;Mlen = &quot;, Mlen/binary&gt;&gt;,
<a name="4658"/> 4658:                  &lt;&lt;&quot;Tlen = &quot;, Tlen/binary&gt;&gt;,
<a name="4659"/> 4659:                  &lt;&lt;&quot;Key1 = &quot;, Key1/binary&gt;&gt;,
<a name="4660"/> 4660:                  &lt;&lt;&quot;Key2 = &quot;, Key2/binary&gt;&gt;,
<a name="4661"/> 4661:                  &lt;&lt;&quot;Key3 = &quot;, Key3/binary&gt;&gt;,
<a name="4662"/> 4662:                  &lt;&lt;&quot;Msg = &quot;, Msg/binary&gt;&gt;,
<a name="4663"/> 4663:                  &lt;&lt;&quot;Mac = &quot;, MAC/binary&gt;&gt;|Rest], State, Acc) -&gt;
<a name="4664"/> 4664:     case Rest of
<a name="4665"/> 4665:         [&lt;&lt;&quot;Result = P&quot;&gt;&gt;|Next] -&gt;
<a name="4666"/> 4666:             parse_rsp_cmac(Type, [Key1,Key2,Key3], Msg, Mlen, Tlen, MAC, Next, State, Acc);
<a name="4667"/> 4667:         [&lt;&lt;&quot;Result = &quot;, _/binary&gt;&gt;|Next] -&gt;
<a name="4668"/> 4668:             parse_rsp(Type, Next, State, Acc);
<a name="4669"/> 4669:         _ -&gt;
<a name="4670"/> 4670:             parse_rsp_cmac(Type, [Key1,Key2,Key3], Msg, Mlen, Tlen, MAC, Rest, State, Acc)
<a name="4671"/> 4671:     end;
<a name="4672"/> 4672: <i>%% GCM format decode format</i>
<a name="4673"/> 4673: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Count = &quot;, Count/binary&gt;&gt;,
<a name="4674"/> 4674:                  &lt;&lt;&quot;Key = &quot;, Key/binary&gt;&gt;,
<a name="4675"/> 4675:                  &lt;&lt;&quot;IV = &quot;,  IV/binary&gt;&gt;,
<a name="4676"/> 4676:                  &lt;&lt;&quot;CT = &quot;,  CipherText/binary&gt;&gt;,
<a name="4677"/> 4677:                  &lt;&lt;&quot;AAD = &quot;, AAD/binary&gt;&gt;,
<a name="4678"/> 4678:                  &lt;&lt;&quot;Tag = &quot;, CipherTag0/binary&gt;&gt;,
<a name="4679"/> 4679:                  &lt;&lt;&quot;PT = &quot;,  PlainText/binary&gt;&gt;|Next], #{file:=File}=State, Acc) -&gt;
<a name="4680"/> 4680:     CipherTag = hexstr2bin(CipherTag0),
<a name="4681"/> 4681:     TestCase = {Type,
<a name="4682"/> 4682:                 hexstr2bin(Key),
<a name="4683"/> 4683:                 hexstr2bin(PlainText),
<a name="4684"/> 4684:                 hexstr2bin(IV),
<a name="4685"/> 4685:                 hexstr2bin(AAD),
<a name="4686"/> 4686:                 hexstr2bin(CipherText),
<a name="4687"/> 4687:                 CipherTag,
<a name="4688"/> 4688:                 size(CipherTag),
<a name="4689"/> 4689:                 {File,decstr2int(Count)}},
<a name="4690"/> 4690:     parse_rsp(Type, Next, State, [TestCase|Acc]);
<a name="4691"/> 4691: <i>%% GCM format encode format</i>
<a name="4692"/> 4692: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Count = &quot;, Count/binary&gt;&gt;,
<a name="4693"/> 4693:                  &lt;&lt;&quot;Key = &quot;, Key/binary&gt;&gt;,
<a name="4694"/> 4694:                  &lt;&lt;&quot;IV = &quot;,  IV/binary&gt;&gt;,
<a name="4695"/> 4695:                  &lt;&lt;&quot;PT = &quot;,  PlainText/binary&gt;&gt;,
<a name="4696"/> 4696:                  &lt;&lt;&quot;AAD = &quot;, AAD/binary&gt;&gt;,
<a name="4697"/> 4697:                  &lt;&lt;&quot;CT = &quot;,  CipherText/binary&gt;&gt;,
<a name="4698"/> 4698:                  &lt;&lt;&quot;Tag = &quot;, CipherTag0/binary&gt;&gt;|Next], #{file:=File}=State, Acc) -&gt;
<a name="4699"/> 4699:     CipherTag = hexstr2bin(CipherTag0),
<a name="4700"/> 4700:     TestCase = {Type,
<a name="4701"/> 4701:                 hexstr2bin(Key),
<a name="4702"/> 4702:                 hexstr2bin(PlainText),
<a name="4703"/> 4703:                 hexstr2bin(IV),
<a name="4704"/> 4704:                 hexstr2bin(AAD),
<a name="4705"/> 4705:                 hexstr2bin(CipherText),
<a name="4706"/> 4706:                 CipherTag,
<a name="4707"/> 4707:                 size(CipherTag),
<a name="4708"/> 4708:                 {File,decstr2int(Count)}},
<a name="4709"/> 4709:     parse_rsp(Type, Next, State, [TestCase|Acc]);
<a name="4710"/> 4710: <i>%% CCM-VADT format</i>
<a name="4711"/> 4711: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;[Alen = &quot;, AlenB0/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4712"/> 4712:     AlenSize = size(AlenB0) - 1, % remove closing ']'
<a name="4713"/> 4713:     Alen = decstr2int(&lt;&lt;AlenB0:AlenSize/binary&gt;&gt;),
<a name="4714"/> 4714:     State = State0#{alen =&gt; Alen},
<a name="4715"/> 4715:     parse_rsp(Type, Next, State, Acc);
<a name="4716"/> 4716: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;[Nlen = &quot;, NlenB0/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4717"/> 4717:     NlenSize = size(NlenB0) - 1, % remove closing ']'
<a name="4718"/> 4718:     Nlen = decstr2int(&lt;&lt;NlenB0:NlenSize/binary&gt;&gt;),
<a name="4719"/> 4719:     State = State0#{nlen =&gt; Nlen},
<a name="4720"/> 4720:     parse_rsp(Type, Next, State, Acc);
<a name="4721"/> 4721: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;[Plen = &quot;, PlenB0/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4722"/> 4722:     PlenSize = size(PlenB0) - 1, % remove closing ']'
<a name="4723"/> 4723:     Plen = decstr2int(&lt;&lt;PlenB0:PlenSize/binary&gt;&gt;),
<a name="4724"/> 4724:     State = State0#{plen =&gt; Plen},
<a name="4725"/> 4725:     parse_rsp(Type, Next, State, Acc);
<a name="4726"/> 4726: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;[Tlen = &quot;, TlenB0/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4727"/> 4727:     TlenSize = size(TlenB0) - 1, % remove closing ']'
<a name="4728"/> 4728:     Tlen = decstr2int(&lt;&lt;TlenB0:TlenSize/binary&gt;&gt;),
<a name="4729"/> 4729:     State = State0#{tlen =&gt; Tlen},
<a name="4730"/> 4730:     parse_rsp(Type, Next, State, Acc);
<a name="4731"/> 4731: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Alen = &quot;, B/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4732"/> 4732:     State = State0#{alen =&gt; decstr2int(B)},
<a name="4733"/> 4733:     parse_rsp(Type, Next, State, Acc);
<a name="4734"/> 4734: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Plen = &quot;, B/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4735"/> 4735:     State = State0#{plen =&gt; decstr2int(B)},
<a name="4736"/> 4736:     parse_rsp(Type, Next, State, Acc);
<a name="4737"/> 4737: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Count = &quot;, B/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4738"/> 4738:     State = State0#{count =&gt; B},
<a name="4739"/> 4739:     parse_rsp(Type, Next, State, Acc);
<a name="4740"/> 4740: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Nlen = &quot;, B/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4741"/> 4741:     State = State0#{nlen =&gt; decstr2int(B)},
<a name="4742"/> 4742:     parse_rsp(Type, Next, State, Acc);
<a name="4743"/> 4743: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Tlen = &quot;, B/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4744"/> 4744:     State = State0#{tlen =&gt; decstr2int(B)},
<a name="4745"/> 4745:     parse_rsp(Type, Next, State, Acc);
<a name="4746"/> 4746: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Key = &quot;,Key/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4747"/> 4747:     State = State0#{key =&gt; hexstr2bin(Key)},
<a name="4748"/> 4748:     parse_rsp(Type, Next, State, Acc);
<a name="4749"/> 4749: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Nonce = &quot;,Nonce/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4750"/> 4750:     State = State0#{nonce =&gt; hexstr2bin(Nonce)},
<a name="4751"/> 4751:     parse_rsp(Type, Next, State, Acc);
<a name="4752"/> 4752: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Adata = &quot;,Adata/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4753"/> 4753:     State = State0#{adata =&gt; hexstr2bin(Adata)},
<a name="4754"/> 4754:     parse_rsp(Type, Next, State, Acc);
<a name="4755"/> 4755: <b>parse_rsp</b>(Type, [&lt;&lt;&quot;Payload = &quot;,Payload/binary&gt;&gt;|Next], State0, Acc) -&gt;
<a name="4756"/> 4756:     State = State0#{payload =&gt; hexstr2bin(Payload)},
<a name="4757"/> 4757:     parse_rsp(Type, Next, State, Acc);
<a name="4758"/> 4758: <b>parse_rsp</b>(Type,
<a name="4759"/> 4759:           [&lt;&lt;&quot;CT = &quot;, CT/binary&gt;&gt;|Next],
<a name="4760"/> 4760:           #{count := Count,
<a name="4761"/> 4761:             file := File,
<a name="4762"/> 4762:             alen := Alen,
<a name="4763"/> 4763:             plen := Plen,
<a name="4764"/> 4764:             nlen := _Nlen,
<a name="4765"/> 4765:             tlen := Tlen,
<a name="4766"/> 4766:             key := Key,
<a name="4767"/> 4767:             nonce := IV,
<a name="4768"/> 4768:             adata := Adata,
<a name="4769"/> 4769:             payload := Payload
<a name="4770"/> 4770:            } = State, Acc) -&gt;
<a name="4771"/> 4771:     AAD = &lt;&lt;Adata:Alen/binary&gt;&gt;,
<a name="4772"/> 4772:     PlainText = &lt;&lt;Payload:Plen/binary&gt;&gt;,
<a name="4773"/> 4773:     &lt;&lt;CipherText:Plen/binary, CipherTag:Tlen/binary&gt;&gt; = hexstr2bin(CT),
<a name="4774"/> 4774:     TestCase = {Type,
<a name="4775"/> 4775:                 Key,
<a name="4776"/> 4776:                 PlainText,
<a name="4777"/> 4777:                 IV,
<a name="4778"/> 4778:                 AAD,
<a name="4779"/> 4779:                 CipherText,
<a name="4780"/> 4780:                 CipherTag,
<a name="4781"/> 4781:                 Tlen,
<a name="4782"/> 4782:                 {File,decstr2int(Count)}},
<a name="4783"/> 4783:     parse_rsp(Type, Next, State, [TestCase|Acc]);
<a name="4784"/> 4784: <b>parse_rsp</b>(Type, [_|Next], State, Acc) -&gt;
<a name="parse_rsp-last_expr"/><a name="4785"/> 4785: <b>    parse_rsp</b>(Type, Next, State, Acc).
<a name="4786"/> 4786: 
<a name="4787"/> 4787: 
<a name="parse_rsp_cmac-9"/><a name="4788"/> 4788: <b>parse_rsp_cmac</b>(Type, Key0, Msg0, Mlen0, Tlen, MAC0, Next, State, Acc) -&gt;
<a name="4789"/> 4789:     Key = if is_list(Key0) -&gt; lists:map(fun hexstr2bin/1, Key0);
<a name="4790"/> 4790:              true -&gt; hexstr2bin(Key0)
<a name="4791"/> 4791:           end,
<a name="4792"/> 4792:     Mlen = binary_to_integer(Mlen0),
<a name="4793"/> 4793:     &lt;&lt;Msg:Mlen/bytes, _/binary&gt;&gt; = hexstr2bin(Msg0),
<a name="4794"/> 4794:     MAC = hexstr2bin(MAC0),
<a name="parse_rsp_cmac-last_expr"/><a name="4795"/> 4795: <b>    case binary_to_integer</b>(Tlen) of
<a name="4796"/> 4796:         0 -&gt;
<a name="4797"/> 4797:             parse_rsp(Type, Next, State, [{cmac, Type, Key, Msg, MAC}|Acc]);
<a name="4798"/> 4798:         I -&gt;
<a name="4799"/> 4799:             parse_rsp(Type, Next, State, [{cmac, Type, Key, Msg, I, MAC}|Acc])
<a name="4800"/> 4800:     end.
<a name="4801"/> 4801: 
<a name="api_errors_ecdh-1"/><a name="4802"/> 4802: <b>api_errors_ecdh</b>(Config) when is_list(Config) -&gt;
<a name="4803"/> 4803:     %% Check that we don't segfault when fed garbage.
<a name="4804"/> 4804:     Test = fun(Others, Curve) -&gt;
<a name="4805"/> 4805:                    {_Pub, Priv} = crypto:generate_key(ecdh, Curve),
<a name="4806"/> 4806:                    crypto:compute_key(ecdh, Others, Priv, Curve)
<a name="4807"/> 4807:            end,
<a name="4808"/> 4808:     Others = [gurka, 0, &lt;&lt;0&gt;&gt;],
<a name="4809"/> 4809:     Curves = [gaffel, 0, sect571r1],
<a name="4810"/> 4810:     [_= (catch Test(O, C)) || O &lt;- Others, C &lt;- Curves],
<a name="api_errors_ecdh-last_expr"/><a name="4811"/> 4811:     ok.
<a name="4812"/> 4812: 
<a name="4813"/> 4813: 
<a name="4814"/> 4814: <i>%%%----- Tests for bad algorithm name as argument</i>
<a name="4815"/> 4815: <b>-define</b>(chk_api_name_helper(Call, ExpectPart),
<a name="4816"/> 4816:         (fun() -&gt; % avoid binding vars
<a name="4817"/> 4817:                  try
<a name="4818"/> 4818:                      Call
<a name="4819"/> 4819:                  catch 
<a name="4820"/> 4820:                      ExpectPart
<a name="4821"/> 4821: 
<a name="4822"/> 4822:                      Class:Reason:Stack -&gt;
<a name="4823"/> 4823:                          ct:log(&quot;~p:~p~n~p&quot;, [Class,Reason,Stack]),
<a name="4824"/> 4824:                          ct:fail(&quot;Bad respons for bad name&quot;)
<a name="4825"/> 4825:                  end
<a name="4826"/> 4826:          end)()
<a name="4827"/> 4827:        ).
<a name="4828"/> 4828: 
<a name="4829"/> 4829: <b>-define</b>(chk_api_name(Call, Expect),
<a name="4830"/> 4830:         ?chk_api_name_helper(Call,  Expect -&gt; ok;)
<a name="4831"/> 4831:        ).
<a name="4832"/> 4832: 
<a name="4833"/> 4833: <b>-define</b>(chk_api_name(Call, Expect1, Expect2),
<a name="4834"/> 4834:         ?chk_api_name_helper(Call,  Expect1 -&gt; ok; Expect2 -&gt; ok; )
<a name="4835"/> 4835:        ).
<a name="4836"/> 4836: 
<a name="4837"/> 4837: <b>-define</b>(chk_api_name(Call, Expect1, Expect2, Expect3),
<a name="4838"/> 4838:         ?chk_api_name_helper(Call,  Expect1 -&gt; ok; Expect2 -&gt; ok; Expect3 -&gt; ok; )
<a name="4839"/> 4839:        ).
<a name="4840"/> 4840: 
<a name="4841"/> 4841: 
<a name="bad_key_length-1"/><a name="4842"/> 4842: <b>bad_key_length</b>(_Config) -&gt;
<a name="bad_key_length-last_expr"/><a name="4843"/> 4843: <b>    ?chk_api_name</b>(crypto:crypto_init(aes_128_ctr, &lt;&lt;1&gt;&gt;, &lt;&lt;0:128&gt;&gt;, true),
<a name="4844"/> 4844:                   error:{badarg,_,&quot;Bad key size&quot;++_}).
<a name="4845"/> 4845: 
<a name="bad_cipher_name-1"/><a name="4846"/> 4846: <b>bad_cipher_name</b>(_Config) -&gt;
<a name="bad_cipher_name-last_expr"/><a name="4847"/> 4847: <b>    ?chk_api_name</b>(crypto:crypto_init(foobar, &lt;&lt;1:128&gt;&gt;, true),
<a name="4848"/> 4848:                   error:{badarg,{&quot;api_ng.c&quot;,_Line},&quot;Unknown cipher&quot;++_}).
<a name="4849"/> 4849: 
<a name="bad_generate_key_name-1"/><a name="4850"/> 4850: <b>bad_generate_key_name</b>(_Config) -&gt;
<a name="bad_generate_key_name-last_expr"/><a name="4851"/> 4851: <b>    ?chk_api_name</b>(crypto:generate_key(foobar, [1024]),
<a name="4852"/> 4852:                   error:function_clause).
<a name="4853"/> 4853: 
<a name="bad_hash_name-1"/><a name="4854"/> 4854: <b>bad_hash_name</b>(_Config) -&gt;
<a name="bad_hash_name-last_expr"/><a name="4855"/> 4855: <b>    ?chk_api_name</b>(crypto:hash_init(foobar),
<a name="4856"/> 4856:                   error:{badarg,{&quot;hash.c&quot;,_},&quot;Bad digest type&quot;++_}).
<a name="4857"/> 4857: 
<a name="bad_mac_name-1"/><a name="4858"/> 4858: <b>bad_mac_name</b>(_Config) -&gt;
<a name="bad_mac_name-last_expr"/><a name="4859"/> 4859: <b>    ?chk_api_name</b>(crypto:mac(foobar, &lt;&lt;1:1024&gt;&gt;, &quot;nothing&quot;),
<a name="4860"/> 4860:                   error:function_clause).
<a name="4861"/> 4861: 
<a name="bad_hmac_name-1"/><a name="4862"/> 4862: <b>bad_hmac_name</b>(_Config) -&gt;
<a name="bad_hmac_name-last_expr"/><a name="4863"/> 4863: <b>    ?chk_api_name</b>(crypto:mac(hmac, foobar, &lt;&lt;1:1024&gt;&gt;, &quot;nothing&quot;),
<a name="4864"/> 4864:                   error:{badarg,{&quot;mac.c&quot;,_},&quot;Bad digest algorithm&quot;++_}).
<a name="4865"/> 4865: 
<a name="bad_cmac_name-1"/><a name="4866"/> 4866: <b>bad_cmac_name</b>(_Config) -&gt;
<a name="bad_cmac_name-last_expr"/><a name="4867"/> 4867: <b>    ?chk_api_name</b>(crypto:mac(cmac, foobar, &lt;&lt;1:1024&gt;&gt;, &quot;nothing&quot;),
<a name="4868"/> 4868:                   error:{badarg,{&quot;mac.c&quot;,_},&quot;Unknown cipher&quot;++_},
<a name="4869"/> 4869:                   error:{notsup,_,          &quot;Unsupported mac algorithm&quot;++_},
<a name="4870"/> 4870:                   error:{badarg,#{},        &quot;Unknown cipher&quot;++_}
<a name="4871"/> 4871:                  ).
<a name="4872"/> 4872: 
<a name="bad_sign_name-1"/><a name="4873"/> 4873: <b>bad_sign_name</b>(_Config) -&gt;
<a name="4874"/> 4874:     ?chk_api_name(crypto:sign(rsa, foobar, &quot;nothing&quot;, &lt;&lt;1:1024&gt;&gt;),
<a name="4875"/> 4875:                   error:{badarg, {&quot;pkey.c&quot;,_}, &quot;Bad digest type&quot;++_}),
<a name="bad_sign_name-last_expr"/><a name="4876"/> 4876: <b>    ?chk_api_name</b>(crypto:sign(foobar, sha, &quot;nothing&quot;, &lt;&lt;1:1024&gt;&gt;),
<a name="4877"/> 4877:                   error:{badarg, {&quot;pkey.c&quot;,_}, &quot;Bad algorithm&quot;++_}).
<a name="4878"/> 4878:     
<a name="bad_verify_name-1"/><a name="4879"/> 4879: <b>bad_verify_name</b>(_Config) -&gt;
<a name="4880"/> 4880:     ?chk_api_name(crypto:verify(rsa, foobar, &quot;nothing&quot;, &lt;&lt;&quot;nothing&quot;&gt;&gt;,  &lt;&lt;1:1024&gt;&gt;),
<a name="4881"/> 4881:                   error:{badarg,{&quot;pkey.c&quot;,_},&quot;Bad digest type&quot;++_}),
<a name="bad_verify_name-last_expr"/><a name="4882"/> 4882: <b>    ?chk_api_name</b>(crypto:verify(foobar, sha, &quot;nothing&quot;, &lt;&lt;&quot;nothing&quot;&gt;&gt;, &lt;&lt;1:1024&gt;&gt;),
<a name="4883"/> 4883:                   error:{badarg, {&quot;pkey.c&quot;,_}, &quot;Bad algorithm&quot;++_}).
<a name="4884"/> 4884: 
<a name="4885"/> 4885: 
<a name="4886"/> 4886: <i>%%%----------------------------------------------------------------</i>
<a name="try_enable_fips_mode-1"/><a name="4887"/> 4887: <b>try_enable_fips_mode</b>(Config) -&gt;
<a name="4888"/> 4888:     FIPSConfig = [{fips, true} | Config],
<a name="try_enable_fips_mode-last_expr"/><a name="4889"/> 4889: <b>    case crypto:info_fips</b>() of
<a name="4890"/> 4890:         enabled -&gt;
<a name="4891"/> 4891:             FIPSConfig;
<a name="4892"/> 4892:         not_enabled -&gt;
<a name="4893"/> 4893:             %% Erlang/crypto configured with --enable-fips
<a name="4894"/> 4894:             case crypto:enable_fips_mode(true) of
<a name="4895"/> 4895: 		true -&gt;
<a name="4896"/> 4896:                     %% and also the cryptolib is fips enabled
<a name="4897"/> 4897: 		    enabled = crypto:info_fips(),
<a name="4898"/> 4898: 		    FIPSConfig;
<a name="4899"/> 4899: 		false -&gt;
<a name="4900"/> 4900:                     try
<a name="4901"/> 4901:                         [{_,_,Inf}] = crypto:info_lib(),
<a name="4902"/> 4902:                         re:run(Inf, &quot;(F|f)(I|i)(P|p)(S|s)&quot;)
<a name="4903"/> 4903:                     of
<a name="4904"/> 4904:                         nomatch -&gt;
<a name="4905"/> 4905:                             {skip, &quot;FIPS mode not supported in cryptolib&quot;};
<a name="4906"/> 4906:                         {match,_} -&gt;
<a name="4907"/> 4907:                             {fail, &quot;Failed to enable FIPS mode&quot;}
<a name="4908"/> 4908:                     catch
<a name="4909"/> 4909:                         _:_ -&gt;
<a name="4910"/> 4910:                             {fail, &quot;Failed to check cryptolib info&quot;}
<a name="4911"/> 4911:                     end,
<a name="4912"/> 4912: 		    {skip, &quot;FIPS mode not supported in cryptolib&quot;}
<a name="4913"/> 4913: 	    end;
<a name="4914"/> 4914:         not_supported -&gt;
<a name="4915"/> 4915:             {skip, &quot;FIPS mode not supported&quot;}
<a name="4916"/> 4916:     end.
<a name="4917"/> 4917: 
<a name="pbkdf2_hmac-0"/><a name="4918"/> 4918: <b>pbkdf2_hmac</b>() -&gt;
<a name="pbkdf2_hmac-last_expr"/><a name="4919"/> 4919:   [{doc, &quot;Test the pbkdf2_hmac function&quot;}].
<a name="pbkdf2_hmac-1"/><a name="4920"/> 4920: <b>pbkdf2_hmac</b>(Config) when is_list(Config) -&gt;
<a name="pbkdf2_hmac-last_expr"/><a name="4921"/> 4921:   try
<a name="4922"/> 4922:     F = fun (A, B, C, D) -&gt;
<a name="4923"/> 4923:             binary:encode_hex(crypto:pbkdf2_hmac(sha, A, B, C, D))
<a name="4924"/> 4924:         end,
<a name="4925"/> 4925:     F256 = fun (A, B, C, D) -&gt;
<a name="4926"/> 4926:             binary:encode_hex(crypto:pbkdf2_hmac(sha256, A, B, C, D))
<a name="4927"/> 4927:         end,
<a name="4928"/> 4928:     %% RFC 6070
<a name="4929"/> 4929:     &lt;&lt;&quot;0C60C80F961F0E71F3A9B524AF6012062FE037A6&quot;&gt;&gt; =
<a name="4930"/> 4930:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 1, 20),
<a name="4931"/> 4931:     &lt;&lt;&quot;EA6C014DC72D6F8CCD1ED92ACE1D41F0D8DE8957&quot;&gt;&gt; =
<a name="4932"/> 4932:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 2, 20),
<a name="4933"/> 4933:     &lt;&lt;&quot;4B007901B765489ABEAD49D926F721D065A429C1&quot;&gt;&gt; =
<a name="4934"/> 4934:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 4096, 20),
<a name="4935"/> 4935:     &lt;&lt;&quot;EEFE3D61CD4DA4E4E9945B3D6BA2158C2634E984&quot;&gt;&gt; =
<a name="4936"/> 4936:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 16777216, 20),
<a name="4937"/> 4937:     &lt;&lt;&quot;3D2EEC4FE41C849B80C8D83662C0E44A8B291A964CF2F07038&quot;&gt;&gt; =
<a name="4938"/> 4938:       F(&lt;&lt;&quot;passwordPASSWORDpassword&quot;&gt;&gt;, &lt;&lt;&quot;saltSALTsaltSALTsaltSALTsaltSALTsalt&quot;&gt;&gt;, 4096, 25),
<a name="4939"/> 4939:     &lt;&lt;&quot;56FA6AA75548099DCC37D7F03425E0C3&quot;&gt;&gt; =
<a name="4940"/> 4940:       F(&lt;&lt;&quot;pass\0word&quot;&gt;&gt;, &lt;&lt;&quot;sa\0lt&quot;&gt;&gt;, 4096, 16),
<a name="4941"/> 4941: 
<a name="4942"/> 4942:     %% RFC 3962
<a name="4943"/> 4943:     &lt;&lt;&quot;CDEDB5281BB2F801565A1122B2563515&quot;&gt;&gt; =
<a name="4944"/> 4944:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;ATHENA.MIT.EDUraeburn&quot;&gt;&gt;, 1, 16),
<a name="4945"/> 4945:     &lt;&lt;&quot;CDEDB5281BB2F801565A1122B25635150AD1F7A04BB9F3A333ECC0E2E1F70837&quot;&gt;&gt; =
<a name="4946"/> 4946:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;ATHENA.MIT.EDUraeburn&quot;&gt;&gt;, 1, 32),
<a name="4947"/> 4947:     &lt;&lt;&quot;01DBEE7F4A9E243E988B62C73CDA935D&quot;&gt;&gt; =
<a name="4948"/> 4948:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;ATHENA.MIT.EDUraeburn&quot;&gt;&gt;, 2, 16),
<a name="4949"/> 4949:     &lt;&lt;&quot;01DBEE7F4A9E243E988B62C73CDA935DA05378B93244EC8F48A99E61AD799D86&quot;&gt;&gt; =
<a name="4950"/> 4950:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;ATHENA.MIT.EDUraeburn&quot;&gt;&gt;, 2, 32),
<a name="4951"/> 4951:     &lt;&lt;&quot;5C08EB61FDF71E4E4EC3CF6BA1F5512B&quot;&gt;&gt; =
<a name="4952"/> 4952:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;ATHENA.MIT.EDUraeburn&quot;&gt;&gt;, 1200, 16),
<a name="4953"/> 4953:     &lt;&lt;&quot;5C08EB61FDF71E4E4EC3CF6BA1F5512BA7E52DDBC5E5142F708A31E2E62B1E13&quot;&gt;&gt; =
<a name="4954"/> 4954:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, &lt;&lt;&quot;ATHENA.MIT.EDUraeburn&quot;&gt;&gt;, 1200, 32),
<a name="4955"/> 4955:     &lt;&lt;&quot;D1DAA78615F287E6A1C8B120D7062A49&quot;&gt;&gt; =
<a name="4956"/> 4956:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, binary:encode_unsigned(16#1234567878563412), 5, 16),
<a name="4957"/> 4957:     &lt;&lt;&quot;D1DAA78615F287E6A1C8B120D7062A493F98D203E6BE49A6ADF4FA574B6E64EE&quot;&gt;&gt; =
<a name="4958"/> 4958:       F(&lt;&lt;&quot;password&quot;&gt;&gt;, binary:encode_unsigned(16#1234567878563412), 5, 32),
<a name="4959"/> 4959:     &lt;&lt;&quot;139C30C0966BC32BA55FDBF212530AC9&quot;&gt;&gt; =
<a name="4960"/> 4960:       F(&lt;&lt;&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;&gt;&gt;,
<a name="4961"/> 4961:         &lt;&lt;&quot;pass phrase equals block size&quot;&gt;&gt;, 1200, 16),
<a name="4962"/> 4962:     &lt;&lt;&quot;139C30C0966BC32BA55FDBF212530AC9C5EC59F1A452F5CC9AD940FEA0598ED1&quot;&gt;&gt; =
<a name="4963"/> 4963:       F(&lt;&lt;&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;&gt;&gt;,
<a name="4964"/> 4964:         &lt;&lt;&quot;pass phrase equals block size&quot;&gt;&gt;, 1200, 32),
<a name="4965"/> 4965:     &lt;&lt;&quot;9CCAD6D468770CD51B10E6A68721BE61&quot;&gt;&gt; =
<a name="4966"/> 4966:       F(&lt;&lt;&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;&gt;&gt;,
<a name="4967"/> 4967:         &lt;&lt;&quot;pass phrase exceeds block size&quot;&gt;&gt;, 1200, 16),
<a name="4968"/> 4968:     &lt;&lt;&quot;9CCAD6D468770CD51B10E6A68721BE611A8B4D282601DB3B36BE9246915EC82A&quot;&gt;&gt; =
<a name="4969"/> 4969:       F(&lt;&lt;&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;&gt;&gt;,
<a name="4970"/> 4970:         &lt;&lt;&quot;pass phrase exceeds block size&quot;&gt;&gt;, 1200, 32),
<a name="4971"/> 4971:     &lt;&lt;&quot;6B9CF26D45455A43A5B8BB276A403B39&quot;&gt;&gt; =
<a name="4972"/> 4972:       F(binary:encode_unsigned(16#f09d849e), &lt;&lt;&quot;EXAMPLE.COMpianist&quot;&gt;&gt;, 50, 16),
<a name="4973"/> 4973:     &lt;&lt;&quot;6B9CF26D45455A43A5B8BB276A403B39E7FE37A0C41E02C281FF3069E1E94F52&quot;&gt;&gt; =
<a name="4974"/> 4974:       F(binary:encode_unsigned(16#f09d849e), &lt;&lt;&quot;EXAMPLE.COMpianist&quot;&gt;&gt;, 50, 32),
<a name="4975"/> 4975: 
<a name="4976"/> 4976:     %% SHA256 variant. Test vectors from RFC 7914 (section 11)
<a name="4977"/> 4977:     &lt;&lt;&quot;55AC046E56E3089FEC1691C22544B605&quot;
<a name="4978"/> 4978:       &quot;F94185216DDE0465E68B9D57C20DACBC&quot;
<a name="4979"/> 4979:       &quot;49CA9CCCF179B645991664B39D77EF31&quot;
<a name="4980"/> 4980:       &quot;7C71B845B1E30BD509112041D3A19783&quot;&gt;&gt; = F256(&lt;&lt;&quot;passwd&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 1, 64),
<a name="4981"/> 4981:     &lt;&lt;&quot;4DDCD8F60B98BE21830CEE5EF22701F9&quot;
<a name="4982"/> 4982:       &quot;641A4418D04C0414AEFF08876B34AB56&quot;
<a name="4983"/> 4983:       &quot;A1D425A1225833549ADB841B51C9B317&quot;
<a name="4984"/> 4984:       &quot;6A272BDEBBA1D078478F62B397F33C8D&quot;&gt;&gt; = F256(&lt;&lt;&quot;Password&quot;&gt;&gt;, &lt;&lt;&quot;NaCl&quot;&gt;&gt;, 80000, 64)
<a name="4985"/> 4985:   catch
<a name="4986"/> 4986:     error:{notsup, _, &quot;Unsupported CRYPTO_PKCS5_PBKDF2_HMAC&quot;++_} -&gt;
<a name="4987"/> 4987:             {skip, &quot;No CRYPTO_PKCS5_PBKDF2_HMAC&quot;}
<a name="4988"/> 4988:   end.
<a name="4989"/> 4989: 
<a name="pbkdf2_hmac_invalid_input-0"/><a name="4990"/> 4990: <b>pbkdf2_hmac_invalid_input</b>() -&gt;
<a name="pbkdf2_hmac_invalid_input-last_expr"/><a name="4991"/> 4991:   [{doc, &quot;Test the pbkdf2_hmac function with invalid input&quot;}].
<a name="pbkdf2_hmac_invalid_input-1"/><a name="4992"/> 4992: <b>pbkdf2_hmac_invalid_input</b>(Config) when is_list(Config) -&gt;
<a name="pbkdf2_hmac_invalid_input-last_expr"/><a name="4993"/> 4993:   try
<a name="4994"/> 4994:     TestFun = fun(Hash, Pass, Salt, Iter, Keylen, ErrorStr) -&gt;
<a name="4995"/> 4995:         try
<a name="4996"/> 4996:             crypto:pbkdf2_hmac(Hash, Pass, Salt, Iter, Keylen)
<a name="4997"/> 4997:         of
<a name="4998"/> 4998:             Res -&gt; ct:fail(&quot;Unexpected result ~p&quot;, [Res])
<a name="4999"/> 4999:         catch
<a name="5000"/> 5000:             error:{badarg, {_, _}, ErrorStr} -&gt;
<a name="5001"/> 5001:                 ok;
<a name="5002"/> 5002:             error:badarg -&gt;
<a name="5003"/> 5003:                 % Erlang &lt;25
<a name="5004"/> 5004:                 ok;
<a name="5005"/> 5005:             Tag:Err -&gt;
<a name="5006"/> 5006:                 ct:fail(&quot;Unexpected exception ~p:~p&quot;, [Tag, Err])
<a name="5007"/> 5007:         end
<a name="5008"/> 5008:     end,
<a name="5009"/> 5009:     TestFun(sha42, &lt;&lt;&quot;pass&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 1, 1, &quot;Bad digest type&quot;),
<a name="5010"/> 5010:     TestFun(sha, &quot;badpass&quot;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 1, 1, &quot;Not binary&quot;),
<a name="5011"/> 5011:     TestFun(sha, &lt;&lt;&quot;pass&quot;&gt;&gt;, &quot;badsalt&quot;, 1, 1, &quot;Not binary&quot;),
<a name="5012"/> 5012:     TestFun(sha, &lt;&lt;&quot;pass&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, &quot;baditer&quot;, 1, &quot;Not integer&quot;),
<a name="5013"/> 5013:     TestFun(sha, &lt;&lt;&quot;pass&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 0, 1, &quot;Must be &gt; 0&quot;),
<a name="5014"/> 5014:     TestFun(sha, &lt;&lt;&quot;pass&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 1, &quot;badlen&quot;, &quot;Not integer&quot;),
<a name="5015"/> 5015:     TestFun(sha, &lt;&lt;&quot;pass&quot;&gt;&gt;, &lt;&lt;&quot;salt&quot;&gt;&gt;, 1, 0, &quot;Must be &gt; 0&quot;)
<a name="5016"/> 5016:   catch
<a name="5017"/> 5017:     error:{notsup, _, &quot;Unsupported CRYPTO_PKCS5_PBKDF2_HMAC&quot;++_} -&gt;
<a name="5018"/> 5018:             {skip, &quot;No CRYPTO_PKCS5_PBKDF2_HMAC&quot;}
<a name="5019"/> 5019:   end.
<a name="get_priv_pub_from_sign_verify-1"/><a name="5020"/> 5020: <b>get_priv_pub_from_sign_verify</b>(L) -&gt;
<a name="get_priv_pub_from_sign_verify-last_expr"/><a name="5021"/> 5021: <b>    lists:foldl</b>(fun get_priv_pub/2, [], L).
<a name="5022"/> 5022: 
<a name="get_priv_pub-2"/><a name="5023"/> 5023: <b>get_priv_pub</b>({Type, undefined=_Hash, Private, Public, _Msg, _Signature}, Acc) -&gt; [{Type,Private,Public} | Acc];
<a name="5024"/> 5024: <b>get_priv_pub</b>({Type, _Hash, Public, Private, _Msg}, Acc) -&gt; [{Type,Private,Public} | Acc];
<a name="5025"/> 5025: <b>get_priv_pub</b>({Type, _Hash, Public, Private, _Msg, _Options}, Acc) -&gt; [{Type,Private,Public} | Acc];
<a name="get_priv_pub-last_expr"/><a name="5026"/> 5026: <b>get_priv_pub</b>(_, Acc) -&gt; Acc.
</pre>
<script>
var hash = window.location.hash.substring(1);
var anchor = document.getElementsByName(hash);
anchor[0].style.backgroundColor="orange";
</script>
</body>
</html>
