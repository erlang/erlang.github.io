<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/lib/crypto/make_test_dir/crypto_test/crypto_collect_labmachine_info_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%%</i>
<a name="2"/>    2: <i>%% %CopyrightBegin%</i>
<a name="3"/>    3: <i>%%</i>
<a name="4"/>    4: <i>%% Copyright Ericsson AB 2008-2023. All Rights Reserved.</i>
<a name="5"/>    5: <i>%%</i>
<a name="6"/>    6: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="7"/>    7: <i>%% you may not use this file except in compliance with the License.</i>
<a name="8"/>    8: <i>%% You may obtain a copy of the License at</i>
<a name="9"/>    9: <i>%%</i>
<a name="10"/>   10: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="11"/>   11: <i>%%</i>
<a name="12"/>   12: <i>%% Unless required by applicable law or agreed to in writing, software</i>
<a name="13"/>   13: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="14"/>   14: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="15"/>   15: <i>%% See the License for the specific language governing permissions and</i>
<a name="16"/>   16: <i>%% limitations under the License.</i>
<a name="17"/>   17: <i>%%</i>
<a name="18"/>   18: <i>%% %CopyrightEnd%</i>
<a name="19"/>   19: <i>%%</i>
<a name="20"/>   20: 
<a name="21"/>   21: <i>%%</i>
<a name="22"/>   22: 
<a name="23"/>   23: <b>-module</b>(crypto_collect_labmachine_info_SUITE).
<a name="24"/>   24: 
<a name="25"/>   25: <i>%% This test suite collects information about the OpenSSL version</i>
<a name="26"/>   26: <i>%% used by crypto application.</i>
<a name="27"/>   27: 
<a name="28"/>   28: <i>%% It requires common_test configuration data 'collect_host_info'</i>
<a name="29"/>   29: <i>%% to be set to the root target directory where the collected</i>
<a name="30"/>   30: <i>%% information will be stored.</i>
<a name="31"/>   31: 
<a name="32"/>   32: <i>%% It can either be a local path</i>
<a name="33"/>   33: <i>%%   {collect_host_info, &quot;/my/local/dir&quot;}.</i>
<a name="34"/>   34: <i>%% or a remote path usable by the scp command</i>
<a name="35"/>   35: <i>%%   {collect_host_info, &quot;hostname:/its/local/dir&quot;}.</i>
<a name="36"/>   36: <i>%%   {collect_host_info, &quot;user@hostname:/its/local/dir&quot;}.</i>
<a name="37"/>   37: 
<a name="38"/>   38: <i>%% The collected data will be store as</i>
<a name="39"/>   39: <i>%% &lt;collect_host_info&gt;/crypto_info/&lt;hostname&gt;.data</i>
<a name="40"/>   40: <i>%% Sub directory crypto_info must exist.</i>
<a name="41"/>   41: 
<a name="42"/>   42: <b>-include_lib</b>(&quot;common_test/include/ct.hrl&quot;).
<a name="43"/>   43: 
<a name="44"/>   44: <b>-export</b>([
<a name="45"/>   45:          suite/0,
<a name="46"/>   46:          all/0,
<a name="47"/>   47:          init_per_suite/1,
<a name="48"/>   48:          end_per_suite/1,
<a name="49"/>   49:          crypto_info_lib/1
<a name="50"/>   50:         ]).
<a name="51"/>   51: 
<a name="52"/>   52: <b>-define</b>(DAYS_TO_KEEP, 5).
<a name="53"/>   53: 
<a name="54"/>   54: <i>%%--------------------------------------------------------------------</i>
<a name="55"/>   55: <i>%% Common Test interface functions -----------------------------------</i>
<a name="56"/>   56: <i>%%--------------------------------------------------------------------</i>
<a name="57"/>   57: 
<a name="suite-0"/><a name="suite-last_expr"/><a name="58"/>   58: <b>suite</b>() -&gt; [{require, collect_host_info},
<a name="59"/>   59:             {timetrap,{seconds,40}}].
<a name="60"/>   60: 
<a name="all-0"/><a name="all-last_expr"/><a name="61"/>   61: <b>all</b>() -&gt; [crypto_info_lib].
<a name="62"/>   62: 
<a name="63"/>   63: <i>%%--------------------------------------------------------------------</i>
<a name="init_per_suite-1"/><a name="64"/>   64: <b>init_per_suite</b>(Config) -&gt;
<a name="65"/>   65:     Root = ct:get_config(collect_host_info),
<a name="66"/>   66:     RemoteFile = filename:join([Root, &quot;crypto_info&quot;, hostname()++&quot;.data&quot;]),
<a name="67"/>   67:     CryptoStarted =
<a name="68"/>   68:         try crypto:start() of
<a name="69"/>   69:             ok -&gt; true;
<a name="70"/>   70:             {error, already_started} -&gt; true;
<a name="71"/>   71:             _ -&gt; false
<a name="72"/>   72:         catch
<a name="73"/>   73:             _:_ -&gt; false
<a name="74"/>   74:         end,
<a name="75"/>   75: 
<a name="init_per_suite-last_expr"/><a name="76"/>   76:     case CryptoStarted of
<a name="77"/>   77:         true -&gt;
<a name="78"/>   78:             LocalFile = priv_file(Config, hostname()++&quot;.cryptodata&quot;),
<a name="79"/>   79: 
<a name="80"/>   80:             case usable_file(LocalFile) of
<a name="81"/>   81:                 false -&gt; ct:fail(no_local_file);
<a name="82"/>   82:                 true -&gt; ok
<a name="83"/>   83:             end,
<a name="84"/>   84: 
<a name="85"/>   85:             ct:log(&quot;os:type() = ~p&quot;, [os:type()]),
<a name="86"/>   86: 
<a name="87"/>   87:             TransferType =
<a name="88"/>   88:                 case {path_type(RemoteFile), os:type()} of
<a name="89"/>   89:                     {local, {unix,_}} -&gt;
<a name="90"/>   90:                              case usable_file(RemoteFile) of
<a name="91"/>   91:                                  true -&gt; filesystem;
<a name="92"/>   92:                                  false -&gt; ssh
<a name="93"/>   93:                              end;
<a name="94"/>   94:                           _ -&gt;
<a name="95"/>   95:                              ssh
<a name="96"/>   96:                      end,
<a name="97"/>   97: 
<a name="98"/>   98:             case TransferType of
<a name="99"/>   99:                 filesystem -&gt;
<a name="100"/>  100:                     %% 'filesystem' was concluded since it was possible
<a name="101"/>  101:                     %% to open the file in append mode
<a name="102"/>  102:                     {ok,B} = file:read_file(RemoteFile),
<a name="103"/>  103:                     ok = file:write_file(LocalFile, B);
<a name="104"/>  104:                 ssh -&gt;
<a name="105"/>  105:                     SCP = wsl_ify(&quot;scp &quot;++RemoteFile++&quot; &quot;++remove_drive_letter(LocalFile)),
<a name="106"/>  106:                     ct:pal(&quot;Run command: \&quot;~s\&quot;&quot;, [SCP]),
<a name="107"/>  107:                     Result = os:cmd(SCP),
<a name="108"/>  108:                     ct:pal(&quot;Command result: \&quot;~s\&quot;&quot;,[Result])
<a name="109"/>  109:             end,
<a name="110"/>  110: 
<a name="111"/>  111:             crypto:enable_fips_mode(true),
<a name="112"/>  112: 
<a name="113"/>  113:             [{transfer_type, TransferType},
<a name="114"/>  114:              {local_file,LocalFile},
<a name="115"/>  115:              {remote_file,RemoteFile} | Config];
<a name="116"/>  116: 
<a name="117"/>  117:         false -&gt;
<a name="118"/>  118:             {skip, &quot;Crypto did not start&quot;}
<a name="119"/>  119:     end.
<a name="120"/>  120: 
<a name="end_per_suite-1"/><a name="121"/>  121: <b>end_per_suite</b>(Config) -&gt;
<a name="122"/>  122:     LocalFile = proplists:get_value(local_file,Config),
<a name="123"/>  123:     RemoteFile = proplists:get_value(remote_file,Config),
<a name="124"/>  124:     case proplists:get_value(transfer_type,Config) of
<a name="125"/>  125:         filesystem -&gt;
<a name="126"/>  126:             {ok,B} = file:read_file(LocalFile),
<a name="127"/>  127:             ok = file:write_file(RemoteFile, B);
<a name="128"/>  128:         ssh -&gt;
<a name="129"/>  129:             SCP = wsl_ify(&quot;scp &quot;++remove_drive_letter(LocalFile)++&quot; &quot;++RemoteFile),
<a name="130"/>  130:             ct:pal(&quot;Run command: \&quot;~s\&quot;&quot;, [SCP]),
<a name="131"/>  131:             Result = os:cmd(SCP),
<a name="132"/>  132:             ct:pal(&quot;Command result: \&quot;~s\&quot;&quot;,[Result])
<a name="133"/>  133:     end,
<a name="end_per_suite-last_expr"/><a name="134"/>  134: <b>    file:delete</b>(LocalFile).
<a name="135"/>  135: 
<a name="path_type-1"/><a name="136"/>  136: <b>path_type</b>(Path) -&gt;
<a name="path_type-last_expr"/><a name="137"/>  137: <b>    case string:lexemes</b>(Path, &quot;:&quot;) of
<a name="138"/>  138:         [_] -&gt;
<a name="139"/>  139:             local;
<a name="140"/>  140:         [Host | _] -&gt;
<a name="141"/>  141:             case string:find(Host, &quot;/&quot;) of
<a name="142"/>  142:                 nomatch -&gt; remote;
<a name="143"/>  143:                 _ -&gt; local
<a name="144"/>  144:             end
<a name="145"/>  145:     end.
<a name="146"/>  146: 
<a name="147"/>  147: <i>%%--------------------------------------------------------------------</i>
<a name="crypto_info_lib-1"/><a name="148"/>  148: <b>crypto_info_lib</b>(Config) -&gt;
<a name="149"/>  149:     LocalFile = proplists:get_value(local_file, Config),
<a name="150"/>  150: 
<a name="151"/>  151:     NewEntry = new_entry(),
<a name="152"/>  152:     ct:pal(&quot;New entry:~n~p&quot;,[NewEntry]),
<a name="153"/>  153: 
<a name="154"/>  154:     YoungEntries =
<a name="155"/>  155:         case file:consult(LocalFile) of
<a name="156"/>  156:             {ok, Consulted} when is_list(Consulted) -&gt;
<a name="157"/>  157:                 lists:filter(fun(E) -&gt; is_young(E) end,
<a name="158"/>  158:                              Consulted);
<a name="159"/>  159:             Other -&gt;
<a name="160"/>  160:                 ct:log(&quot;Strange result of consult:~n~p&quot;, [Other]),
<a name="161"/>  161:                 ct:fail(&quot;Consult failed&quot;)
<a name="162"/>  162:         end,
<a name="163"/>  163: 
<a name="164"/>  164:     {ok,D} = file:open(LocalFile, [write]),
<a name="165"/>  165:     lists:foreach(fun(E) -&gt;
<a name="166"/>  166:                           io:format(D, '~p.~n', [E])
<a name="167"/>  167:                   end, lists:usort([NewEntry|YoungEntries])),
<a name="crypto_info_lib-last_expr"/><a name="168"/>  168: <b>    file:close</b>(D).
<a name="169"/>  169: 
<a name="is_young-1"/><a name="170"/>  170: <b>is_young</b>(E) -&gt;
<a name="is_young-last_expr"/><a name="171"/>  171:     try
<a name="172"/>  172:         Days = days_ago(proplists:get_value(date, E)),
<a name="173"/>  173:         Days &gt;= 0 andalso Days =&lt; ?DAYS_TO_KEEP
<a name="174"/>  174:     catch
<a name="175"/>  175:         _:_ -&gt; false                     % No or illegal date property
<a name="176"/>  176:     end.
<a name="177"/>  177: 
<a name="days_ago-1"/><a name="178"/>  178: <b>days_ago</b>(D={_,_,_})-&gt;
<a name="days_ago-last_expr"/><a name="179"/>  179: <b>     calendar:date_to_gregorian_days</b>(date()) - calendar:date_to_gregorian_days(D).
<a name="180"/>  180: 
<a name="new_entry-0"/><a name="181"/>  181: <b>new_entry</b>() -&gt;
<a name="182"/>  182:     [{hostname,  hostname()},
<a name="183"/>  183:      {date,      date()},
<a name="184"/>  184:      {time,      time()},
<a name="185"/>  185:      {os_type,   os:type()},
<a name="186"/>  186:      {os_version,os:version()}
<a name="187"/>  187:     ]
<a name="new_entry-last_expr"/><a name="188"/>  188: <b>    ++ [{cwd,PWD} || {ok,PWD} &lt;- [file:get_cwd</b>()]]
<a name="189"/>  189:     ++ crypto_info([info_lib,info_fips,compile_type,link_type,supports,ec_curves])
<a name="190"/>  190:     ++ try_rsa().
<a name="191"/>  191: 
<a name="crypto_info-1"/><a name="192"/>  192: <b>crypto_info</b>(Tags) -&gt;
<a name="crypto_info-last_expr"/><a name="193"/>  193:     [{Tag, Info} || Tag &lt;- Tags,
<a name="194"/>  194:                     Info &lt;-
<a name="195"/>  195:                         try crypto:Tag()
<a name="196"/>  196:                         of V -&gt; [V]
<a name="197"/>  197:                         catch _:_ -&gt;
<a name="198"/>  198:                                 try maps:get(Tag, crypto:info()) of
<a name="199"/>  199:                                     V -&gt; [V]
<a name="200"/>  200:                                 catch  _:_ -&gt; []
<a name="201"/>  201:                                 end
<a name="202"/>  202:                         end
<a name="203"/>  203:     ].
<a name="204"/>  204: 
<a name="205"/>  205: <i>%%--------------------------------------------------------------------</i>
<a name="try_rsa-0"/><a name="206"/>  206: <b>try_rsa</b>() -&gt;
<a name="try_rsa-last_expr"/><a name="207"/>  207:     try
<a name="208"/>  208:         {Pub,Pri} = rsa_keys(), %% Precomputed {4096,65537}
<a name="209"/>  209:         RsaOpts = proplists:get_value(rsa_opts, crypto:supports(), []),
<a name="210"/>  210:         [{sign_verify, test_sign_verify(Pub, Pri, RsaOpts)},
<a name="211"/>  211:          {pub_enc_priv_dec, pk_enc_dec(RsaOpts, Pub, fun crypto:public_encrypt/4,  Pri, fun crypto:private_decrypt/4)},
<a name="212"/>  212:          {priv_enc_pub_dec, pk_enc_dec(RsaOpts, Pri, fun crypto:private_encrypt/4, Pub, fun crypto:public_decrypt/4)}
<a name="213"/>  213:         ]
<a name="214"/>  214:     catch
<a name="215"/>  215:         _:_ -&gt;
<a name="216"/>  216:             []
<a name="217"/>  217:     end.
<a name="218"/>  218: 
<a name="md_opts-0"/><a name="219"/>  219: <b>md_opts</b>() -&gt;
<a name="md_opts-last_expr"/><a name="220"/>  220:     [rsa_mgf1_md, rsa_oaep_md].
<a name="221"/>  221: 
<a name="222"/>  222: <i>%%----------------</i>
<a name="pk_enc_dec-5"/><a name="223"/>  223: <b>pk_enc_dec</b>(PadOpts, KeyEnc, Fenc, KeyDec, Fdec) -&gt;
<a name="224"/>  224:     Ptxt = &lt;&lt;1:32/unit:8&gt;&gt;,
<a name="225"/>  225:     HashOpts = [O || O &lt;- md_opts(),
<a name="226"/>  226:                      lists:member(O, PadOpts)],
<a name="227"/>  227:     NonHashOpts = PadOpts -- HashOpts,
<a name="pk_enc_dec-last_expr"/><a name="228"/>  228: <b>    lists:sort</b>(
<a name="229"/>  229:       pk_enc_dec_hash_opts(HashOpts, KeyEnc, Fenc, KeyDec, Fdec, Ptxt) ++
<a name="230"/>  230:       pk_enc_dec_non_hash_opts(NonHashOpts, KeyEnc, Fenc, KeyDec, Fdec, Ptxt)
<a name="231"/>  231:      ).
<a name="232"/>  232: 
<a name="233"/>  233: <i>%%----</i>
<a name="pk_enc_dec_hash_opts-6"/><a name="234"/>  234: <b>pk_enc_dec_hash_opts</b>(PadOpts, KeyEnc, Fenc, KeyDec, Fdec, Ptxt) -&gt;
<a name="235"/>  235:     SupHash = proplists:get_value(hashs, crypto:supports(), []),
<a name="pk_enc_dec_hash_opts-last_expr"/><a name="236"/>  236:     [begin
<a name="237"/>  237:          [H|T] = lists:reverse(tuple_to_list(LogOpt)),
<a name="238"/>  238:          list_to_tuple(lists:reverse([{H,OkMDs}|T]))
<a name="239"/>  239:      end ||
<a name="240"/>  240:         Opt &lt;- PadOpts,
<a name="241"/>  241:         {LogOpt, OptsF} &lt;- gen_logopt_opts(Opt),
<a name="242"/>  242:         OkMDs &lt;- [
<a name="243"/>  243:                     [MD || MD &lt;- SupHash,
<a name="244"/>  244:                              pk_enc_dec_1(Fenc, Ptxt, KeyEnc, Fdec, KeyDec, OptsF(MD))]
<a name="245"/>  245:                    ],
<a name="246"/>  246:         OkMDs =/= []
<a name="247"/>  247:     ].
<a name="248"/>  248: 
<a name="pk_enc_dec_non_hash_opts-6"/><a name="249"/>  249: <b>pk_enc_dec_non_hash_opts</b>(PadOpts, KeyEnc, Fenc, KeyDec, Fdec, Ptxt) -&gt;
<a name="pk_enc_dec_non_hash_opts-last_expr"/><a name="250"/>  250:     [LogOpt ||
<a name="251"/>  251:         Opt &lt;- PadOpts,
<a name="252"/>  252:         {LogOpt, OptsF} &lt;- gen_logopt_opts(Opt),
<a name="253"/>  253:         pk_enc_dec_1(Fenc, Ptxt, KeyEnc, Fdec, KeyDec, OptsF(undefined))
<a name="254"/>  254:     ].
<a name="255"/>  255: 
<a name="256"/>  256: <i>%%----</i>
<a name="pk_enc_dec_1-6"/><a name="257"/>  257: <b>pk_enc_dec_1</b>(Fenc, Ptxt, KeyEnc, Fdec, KeyDec, Opts) -&gt;
<a name="pk_enc_dec_1-last_expr"/><a name="258"/>  258:     case
<a name="259"/>  259:         begin
<a name="260"/>  260:             R = try Fdec(rsa, Fenc(rsa,Ptxt,KeyEnc,Opts), KeyDec, Opts)
<a name="261"/>  261:                 catch _:_ -&gt; no
<a name="262"/>  262:                 end,
<a name="263"/>  263:             ct:pal(&quot;enc/dec ~p -&gt; ~p&quot;,[Opts,R]),
<a name="264"/>  264:             R
<a name="265"/>  265:         end
<a name="266"/>  266:     of
<a name="267"/>  267:         Ptxt -&gt;
<a name="268"/>  268:             true;
<a name="269"/>  269:         _ -&gt;
<a name="270"/>  270:             false
<a name="271"/>  271:     end.
<a name="272"/>  272: 
<a name="273"/>  273: <i>%%----------------</i>
<a name="test_sign_verify-3"/><a name="274"/>  274: <b>test_sign_verify</b>(Pub, Pri, RsaOpts) -&gt;
<a name="275"/>  275:     MDs = Hashs = proplists:get_value(hashs, crypto:supports(), []),
<a name="276"/>  276:     HashOpts = [O || O &lt;- md_opts(),
<a name="277"/>  277:                      lists:member(O, RsaOpts)],
<a name="278"/>  278:     NonHashOpts = RsaOpts -- HashOpts,
<a name="279"/>  279:     Rm1 =
<a name="280"/>  280:         lists:sort(
<a name="281"/>  281:           [{{LogOpt,OkHashs},MD} ||
<a name="282"/>  282:               Opt &lt;- HashOpts,
<a name="283"/>  283:               {LogOpt, OptsF}  &lt;- gen_logopt_opts(Opt),
<a name="284"/>  284:               MD &lt;- MDs,
<a name="285"/>  285:               OkHashs &lt;- [test_sign_verify_hashs(Pub, Pri, OptsF(MD), Hashs)],
<a name="286"/>  286:               OkHashs =/= []
<a name="287"/>  287:           ]),
<a name="288"/>  288: 
<a name="289"/>  289:     Rm2 =
<a name="290"/>  290:         lists:sort(
<a name="291"/>  291:           [{LogOpt,OkHashs} ||
<a name="292"/>  292:               Opt &lt;- NonHashOpts,
<a name="293"/>  293:               {LogOpt, OptsF}  &lt;- gen_logopt_opts(Opt),
<a name="294"/>  294:               OkHashs &lt;- [test_sign_verify_hashs(Pub, Pri, OptsF(undefined), Hashs)],
<a name="295"/>  295:               OkHashs =/= []
<a name="296"/>  296:           ]),
<a name="297"/>  297: 
<a name="test_sign_verify-last_expr"/><a name="298"/>  298: <b>    lists:sort</b>(
<a name="299"/>  299:       Rm2 ++ 
<a name="300"/>  300:           lists:foldr(fun({{LogOpt,MD0s},_OkHashs}, Acc) -&gt;
<a name="301"/>  301:                               [H|T] = lists:reverse(tuple_to_list(LogOpt)),
<a name="302"/>  302:                               [list_to_tuple(lists:reverse([{H,MD0s}|T])) | Acc]
<a name="303"/>  303:                       end,
<a name="304"/>  304:                       [],
<a name="305"/>  305:                       lists:foldr(fun({{LogOpt,OkHashs},MD1}, [{{LogOpt,MD1s},OkHashs}|T]) -&gt;
<a name="306"/>  306:                                           [{{LogOpt,[MD1|MD1s]},OkHashs}|T];
<a name="307"/>  307:                                      ({{LogOpt,OkHashs},MD1}, T) -&gt;
<a name="308"/>  308:                                           [{{LogOpt,[MD1]},OkHashs}|T]
<a name="309"/>  309:                                   end, [], Rm1)
<a name="310"/>  310:                      )
<a name="311"/>  311:      ).
<a name="312"/>  312: 
<a name="test_sign_verify_hashs-4"/><a name="313"/>  313: <b>test_sign_verify_hashs</b>(Pub, Pri, Opts, Hashs) -&gt;
<a name="test_sign_verify_hashs-last_expr"/><a name="314"/>  314:     [Hash || Hash &lt;- Hashs,
<a name="315"/>  315:              test_sign_verify_hash(Pub, Pri, Opts, Hash)
<a name="316"/>  316:     ].
<a name="317"/>  317: 
<a name="test_sign_verify_hash-4"/><a name="318"/>  318: <b>test_sign_verify_hash</b>(Pub, Pri, Opts, Hash) -&gt;
<a name="319"/>  319:     R = try
<a name="320"/>  320:             Sig = crypto:sign(rsa, Hash, &lt;&lt;&quot;hej&quot;&gt;&gt;, Pri, Opts),
<a name="321"/>  321:             true == crypto:verify(rsa, Hash, &lt;&lt;&quot;hej&quot;&gt;&gt;, Sig, Pub, Opts)
<a name="322"/>  322:         catch
<a name="323"/>  323:             _:_ -&gt; false
<a name="324"/>  324:         end,
<a name="325"/>  325:     ct:pal(&quot;sign/verify ~p ~p -&gt; ~p&quot;,[Opts,Hash,R]),
<a name="test_sign_verify_hash-last_expr"/><a name="326"/>  326:     R.
<a name="327"/>  327: 
<a name="328"/>  328: <i>%%----------------</i>
<a name="gen_logopt_opts-1"/><a name="329"/>  329: <b>gen_logopt_opts</b>(rsa_mgf1_md = Opt) -&gt;
<a name="330"/>  330:     [{{rsa_pkcs1_pss_padding, Opt},
<a name="331"/>  331:       fun(Hash) -&gt;
<a name="332"/>  332:               [{rsa_padding,rsa_pkcs1_pss_padding},
<a name="333"/>  333:                {rsa_mgf1_md,Hash}]
<a name="334"/>  334:       end
<a name="335"/>  335:      },
<a name="336"/>  336: 
<a name="337"/>  337:      {{rsa_pkcs1_oaep_padding,Opt},
<a name="338"/>  338:       fun(Hash) -&gt;
<a name="339"/>  339:               [{rsa_padding,rsa_pkcs1_oaep_padding},
<a name="340"/>  340:                {rsa_mgf1_md,Hash}]
<a name="341"/>  341:       end
<a name="342"/>  342:      }
<a name="343"/>  343:     ];
<a name="344"/>  344: 
<a name="345"/>  345: <b>gen_logopt_opts</b>(rsa_pss_saltlen = Opt) -&gt; 
<a name="346"/>  346:     [{{rsa_pkcs1_pss_padding,Opt},
<a name="347"/>  347:       fun(_Hash) -&gt;
<a name="348"/>  348:               [{rsa_padding,rsa_pkcs1_pss_padding},
<a name="349"/>  349:                {rsa_pss_saltlen,3}]
<a name="350"/>  350:       end
<a name="351"/>  351:      }];
<a name="352"/>  352: 
<a name="353"/>  353: <b>gen_logopt_opts</b>(rsa_oaep_label = Opt) -&gt; 
<a name="354"/>  354:     [{{rsa_pkcs1_oaep_padding,Opt},
<a name="355"/>  355:        fun(_Hash) -&gt;
<a name="356"/>  356:                [{rsa_padding,rsa_pkcs1_oaep_padding},
<a name="357"/>  357:                 {rsa_oaep_label,&lt;&lt;&quot;putte&quot;&gt;&gt;}]
<a name="358"/>  358:        end
<a name="359"/>  359:      }];
<a name="360"/>  360: 
<a name="361"/>  361: <b>gen_logopt_opts</b>(rsa_oaep_md = Opt) -&gt;
<a name="362"/>  362:     [{{rsa_pkcs1_oaep_padding,Opt},
<a name="363"/>  363:       fun(Hash) -&gt;
<a name="364"/>  364:               [{rsa_padding,rsa_pkcs1_oaep_padding},
<a name="365"/>  365:                {rsa_oaep_md,Hash}]
<a name="366"/>  366:       end
<a name="367"/>  367:      }];
<a name="368"/>  368: 
<a name="369"/>  369: <b>gen_logopt_opts</b>(signature_md) -&gt;
<a name="370"/>  370:     [];
<a name="371"/>  371: 
<a name="372"/>  372: <b>gen_logopt_opts</b>(Opt) -&gt; 
<a name="gen_logopt_opts-last_expr"/><a name="373"/>  373:     [{Opt,
<a name="374"/>  374:       fun(_Hash) -&gt;
<a name="375"/>  375:               [{rsa_padding,Opt}]
<a name="376"/>  376:       end
<a name="377"/>  377:      }].
<a name="378"/>  378:         
<a name="379"/>  379:         
<a name="380"/>  380: 
<a name="rsa_keys-0"/><a name="381"/>  381: <b>rsa_keys</b>() -&gt;
<a name="rsa_keys-last_expr"/><a name="382"/>  382:     {[&lt;&lt;1,0,1&gt;&gt;,
<a name="383"/>  383:       &lt;&lt;184,150,67,22,76,107,137,142,167,255,194,1,215,181,17,212,132,236,4,125,13,115,247,242,189,131,107,101,85,44,86,194,140,47,9,223,187,8,149,120,79,189,228,126,124,174,244,3,164,165,48,50,32,28,251,226,109,27,132,254,210,71,48,86,110,101,77,172,88,148,39,124,235,88,63,225,142,192,255,168,105,177,37,238,148,38,198,188,224,8,82,34,255,203,212,12,1,164,191,222,94,102,252,82,155,33,234,106,207,220,68,84,120,86,189,33,107,162,48,56,9,99,179,3,114,179,107,160,113,246,128,72,89,243,152,31,107,145,151,12,214,79,57,120,210,225,59,221,145,70,120,167,115,66,62,12,250,53,171,0,253,53,117,40,33,98,212,0,135,29,205,119,70,76,17,226,94,108,166,119,181,54,47,152,162,179,123,170,233,43,195,19,191,95,124,245,133,154,46,221,89,162,153,104,26,189,0,122,21,23,98,105,251,52,220,2,168,31,246,247,170,194,141,76,79,104,48,57,24,126,150,43,92,199,27,204,124,62,187,234,59,88,131,126,147,8,176,106,216,186,185,180,184,71,223,4,123,190,138,46,236,27,138,81,34,204,57,229,222,59,68,23,199,153,90,1,41,190,170,190,131,163,215,144,43,238,203,134,85,150,22,40,234,86,142,16,232,205,172,231,242,11,113,85,89,55,236,12,91,9,107,157,93,86,51,86,164,233,169,113,33,175,182,188,142,91,95,177,162,157,110,172,84,239,230,234,133,26,162,198,193,246,66,23,13,16,25,45,59,174,175,0,96,83,241,137,102,24,54,77,189,14,191,108,44,143,60,239,45,231,236,116,66,188,77,227,234,94,169,114,97,220,38,153,222,77,77,102,81,138,51,18,46,137,177,99,155,85,10,213,82,221,6,35,162,177,110,164,79,197,233,242,100,159,105,91,200,234,5,120,142,237,216,118,60,245,172,29,182,168,227,125,17,159,8,143,233,136,55,130,253,7,150,94,206,106,231,68,199,254,25,85,22,57,74,236,144,19,242,179,57,57,9,14,146,28,52,54,170,109,200,195,152,170,214,81,249,238,9,38,215,73,86,241,116,26,139,152,99,64,165,192,69,84,214,96,18,28,141,118,63,35,114,122,87,43,96,4,199,224,157,239&gt;&gt;],
<a name="384"/>  384: 
<a name="385"/>  385:      [&lt;&lt;1,0,1&gt;&gt;,
<a name="386"/>  386:       &lt;&lt;184,150,67,22,76,107,137,142,167,255,194,1,215,181,17,212,132,236,4,125,13,115,247,242,189,131,107,101,85,44,86,194,140,47,9,223,187,8,149,120,79,189,228,126,124,174,244,3,164,165,48,50,32,28,251,226,109,27,132,254,210,71,48,86,110,101,77,172,88,148,39,124,235,88,63,225,142,192,255,168,105,177,37,238,148,38,198,188,224,8,82,34,255,203,212,12,1,164,191,222,94,102,252,82,155,33,234,106,207,220,68,84,120,86,189,33,107,162,48,56,9,99,179,3,114,179,107,160,113,246,128,72,89,243,152,31,107,145,151,12,214,79,57,120,210,225,59,221,145,70,120,167,115,66,62,12,250,53,171,0,253,53,117,40,33,98,212,0,135,29,205,119,70,76,17,226,94,108,166,119,181,54,47,152,162,179,123,170,233,43,195,19,191,95,124,245,133,154,46,221,89,162,153,104,26,189,0,122,21,23,98,105,251,52,220,2,168,31,246,247,170,194,141,76,79,104,48,57,24,126,150,43,92,199,27,204,124,62,187,234,59,88,131,126,147,8,176,106,216,186,185,180,184,71,223,4,123,190,138,46,236,27,138,81,34,204,57,229,222,59,68,23,199,153,90,1,41,190,170,190,131,163,215,144,43,238,203,134,85,150,22,40,234,86,142,16,232,205,172,231,242,11,113,85,89,55,236,12,91,9,107,157,93,86,51,86,164,233,169,113,33,175,182,188,142,91,95,177,162,157,110,172,84,239,230,234,133,26,162,198,193,246,66,23,13,16,25,45,59,174,175,0,96,83,241,137,102,24,54,77,189,14,191,108,44,143,60,239,45,231,236,116,66,188,77,227,234,94,169,114,97,220,38,153,222,77,77,102,81,138,51,18,46,137,177,99,155,85,10,213,82,221,6,35,162,177,110,164,79,197,233,242,100,159,105,91,200,234,5,120,142,237,216,118,60,245,172,29,182,168,227,125,17,159,8,143,233,136,55,130,253,7,150,94,206,106,231,68,199,254,25,85,22,57,74,236,144,19,242,179,57,57,9,14,146,28,52,54,170,109,200,195,152,170,214,81,249,238,9,38,215,73,86,241,116,26,139,152,99,64,165,192,69,84,214,96,18,28,141,118,63,35,114,122,87,43,96,4,199,224,157,239&gt;&gt;,
<a name="387"/>  387:       &lt;&lt;6,96,106,128,226,178,244,85,145,72,44,147,147,184,21,157,153,217,237,109,196,129,53,23,149,164,108,153,91,143,228,143,99,248,92,6,246,151,29,82,194,174,116,174,73,240,97,77,158,234,117,247,197,84,58,255,95,117,139,234,161,169,3,234,120,117,215,113,20,190,73,126,239,66,101,50,141,147,237,65,12,37,170,129,203,108,107,129,42,220,30,186,70,203,235,207,94,95,42,161,171,241,50,214,71,181,172,59,116,98,207,153,123,110,195,169,219,230,6,116,105,30,160,152,133,229,220,217,246,21,229,232,153,242,232,86,109,136,226,6,247,128,85,35,239,101,8,132,102,248,96,66,168,160,169,52,25,144,177,15,159,175,177,20,105,210,216,48,12,122,227,22,51,191,124,254,172,244,99,235,206,190,200,118,37,104,189,228,241,153,41,108,13,56,103,64,180,20,215,121,158,23,23,229,152,198,222,181,88,245,45,217,43,108,112,13,71,113,147,62,139,15,157,129,253,92,68,14,52,226,106,157,164,222,219,254,252,107,206,98,17,26,197,176,33,180,51,35,253,200,181,145,160,172,26,240,37,163,4,195,29,56,108,116,12,23,232,64,225,80,249,223,3,119,251,59,192,43,120,132,98,193,108,88,160,83,183,24,210,143,125,12,78,248,44,137,55,191,250,226,84,45,184,107,35,65,221,107,13,145,179,84,64,190,211,39,13,52,253,37,231,12,67,138,218,140,215,57,181,178,154,64,22,196,57,233,183,182,34,229,214,100,252,39,83,1,166,26,238,91,82,70,224,170,46,250,215,247,237,44,61,245,153,198,50,119,158,157,26,196,168,56,238,136,3,233,137,186,165,143,228,19,14,52,106,61,97,85,50,212,160,24,73,246,145,226,163,176,16,156,45,16,34,122,143,142,223,50,240,224,12,234,119,122,65,167,150,190,63,118,10,250,233,173,206,90,44,36,176,32,110,235,189,56,68,151,29,43,72,41,4,177,112,119,144,243,92,120,51,157,232,113,57,186,7,21,152,22,244,56,92,44,63,213,110,197,204,22,19,69,10,172,136,114,172,19,128,4,149,50,130,238,212,139,78,164,219,187,2,2,23,197,0,40,22,65,197,129,55,206,221,4,208,60,173,157,138,105,67,147,192,193&gt;&gt;,
<a name="388"/>  388:       &lt;&lt;236,240,239,180,144,149,110,219,221,16,232,109,235,113,46,241,245,63,172,130,16,207,32,9,108,91,17,129,164,182,0,67,167,223,65,148,51,163,132,226,195,45,22,71,86,45,48,115,229,0,104,114,192,215,190,50,98,38,56,205,247,193,186,213,138,127,210,154,130,26,7,206,42,70,61,208,223,99,179,2,2,201,148,49,53,57,154,209,20,125,8,45,215,107,39,198,228,176,12,161,14,57,84,247,236,147,134,1,124,83,146,218,235,65,176,143,205,166,10,177,127,238,94,7,240,194,161,222,154,27,75,10,144,155,8,100,128,1,220,108,98,58,152,21,42,133,212,127,161,155,175,36,142,140,107,236,37,232,86,200,251,43,121,91,51,60,67,248,26,113,168,110,134,161,244,42,162,72,39,111,85,62,169,237,53,153,241,191,178,236,139,9,17,40,120,77,187,198,216,143,179,179,77,117,199,226,8,196,238,65,97,163,62,2,150,122,1,240,12,25,226,211,84,119,186,172,218,171,155,202,201,178,142,36,232,249,44,135,235,81,146,148,106,249,83,253,233,198,152,29,205,18,166,147,240,195&gt;&gt;,
<a name="389"/>  389:       &lt;&lt;199,111,65,34,99,67,225,246,145,69,58,195,193,187,63,170,49,114,63,158,95,149,1,57,178,55,176,29,96,188,238,6,201,184,175,16,48,80,9,237,111,171,37,74,199,72,121,197,230,136,217,226,137,95,181,202,104,75,148,142,16,52,84,127,250,114,137,197,254,184,140,132,213,238,67,140,165,0,209,138,63,100,169,185,150,94,73,156,232,46,135,226,216,63,214,148,131,169,92,166,109,68,132,152,102,111,126,164,26,81,64,156,178,158,168,183,94,93,114,246,250,179,80,142,112,196,58,157,93,82,43,173,153,212,154,74,217,44,239,247,127,91,23,207,204,125,61,24,119,108,186,197,102,109,77,203,218,172,254,118,183,95,196,158,112,100,41,171,92,105,127,190,21,54,252,107,75,155,108,129,43,252,246,239,176,137,26,26,224,93,46,153,200,60,75,48,184,40,45,168,9,23,202,103,234,8,192,198,161,174,44,152,236,132,193,240,149,234,56,201,68,83,27,1,106,65,46,60,112,67,186,173,25,71,220,138,127,89,79,65,162,121,15,123,119,216,244,46,27,249,171,129,72,136,203,101&gt;&gt;,
<a name="390"/>  390:       &lt;&lt;94,223,6,11,181,140,175,235,198,243,91,45,144,5,44,183,226,236,16,229,175,87,79,203,150,32,76,189,45,55,86,153,192,96,203,64,77,0,223,87,112,176,223,231,198,96,167,178,239,241,158,224,187,200,102,182,131,200,44,28,132,100,132,171,182,30,2,52,173,125,64,188,210,254,119,7,232,58,98,85,158,202,25,213,46,43,151,138,185,250,106,72,248,165,70,51,4,36,93,154,43,56,215,133,193,171,60,15,226,57,16,103,41,165,142,205,181,153,19,85,9,21,103,127,36,110,186,35,136,110,255,56,6,184,156,190,168,230,149,220,171,228,44,58,229,96,218,186,19,250,99,65,110,246,88,204,32,77,140,90,66,255,160,66,221,27,247,87,35,55,121,42,112,43,238,185,23,107,110,166,204,106,31,222,4,5,84,223,222,3,138,148,33,211,163,127,244,124,228,255,125,3,129,51,116,202,83,154,142,143,141,73,176,173,150,148,217,171,197,28,164,78,219,214,104,223,135,91,9,49,68,91,131,64,210,43,219,33,189,30,87,99,168,5,151,20,231,3,6,171,128,14,68,182,157,195&gt;&gt;,
<a name="391"/>  391:       &lt;&lt;7,89,91,46,24,56,85,40,79,220,28,57,64,119,84,246,65,146,51,51,243,211,186,210,212,117,102,224,254,66,152,6,218,2,27,57,94,126,100,143,66,81,45,51,159,58,85,122,108,111,88,144,23,125,214,102,26,7,198,246,161,52,60,116,230,214,183,170,251,34,243,210,165,75,125,99,190,100,212,83,226,216,35,196,249,252,137,123,229,182,105,61,123,184,134,128,188,133,78,43,183,213,17,137,200,36,141,167,32,109,36,19,98,37,164,147,245,63,62,80,73,150,183,254,55,187,147,105,95,25,251,16,15,158,28,253,107,25,83,210,107,248,0,93,160,236,112,134,233,71,177,110,58,195,6,93,223,182,6,62,123,173,100,194,109,227,211,1,68,139,130,176,143,121,146,61,165,240,153,67,253,73,250,19,133,14,216,78,107,60,35,206,120,233,119,223,216,185,106,77,73,224,125,141,236,186,219,215,181,247,132,31,50,128,5,225,134,180,181,216,252,210,143,41,51,48,41,179,2,116,12,121,250,119,130,113,252,21,95,109,76,190,103,74,166,116,241,50,141,199,90,129,142,25,180,93&gt;&gt;,
<a name="392"/>  392:       &lt;&lt;150,52,171,50,46,79,167,168,5,191,161,144,81,14,216,185,45,107,92,238,220,196,190,14,89,8,217,1,206,175,171,46,59,0,117,183,68,66,186,93,198,237,143,4,10,80,186,176,32,4,27,67,211,137,193,66,9,163,109,188,250,25,11,73,82,91,172,10,149,69,25,169,123,56,174,72,2,1,24,61,5,231,214,164,163,65,121,178,147,24,250,154,193,105,148,223,164,116,179,91,183,58,178,125,188,237,234,104,195,67,144,163,49,219,49,254,13,66,125,185,171,201,244,1,70,6,76,251,4,162,17,246,180,29,20,121,38,248,76,165,250,16,59,42,11,114,89,223,171,28,35,194,84,223,136,63,63,205,172,254,237,195,90,232,181,189,218,133,238,47,95,218,105,32,10,140,81,97,214,238,2,191,107,0,106,107,219,132,123,204,151,252,87,170,139,181,53,60,188,243,230,8,145,184,79,177,225,170,198,250,122,140,253,160,69,226,136,185,69,10,43,97,19,214,68,7,126,194,114,241,207,51,244,35,180,20,136,27,84,155,61,213,189,98,197,120,31,71,209,129,105,98,114,102,77,147&gt;&gt;]}.
<a name="393"/>  393: 
<a name="394"/>  394: <i>%%--------------------------------------------------------------------</i>
<a name="hostname-0"/><a name="395"/>  395: <b>hostname</b>() -&gt;
<a name="hostname-last_expr"/><a name="396"/>  396: <b>    case inet:gethostname</b>() of
<a name="397"/>  397: 	{ok,Name} -&gt; string:to_lower(Name);
<a name="398"/>  398: 	_ -&gt; &quot;undefined&quot;
<a name="399"/>  399:     end.
<a name="400"/>  400: 	    
<a name="priv_dir-1"/><a name="priv_dir-last_expr"/><a name="401"/>  401: <b>priv_dir</b>(Config) -&gt; proplists:get_value(priv_dir, Config).
<a name="402"/>  402: 
<a name="priv_file-2"/><a name="priv_file-last_expr"/><a name="403"/>  403: <b>priv_file</b>(Config, Name) -&gt; filename:join(priv_dir(Config), Name).
<a name="404"/>  404: 
<a name="405"/>  405: 
<a name="remove_drive_letter-1"/><a name="406"/>  406: <b>remove_drive_letter</b>([_DriveLetter,$:|FileName]) -&gt; &quot;/mnt/c&quot; ++ FileName;
<a name="remove_drive_letter-last_expr"/><a name="407"/>  407: <b>remove_drive_letter</b>(FileName) -&gt; FileName.
<a name="408"/>  408: 
<a name="409"/>  409: 
<a name="usable_file-1"/><a name="410"/>  410: <b>usable_file</b>(FileName) -&gt;
<a name="usable_file-last_expr"/><a name="411"/>  411: <b>    case file:open</b>(FileName, [append]) of
<a name="412"/>  412:         {ok,D} -&gt;
<a name="413"/>  413:             ok == file:close(D);
<a name="414"/>  414:         _ -&gt;
<a name="415"/>  415:             false
<a name="416"/>  416:     end.
<a name="417"/>  417: 
<a name="418"/>  418: <i>%%%----------------------------------------------------------------</i>
<a name="wsl_ify-1"/><a name="419"/>  419: <b>wsl_ify</b>(Cmnd) -&gt;
<a name="wsl_ify-last_expr"/><a name="420"/>  420: <b>    case os:getenv</b>(&quot;WSLENV&quot;) of
<a name="421"/>  421:         false -&gt; Cmnd;
<a name="422"/>  422:         _ -&gt; &quot;wsl &quot; ++ Cmnd
<a name="423"/>  423:     end.
</pre>
<script>
var hash = window.location.hash.substring(1);
var anchor = document.getElementsByName(hash);
anchor[0].style.backgroundColor="orange";
</script>
</body>
</html>
