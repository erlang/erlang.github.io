<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/lib/stdlib/make_test_dir/stdlib_test/queue_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%%</i>
<a name="2"/>    2: <i>%% %CopyrightBegin%</i>
<a name="3"/>    3: <i>%%</i>
<a name="4"/>    4: <i>%% Copyright Ericsson AB 1999-2021. All Rights Reserved.</i>
<a name="5"/>    5: <i>%%</i>
<a name="6"/>    6: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="7"/>    7: <i>%% you may not use this file except in compliance with the License.</i>
<a name="8"/>    8: <i>%% You may obtain a copy of the License at</i>
<a name="9"/>    9: <i>%%</i>
<a name="10"/>   10: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="11"/>   11: <i>%%</i>
<a name="12"/>   12: <i>%% Unless required by applicable law or agreed to in writing, software</i>
<a name="13"/>   13: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="14"/>   14: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="15"/>   15: <i>%% See the License for the specific language governing permissions and</i>
<a name="16"/>   16: <i>%% limitations under the License.</i>
<a name="17"/>   17: <i>%%</i>
<a name="18"/>   18: <i>%% %CopyrightEnd%</i>
<a name="19"/>   19: <i>%%</i>
<a name="20"/>   20: <b>-module</b>(queue_SUITE).
<a name="21"/>   21: <b>-export</b>([all/0, suite/0,groups/0,init_per_suite/1, end_per_suite/1, 
<a name="22"/>   22: 	 init_per_testcase/2, end_per_testcase/2,
<a name="23"/>   23: 	 init_per_group/2,end_per_group/2]).
<a name="24"/>   24: 
<a name="25"/>   25: <b>-export</b>([do/1, to_list/1, io_test/1, op_test/1, error/1, oops/1]).
<a name="26"/>   26: 
<a name="27"/>   27: 
<a name="28"/>   28: <b>-include_lib</b>(&quot;common_test/include/ct.hrl&quot;).
<a name="29"/>   29: 
<a name="init_per_testcase-2"/><a name="30"/>   30: <b>init_per_testcase</b>(_Case, Config) -&gt;
<a name="init_per_testcase-last_expr"/><a name="31"/>   31:     Config.
<a name="32"/>   32: 
<a name="end_per_testcase-2"/><a name="33"/>   33: <b>end_per_testcase</b>(_Case, _Config) -&gt;
<a name="end_per_testcase-last_expr"/><a name="34"/>   34:     ok.
<a name="35"/>   35: 
<a name="suite-0"/><a name="36"/>   36: <b>suite</b>() -&gt;
<a name="suite-last_expr"/><a name="37"/>   37:     [{ct_hooks,[ts_install_cth]},
<a name="38"/>   38:      {timetrap,{minutes,1}}].
<a name="39"/>   39: 
<a name="all-0"/><a name="40"/>   40: <b>all</b>() -&gt; 
<a name="all-last_expr"/><a name="41"/>   41:     [do, to_list, io_test, op_test, error, oops].
<a name="42"/>   42: 
<a name="groups-0"/><a name="43"/>   43: <b>groups</b>() -&gt; 
<a name="groups-last_expr"/><a name="44"/>   44:     [].
<a name="45"/>   45: 
<a name="init_per_suite-1"/><a name="46"/>   46: <b>init_per_suite</b>(Config) -&gt;
<a name="init_per_suite-last_expr"/><a name="47"/>   47:     Config.
<a name="48"/>   48: 
<a name="end_per_suite-1"/><a name="49"/>   49: <b>end_per_suite</b>(_Config) -&gt;
<a name="end_per_suite-last_expr"/><a name="50"/>   50:     ok.
<a name="51"/>   51: 
<a name="init_per_group-2"/><a name="52"/>   52: <b>init_per_group</b>(_GroupName, Config) -&gt;
<a name="init_per_group-last_expr"/><a name="53"/>   53:     Config.
<a name="54"/>   54: 
<a name="end_per_group-2"/><a name="55"/>   55: <b>end_per_group</b>(_GroupName, Config) -&gt;
<a name="end_per_group-last_expr"/><a name="56"/>   56:     Config.
<a name="57"/>   57: 
<a name="58"/>   58: 
<a name="do-1"/><a name="59"/>   59: <b>do</b>(Config) when is_list(Config) -&gt;
<a name="60"/>   60:     L = [{in, 1},
<a name="61"/>   61: 	 {in, 2},
<a name="62"/>   62: 	 {out, {value, 1}},
<a name="63"/>   63: 	 {in, 3},
<a name="64"/>   64: 	 {out, {value, 2}},
<a name="65"/>   65: 	 {out, {value, 3}},
<a name="66"/>   66: 	 {out, empty}
<a name="67"/>   67: 	],
<a name="68"/>   68: 
<a name="69"/>   69:     E = queue:new(),
<a name="70"/>   70:     [] = queue:to_list(E),
<a name="71"/>   71:     Q = do_queue(E, L),
<a name="72"/>   72:     true = queue:is_empty(Q),
<a name="73"/>   73:     0 = queue:len(Q),
<a name="do-last_expr"/><a name="74"/>   74:     ok.
<a name="75"/>   75: 
<a name="76"/>   76: <i>%% OTP-2701</i>
<a name="to_list-1"/><a name="77"/>   77: <b>to_list</b>(Config) when is_list(Config) -&gt;
<a name="78"/>   78:     E = queue:new(),
<a name="79"/>   79:     Q = do_queue(E, [{in, 1},
<a name="80"/>   80: 		     {in, 2},
<a name="81"/>   81: 		     {in, 3},
<a name="82"/>   82: 		     {out, {value, 1}},
<a name="83"/>   83: 		     {in, 4},
<a name="84"/>   84: 		     {in, 5}]),
<a name="85"/>   85:     true = queue:is_queue(Q),
<a name="86"/>   86:     4 = queue:len(Q),
<a name="87"/>   87:     case queue:to_list(Q) of
<a name="88"/>   88: 	[2,3,4,5] -&gt;
<a name="89"/>   89: 	    ok;
<a name="90"/>   90: 	Other1 -&gt;
<a name="91"/>   91: 	    ct:fail(Other1)
<a name="92"/>   92:     end,
<a name="to_list-last_expr"/><a name="93"/>   93:     ok.
<a name="94"/>   94: 
<a name="do_queue-2"/><a name="95"/>   95: <b>do_queue</b>(Q, []) -&gt;
<a name="96"/>   96:     Q;
<a name="97"/>   97: <b>do_queue</b>(Q, [E | Rest]) -&gt;
<a name="do_queue-last_expr"/><a name="98"/>   98: <b>    do_queue</b>(do_queue_1(E, Q), Rest).
<a name="99"/>   99: 
<a name="do_queue_1-2"/><a name="100"/>  100: <b>do_queue_1</b>({in, E}, Q) -&gt;
<a name="101"/>  101:     queue:in(E, Q);
<a name="102"/>  102: <b>do_queue_1</b>({out, E}, Q) -&gt;
<a name="do_queue_1-last_expr"/><a name="103"/>  103: <b>    case queue:out</b>(Q) of
<a name="104"/>  104: 	{E, Q1} -&gt;
<a name="105"/>  105: 	    Q1;
<a name="106"/>  106: 	Other -&gt;
<a name="107"/>  107: 	    ct:fail({&quot;out failed&quot;, E, Q, Other})
<a name="108"/>  108:     end.
<a name="109"/>  109: 
<a name="110"/>  110: 
<a name="111"/>  111: <i>%% Test input and output.</i>
<a name="io_test-1"/><a name="112"/>  112: <b>io_test</b>(Config) when is_list(Config) -&gt;
<a name="113"/>  113:     E = queue:new(),
<a name="114"/>  114:     do_io_test(E),
<a name="io_test-last_expr"/><a name="115"/>  115:     ok.
<a name="116"/>  116: 
<a name="do_io_test-1"/><a name="117"/>  117: <b>do_io_test</b>(E) -&gt;
<a name="118"/>  118:     [4,3,5] =
<a name="119"/>  119: 	io([snoc,snoc,head,head,head,cons,cons,snoc], E, 1),
<a name="120"/>  120:     [5,3,4] =
<a name="121"/>  121: 	io([cons,cons,daeh,daeh,daeh,snoc,snoc,cons], E, 1),
<a name="122"/>  122:     [4,3,5] =
<a name="123"/>  123: 	io([in,in,out,out,out,in_r,in_r,in], E, 1),
<a name="124"/>  124:     [5,3,4] =
<a name="125"/>  125: 	io([in_r,in_r,out_r,out_r,out_r,in,in,in_r], E, 1),
<a name="126"/>  126:     %%
<a name="127"/>  127:     [] =
<a name="128"/>  128: 	io([snoc,snoc,head,snoc,snoc,head,head,snoc,head,head], E, 1),
<a name="129"/>  129:     [] =
<a name="130"/>  130: 	io([cons,cons,daeh,cons,cons,daeh,daeh,cons,daeh,daeh], E, 1),
<a name="131"/>  131:     [] =
<a name="132"/>  132: 	io([in,in,out,in,in,out,out,in,out,out], E, 1),
<a name="133"/>  133:     [] =
<a name="134"/>  134: 	io([in_r,in_r,out_r,in_r,in_r,out_r,out_r,in_r,out_r,out_r], 
<a name="135"/>  135: 	   E, 1),
<a name="136"/>  136:     %%
<a name="137"/>  137:     [5,6] =
<a name="138"/>  138: 	io([snoc,snoc,snoc,head,head,snoc,snoc,snoc,head,head], E, 1),
<a name="139"/>  139:     [6,5] =
<a name="140"/>  140: 	io([cons,cons,cons,daeh,daeh,cons,cons,cons,daeh,daeh], E, 1),
<a name="141"/>  141:     [5,6] =
<a name="142"/>  142: 	io([in,in,in,out,out,in,in,in,out,out], E, 1),
<a name="143"/>  143:     [6,5] =
<a name="144"/>  144: 	io([in_r,in_r,in_r,out_r,out_r,in_r,in_r,in_r,out_r,out_r], 
<a name="145"/>  145: 	   E, 1),
<a name="146"/>  146:     %%
<a name="147"/>  147:     [5] =
<a name="148"/>  148: 	io([snoc,head,head,snoc,head,snoc,head,snoc,head,snoc], E, 1),
<a name="149"/>  149:     [5] =
<a name="150"/>  150: 	io([cons,daeh,daeh,cons,daeh,cons,daeh,cons,daeh,cons], E, 1),
<a name="151"/>  151:     [5] =
<a name="152"/>  152: 	io([in,out,out,in,out,in,out,in,out,in], E, 1),
<a name="153"/>  153:     [5] =
<a name="154"/>  154: 	io([in_r,out_r,out_r,in_r,out_r,in_r,out_r,in_r,out_r,in_r], 
<a name="155"/>  155: 	   E, 1),
<a name="156"/>  156:     %%
<a name="157"/>  157:     [] =
<a name="158"/>  158: 	io([snoc,head,snoc,snoc,head,head,snoc,snoc,snoc,head,head,head], 
<a name="159"/>  159: 	   E, 1),
<a name="160"/>  160:     [] =
<a name="161"/>  161: 	io([cons,daeh,cons,cons,daeh,daeh,cons,cons,cons,daeh,daeh,daeh],
<a name="162"/>  162: 	   E, 1),
<a name="163"/>  163:     [] =
<a name="164"/>  164: 	io([in,out,in,in,out,out,in,in,in,out,out,out], 
<a name="165"/>  165: 	   E, 1),
<a name="166"/>  166:     [] =
<a name="167"/>  167: 	io([in_r,out_r,in_r,in_r,out_r,out_r,in_r,in_r,in_r,out_r,out_r,out_r],
<a name="168"/>  168: 	   E, 1),
<a name="169"/>  169:     %%
<a name="170"/>  170:     [3] =	io([cons,cons,cons,snoc,daeh,daeh,daeh], E, 1),
<a name="171"/>  171:     [3] =	io([snoc,snoc,snoc,cons,head,head,head], E, 1),
<a name="172"/>  172:     [3] =	io([in,in,in,in_r,out,out,out], E, 1),
<a name="173"/>  173:     [3] =	io([in_r,in_r,in_r,in,out_r,out_r,out_r], E, 1),
<a name="174"/>  174:     %%
<a name="175"/>  175:     Q2 = queue:join(queue:cons(1, E),queue:cons(2, E)),
<a name="176"/>  176:     Q1 = queue:reverse(Q2),
<a name="177"/>  177:     [1] = io([head],  Q1, 3),
<a name="178"/>  178:     [1] = io([out],   Q1, 3),
<a name="179"/>  179:     [1] = io([daeh],  Q2, 3),
<a name="180"/>  180:     [1] = io([out_r], Q2, 3),
<a name="181"/>  181:     %%
<a name="182"/>  182:     [2] =
<a name="183"/>  183: 	io([in,peek,peek_r,drop,in_r,peek,peek_r,in,peek,peek_r,drop_r], E, 1),
<a name="184"/>  184:     %% Malformed queues UGLY-GUTS-ALL-OVER-THE-PLACE
<a name="185"/>  185:     [2,1] = io([peek], {[1,2],[]}, 1),
<a name="186"/>  186:     [1,2] = io([peek_r], {[],[1,2]}, 1),
<a name="187"/>  187:     %%
<a name="do_io_test-last_expr"/><a name="188"/>  188:     ok.
<a name="189"/>  189: 
<a name="190"/>  190: <i>%% Perform a list of operations to a queue.</i>
<a name="191"/>  191: <i>%% Keep a reference queue on the side; just a list.</i>
<a name="192"/>  192: <i>%% Compare the read values between the queues.</i>
<a name="193"/>  193: <i>%% Return the resulting queue as a list.</i>
<a name="194"/>  194: <i>%% Inserted values are increments of the previously inserted.</i>
<a name="io-3"/><a name="195"/>  195: <b>io</b>(Ops, Q, X) -&gt;
<a name="io-last_expr"/><a name="196"/>  196: <b>    io</b>(Ops, Q, queue:to_list(Q), X).
<a name="197"/>  197: 
<a name="io-4"/><a name="198"/>  198: <b>io</b>([head | Tail], Q, [], X) -&gt;
<a name="199"/>  199:     true = queue:is_empty(Q),
<a name="200"/>  200:     {'EXIT',{empty,_}} = (catch {ok,queue:head(Q)}),
<a name="201"/>  201:     {'EXIT',{empty,_}} = (catch {ok,queue:tail(Q)}),
<a name="202"/>  202:     io(Tail, Q, [], X);
<a name="203"/>  203: <b>io</b>([head | Tail], Q, [H | T], X) -&gt;
<a name="204"/>  204:     H = queue:head(Q),
<a name="205"/>  205:     false = queue:is_empty(Q),
<a name="206"/>  206:     io(Tail, queue:tail(Q), T, X);
<a name="207"/>  207: <b>io</b>([daeh | Tail], Q, [], X) -&gt;
<a name="208"/>  208:     true = queue:is_empty(Q),
<a name="209"/>  209:     {'EXIT',{empty,_}} = (catch {ok,queue:daeh(Q)}),
<a name="210"/>  210:     {'EXIT',{empty,_}} = (catch {ok,queue:liat(Q)}),
<a name="211"/>  211:     {'EXIT',{empty,_}} = (catch {ok,queue:lait(Q)}),
<a name="212"/>  212:     io(Tail, Q, [], X);
<a name="213"/>  213: <b>io</b>([daeh | Tail], Q, QQ, X) -&gt;
<a name="214"/>  214:     H = queue:daeh(Q),
<a name="215"/>  215:     false = queue:is_empty(Q),
<a name="216"/>  216:     [H | T] = lists:reverse(QQ),
<a name="217"/>  217:     io(Tail, queue:liat(Q), lists:reverse(T), X);
<a name="218"/>  218: <b>io</b>([out | Tail], Q, [], X) -&gt;
<a name="219"/>  219:     {empty, Q1} = queue:out(Q),
<a name="220"/>  220:     io(Tail, Q1, [], X);
<a name="221"/>  221: <b>io</b>([out | Tail], Q, [H | T], X) -&gt;
<a name="222"/>  222:     {{value,H}, Q1} = queue:out(Q),
<a name="223"/>  223:     io(Tail, Q1, T, X);
<a name="224"/>  224: <b>io</b>([out_r | Tail], Q, [], X) -&gt;
<a name="225"/>  225:     {empty, Q1} = queue:out_r(Q),
<a name="226"/>  226:     io(Tail, Q1, [], X);
<a name="227"/>  227: <b>io</b>([out_r | Tail], Q, QQ, X) -&gt;
<a name="228"/>  228:     {{value,H}, Q1} = queue:out_r(Q),
<a name="229"/>  229:     [H | T] = lists:reverse(QQ),
<a name="230"/>  230:     io(Tail, Q1, lists:reverse(T), X);
<a name="231"/>  231: <b>io</b>([cons | Tail], Q, QQ, X) -&gt;
<a name="232"/>  232:     io(Tail, queue:cons(X,Q), [X|QQ], X+1);
<a name="233"/>  233: <b>io</b>([snoc | Tail], Q, QQ, X) -&gt;
<a name="234"/>  234:     io(Tail, queue:snoc(Q,X), QQ++[X], X+1);
<a name="235"/>  235: <b>io</b>([in_r | Tail], Q, QQ, X) -&gt;
<a name="236"/>  236:     io(Tail, queue:in_r(X,Q), [X|QQ], X+1);
<a name="237"/>  237: <b>io</b>([in | Tail], Q, QQ, X) -&gt;
<a name="238"/>  238:     io(Tail, queue:in(X,Q), QQ++[X], X+1);
<a name="239"/>  239: <b>io</b>([peek | Tail], Q, [], X) -&gt;
<a name="240"/>  240:     empty = queue:peek(Q),
<a name="241"/>  241:     io(Tail, Q, [], X);
<a name="242"/>  242: <b>io</b>([peek | Tail], Q, [H|_]=Q0, X) -&gt;
<a name="243"/>  243:     {value,H} = queue:peek(Q),
<a name="244"/>  244:     io(Tail, Q, Q0, X);
<a name="245"/>  245: <b>io</b>([peek_r | Tail], Q, [], X) -&gt;
<a name="246"/>  246:     empty = queue:peek_r(Q),
<a name="247"/>  247:     io(Tail, Q, [], X);
<a name="248"/>  248: <b>io</b>([peek_r | Tail], Q, Q0, X) -&gt;
<a name="249"/>  249:     E = lists:last(Q0),
<a name="250"/>  250:     {value,E} = queue:peek_r(Q),
<a name="251"/>  251:     io(Tail, Q, Q0, X);
<a name="252"/>  252: <b>io</b>([drop | Tail], Q, [], X) -&gt;
<a name="253"/>  253:     try queue:drop(Q) of
<a name="254"/>  254: 	V -&gt;
<a name="255"/>  255: 	    ct:fail({?MODULE,?LINE,V})
<a name="256"/>  256:     catch
<a name="257"/>  257: 	error:empty -&gt;
<a name="258"/>  258: 	    io(Tail, Q, [], X)
<a name="259"/>  259:     end;
<a name="260"/>  260: <b>io</b>([drop | Tail], Q, [_ | T], X) -&gt;
<a name="261"/>  261:     Q1 = queue:drop(Q),
<a name="262"/>  262:     io(Tail, Q1, T, X);
<a name="263"/>  263: <b>io</b>([drop_r | Tail], Q, [], X) -&gt;
<a name="264"/>  264:     try queue:drop_r(Q) of
<a name="265"/>  265: 	V -&gt;
<a name="266"/>  266: 	    ct:fail({?MODULE,?LINE,V})
<a name="267"/>  267:     catch
<a name="268"/>  268: 	error:empty -&gt;
<a name="269"/>  269: 	    io(Tail, Q, [], X)
<a name="270"/>  270:     end;
<a name="271"/>  271: <b>io</b>([drop_r | Tail], Q, L, X) -&gt;
<a name="272"/>  272:     io:format(&quot;~p~n&quot;, [{drop_r,Tail,Q,L,X}]),
<a name="273"/>  273:     Q1 = queue:drop_r(Q),
<a name="274"/>  274:     [_ | T] = lists:reverse(L),
<a name="275"/>  275:     io:format(&quot;~p~n&quot;, [{drop_r,Q1,T}]),
<a name="276"/>  276:     io(Tail, Q1, lists:reverse(T), X);
<a name="277"/>  277: <b>io</b>([], Q, QQ, _X) -&gt;
<a name="278"/>  278:     QQ = queue:to_list(Q),
<a name="279"/>  279:     Length = length(QQ),
<a name="280"/>  280:     Length = queue:len(Q),
<a name="io-last_expr"/><a name="281"/>  281:     QQ.
<a name="282"/>  282: 
<a name="283"/>  283: 
<a name="284"/>  284: <i>%% Test operations on whole queues.</i>
<a name="op_test-1"/><a name="285"/>  285: <b>op_test</b>(Config) when is_list(Config) -&gt;
<a name="286"/>  286:     do_op_test(fun id/1),
<a name="op_test-last_expr"/><a name="287"/>  287:     ok.
<a name="288"/>  288: 
<a name="do_op_test-1"/><a name="289"/>  289: <b>do_op_test</b>(F) -&gt;
<a name="290"/>  290:     Len = 50,
<a name="291"/>  291:     Len2 = 2*Len,
<a name="292"/>  292:     L1 = lists:seq(1, Len),
<a name="293"/>  293:     L1r = lists:reverse(L1),
<a name="294"/>  294:     L2 = lists:seq(Len+1, Len2),
<a name="295"/>  295:     L2r = lists:reverse(L2),
<a name="296"/>  296:     L3 = L1++L2,
<a name="297"/>  297:     L3r = L2r++L1r,
<a name="298"/>  298:     Q0 = F(queue:new()),
<a name="299"/>  299:     [] = queue:to_list(Q0),
<a name="300"/>  300:     Q0 = F(queue:from_list([])),
<a name="301"/>  301:     Q1 = F(queue:from_list(L1)),
<a name="302"/>  302:     Q2 = F(queue:from_list(L2)),
<a name="303"/>  303:     Q3 = F(queue:from_list(L3)),
<a name="304"/>  304:     Len = queue:len(Q1),
<a name="305"/>  305:     Len = queue:len(Q2),
<a name="306"/>  306:     Len2 = queue:len(Q3),
<a name="307"/>  307:     L1 = queue:to_list(Q1),
<a name="308"/>  308:     L2 = queue:to_list(Q2),
<a name="309"/>  309:     L3 = queue:to_list(Q3),
<a name="310"/>  310:     Q3b = queue:join(Q0, queue:join(queue:join(Q1, Q2), Q0)),
<a name="311"/>  311:     L3 = queue:to_list(Q3b),
<a name="312"/>  312:     {Q0, Q3New1} = queue:split(0, Q3),
<a name="313"/>  313:     L3 = queue:to_list(Q3New1),
<a name="314"/>  314:     {Q3New2, Q0} = queue:split(Len2, Q3),
<a name="315"/>  315:     L3 = queue:to_list(Q3New2),
<a name="316"/>  316:     {Q1a, Q2a} = queue:split(Len, Q3),
<a name="317"/>  317:     L1 = queue:to_list(Q1a),
<a name="318"/>  318:     L2 = queue:to_list(Q2a),
<a name="319"/>  319:     {Q3c, Q3d} = queue:split(2, Q3),
<a name="320"/>  320:     L3 = queue:to_list(Q3c) ++ queue:to_list(Q3d),
<a name="321"/>  321:     {Q1b, Q2b} = queue:split(Len, Q3b),
<a name="322"/>  322:     L1 = queue:to_list(Q1b),
<a name="323"/>  323:     L2 = queue:to_list(Q2b),
<a name="324"/>  324:     Len = queue:len(Q1b),
<a name="325"/>  325:     Len = queue:len(Q2b),
<a name="326"/>  326:     Len2 = queue:len(Q3b),
<a name="327"/>  327:     Q1r = queue:reverse(Q1),
<a name="328"/>  328:     Q2r = queue:reverse(Q2),
<a name="329"/>  329:     Q1ar = queue:reverse(Q1a),
<a name="330"/>  330:     Q2ar = queue:reverse(Q2a),
<a name="331"/>  331:     Q1br = queue:reverse(Q1b),
<a name="332"/>  332:     Q2br = queue:reverse(Q2b),
<a name="333"/>  333:     Q3br = queue:reverse(Q3b),
<a name="334"/>  334:     L1r = queue:to_list(Q1r),
<a name="335"/>  335:     L1r = queue:to_list(Q1ar),
<a name="336"/>  336:     L1r = queue:to_list(Q1br),
<a name="337"/>  337:     L2r = queue:to_list(Q2r),
<a name="338"/>  338:     L2r = queue:to_list(Q2ar),
<a name="339"/>  339:     L2r = queue:to_list(Q2br),
<a name="340"/>  340:     L3r = queue:to_list(Q3br),
<a name="341"/>  341:     Len = queue:len(Q1br),
<a name="342"/>  342:     Len = queue:len(Q2br),
<a name="343"/>  343:     Len2 = queue:len(Q3br),
<a name="344"/>  344:     false = queue:member([], Q0),
<a name="345"/>  345:     false = queue:member(0, Q0),
<a name="346"/>  346:     false = queue:member(0, Q1),
<a name="347"/>  347:     false = queue:member([], Q1),
<a name="348"/>  348:     true = queue:member(1, Q1),
<a name="349"/>  349:     false = queue:member(1.0, Q1),
<a name="350"/>  350:     true = queue:member(Len, Q1),
<a name="351"/>  351:     %%
<a name="352"/>  352:     %% Additional coverage.
<a name="353"/>  353:     {MyL1r,MyL2r} = lists:split(Len-2, L1r),
<a name="354"/>  354:     MyQ0r = queue:reverse(F(queue:from_list(L1))),
<a name="355"/>  355:     {MyQ1r,MyQ2r} = queue:split(Len-2, MyQ0r),
<a name="356"/>  356:     MyL1r = queue:to_list(MyQ1r),
<a name="357"/>  357:     MyL2r = queue:to_list(MyQ2r),
<a name="358"/>  358:     MyQ3r = queue:filter(
<a name="359"/>  359: 	      fun (X) when X rem 4 &gt;= 2 -&gt; false;
<a name="360"/>  360: 		  (X) when X rem 8 == 0 -&gt; [float(X),{X}];
<a name="361"/>  361: 		  (X) when X rem 2 &gt;= 1 -&gt; [{X}];
<a name="362"/>  362: 		  (_)                   -&gt; true
<a name="363"/>  363: 	      end, MyQ1r),
<a name="364"/>  364:     MyL3r = lists:flatten(
<a name="365"/>  365: 	      [if X rem 8 == 0 -&gt; [float(X),{X}];
<a name="366"/>  366: 		  X rem 2 &gt;= 1 -&gt; {X};
<a name="367"/>  367: 		  true         -&gt; X
<a name="368"/>  368: 	       end || X &lt;- MyL1r,
<a name="369"/>  369: 		      X rem 4 &lt; 2]),
<a name="370"/>  370:     MyL3r = queue:to_list(MyQ3r),
<a name="371"/>  371:     MyQ4 = F(queue:from_list([11,22,33,44])),
<a name="372"/>  372:     [11,22] = queue:to_list(queue:filter(fun(X) when X &lt; 27 -&gt; true;
<a name="373"/>  373: 					    (_) -&gt; [] end, MyQ4)),
<a name="374"/>  374:     [33,44] = queue:to_list(queue:filter(fun(X) when X &lt; 27 -&gt; false;
<a name="375"/>  375: 					    (X) -&gt; [X] end, MyQ4)),
<a name="376"/>  376:     [11,22*22,33*33] = queue:to_list(queue:filtermap(fun(X) when X &lt; 17 -&gt; true;
<a name="377"/>  377: 							(X) when X &gt; 37 -&gt; false;
<a name="378"/>  378: 							(X) -&gt; {true, X*X}
<a name="379"/>  379: 						     end, MyQ4)),
<a name="380"/>  380:     [22*22,33*33,44] = queue:to_list(queue:filtermap(fun(X) when X &lt; 17 -&gt; false;
<a name="381"/>  381: 							(X) when X &gt; 37 -&gt; true;
<a name="382"/>  382: 							(X) -&gt; {true, X*X}
<a name="383"/>  383: 						     end, MyQ4)),
<a name="384"/>  384:     FoldQ = queue:from_list(L1),
<a name="385"/>  385:     FoldExp1 = lists:sum(L1),
<a name="386"/>  386:     FoldAct1 = queue:fold(fun(X,A) -&gt; X+A end, 0, FoldQ),
<a name="387"/>  387:     FoldExp1 = FoldAct1,
<a name="388"/>  388:     FoldExp2 = [X*X || X &lt;- L1],
<a name="389"/>  389:     FoldAct2 = queue:fold(fun(X,A) -&gt; [X*X|A] end, [], FoldQ),
<a name="390"/>  390:     FoldExp2 = lists:reverse(FoldAct2),
<a name="391"/>  391:     false = queue:any(fun(X) -&gt; X&gt;9 end, queue:from_list([])),
<a name="392"/>  392:     AnyQ = queue:from_list([1,2,3]),
<a name="393"/>  393:     true = queue:any(fun(X) -&gt; X&gt;1 end, AnyQ),
<a name="394"/>  394:     false = queue:any(fun(X) -&gt; X&lt;1 end, AnyQ),
<a name="395"/>  395:     true = queue:any(fun(X) -&gt; X&lt;3 end, AnyQ),
<a name="396"/>  396:     false = queue:any(fun(X) -&gt; X&gt;3 end, AnyQ),
<a name="397"/>  397:     true = queue:all(fun(X) -&gt; X&gt;9 end, queue:from_list([])),
<a name="398"/>  398:     AllQ = queue:from_list([1,2,3]),
<a name="399"/>  399:     true = queue:all(fun(X) -&gt; X&gt;=1 end, AllQ),
<a name="400"/>  400:     false = queue:all(fun(X) -&gt; X&gt;1 end, AllQ),
<a name="401"/>  401:     true = queue:all(fun(X) -&gt; X=&lt;3 end, AllQ),
<a name="402"/>  402:     false = queue:all(fun(X) -&gt; X&lt;3 end, AllQ),
<a name="403"/>  403:     [] = queue:to_list(queue:delete(x, queue:new())),
<a name="404"/>  404:     [1,2,3] = queue:to_list(queue:delete(x, queue:from_list([1,2,3]))),
<a name="405"/>  405:     [2,3] = queue:to_list(queue:delete(x, queue:from_list([x,2,3]))),
<a name="406"/>  406:     [1,3] = queue:to_list(queue:delete(x, queue:from_list([1,x,3]))),
<a name="407"/>  407:     [1,2] = queue:to_list(queue:delete(x, queue:from_list([1,2,x]))),
<a name="408"/>  408:     [1,2,x] = queue:to_list(queue:delete(x, queue:from_list([x,1,2,x]))),
<a name="409"/>  409:     [] = queue:to_list(queue:delete_r(x, queue:new())),
<a name="410"/>  410:     [1,2,3] = queue:to_list(queue:delete_r(x, queue:from_list([1,2,3]))),
<a name="411"/>  411:     [2,3] = queue:to_list(queue:delete_r(x, queue:from_list([x,2,3]))),
<a name="412"/>  412:     [1,3] = queue:to_list(queue:delete_r(x, queue:from_list([1,x,3]))),
<a name="413"/>  413:     [1,2] = queue:to_list(queue:delete_r(x, queue:from_list([1,2,x]))),
<a name="414"/>  414:     [x,1,2] = queue:to_list(queue:delete_r(x, queue:from_list([x,1,2,x]))),
<a name="415"/>  415:     [] = queue:to_list(queue:delete_with(fun(_) -&gt; false end, queue:new())),
<a name="416"/>  416:     [1,2,3] = queue:to_list(queue:delete_with(fun(X) -&gt; X&lt;0 end, queue:from_list([1,2,3]))),
<a name="417"/>  417:     [2,3] = queue:to_list(queue:delete_with(fun(X) -&gt; X&gt;0 end, queue:from_list([1,2,3]))),
<a name="418"/>  418:     [1,3] = queue:to_list(queue:delete_with(fun(X) -&gt; X&gt;1 end, queue:from_list([1,2,3]))),
<a name="419"/>  419:     [1,2] = queue:to_list(queue:delete_with(fun(X) -&gt; X&gt;2 end, queue:from_list([1,2,3]))),
<a name="420"/>  420:     [1,2,3] = queue:to_list(queue:delete_with(fun(X) -&gt; X&gt;1 end, queue:from_list([1,2,2,3]))),
<a name="421"/>  421:     [] = queue:to_list(queue:delete_with_r(fun(_) -&gt; false end, queue:new())),
<a name="422"/>  422:     [1,2,3] = queue:to_list(queue:delete_with_r(fun(X) -&gt; X&gt;9 end, queue:from_list([1,2,3]))),
<a name="423"/>  423:     [1,2] = queue:to_list(queue:delete_with_r(fun(X) -&gt; X&lt;9 end, queue:from_list([1,2,3]))),
<a name="424"/>  424:     [1,3] = queue:to_list(queue:delete_with_r(fun(X) -&gt; X&lt;3 end, queue:from_list([1,2,3]))),
<a name="425"/>  425:     [2,3] = queue:to_list(queue:delete_with_r(fun(X) -&gt; X&lt;2 end, queue:from_list([1,2,3]))),
<a name="426"/>  426:     [1,2,3] = queue:to_list(queue:delete_with_r(fun(X) -&gt; X&lt;3 end, queue:from_list([1,2,2,3]))),
<a name="427"/>  427:     %%
<a name="do_op_test-last_expr"/><a name="428"/>  428:     ok.
<a name="429"/>  429: 
<a name="430"/>  430: <i>%% Test queue errors.</i>
<a name="error-1"/><a name="431"/>  431: <b>error</b>(Config) when is_list(Config) -&gt;
<a name="432"/>  432:     do_error(fun id/1, illegal_queue),
<a name="433"/>  433:     do_error(fun id/1, {[],illegal_queue}),
<a name="434"/>  434:     do_error(fun id/1, {illegal_queue,[17]}),
<a name="error-last_expr"/><a name="435"/>  435:     ok.
<a name="436"/>  436: 
<a name="trycatch-2"/><a name="437"/>  437: <b>trycatch</b>(F, Args) -&gt;
<a name="trycatch-last_expr"/><a name="438"/>  438: <b>    trycatch</b>(queue, F, Args).
<a name="439"/>  439: 
<a name="trycatch-3"/><a name="440"/>  440: <b>trycatch</b>(M, F, Args) -&gt;
<a name="trycatch-last_expr"/><a name="441"/>  441: <b>    try apply</b>(M, F, Args) of
<a name="442"/>  442: 	V -&gt; {value,V}
<a name="443"/>  443:     catch
<a name="444"/>  444: 	C:R -&gt; {C,R}
<a name="445"/>  445:     end.
<a name="446"/>  446: 
<a name="do_error-2"/><a name="447"/>  447: <b>do_error</b>(F, IQ) -&gt;
<a name="448"/>  448:     io:format(&quot;Illegal Queue: ~p~n&quot;, [IQ]),
<a name="449"/>  449:     %%
<a name="450"/>  450:     {error,badarg} = trycatch(in, [1, IQ]),
<a name="451"/>  451:     {error,badarg} = trycatch(out, [IQ]),
<a name="452"/>  452:     {error,badarg} = trycatch(in_r ,[1, IQ]),
<a name="453"/>  453:     {error,badarg} = trycatch(out_r ,[IQ]),
<a name="454"/>  454:     {error,badarg} = trycatch(to_list ,[IQ]),
<a name="455"/>  455:     %%
<a name="456"/>  456:     {error,badarg} = trycatch(from_list, [no_list]),
<a name="457"/>  457:     {error,badarg} = trycatch(is_empty, [IQ]),
<a name="458"/>  458:     {error,badarg} = trycatch(len, [IQ]),
<a name="459"/>  459:     %%
<a name="460"/>  460:     {error,badarg} = trycatch(cons, [1, IQ]),
<a name="461"/>  461:     {error,badarg} = trycatch(head, [IQ]),
<a name="462"/>  462:     {error,badarg} = trycatch(tail, [IQ]),
<a name="463"/>  463:     %%
<a name="464"/>  464:     {error,badarg} = trycatch(snoc, [IQ, 1]),
<a name="465"/>  465:     {error,badarg} = trycatch(last, [IQ]),
<a name="466"/>  466:     {error,badarg} = trycatch(daeh, [IQ]),
<a name="467"/>  467:     {error,badarg} = trycatch(liat, [IQ]),
<a name="468"/>  468:     {error,badarg} = trycatch(lait, [IQ]),
<a name="469"/>  469:     {error,badarg} = trycatch(init, [IQ]),
<a name="470"/>  470:     %%
<a name="471"/>  471:     {error,badarg} = trycatch(reverse, [IQ]),
<a name="472"/>  472:     {error,badarg} = trycatch(join, [F(queue:new()), IQ]),
<a name="473"/>  473:     {error,badarg} = trycatch(join, [IQ, F(queue:new())]),
<a name="474"/>  474:     {error,badarg} = trycatch(split, [17, IQ]),
<a name="475"/>  475:     {error,badarg} = trycatch(head, [IQ]),
<a name="476"/>  476:     %%
<a name="477"/>  477:     Q0 = F(queue:new()),
<a name="478"/>  478:     {error,badarg} = trycatch(split, [1, Q0]),
<a name="479"/>  479:     {error,badarg} = trycatch(split, [2, queue:snoc(Q0, 1)]),
<a name="480"/>  480:     %%
<a name="481"/>  481:     {value,false}  = trycatch(is_queue, [IQ]),
<a name="482"/>  482:     {error,badarg} = trycatch(get, [IQ]),
<a name="483"/>  483:     {error,badarg} = trycatch(peek, [IQ]),
<a name="484"/>  484:     {error,badarg} = trycatch(peek_r, [IQ]),
<a name="485"/>  485:     {error,badarg} = trycatch(filter, [fun id/1, IQ]),
<a name="486"/>  486:     {error,badarg} = trycatch(filter, [no_fun, Q0]),
<a name="487"/>  487:     %%
<a name="488"/>  488:     {error,badarg} = trycatch(member, [1, IQ]),
<a name="do_error-last_expr"/><a name="489"/>  489:     ok.
<a name="490"/>  490: 
<a name="id-1"/><a name="491"/>  491: <b>id</b>(X) -&gt;
<a name="id-last_expr"/><a name="492"/>  492:     X.
<a name="493"/>  493: 
<a name="494"/>  494: <i>%% Test queue errors.</i>
<a name="oops-1"/><a name="495"/>  495: <b>oops</b>(Config) when is_list(Config) -&gt;
<a name="496"/>  496:     N = 3142,
<a name="497"/>  497:     Optab = optab(),
<a name="498"/>  498:     Seed0 = rand:seed(exsplus, {1,2,4}),
<a name="499"/>  499:     {Is,Seed} = random_list(N, tuple_size(Optab), Seed0, []),
<a name="500"/>  500:     io:format(&quot;~p &quot;, [Is]),
<a name="501"/>  501:     QA = queue:new(),
<a name="502"/>  502:     QB = {[]},
<a name="oops-last_expr"/><a name="503"/>  503: <b>    emul</b>([QA], [QB], Seed, [element(I, Optab) || I &lt;- Is]).
<a name="504"/>  504: 
<a name="optab-0"/><a name="505"/>  505: <b>optab</b>() -&gt;
<a name="optab-last_expr"/><a name="506"/>  506: <b>    {{new,[],        q,     fun </b>()     -&gt; {[]} end},
<a name="507"/>  507:      {is_queue,[q],  v,     fun (_)    -&gt; true end},
<a name="508"/>  508:      {is_empty,[q],  v,     fun (Q) -&gt; 
<a name="509"/>  509: 				    case Q of 
<a name="510"/>  510: 					{[]} -&gt; true;
<a name="511"/>  511: 					_    -&gt; false
<a name="512"/>  512: 				    end end},
<a name="513"/>  513:      {len,[q],       v,     fun ({L})   -&gt; length(L) end},
<a name="514"/>  514:      {to_list,[q],   v,     fun ({L})   -&gt; L end},
<a name="515"/>  515:      {from_list,[l], q,     fun (L)     -&gt; {L} end},
<a name="516"/>  516:      {in,[t,q],      q,     fun (X,{L}) -&gt; {L++[X]} end},
<a name="517"/>  517:      {in_r,[t,q],    q,     fun (X,{L}) -&gt; {[X|L]} end},
<a name="518"/>  518:      {out,[q],       {v,q}, fun ({L}=Q) -&gt;
<a name="519"/>  519: 				    case L of
<a name="520"/>  520: 					[]    -&gt; {empty,Q};
<a name="521"/>  521: 					[X|T] -&gt; {{value,X},{T}}
<a name="522"/>  522: 				    end
<a name="523"/>  523: 			    end},
<a name="524"/>  524:      {out_r,[q],     {v,q}, fun ({L}=Q) -&gt;
<a name="525"/>  525: 				    case L of
<a name="526"/>  526: 					[]    -&gt; {empty,Q};
<a name="527"/>  527: 					_ -&gt; 
<a name="528"/>  528: 					    [X|R] = lists:reverse(L),
<a name="529"/>  529: 					    T = lists:reverse(R),
<a name="530"/>  530: 					    {{value,X},{T}}
<a name="531"/>  531: 				    end
<a name="532"/>  532: 			    end},
<a name="533"/>  533:      {get,[q],       v,     fun ({[]})    -&gt; erlang:error(empty);
<a name="534"/>  534: 				({[H|_]}) -&gt; H
<a name="535"/>  535: 			    end},
<a name="536"/>  536:      {get_r,[q],     v,     fun ({[]})    -&gt; erlang:error(empty);
<a name="537"/>  537: 				({L})     -&gt; lists:last(L)
<a name="538"/>  538: 			    end},
<a name="539"/>  539:      {peek,[q],      v,     fun ({[]})    -&gt; empty;
<a name="540"/>  540: 				({[H|_]}) -&gt; {value,H}
<a name="541"/>  541: 			    end},
<a name="542"/>  542:      {peek_r,[q],    v,     fun ({[]})    -&gt; empty;
<a name="543"/>  543: 				({L})     -&gt; {value,lists:last(L)}
<a name="544"/>  544: 			    end},
<a name="545"/>  545:      {drop,[q],      q,     fun ({[]})    -&gt; erlang:error(empty);
<a name="546"/>  546: 				({[_|T]}) -&gt; {T}
<a name="547"/>  547: 			    end},
<a name="548"/>  548:      {drop_r,[q],    q,     fun ({[]})    -&gt; erlang:error(empty);
<a name="549"/>  549: 				({L})     -&gt; [_|R] = lists:reverse(L),
<a name="550"/>  550: 					     {lists:reverse(R)}
<a name="551"/>  551: 			    end},
<a name="552"/>  552:      {reverse,[q],   q,     fun ({L})     -&gt; {lists:reverse(L)} end},
<a name="553"/>  553:      {join,[q,q],    q,     fun ({L1}, {L2}) -&gt; {L1++L2} end},
<a name="554"/>  554:      {split,[n,q],   {q,q}, fun (N, {L})  -&gt; {L1,L2} = lists:split(N, L),
<a name="555"/>  555: 					     {{L1},{L2}} end},
<a name="556"/>  556:      {member,[t,q],  v,     fun (X, {L})  -&gt; lists:member(X, L) end}
<a name="557"/>  557:     }.
<a name="558"/>  558: 
<a name="emul-4"/><a name="559"/>  559: <b>emul</b>(_, _, _, []) -&gt;
<a name="560"/>  560:     ok;
<a name="561"/>  561: <b>emul</b>(QsA0, QsB0, Seed0, [{Op,Ts,S,Fun}|Ops]) -&gt;
<a name="562"/>  562:     {AsA,Seed} = args(Ts, QsA0, Seed0, []),
<a name="563"/>  563:     {AsB,Seed} = args(Ts, QsB0, Seed0, []),
<a name="564"/>  564:     io:format(&quot;~n% ~w % ~p &quot;, [Op,AsA]),
<a name="565"/>  565:     io:format(&quot;% ~p :&quot;, [AsB]),
<a name="566"/>  566:     XX = call({queue,Op}, AsA),
<a name="567"/>  567:     YY = call(Fun, AsB),
<a name="emul-last_expr"/><a name="568"/>  568:     case {XX,YY} of
<a name="569"/>  569: 	{{value,X},{value,Y}} -&gt;
<a name="570"/>  570: 	    {[Qa|_]=QsA,[{Lb}|_]=QsB} = chk(QsA0, QsB0, S, X, Y),
<a name="571"/>  571: 	    case queue:to_list(Qa) of
<a name="572"/>  572: 		Lb -&gt;
<a name="573"/>  573: 		    io:format(&quot;|~p| &quot;, [Lb]),
<a name="574"/>  574: 		    emul(QsA, QsB, Seed, Ops);
<a name="575"/>  575: 		La -&gt;
<a name="576"/>  576: 		    throw({to_list,[XX,YY,Op,AsA,AsB,La,Lb]})
<a name="577"/>  577: 	    end;
<a name="578"/>  578: 	{Exception,Exception} -&gt;
<a name="579"/>  579: 	    io:format(&quot;!~p! &quot;, [Exception]),
<a name="580"/>  580: 	    emul(QsA0, QsB0, Seed, Ops);
<a name="581"/>  581: 	_ -&gt;
<a name="582"/>  582: 	    throw({diff,[XX,YY,Op,AsA,AsB]})
<a name="583"/>  583:     end.
<a name="584"/>  584: 
<a name="args-4"/><a name="585"/>  585: <b>args</b>([], _, Seed, R) -&gt;
<a name="586"/>  586:     {lists:reverse(R),Seed};
<a name="587"/>  587: <b>args</b>([q|Ts], [Q|Qs]=Qss, Seed, R) -&gt;
<a name="588"/>  588:     args(Ts, if Qs =:= [] -&gt; Qss; true -&gt; Qs end, Seed, [Q|R]);
<a name="589"/>  589: <b>args</b>([l|Ts], Qs, Seed0, R) -&gt;
<a name="590"/>  590:     {N,Seed1} = rand:uniform_s(17, Seed0),
<a name="591"/>  591:     {L,Seed} = random_list(N, 4711, Seed1, []),
<a name="592"/>  592:     args(Ts, Qs, Seed, [L|R]);
<a name="593"/>  593: <b>args</b>([t|Ts], Qs, Seed0, R) -&gt;
<a name="594"/>  594:     {T,Seed} = rand:uniform_s(4711, Seed0),
<a name="595"/>  595:     args(Ts, Qs, Seed, [T|R]);
<a name="596"/>  596: <b>args</b>([n|Ts], Qs, Seed0, R) -&gt;
<a name="597"/>  597:     {N,Seed} = rand:uniform_s(17, Seed0),
<a name="args-last_expr"/><a name="598"/>  598: <b>    args</b>(Ts, Qs, Seed, [N|R]).
<a name="599"/>  599: 
<a name="random_list-4"/><a name="600"/>  600: <b>random_list</b>(0, _, Seed, R) -&gt;
<a name="601"/>  601:     {R,Seed};
<a name="602"/>  602: <b>random_list</b>(N, M, Seed0, R) -&gt;
<a name="603"/>  603:     {X,Seed} = rand:uniform_s(M, Seed0),
<a name="random_list-last_expr"/><a name="604"/>  604: <b>    random_list</b>(N-1, M, Seed, [X|R]).
<a name="605"/>  605: 
<a name="call-2"/><a name="606"/>  606: <b>call</b>(Func, As) -&gt;
<a name="call-last_expr"/><a name="607"/>  607:     try case Func of
<a name="608"/>  608: 	    {M,F} -&gt; apply(M, F, As);
<a name="609"/>  609: 	    _     -&gt; apply(Func, As)
<a name="610"/>  610: 	end of
<a name="611"/>  611: 	V -&gt;
<a name="612"/>  612: 	    {value,V}
<a name="613"/>  613:     catch
<a name="614"/>  614: 	Class:Reason -&gt;
<a name="615"/>  615: 	    {Class,Reason}
<a name="616"/>  616:     end.
<a name="617"/>  617: 
<a name="chk-5"/><a name="618"/>  618: <b>chk</b>(QsA, QsB, v, X, X) -&gt;
<a name="619"/>  619:     io:format(&quot;&lt;~p&gt; &quot;, [X]),
<a name="620"/>  620:     {QsA,QsB};
<a name="621"/>  621: <b>chk</b>(_, _, v, X, Y) -&gt;
<a name="622"/>  622:     throw({diff,v,[X,Y]});
<a name="623"/>  623: <b>chk</b>(QsA, QsB, q, Qa, {Lb}=Qb) -&gt;
<a name="624"/>  624:     case queue:to_list(Qa) of
<a name="625"/>  625: 	Lb -&gt; 
<a name="626"/>  626: 	    io:format(&quot;|~p| &quot;, [Lb]),
<a name="627"/>  627: 	    {[Qa|QsA],[Qb|QsB]};
<a name="628"/>  628: 	La -&gt;
<a name="629"/>  629: 	    throw({diff,q,[Qa,La,Lb]})
<a name="630"/>  630:     end;
<a name="631"/>  631: <b>chk</b>(QsA, QsB, T, X, Y)
<a name="632"/>  632:   when tuple_size(T) =:= tuple_size(X), tuple_size(T) =:= tuple_size(Y) -&gt;
<a name="633"/>  633:     io:format(&quot;{&quot;),
<a name="634"/>  634:     try
<a name="635"/>  635: 	chk_tuple(QsA, QsB, T, X, Y, 1)
<a name="636"/>  636:     after
<a name="637"/>  637: 	io:format(&quot;}&quot;)
<a name="638"/>  638:     end;
<a name="639"/>  639: <b>chk</b>(_, _, T, X, Y)
<a name="640"/>  640:   when is_tuple(T), is_tuple(X), is_tuple(Y) -&gt;
<a name="chk-last_expr"/><a name="641"/>  641: <b>    throw</b>({diff,T,[X,Y]}).
<a name="642"/>  642: 
<a name="chk_tuple-6"/><a name="643"/>  643: <b>chk_tuple</b>(QsA, QsB, T, _, _, N) when N &gt; tuple_size(T) -&gt;
<a name="644"/>  644:     {QsA,QsB};
<a name="645"/>  645: <b>chk_tuple</b>(QsA0, QsB0, T, X, Y, N) -&gt;
<a name="646"/>  646:     {QsA,QsB} = chk(QsA0, QsB0, element(N, T), element(N, X), element(N, Y)),
<a name="chk_tuple-last_expr"/><a name="647"/>  647: <b>    chk_tuple</b>(QsA, QsB, T, X, Y, N+1).
</pre>
<script>
var hash = window.location.hash.substring(1);
var anchor = document.getElementsByName(hash);
anchor[0].style.backgroundColor="orange";
</script>
</body>
</html>
