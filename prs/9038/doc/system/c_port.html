<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.34.1">
    <meta name="project" content="Erlang System Documentation v28.0-rc0">


    <title>Ports — Erlang System Documentation v28.0-rc0</title>
    <link rel="stylesheet" href="dist/html-erlang-APNLKZCW.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-4A143270.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-7XSQ4GTY.js"></script>
<style type="text/css">
  .monospace-font > code {
    font-family: monospace;
  }
</style>


  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Erlang System Documentation" />
        </a>

      <div>
        <a href="../index.html" class="sidebar-projectName" translate="no">
Erlang System Documentation
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v28.0-rc0
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Erlang System Documentation</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/erlang/otp/blob/dependabot/github_actions/github-actions-5a5a561238/system/doc/tutorial/c_port.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>


    <span>Ports</span>
  </h1>

<p>This section outlines an example of how to solve the example problem in the
<a href="example.html">previous section</a> by using a port.</p><p>The scenario is illustrated in the following figure:</p><pre><code class="mermaid">---
title: Port Communication
---
flowchart LR
    subgraph Legend
        direction LR

        os[OS Process]
        erl([Erlang Process])
    end

    subgraph ERTS
        direction LR

        port{Port} --&gt; erlProc
        erlProc([Connected process]) --&gt; port
    end

    port --&gt; proc[External Program]
    proc --&gt; port</code></pre><h2 id="erlang-program" class="section-heading">
  <a href="#erlang-program" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Erlang Program</span>
</h2>
<p>All communication between Erlang and C must be established by creating the port.
The Erlang process that creates a port is said to be <em>the connected process</em> of
the port. All communication to and from the port must go through the connected
process. If the connected process terminates, the port also terminates (and the
external program, if it is written properly).</p><p>The port is created using the BIF <a href="../../erts-15.1.2/doc/html/erlang.html#open_port/2"><code class="inline">open_port/2</code></a> with
<code class="inline">{spawn,ExtPrg}</code> as the first argument. The string <code class="inline">ExtPrg</code> is the name of the
external program, including any command line arguments. The second argument is a
list of options, in this case only <code class="inline">{packet,2}</code>. This option says that a 2 byte
length indicator is to be used to simplify the communication between C and
Erlang. The Erlang port automatically adds the length indicator, but this must
be done explicitly in the external C program.</p><p>The process is also set to trap exits, which enables detection of failure of the
external program:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="0242534578-1">(</span><span class="ss">complex1</span><span class="p" data-group-id="0242534578-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="0242534578-2">(</span><span class="p" data-group-id="0242534578-3">[</span><span class="ss">start</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">init</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="0242534578-3">]</span><span class="p" data-group-id="0242534578-2">)</span><span class="p">.</span><span class="w">

</span><span class="nf">start</span><span class="p" data-group-id="0242534578-4">(</span><span class="n">ExtPrg</span><span class="p" data-group-id="0242534578-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="nf">spawn</span><span class="p" data-group-id="0242534578-5">(</span><span class="o">?</span><span class="n">MODULE</span><span class="p">,</span><span class="w"> </span><span class="ss">init</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0242534578-6">[</span><span class="n">ExtPrg</span><span class="p" data-group-id="0242534578-6">]</span><span class="p" data-group-id="0242534578-5">)</span><span class="p">.</span><span class="w">

</span><span class="nf">init</span><span class="p" data-group-id="0242534578-7">(</span><span class="n">ExtPrg</span><span class="p" data-group-id="0242534578-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="nf">register</span><span class="p" data-group-id="0242534578-8">(</span><span class="ss">complex</span><span class="p">,</span><span class="w"> </span><span class="nf">self</span><span class="p" data-group-id="0242534578-9">(</span><span class="p" data-group-id="0242534578-9">)</span><span class="p" data-group-id="0242534578-8">)</span><span class="p">,</span><span class="w">
  </span><span class="nf">process_flag</span><span class="p" data-group-id="0242534578-10">(</span><span class="ss">trap_exit</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="0242534578-10">)</span><span class="p">,</span><span class="w">
  </span><span class="n">Port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">open_port</span><span class="p" data-group-id="0242534578-11">(</span><span class="p" data-group-id="0242534578-12">{</span><span class="nb">spawn</span><span class="p">,</span><span class="w"> </span><span class="n">ExtPrg</span><span class="p" data-group-id="0242534578-12">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0242534578-13">[</span><span class="p" data-group-id="0242534578-14">{</span><span class="ss">packet</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="0242534578-14">}</span><span class="p" data-group-id="0242534578-13">]</span><span class="p" data-group-id="0242534578-11">)</span><span class="p">,</span><span class="w">
  </span><span class="nf">loop</span><span class="p" data-group-id="0242534578-15">(</span><span class="n">Port</span><span class="p" data-group-id="0242534578-15">)</span><span class="p">.</span></code></pre><p>Now <code class="inline">complex1:foo/1</code> and <code class="inline">complex1:bar/1</code> can be implemented. Both send a
message to the <code class="inline">complex</code> process and receive the following replies:</p><pre><code class="makeup erlang" translate="no"><span class="nf">foo</span><span class="p" data-group-id="8481554127-1">(</span><span class="n">X</span><span class="p" data-group-id="8481554127-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="nf">call_port</span><span class="p" data-group-id="8481554127-2">(</span><span class="p" data-group-id="8481554127-3">{</span><span class="ss">foo</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p" data-group-id="8481554127-3">}</span><span class="p" data-group-id="8481554127-2">)</span><span class="p">.</span><span class="w">
</span><span class="nf">bar</span><span class="p" data-group-id="8481554127-4">(</span><span class="n">Y</span><span class="p" data-group-id="8481554127-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="nf">call_port</span><span class="p" data-group-id="8481554127-5">(</span><span class="p" data-group-id="8481554127-6">{</span><span class="ss">bar</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="8481554127-6">}</span><span class="p" data-group-id="8481554127-5">)</span><span class="p">.</span><span class="w">

</span><span class="nf">call_port</span><span class="p" data-group-id="8481554127-7">(</span><span class="n">Msg</span><span class="p" data-group-id="8481554127-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="ss">complex</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="8481554127-8">{</span><span class="ss">call</span><span class="p">,</span><span class="w"> </span><span class="nf">self</span><span class="p" data-group-id="8481554127-9">(</span><span class="p" data-group-id="8481554127-9">)</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p" data-group-id="8481554127-8">}</span><span class="p">,</span><span class="w">
  </span><span class="k">receive</span><span class="w">
    </span><span class="p" data-group-id="8481554127-10">{</span><span class="ss">complex</span><span class="p">,</span><span class="w"> </span><span class="n">Result</span><span class="p" data-group-id="8481554127-10">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
      </span><span class="n">Result</span><span class="w">
  </span><span class="k">end</span><span class="p">.</span></code></pre><p>The <code class="inline">complex</code> process does the following:</p><ul><li>Encodes the message into a sequence of bytes.</li><li>Sends it to the port.</li><li>Waits for a reply.</li><li>Decodes the reply.</li><li>Sends it back to the caller:</li></ul><pre><code class="makeup erlang" translate="no"><span class="nf">loop</span><span class="p" data-group-id="6725345467-1">(</span><span class="n">Port</span><span class="p" data-group-id="6725345467-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="k">receive</span><span class="w">
    </span><span class="p" data-group-id="6725345467-2">{</span><span class="ss">call</span><span class="p">,</span><span class="w"> </span><span class="n">Caller</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p" data-group-id="6725345467-2">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
      </span><span class="n">Port</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="6725345467-3">{</span><span class="nf">self</span><span class="p" data-group-id="6725345467-4">(</span><span class="p" data-group-id="6725345467-4">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6725345467-5">{</span><span class="ss">command</span><span class="p">,</span><span class="w"> </span><span class="nf">encode</span><span class="p" data-group-id="6725345467-6">(</span><span class="n">Msg</span><span class="p" data-group-id="6725345467-6">)</span><span class="p" data-group-id="6725345467-5">}</span><span class="p" data-group-id="6725345467-3">}</span><span class="p">,</span><span class="w">
      </span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="6725345467-7">{</span><span class="n">Port</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6725345467-8">{</span><span class="ss">data</span><span class="p">,</span><span class="w"> </span><span class="n">Data</span><span class="p" data-group-id="6725345467-8">}</span><span class="p" data-group-id="6725345467-7">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
          </span><span class="n">Caller</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="6725345467-9">{</span><span class="ss">complex</span><span class="p">,</span><span class="w"> </span><span class="nf">decode</span><span class="p" data-group-id="6725345467-10">(</span><span class="n">Data</span><span class="p" data-group-id="6725345467-10">)</span><span class="p" data-group-id="6725345467-9">}</span><span class="w">
      </span><span class="k">end</span><span class="p">,</span><span class="w">
      </span><span class="nf">loop</span><span class="p" data-group-id="6725345467-11">(</span><span class="n">Port</span><span class="p" data-group-id="6725345467-11">)</span><span class="w">
  </span><span class="k">end</span><span class="p">.</span></code></pre><p>Assuming that both the arguments and the results from the C functions are less
than 256, a simple encoding/decoding scheme is employed. In this scheme, <code class="inline">foo</code>
is represented by byte 1, <code class="inline">bar</code> is represented by 2, and the argument/result is
represented by a single byte as well:</p><pre><code class="makeup erlang" translate="no"><span class="nf">encode</span><span class="p" data-group-id="8802677428-1">(</span><span class="p" data-group-id="8802677428-2">{</span><span class="ss">foo</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p" data-group-id="8802677428-2">}</span><span class="p" data-group-id="8802677428-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="8802677428-3">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p" data-group-id="8802677428-3">]</span><span class="p">;</span><span class="w">
</span><span class="nf">encode</span><span class="p" data-group-id="8802677428-4">(</span><span class="p" data-group-id="8802677428-5">{</span><span class="ss">bar</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="8802677428-5">}</span><span class="p" data-group-id="8802677428-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="8802677428-6">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="8802677428-6">]</span><span class="p">.</span><span class="w">

</span><span class="nf">decode</span><span class="p" data-group-id="8802677428-7">(</span><span class="p" data-group-id="8802677428-8">[</span><span class="n">Int</span><span class="p" data-group-id="8802677428-8">]</span><span class="p" data-group-id="8802677428-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">Int</span><span class="p">.</span></code></pre><p>The resulting Erlang program, including functionality for stopping the port and
detecting port failures, is as follows:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="1812578471-1">(</span><span class="ss">complex1</span><span class="p" data-group-id="1812578471-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="1812578471-2">(</span><span class="p" data-group-id="1812578471-3">[</span><span class="ss">start</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">stop</span><span class="p">/</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="ss">init</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="1812578471-3">]</span><span class="p" data-group-id="1812578471-2">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="1812578471-4">(</span><span class="p" data-group-id="1812578471-5">[</span><span class="ss">foo</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">bar</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="1812578471-5">]</span><span class="p" data-group-id="1812578471-4">)</span><span class="p">.</span><span class="w">

</span><span class="nf">start</span><span class="p" data-group-id="1812578471-6">(</span><span class="n">ExtPrg</span><span class="p" data-group-id="1812578471-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">spawn</span><span class="p" data-group-id="1812578471-7">(</span><span class="o">?</span><span class="n">MODULE</span><span class="p">,</span><span class="w"> </span><span class="ss">init</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1812578471-8">[</span><span class="n">ExtPrg</span><span class="p" data-group-id="1812578471-8">]</span><span class="p" data-group-id="1812578471-7">)</span><span class="p">.</span><span class="w">
</span><span class="nf">stop</span><span class="p" data-group-id="1812578471-9">(</span><span class="p" data-group-id="1812578471-9">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="ss">complex</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="ss">stop</span><span class="p">.</span><span class="w">

</span><span class="nf">foo</span><span class="p" data-group-id="1812578471-10">(</span><span class="n">X</span><span class="p" data-group-id="1812578471-10">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">call_port</span><span class="p" data-group-id="1812578471-11">(</span><span class="p" data-group-id="1812578471-12">{</span><span class="ss">foo</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p" data-group-id="1812578471-12">}</span><span class="p" data-group-id="1812578471-11">)</span><span class="p">.</span><span class="w">
</span><span class="nf">bar</span><span class="p" data-group-id="1812578471-13">(</span><span class="n">Y</span><span class="p" data-group-id="1812578471-13">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">call_port</span><span class="p" data-group-id="1812578471-14">(</span><span class="p" data-group-id="1812578471-15">{</span><span class="ss">bar</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="1812578471-15">}</span><span class="p" data-group-id="1812578471-14">)</span><span class="p">.</span><span class="w">

</span><span class="nf">call_port</span><span class="p" data-group-id="1812578471-16">(</span><span class="n">Msg</span><span class="p" data-group-id="1812578471-16">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="ss">complex</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="1812578471-17">{</span><span class="ss">call</span><span class="p">,</span><span class="w"> </span><span class="nf">self</span><span class="p" data-group-id="1812578471-18">(</span><span class="p" data-group-id="1812578471-18">)</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p" data-group-id="1812578471-17">}</span><span class="p">,</span><span class="w">
    </span><span class="k">receive</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="1812578471-19">{</span><span class="ss">complex</span><span class="p">,</span><span class="w"> </span><span class="n">Result</span><span class="p" data-group-id="1812578471-19">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="n">Result</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">init</span><span class="p" data-group-id="1812578471-20">(</span><span class="n">ExtPrg</span><span class="p" data-group-id="1812578471-20">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">register</span><span class="p" data-group-id="1812578471-21">(</span><span class="ss">complex</span><span class="p">,</span><span class="w"> </span><span class="nf">self</span><span class="p" data-group-id="1812578471-22">(</span><span class="p" data-group-id="1812578471-22">)</span><span class="p" data-group-id="1812578471-21">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">process_flag</span><span class="p" data-group-id="1812578471-23">(</span><span class="ss">trap_exit</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="1812578471-23">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">open_port</span><span class="p" data-group-id="1812578471-24">(</span><span class="p" data-group-id="1812578471-25">{</span><span class="nb">spawn</span><span class="p">,</span><span class="w"> </span><span class="n">ExtPrg</span><span class="p" data-group-id="1812578471-25">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1812578471-26">[</span><span class="p" data-group-id="1812578471-27">{</span><span class="ss">packet</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="1812578471-27">}</span><span class="p" data-group-id="1812578471-26">]</span><span class="p" data-group-id="1812578471-24">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">loop</span><span class="p" data-group-id="1812578471-28">(</span><span class="n">Port</span><span class="p" data-group-id="1812578471-28">)</span><span class="p">.</span><span class="w">

</span><span class="nf">loop</span><span class="p" data-group-id="1812578471-29">(</span><span class="n">Port</span><span class="p" data-group-id="1812578471-29">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">receive</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="1812578471-30">{</span><span class="ss">call</span><span class="p">,</span><span class="w"> </span><span class="n">Caller</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p" data-group-id="1812578471-30">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="n">Port</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="1812578471-31">{</span><span class="nf">self</span><span class="p" data-group-id="1812578471-32">(</span><span class="p" data-group-id="1812578471-32">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1812578471-33">{</span><span class="ss">command</span><span class="p">,</span><span class="w"> </span><span class="nf">encode</span><span class="p" data-group-id="1812578471-34">(</span><span class="n">Msg</span><span class="p" data-group-id="1812578471-34">)</span><span class="p" data-group-id="1812578471-33">}</span><span class="p" data-group-id="1812578471-31">}</span><span class="p">,</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="k">receive</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="p" data-group-id="1812578471-35">{</span><span class="n">Port</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1812578471-36">{</span><span class="ss">data</span><span class="p">,</span><span class="w"> </span><span class="n">Data</span><span class="p" data-group-id="1812578471-36">}</span><span class="p" data-group-id="1812578471-35">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="w">    </span><span class="n">Caller</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="1812578471-37">{</span><span class="ss">complex</span><span class="p">,</span><span class="w"> </span><span class="nf">decode</span><span class="p" data-group-id="1812578471-38">(</span><span class="n">Data</span><span class="p" data-group-id="1812578471-38">)</span><span class="p" data-group-id="1812578471-37">}</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="k">end</span><span class="p">,</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="nf">loop</span><span class="p" data-group-id="1812578471-39">(</span><span class="n">Port</span><span class="p" data-group-id="1812578471-39">)</span><span class="p">;</span><span class="w">
</span><span class="err">	</span><span class="ss">stop</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="n">Port</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="1812578471-40">{</span><span class="nf">self</span><span class="p" data-group-id="1812578471-41">(</span><span class="p" data-group-id="1812578471-41">)</span><span class="p">,</span><span class="w"> </span><span class="ss">close</span><span class="p" data-group-id="1812578471-40">}</span><span class="p">,</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="k">receive</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="p" data-group-id="1812578471-42">{</span><span class="n">Port</span><span class="p">,</span><span class="w"> </span><span class="ss">closed</span><span class="p" data-group-id="1812578471-42">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="w">    </span><span class="nf">exit</span><span class="p" data-group-id="1812578471-43">(</span><span class="ss">normal</span><span class="p" data-group-id="1812578471-43">)</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="k">end</span><span class="p">;</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="1812578471-44">{</span><span class="ss">&#39;EXIT&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Port</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="1812578471-44">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="w">    </span><span class="nf">exit</span><span class="p" data-group-id="1812578471-45">(</span><span class="ss">port_terminated</span><span class="p" data-group-id="1812578471-45">)</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">encode</span><span class="p" data-group-id="1812578471-46">(</span><span class="p" data-group-id="1812578471-47">{</span><span class="ss">foo</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p" data-group-id="1812578471-47">}</span><span class="p" data-group-id="1812578471-46">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="1812578471-48">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p" data-group-id="1812578471-48">]</span><span class="p">;</span><span class="w">
</span><span class="nf">encode</span><span class="p" data-group-id="1812578471-49">(</span><span class="p" data-group-id="1812578471-50">{</span><span class="ss">bar</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="1812578471-50">}</span><span class="p" data-group-id="1812578471-49">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="1812578471-51">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="1812578471-51">]</span><span class="p">.</span><span class="w">

</span><span class="nf">decode</span><span class="p" data-group-id="1812578471-52">(</span><span class="p" data-group-id="1812578471-53">[</span><span class="n">Int</span><span class="p" data-group-id="1812578471-53">]</span><span class="p" data-group-id="1812578471-52">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">Int</span><span class="p">.</span></code></pre><h2 id="c-program" class="section-heading">
  <a href="#c-program" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">C Program</span>
</h2>
<p>On the C side, it is necessary to write functions for receiving and sending data
with 2 byte length indicators from/to Erlang. By default, the C program is to
read from standard input (file descriptor 0) and write to standard output (file
descriptor 1). Examples of such functions, <code class="inline">read_cmd/1</code> and <code class="inline">write_cmd/2</code>,
follows:</p><pre><code class="makeup c" translate="no"><span class="cm">/* erl_comm.c */</span><span class="w">

</span><span class="kp">#include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span><span class="w">
</span><span class="kp">#include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span><span class="w">

</span><span class="k">typedef</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="kt">byte</span><span class="p">;</span><span class="w">

</span><span class="kt">int</span><span class="w"> </span><span class="nf">read_exact</span><span class="p" data-group-id="4122428866-1">(</span><span class="kt">byte</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p" data-group-id="4122428866-1">)</span><span class="w">
</span><span class="p" data-group-id="4122428866-2">{</span><span class="w">
  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">got</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w">

  </span><span class="k">do</span><span class="w"> </span><span class="p" data-group-id="4122428866-3">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="p" data-group-id="4122428866-4">(</span><span class="p" data-group-id="4122428866-5">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read</span><span class="p" data-group-id="4122428866-6">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="o">+</span><span class="n">got</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="o">-</span><span class="n">got</span><span class="p" data-group-id="4122428866-6">)</span><span class="p" data-group-id="4122428866-5">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="4122428866-4">)</span><span class="p" data-group-id="4122428866-7">{</span><span class="w">
          </span><span class="nf">return</span><span class="p" data-group-id="4122428866-8">(</span><span class="n">i</span><span class="p" data-group-id="4122428866-8">)</span><span class="p">;</span><span class="w">
      </span><span class="p" data-group-id="4122428866-7">}</span><span class="w">
    </span><span class="n">got</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
  </span><span class="p" data-group-id="4122428866-3">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p" data-group-id="4122428866-9">(</span><span class="n">got</span><span class="o">&lt;</span><span class="n">len</span><span class="p" data-group-id="4122428866-9">)</span><span class="p">;</span><span class="w">

  </span><span class="nf">return</span><span class="p" data-group-id="4122428866-10">(</span><span class="n">len</span><span class="p" data-group-id="4122428866-10">)</span><span class="p">;</span><span class="w">
</span><span class="p" data-group-id="4122428866-2">}</span><span class="w">

</span><span class="kt">int</span><span class="w"> </span><span class="nf">write_exact</span><span class="p" data-group-id="4122428866-11">(</span><span class="kt">byte</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p" data-group-id="4122428866-11">)</span><span class="w">
</span><span class="p" data-group-id="4122428866-12">{</span><span class="w">
  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">wrote</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">

  </span><span class="k">do</span><span class="w"> </span><span class="p" data-group-id="4122428866-13">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p" data-group-id="4122428866-14">(</span><span class="p" data-group-id="4122428866-15">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">write</span><span class="p" data-group-id="4122428866-16">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="o">+</span><span class="n">wrote</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="o">-</span><span class="n">wrote</span><span class="p" data-group-id="4122428866-16">)</span><span class="p" data-group-id="4122428866-15">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="4122428866-14">)</span><span class="w">
      </span><span class="k">return</span><span class="w"> </span><span class="p" data-group-id="4122428866-17">(</span><span class="n">i</span><span class="p" data-group-id="4122428866-17">)</span><span class="p">;</span><span class="w">
    </span><span class="n">wrote</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
  </span><span class="p" data-group-id="4122428866-13">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p" data-group-id="4122428866-18">(</span><span class="n">wrote</span><span class="o">&lt;</span><span class="n">len</span><span class="p" data-group-id="4122428866-18">)</span><span class="p">;</span><span class="w">

  </span><span class="k">return</span><span class="w"> </span><span class="p" data-group-id="4122428866-19">(</span><span class="n">len</span><span class="p" data-group-id="4122428866-19">)</span><span class="p">;</span><span class="w">
</span><span class="p" data-group-id="4122428866-12">}</span><span class="w">

</span><span class="kt">int</span><span class="w"> </span><span class="nf">read_cmd</span><span class="p" data-group-id="4122428866-20">(</span><span class="kt">byte</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p" data-group-id="4122428866-20">)</span><span class="w">
</span><span class="p" data-group-id="4122428866-21">{</span><span class="w">
  </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p" data-group-id="4122428866-22">(</span><span class="nf">read_exact</span><span class="p" data-group-id="4122428866-23">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="4122428866-23">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="4122428866-22">)</span><span class="w">
    </span><span class="nf">return</span><span class="p" data-group-id="4122428866-24">(</span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="4122428866-24">)</span><span class="p">;</span><span class="w">
  </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4122428866-25">(</span><span class="n">buf</span><span class="p" data-group-id="4122428866-26">[</span><span class="mi">0</span><span class="p" data-group-id="4122428866-26">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="4122428866-25">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">buf</span><span class="p" data-group-id="4122428866-27">[</span><span class="mi">1</span><span class="p" data-group-id="4122428866-27">]</span><span class="p">;</span><span class="w">
  </span><span class="k">return</span><span class="w"> </span><span class="nf">read_exact</span><span class="p" data-group-id="4122428866-28">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p" data-group-id="4122428866-28">)</span><span class="p">;</span><span class="w">
</span><span class="p" data-group-id="4122428866-21">}</span><span class="w">

</span><span class="kt">int</span><span class="w"> </span><span class="nf">write_cmd</span><span class="p" data-group-id="4122428866-29">(</span><span class="kt">byte</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p" data-group-id="4122428866-29">)</span><span class="w">
</span><span class="p" data-group-id="4122428866-30">{</span><span class="w">
  </span><span class="kt">byte</span><span class="w"> </span><span class="n">li</span><span class="p">;</span><span class="w">

  </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4122428866-31">(</span><span class="n">len</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="4122428866-31">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">;</span><span class="w">
  </span><span class="nf">write_exact</span><span class="p" data-group-id="4122428866-32">(</span><span class="o">&amp;</span><span class="n">li</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4122428866-32">)</span><span class="p">;</span><span class="w">

  </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">;</span><span class="w">
  </span><span class="nf">write_exact</span><span class="p" data-group-id="4122428866-33">(</span><span class="o">&amp;</span><span class="n">li</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4122428866-33">)</span><span class="p">;</span><span class="w">

  </span><span class="k">return</span><span class="w"> </span><span class="nf">write_exact</span><span class="p" data-group-id="4122428866-34">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p" data-group-id="4122428866-34">)</span><span class="p">;</span><span class="w">
</span><span class="p" data-group-id="4122428866-30">}</span></code></pre><p>Notice that <code class="inline">stdin</code> and <code class="inline">stdout</code> are for buffered input/output and must <em>not</em> be
used for the communication with Erlang.</p><p>In the <code class="inline">main</code> function, the C program is to listen for a message from Erlang
and, according to the selected encoding/decoding scheme, use the first byte to
determine which function to call and the second byte as argument to the
function. The result of calling the function is then to be sent back to Erlang:</p><pre><code class="makeup c" translate="no"><span class="cm">/* port.c */</span><span class="w">

</span><span class="k">typedef</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="kt">byte</span><span class="p">;</span><span class="w">

</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p" data-group-id="4188738761-1">(</span><span class="p" data-group-id="4188738761-1">)</span><span class="w"> </span><span class="p" data-group-id="4188738761-2">{</span><span class="w">
  </span><span class="kt">int</span><span class="w"> </span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">;</span><span class="w">
  </span><span class="kt">byte</span><span class="w"> </span><span class="n">buf</span><span class="p" data-group-id="4188738761-3">[</span><span class="mi">100</span><span class="p" data-group-id="4188738761-3">]</span><span class="p">;</span><span class="w">

  </span><span class="k">while</span><span class="w"> </span><span class="p" data-group-id="4188738761-4">(</span><span class="nf">read_cmd</span><span class="p" data-group-id="4188738761-5">(</span><span class="n">buf</span><span class="p" data-group-id="4188738761-5">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="4188738761-4">)</span><span class="w"> </span><span class="p" data-group-id="4188738761-6">{</span><span class="w">
    </span><span class="n">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buf</span><span class="p" data-group-id="4188738761-7">[</span><span class="mi">0</span><span class="p" data-group-id="4188738761-7">]</span><span class="p">;</span><span class="w">
    </span><span class="n">arg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buf</span><span class="p" data-group-id="4188738761-8">[</span><span class="mi">1</span><span class="p" data-group-id="4188738761-8">]</span><span class="p">;</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p" data-group-id="4188738761-9">(</span><span class="n">fn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4188738761-9">)</span><span class="w"> </span><span class="p" data-group-id="4188738761-10">{</span><span class="w">
      </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">foo</span><span class="p" data-group-id="4188738761-11">(</span><span class="n">arg</span><span class="p" data-group-id="4188738761-11">)</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="4188738761-10">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p" data-group-id="4188738761-12">(</span><span class="n">fn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="4188738761-12">)</span><span class="w"> </span><span class="p" data-group-id="4188738761-13">{</span><span class="w">
      </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">bar</span><span class="p" data-group-id="4188738761-14">(</span><span class="n">arg</span><span class="p" data-group-id="4188738761-14">)</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="4188738761-13">}</span><span class="w">

    </span><span class="n">buf</span><span class="p" data-group-id="4188738761-15">[</span><span class="mi">0</span><span class="p" data-group-id="4188738761-15">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">res</span><span class="p">;</span><span class="w">
    </span><span class="nf">write_cmd</span><span class="p" data-group-id="4188738761-16">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4188738761-16">)</span><span class="p">;</span><span class="w">
  </span><span class="p" data-group-id="4188738761-6">}</span><span class="w">
</span><span class="p" data-group-id="4188738761-2">}</span></code></pre><p>Notice that the C program is in a <code class="inline">while</code>-loop, checking for the return value
of <code class="inline">read_cmd/1</code>. This is because the C program must detect when the port closes
and terminates.</p><h2 id="running-the-example" class="section-heading">
  <a href="#running-the-example" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Running the Example</span>
</h2>
<p><em>Step 1.</em> Compile the C code:</p><pre><code class="text">$ gcc -o extprg complex.c erl_comm.c port.c</code></pre><p><em>Step 2.</em> Start Erlang and compile the Erlang code:</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">erl</span><span class="w">
</span><span class="n">Erlang</span><span class="o">/</span><span class="n">OTP</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="p" data-group-id="9030501633-1">[</span><span class="ss">erts</span><span class="o">-</span><span class="mf">14.2</span><span class="p" data-group-id="9030501633-1">]</span><span class="w"> </span><span class="p" data-group-id="9030501633-2">[</span><span class="ss">source</span><span class="p" data-group-id="9030501633-2">]</span><span class="w"> </span><span class="p" data-group-id="9030501633-3">[</span><span class="mi">64</span><span class="o">-</span><span class="ss">bit</span><span class="p" data-group-id="9030501633-3">]</span><span class="w"> </span><span class="p" data-group-id="9030501633-4">[</span><span class="nc">smp</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="p" data-group-id="9030501633-4">]</span><span class="w"> </span><span class="p" data-group-id="9030501633-5">[</span><span class="nc">ds</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p" data-group-id="9030501633-5">]</span><span class="w"> </span><span class="p" data-group-id="9030501633-6">[</span><span class="ss">async</span><span class="o">-</span><span class="nc">threads</span><span class="p">:</span><span class="mi">1</span><span class="p" data-group-id="9030501633-6">]</span><span class="w"> </span><span class="p" data-group-id="9030501633-7">[</span><span class="nc">jit</span><span class="p">:</span><span class="ss">ns</span><span class="p" data-group-id="9030501633-7">]</span><span class="w">

</span><span class="n">Eshell</span><span class="w"> </span><span class="n">V14</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="p" data-group-id="9030501633-8">(</span><span class="ss">press</span><span class="w"> </span><span class="n">Ctrl</span><span class="o">+</span><span class="n">G</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">abort</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="w"> </span><span class="nf">help</span><span class="p" data-group-id="9030501633-9">(</span><span class="p" data-group-id="9030501633-9">)</span><span class="p">.</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">help</span><span class="p" data-group-id="9030501633-8">)</span><span class="gp unselectable">
1&gt; </span><span class="nf">c</span><span class="p" data-group-id="9030501633-10">(</span><span class="ss">complex1</span><span class="p" data-group-id="9030501633-10">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="9030501633-11">{</span><span class="ss">ok</span><span class="p">,</span><span class="ss">complex1</span><span class="p" data-group-id="9030501633-11">}</span></code></pre><p><em>Step 3.</em> Run the example:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">2&gt; </span><span class="nc">complex1</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="9935809711-1">(</span><span class="s">&quot;./extprg&quot;</span><span class="p" data-group-id="9935809711-1">)</span><span class="p">.</span><span class="w">
</span><span class="o">&lt;</span><span class="mf">0.34</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="gp unselectable">
3&gt; </span><span class="nc">complex1</span><span class="p">:</span><span class="nf">foo</span><span class="p" data-group-id="9935809711-2">(</span><span class="mi">3</span><span class="p" data-group-id="9935809711-2">)</span><span class="p">.</span><span class="w">
</span><span class="mi">4</span><span class="gp unselectable">
4&gt; </span><span class="nc">complex1</span><span class="p">:</span><span class="nf">bar</span><span class="p" data-group-id="9935809711-3">(</span><span class="mi">5</span><span class="p" data-group-id="9935809711-3">)</span><span class="p">.</span><span class="w">
</span><span class="mi">10</span><span class="gp unselectable">
5&gt; </span><span class="nc">complex1</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="9935809711-4">(</span><span class="p" data-group-id="9935809711-4">)</span><span class="p">.</span><span class="w">
</span><span class="ss">stop</span></code></pre>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="example.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Problem Example
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="erl_interface.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Erl_Interface
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="Erlang System Documentation.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.34.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2024 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
<script>
  function mermaidLoaded() {
    mermaid.initialize({
      startOnLoad: false,
      theme: document.body.className.includes("dark") ? "dark" : "default"
    });
    let id = 0;
    for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
        graphEl.innerHTML = svg;
        bindFunctions?.(graphEl);
        preEl.insertAdjacentElement("afterend", graphEl);
        preEl.remove();
      });
    }
  }
</script>
<script async src="https://cdn.jsdelivr.net/npm/mermaid@10.2.3/dist/mermaid.min.js" onload="mermaidLoaded();"></script>

  </body>
</html>
