<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/lib/ssl/make_test_dir/ssl_test/ssl_rfc_5869_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%%</i>
<a name="2"/>    2: <i>%% %CopyrightBegin%</i>
<a name="3"/>    3: <i>%%</i>
<a name="4"/>    4: <i>%% Copyright Ericsson AB 2018-2021. All Rights Reserved.</i>
<a name="5"/>    5: <i>%%</i>
<a name="6"/>    6: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="7"/>    7: <i>%% you may not use this file except in compliance with the License.</i>
<a name="8"/>    8: <i>%% You may obtain a copy of the License at</i>
<a name="9"/>    9: <i>%%</i>
<a name="10"/>   10: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="11"/>   11: <i>%%</i>
<a name="12"/>   12: <i>%% Unless required by applicable law or agreed to in writing, software</i>
<a name="13"/>   13: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="14"/>   14: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="15"/>   15: <i>%% See the License for the specific language governing permissions and</i>
<a name="16"/>   16: <i>%% limitations under the License.</i>
<a name="17"/>   17: <i>%%</i>
<a name="18"/>   18: <i>%% %CopyrightEnd%</i>
<a name="19"/>   19: <i>%%</i>
<a name="20"/>   20: 
<a name="21"/>   21: <i>%%</i>
<a name="22"/>   22: <b>-module</b>(ssl_rfc_5869_SUITE).
<a name="23"/>   23: 
<a name="24"/>   24: <b>-behaviour</b>(ct_suite).
<a name="25"/>   25: 
<a name="26"/>   26: <b>-include_lib</b>(&quot;common_test/include/ct.hrl&quot;).
<a name="27"/>   27: 
<a name="28"/>   28: <i>%% Common test</i>
<a name="29"/>   29: <b>-export</b>([all/0,
<a name="30"/>   30:          init_per_suite/1,
<a name="31"/>   31:          init_per_testcase/2,
<a name="32"/>   32:          end_per_suite/1,
<a name="33"/>   33:          end_per_testcase/2
<a name="34"/>   34:         ]).
<a name="35"/>   35: 
<a name="36"/>   36: <i>%% Test cases</i>
<a name="37"/>   37: <b>-export</b>([sha_256_basic/0,
<a name="38"/>   38:          sha_256_basic/1,
<a name="39"/>   39:          sha_256_long/0,
<a name="40"/>   40:          sha_256_long/1,
<a name="41"/>   41:          sha_256_no_salt/0,
<a name="42"/>   42:          sha_256_no_salt/1,
<a name="43"/>   43:          sha_basic/0,
<a name="44"/>   44:          sha_basic/1,
<a name="45"/>   45:          sha_long/0,
<a name="46"/>   46:          sha_long/1,
<a name="47"/>   47:          sha_no_salt/0,
<a name="48"/>   48:          sha_no_salt/1,
<a name="49"/>   49:          sha_default_salt/0,
<a name="50"/>   50:          sha_default_salt/1
<a name="51"/>   51:         ]).
<a name="52"/>   52: 
<a name="53"/>   53: <i>%%--------------------------------------------------------------------</i>
<a name="54"/>   54: <i>%% Common Test interface functions -----------------------------------</i>
<a name="55"/>   55: <i>%%--------------------------------------------------------------------</i>
<a name="all-0"/><a name="56"/>   56: <b>all</b>() -&gt; 
<a name="all-last_expr"/><a name="57"/>   57:     [sha_256_basic,
<a name="58"/>   58:      sha_256_long,
<a name="59"/>   59:      sha_256_no_salt,
<a name="60"/>   60:      sha_basic,
<a name="61"/>   61:      sha_long,
<a name="62"/>   62:      sha_no_salt,
<a name="63"/>   63:      sha_default_salt
<a name="64"/>   64:     ].
<a name="65"/>   65: 
<a name="66"/>   66: <i>%%--------------------------------------------------------------------</i>
<a name="init_per_suite-1"/><a name="67"/>   67: <b>init_per_suite</b>(Config) -&gt;
<a name="68"/>   68:     catch crypto:stop(),
<a name="init_per_suite-last_expr"/><a name="69"/>   69: <b>    try crypto:start</b>() of
<a name="70"/>   70: 	ok -&gt;
<a name="71"/>   71:             Config
<a name="72"/>   72:     catch _:_ -&gt;
<a name="73"/>   73: 	    {skip, &quot;Crypto did not start&quot;}
<a name="74"/>   74:     end.
<a name="75"/>   75: 
<a name="end_per_suite-1"/><a name="76"/>   76: <b>end_per_suite</b>(_Config) -&gt;
<a name="end_per_suite-last_expr"/><a name="77"/>   77: <b>    application:stop</b>(crypto).
<a name="78"/>   78: 
<a name="79"/>   79: <i>%%--------------------------------------------------------------------</i>
<a name="init_per_testcase-2"/><a name="80"/>   80: <b>init_per_testcase</b>(_TestCase, Config) -&gt;
<a name="81"/>   81:     ct:timetrap({seconds, 5}),
<a name="init_per_testcase-last_expr"/><a name="82"/>   82:     Config.
<a name="83"/>   83: 
<a name="end_per_testcase-2"/><a name="84"/>   84: <b>end_per_testcase</b>(_TestCase, Config) -&gt;
<a name="end_per_testcase-last_expr"/><a name="85"/>   85:     Config.
<a name="86"/>   86: 
<a name="87"/>   87: <i>%%--------------------------------------------------------------------</i>
<a name="88"/>   88: <i>%% Test Cases --------------------------------------------------------</i>
<a name="89"/>   89: <i>%%--------------------------------------------------------------------</i>
<a name="90"/>   90:   
<a name="sha_256_basic-0"/><a name="91"/>   91: <b>sha_256_basic</b>() -&gt;
<a name="sha_256_basic-last_expr"/><a name="92"/>   92:     [{doc, &quot;Basic test case with SHA-256&quot;}].
<a name="sha_256_basic-1"/><a name="93"/>   93: <b>sha_256_basic</b>(Config) when is_list(Config) -&gt;
<a name="94"/>   94:     %% Hash = SHA-256
<a name="95"/>   95:     %% IKM  = 0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b (22 octets)
<a name="96"/>   96:     %% salt = 0x000102030405060708090a0b0c (13 octets)
<a name="97"/>   97:     %% info = 0xf0f1f2f3f4f5f6f7f8f9 (10 octets)
<a name="98"/>   98:     %% L    = 42
<a name="99"/>   99:     %% PRK  = 0x077709362c2e32df0ddc3f0dc47bba63
<a name="100"/>  100:     %%        90b6c73bb50f9c3122ec844ad7c2b3e5 (32 octets)
<a name="101"/>  101:     %% OKM  = 0x3cb25f25faacd57a90434f64d0362f2a
<a name="102"/>  102:     %%        2d2d0a90cf1a5a4c5db02d56ecc4c5bf
<a name="103"/>  103:     %%        34007208d5b887185865 (42 octets)
<a name="104"/>  104:     IKM  = hexstr2bin(&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b&quot;),
<a name="105"/>  105:     Salt = hexstr2bin(&quot;000102030405060708090a0b0c&quot;),
<a name="106"/>  106:     Info = hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9&quot;),
<a name="107"/>  107:     PRK  = hexstr2bin(&quot;077709362c2e32df0ddc3f0dc47bba63&quot;
<a name="108"/>  108:                       &quot;90b6c73bb50f9c3122ec844ad7c2b3e5&quot;),
<a name="109"/>  109:     OKM  = hexstr2bin(&quot;3cb25f25faacd57a90434f64d0362f2a&quot;
<a name="110"/>  110:                       &quot;2d2d0a90cf1a5a4c5db02d56ecc4c5bf&quot;
<a name="111"/>  111:                       &quot;34007208d5b887185865&quot;),
<a name="sha_256_basic-last_expr"/><a name="112"/>  112: <b>    hkdf_test</b>(sha256, Salt, IKM, PRK, Info, 42, OKM).
<a name="113"/>  113: 
<a name="sha_256_long-0"/><a name="114"/>  114: <b>sha_256_long</b>() -&gt;
<a name="sha_256_long-last_expr"/><a name="115"/>  115:     [{doc, &quot;Test with SHA-256 and longer inputs/outputs&quot;}].
<a name="sha_256_long-1"/><a name="116"/>  116: <b>sha_256_long</b>(Config) when is_list(Config) -&gt;
<a name="117"/>  117:     %% Hash = SHA-256
<a name="118"/>  118:     %% IKM  = 0x000102030405060708090a0b0c0d0e0f
<a name="119"/>  119:     %%        101112131415161718191a1b1c1d1e1f
<a name="120"/>  120:     %%        202122232425262728292a2b2c2d2e2f
<a name="121"/>  121:     %%        303132333435363738393a3b3c3d3e3f
<a name="122"/>  122:     %%        404142434445464748494a4b4c4d4e4f (80 octets)
<a name="123"/>  123:     %% salt = 0x606162636465666768696a6b6c6d6e6f
<a name="124"/>  124:     %%        707172737475767778797a7b7c7d7e7f
<a name="125"/>  125:     %%        808182838485868788898a8b8c8d8e8f
<a name="126"/>  126:     %%        909192939495969798999a9b9c9d9e9f
<a name="127"/>  127:     %%        a0a1a2a3a4a5a6a7a8a9aaabacadaeaf (80 octets)
<a name="128"/>  128:     %% info = 0xb0b1b2b3b4b5b6b7b8b9babbbcbdbebf
<a name="129"/>  129:     %%        c0c1c2c3c4c5c6c7c8c9cacbcccdcecf
<a name="130"/>  130:     %%        d0d1d2d3d4d5d6d7d8d9dadbdcdddedf
<a name="131"/>  131:     %%        e0e1e2e3e4e5e6e7e8e9eaebecedeeef
<a name="132"/>  132:     %%        f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff (80 octets)
<a name="133"/>  133:     %% L    = 82
<a name="134"/>  134:     
<a name="135"/>  135:     %% PRK  = 0x06a6b88c5853361a06104c9ceb35b45c
<a name="136"/>  136:     %%        ef760014904671014a193f40c15fc244 (32 octets)
<a name="137"/>  137:     %% OKM  = 0xb11e398dc80327a1c8e7f78c596a4934
<a name="138"/>  138:     %%        4f012eda2d4efad8a050cc4c19afa97c
<a name="139"/>  139:     %%        59045a99cac7827271cb41c65e590e09
<a name="140"/>  140:     %%        da3275600c2f09b8367793a9aca3db71
<a name="141"/>  141:     %%        cc30c58179ec3e87c14c01d5c1f3434f
<a name="142"/>  142:     %%        1d87 (82 octets)
<a name="143"/>  143:     IKM  = hexstr2bin(&quot;000102030405060708090a0b0c0d0e0f&quot;
<a name="144"/>  144:                       &quot;101112131415161718191a1b1c1d1e1f&quot;
<a name="145"/>  145:                       &quot;202122232425262728292a2b2c2d2e2f&quot;
<a name="146"/>  146:                       &quot;303132333435363738393a3b3c3d3e3f&quot;
<a name="147"/>  147:                       &quot;404142434445464748494a4b4c4d4e4f&quot;
<a name="148"/>  148:                      ),
<a name="149"/>  149:     Salt = hexstr2bin(&quot;606162636465666768696a6b6c6d6e6f&quot;
<a name="150"/>  150:                       &quot;707172737475767778797a7b7c7d7e7f&quot;
<a name="151"/>  151:                       &quot;808182838485868788898a8b8c8d8e8f&quot;
<a name="152"/>  152:                       &quot;909192939495969798999a9b9c9d9e9f&quot;
<a name="153"/>  153:                       &quot;a0a1a2a3a4a5a6a7a8a9aaabacadaeaf&quot;
<a name="154"/>  154:                      ),
<a name="155"/>  155:     Info = hexstr2bin(&quot;b0b1b2b3b4b5b6b7b8b9babbbcbdbebf&quot;
<a name="156"/>  156:                       &quot;c0c1c2c3c4c5c6c7c8c9cacbcccdcecf&quot;
<a name="157"/>  157:                       &quot;d0d1d2d3d4d5d6d7d8d9dadbdcdddedf&quot;
<a name="158"/>  158:                       &quot;e0e1e2e3e4e5e6e7e8e9eaebecedeeef&quot;
<a name="159"/>  159:                       &quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff&quot;
<a name="160"/>  160:                      ),
<a name="161"/>  161:     PRK  = hexstr2bin(&quot;06a6b88c5853361a06104c9ceb35b45c&quot;
<a name="162"/>  162:                       &quot;ef760014904671014a193f40c15fc244&quot;),
<a name="163"/>  163:     OKM  = hexstr2bin(&quot;b11e398dc80327a1c8e7f78c596a4934&quot;
<a name="164"/>  164:                       &quot;4f012eda2d4efad8a050cc4c19afa97c&quot;
<a name="165"/>  165:                       &quot;59045a99cac7827271cb41c65e590e09&quot;
<a name="166"/>  166:                       &quot;da3275600c2f09b8367793a9aca3db71&quot;
<a name="167"/>  167:                       &quot;cc30c58179ec3e87c14c01d5c1f3434f&quot;
<a name="168"/>  168:                       &quot;1d87&quot;
<a name="169"/>  169:                      ),
<a name="sha_256_long-last_expr"/><a name="170"/>  170: <b>    hkdf_test</b>(sha256, Salt, IKM, PRK, Info, 82, OKM).
<a name="sha_256_no_salt-0"/><a name="171"/>  171: <b>sha_256_no_salt</b>() -&gt;
<a name="sha_256_no_salt-last_expr"/><a name="172"/>  172:     [{doc, &quot;Test with SHA-256 and zero-length salt/info&quot;}].
<a name="sha_256_no_salt-1"/><a name="173"/>  173: <b>sha_256_no_salt</b>(Config) when is_list(Config) -&gt;
<a name="174"/>  174:     %% Hash = SHA-256
<a name="175"/>  175:     %% IKM  = 0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b (22 octets)
<a name="176"/>  176:     %% salt = (0 octets)
<a name="177"/>  177:     %% info = (0 octets)
<a name="178"/>  178:     %% L    = 42
<a name="179"/>  179:     
<a name="180"/>  180:     %% PRK  = 0x19ef24a32c717b167f33a91d6f648bdf
<a name="181"/>  181:     %%        96596776afdb6377ac434c1c293ccb04 (32 octets)
<a name="182"/>  182:     %% OKM  = 0x8da4e775a563c18f715f802a063c5a31
<a name="183"/>  183:     %%        b8a11f5c5ee1879ec3454e5f3c738d2d
<a name="184"/>  184:     %%        9d201395faa4b61a96c8 (42 octets)
<a name="185"/>  185:     IKM  = hexstr2bin(&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b&quot;),
<a name="186"/>  186:     Salt = &lt;&lt;&gt;&gt;,
<a name="187"/>  187:     Info = &lt;&lt;&gt;&gt;,
<a name="188"/>  188:     PRK  = hexstr2bin(&quot;19ef24a32c717b167f33a91d6f648bdf&quot;
<a name="189"/>  189:                       &quot;96596776afdb6377ac434c1c293ccb04&quot;),
<a name="190"/>  190:     OKM  = hexstr2bin(&quot;8da4e775a563c18f715f802a063c5a31&quot;
<a name="191"/>  191:                       &quot;b8a11f5c5ee1879ec3454e5f3c738d2d&quot;
<a name="192"/>  192:                       &quot;9d201395faa4b61a96c8&quot;),
<a name="sha_256_no_salt-last_expr"/><a name="193"/>  193: <b>    hkdf_test</b>(sha256, Salt, IKM, PRK, Info, 42, OKM).
<a name="194"/>  194: 
<a name="sha_basic-0"/><a name="195"/>  195: <b>sha_basic</b>() -&gt;
<a name="sha_basic-last_expr"/><a name="196"/>  196:     [{doc, &quot; Basic test case with SHA-1&quot;}].
<a name="sha_basic-1"/><a name="197"/>  197: <b>sha_basic</b>(Config) when is_list(Config) -&gt;
<a name="198"/>  198:     %% Hash = SHA-1
<a name="199"/>  199:     %% IKM  = 0x0b0b0b0b0b0b0b0b0b0b0b (11 octets)
<a name="200"/>  200:     %% salt = 0x000102030405060708090a0b0c (13 octets)
<a name="201"/>  201:     %% info = 0xf0f1f2f3f4f5f6f7f8f9 (10 octets)
<a name="202"/>  202:     %% L    = 42
<a name="203"/>  203:     
<a name="204"/>  204:     %% PRK  = 0x9b6c18c432a7bf8f0e71c8eb88f4b30baa2ba243 (20 octets)
<a name="205"/>  205:     %% OKM  = 0x085a01ea1b10f36933068b56efa5ad81
<a name="206"/>  206:     %%        a4f14b822f5b091568a9cdd4f155fda2
<a name="207"/>  207:     %%        c22e422478d305f3f896 (42 octets)
<a name="208"/>  208:     IKM  = hexstr2bin(&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b&quot;),
<a name="209"/>  209:     Salt = hexstr2bin(&quot;000102030405060708090a0b0c&quot;),
<a name="210"/>  210:     Info = hexstr2bin(&quot;f0f1f2f3f4f5f6f7f8f9&quot;),
<a name="211"/>  211:     PRK  = hexstr2bin(&quot;077709362c2e32df0ddc3f0dc47bba63&quot;
<a name="212"/>  212:                       &quot;90b6c73bb50f9c3122ec844ad7c2b3e5&quot;),
<a name="213"/>  213:     OKM  = hexstr2bin(&quot;3cb25f25faacd57a90434f64d0362f2a&quot;
<a name="214"/>  214:                       &quot;2d2d0a90cf1a5a4c5db02d56ecc4c5bf&quot;
<a name="215"/>  215:                       &quot;34007208d5b887185865&quot;),
<a name="sha_basic-last_expr"/><a name="216"/>  216: <b>    hkdf_test</b>(sha256, Salt, IKM, PRK, Info, 42, OKM).
<a name="217"/>  217: 
<a name="sha_long-0"/><a name="218"/>  218: <b>sha_long</b>() -&gt;
<a name="sha_long-last_expr"/><a name="219"/>  219:     [{doc, &quot;Test with SHA-1 and longer inputs/outputs&quot;}].
<a name="sha_long-1"/><a name="220"/>  220: <b>sha_long</b>(Config) when is_list(Config) -&gt;
<a name="221"/>  221:     %% Hash = SHA-1
<a name="222"/>  222:     %% IKM  = 0x000102030405060708090a0b0c0d0e0f
<a name="223"/>  223:     %%        101112131415161718191a1b1c1d1e1f
<a name="224"/>  224:     %%        202122232425262728292a2b2c2d2e2f
<a name="225"/>  225:     %%        303132333435363738393a3b3c3d3e3f
<a name="226"/>  226:     %%        404142434445464748494a4b4c4d4e4f (80 octets)
<a name="227"/>  227:     %% salt = 0x606162636465666768696a6b6c6d6e6f
<a name="228"/>  228:     %%        707172737475767778797a7b7c7d7e7f
<a name="229"/>  229:     %%        808182838485868788898a8b8c8d8e8f
<a name="230"/>  230:     %%        909192939495969798999a9b9c9d9e9f
<a name="231"/>  231:     %%        a0a1a2a3a4a5a6a7a8a9aaabacadaeaf (80 octets)
<a name="232"/>  232:     %% info = 0xb0b1b2b3b4b5b6b7b8b9babbbcbdbebf
<a name="233"/>  233:     %%        c0c1c2c3c4c5c6c7c8c9cacbcccdcecf
<a name="234"/>  234:     %%        d0d1d2d3d4d5d6d7d8d9dadbdcdddedf
<a name="235"/>  235:     %%        e0e1e2e3e4e5e6e7e8e9eaebecedeeef
<a name="236"/>  236:     %%        f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff (80 octets)
<a name="237"/>  237:     %% L    = 82
<a name="238"/>  238:     
<a name="239"/>  239:     %% PRK  = 0x8adae09a2a307059478d309b26c4115a224cfaf6 (20 octets)
<a name="240"/>  240:     %% OKM  = 0x0bd770a74d1160f7c9f12cd5912a06eb
<a name="241"/>  241:     %%        ff6adcae899d92191fe4305673ba2ffe
<a name="242"/>  242:     %%        8fa3f1a4e5ad79f3f334b3b202b2173c
<a name="243"/>  243:     %%        486ea37ce3d397ed034c7f9dfeb15c5e
<a name="244"/>  244:     %%        927336d0441f4c4300e2cff0d0900b52
<a name="245"/>  245:     %%        d3b4 (82 octets)
<a name="246"/>  246:     IKM  = hexstr2bin(&quot;000102030405060708090a0b0c0d0e0f&quot;
<a name="247"/>  247:                       &quot;101112131415161718191a1b1c1d1e1f&quot;
<a name="248"/>  248:                       &quot;202122232425262728292a2b2c2d2e2f&quot;
<a name="249"/>  249:                       &quot;303132333435363738393a3b3c3d3e3f&quot;
<a name="250"/>  250:                       &quot;404142434445464748494a4b4c4d4e4f&quot;
<a name="251"/>  251:                      ),
<a name="252"/>  252:     Salt = hexstr2bin(&quot;606162636465666768696a6b6c6d6e6f&quot;
<a name="253"/>  253:                       &quot;707172737475767778797a7b7c7d7e7f&quot;
<a name="254"/>  254:                       &quot;808182838485868788898a8b8c8d8e8f&quot;
<a name="255"/>  255:                       &quot;909192939495969798999a9b9c9d9e9f&quot;
<a name="256"/>  256:                       &quot;a0a1a2a3a4a5a6a7a8a9aaabacadaeaf&quot;
<a name="257"/>  257:                      ),
<a name="258"/>  258:     Info = hexstr2bin(&quot;b0b1b2b3b4b5b6b7b8b9babbbcbdbebf&quot;
<a name="259"/>  259:                       &quot;c0c1c2c3c4c5c6c7c8c9cacbcccdcecf&quot;
<a name="260"/>  260:                       &quot;d0d1d2d3d4d5d6d7d8d9dadbdcdddedf&quot;
<a name="261"/>  261:                       &quot;e0e1e2e3e4e5e6e7e8e9eaebecedeeef&quot;
<a name="262"/>  262:                       &quot;f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff&quot;
<a name="263"/>  263:                      ),
<a name="264"/>  264:     PRK  = hexstr2bin(&quot;8adae09a2a307059478d309b26c4115a224cfaf6&quot;),
<a name="265"/>  265:     OKM  = hexstr2bin(&quot;0bd770a74d1160f7c9f12cd5912a06eb&quot;
<a name="266"/>  266:                       &quot;ff6adcae899d92191fe4305673ba2ffe&quot;
<a name="267"/>  267:                       &quot;8fa3f1a4e5ad79f3f334b3b202b2173c&quot;
<a name="268"/>  268:                       &quot;486ea37ce3d397ed034c7f9dfeb15c5e&quot;
<a name="269"/>  269:                       &quot;927336d0441f4c4300e2cff0d0900b52&quot;
<a name="270"/>  270:                       &quot;d3b4&quot;
<a name="271"/>  271:                      ),
<a name="sha_long-last_expr"/><a name="272"/>  272: <b>    hkdf_test</b>(sha, Salt, IKM, PRK, Info, 82, OKM).
<a name="273"/>  273: 
<a name="sha_no_salt-0"/><a name="274"/>  274: <b>sha_no_salt</b>() -&gt;
<a name="sha_no_salt-last_expr"/><a name="275"/>  275:     [{doc, &quot;Test with SHA-1 and zero-length salt/info&quot;}].
<a name="sha_no_salt-1"/><a name="276"/>  276: <b>sha_no_salt</b>(Config) when is_list(Config) -&gt;
<a name="277"/>  277:     %%   Hash = SHA-1
<a name="278"/>  278:     %% IKM  = 0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b (22 octets)
<a name="279"/>  279:     %% salt = (0 octets)
<a name="280"/>  280:     %% info = (0 octets)
<a name="281"/>  281:     %% L    = 42
<a name="282"/>  282: 
<a name="283"/>  283:     %% PRK  = 0xda8c8a73c7fa77288ec6f5e7c297786aa0d32d01 (20 octets)
<a name="284"/>  284:     %% OKM  = 0x0ac1af7002b3d761d1e55298da9d0506
<a name="285"/>  285:     %%        b9ae52057220a306e07b6b87e8df21d0
<a name="286"/>  286:     %%        ea00033de03984d34918 (42 octets)
<a name="287"/>  287:     IKM  = hexstr2bin(&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b&quot;),
<a name="288"/>  288:     Salt = &lt;&lt;&gt;&gt;,
<a name="289"/>  289:     Info = &lt;&lt;&gt;&gt;,
<a name="290"/>  290:     PRK  = hexstr2bin(&quot;da8c8a73c7fa77288ec6f5e7c297786aa0d32d01&quot;),
<a name="291"/>  291:     OKM  = hexstr2bin(&quot;0ac1af7002b3d761d1e55298da9d0506&quot;
<a name="292"/>  292:                       &quot;b9ae52057220a306e07b6b87e8df21d0&quot;
<a name="293"/>  293:                       &quot;ea00033de03984d34918&quot;),
<a name="sha_no_salt-last_expr"/><a name="294"/>  294: <b>    hkdf_test</b>(sha, Salt, IKM, PRK, Info, 42, OKM).
<a name="295"/>  295: 
<a name="296"/>  296: 
<a name="sha_default_salt-0"/><a name="297"/>  297: <b>sha_default_salt</b>() -&gt;
<a name="sha_default_salt-last_expr"/><a name="298"/>  298: <b>    [{doc, &quot;Test with SHA-1, salt not provided </b>(defaults to HashLen zero octets),
<a name="299"/>  299:    zero-length info&quot;}].
<a name="sha_default_salt-1"/><a name="300"/>  300: <b>sha_default_salt</b>(Config) when is_list(Config) -&gt;     
<a name="301"/>  301:     %% Hash = SHA-1
<a name="302"/>  302:     %% IKM  = 0x0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c (22 octets)
<a name="303"/>  303:     %% salt = not provided (defaults to HashLen zero octets)
<a name="304"/>  304:     %% info = (0 octets)
<a name="305"/>  305:     %% L    = 42
<a name="306"/>  306: 
<a name="307"/>  307:     %% PRK  = 0x2adccada18779e7c2077ad2eb19d3f3e731385dd (20 octets)
<a name="308"/>  308:     %% OKM  = 0x2c91117204d745f3500d636a62f64f0a
<a name="309"/>  309:     %%        b3bae548aa53d423b0d1f27ebba6f5e5
<a name="310"/>  310:     %%        673a081d70cce7acfc48 (42 octets)
<a name="311"/>  311:     IKM  = hexstr2bin(&quot;0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c&quot;),
<a name="312"/>  312:     Salt = binary:copy(&lt;&lt;0&gt;&gt;, 20),
<a name="313"/>  313:     Info = &lt;&lt;&gt;&gt;,
<a name="314"/>  314:     PRK  = hexstr2bin(&quot;2adccada18779e7c2077ad2eb19d3f3e731385dd&quot;),
<a name="315"/>  315:     OKM  = hexstr2bin(&quot;2c91117204d745f3500d636a62f64f0a&quot;
<a name="316"/>  316:                       &quot;b3bae548aa53d423b0d1f27ebba6f5e5&quot;
<a name="317"/>  317:                       &quot;673a081d70cce7acfc48&quot;),
<a name="sha_default_salt-last_expr"/><a name="318"/>  318: <b>    hkdf_test</b>(sha, Salt, IKM, PRK, Info, 42, OKM).
<a name="319"/>  319: 
<a name="hkdf_test-7"/><a name="320"/>  320: <b>hkdf_test</b>(HashAlg, Salt, KeyingMaterial, PsedoRandKey, ContextInfo, Length, Key) -&gt;   
<a name="321"/>  321:     PsedoRandKey = tls_v1:hkdf_extract(HashAlg, Salt, KeyingMaterial),
<a name="hkdf_test-last_expr"/><a name="322"/>  322: <b>    Key = tls_v1:hkdf_expand</b>(PsedoRandKey, ContextInfo, Length, HashAlg).
<a name="323"/>  323:     
<a name="hexstr2bin-1"/><a name="324"/>  324: <b>hexstr2bin</b>(S) when is_binary(S) -&gt;
<a name="325"/>  325:     list_to_binary(hexstr2list(binary_to_list(S)));
<a name="326"/>  326: <b>hexstr2bin</b>(S) -&gt;
<a name="hexstr2bin-last_expr"/><a name="327"/>  327: <b>    list_to_binary</b>(hexstr2list(S)).
<a name="328"/>  328: 
<a name="hexstr2list-1"/><a name="329"/>  329: <b>hexstr2list</b>([$ |T]) -&gt;
<a name="330"/>  330:     hexstr2list(T);
<a name="331"/>  331: <b>hexstr2list</b>([X,Y|T]) -&gt;
<a name="332"/>  332:     [mkint(X)*16 + mkint(Y) | hexstr2list(T)];
<a name="333"/>  333: <b>hexstr2list</b>([]) -&gt;
<a name="hexstr2list-last_expr"/><a name="334"/>  334:     [].
<a name="mkint-1"/><a name="335"/>  335: <b>mkint</b>(C) when $0 =&lt; C, C =&lt; $9 -&gt;
<a name="336"/>  336:     C - $0;
<a name="337"/>  337: <b>mkint</b>(C) when $A =&lt; C, C =&lt; $F -&gt;
<a name="338"/>  338:     C - $A + 10;
<a name="339"/>  339: <b>mkint</b>(C) when $a =&lt; C, C =&lt; $f -&gt;
<a name="mkint-last_expr"/><a name="340"/>  340:     C - $a + 10.
</pre>
<script>
var hash = window.location.hash.substring(1);
var anchor = document.getElementsByName(hash);
anchor[0].style.backgroundColor="orange";
</script>
</body>
</html>
