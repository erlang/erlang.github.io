<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></meta>
<title>/buildroot/otp/lib/public_key/make_test_dir/public_key_test/pubkey_ocsp_SUITE.erl</title>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
<a name="1"/>    1: <i>%%</i>
<a name="2"/>    2: <i>%% %CopyrightBegin%</i>
<a name="3"/>    3: <i>%%</i>
<a name="4"/>    4: <i>%% Copyright Ericsson AB 2011-2024. All Rights Reserved.</i>
<a name="5"/>    5: <i>%%</i>
<a name="6"/>    6: <i>%% Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</i>
<a name="7"/>    7: <i>%% you may not use this file except in compliance with the License.</i>
<a name="8"/>    8: <i>%% You may obtain a copy of the License at</i>
<a name="9"/>    9: <i>%%</i>
<a name="10"/>   10: <i>%%     http://www.apache.org/licenses/LICENSE-2.0</i>
<a name="11"/>   11: <i>%%</i>
<a name="12"/>   12: <i>%% Unless required by applicable law or agreed to in writing, software</i>
<a name="13"/>   13: <i>%% distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</i>
<a name="14"/>   14: <i>%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i>
<a name="15"/>   15: <i>%% See the License for the specific language governing permissions and</i>
<a name="16"/>   16: <i>%% limitations under the License.</i>
<a name="17"/>   17: <i>%%</i>
<a name="18"/>   18: <i>%% %CopyrightEnd%</i>
<a name="19"/>   19: <i>%%</i>
<a name="20"/>   20: 
<a name="21"/>   21: <b>-module</b>(pubkey_ocsp_SUITE).
<a name="22"/>   22: 
<a name="23"/>   23: <b>-include_lib</b>(&quot;common_test/include/ct.hrl&quot;).
<a name="24"/>   24: <b>-include_lib</b>(&quot;public_key/include/public_key.hrl&quot;).
<a name="25"/>   25: <i>%% Note: This directive should only be used in test suites.</i>
<a name="26"/>   26: <b>-compile</b>([export_all, nowarn_export_all]).
<a name="27"/>   27: 
<a name="28"/>   28: <b>-define</b>(NONCE,
<a name="29"/>   29:         &lt;&lt;4,8,93,33,1,52,187,3,12,142&gt;&gt;).
<a name="30"/>   30: <b>-define</b>(OCSP_RESPONSE_DER,
<a name="31"/>   31:         &lt;&lt;48,130,7,36,10,1,0,160,130,7,29,48,130,7,25,6,9,43,6,1,5,5,7,48,1,1,4,130,7,10,48,130,7,6,48,130,1,10,161,129,134,48,129,131,49,14,48,12,6,3,85,4,3,12,5,111,116,112,67,65,49,19,48,17,6,3,85,4,11,12,10,69,114,108,97,110,103,32,79,84,80,49,20,48,18,6,3,85,4,10,12,11,69,114,105,99,115,115,111,110,32,65,66,49,11,48,9,6,3,85,4,6,19,2,83,69,49,18,48,16,6,3,85,4,7,12,9,83,116,111,99,107,104,111,108,109,49,37,48,35,6,9,42,134,72,134,247,13,1,9,1,22,22,112,101,116,101,114,64,101,114,105,120,46,101,
<a name="32"/>   32:           114,105,99,115,115,111,110,46,115,101,24,15,50,48,50,51,48,55,50,48,49,50,50,57,52,57,90,48,81,48,79,48,58,48,9,6,5,43,14,3,2,26,5,0,4,20,227,147,252,182,155,101,129,45,194,162,22,93,127,46,112,193,196,28,241,232,4,20,34,25,129,87,115,255,155,246,200,97,92,7,51,110,152,61,97,155,164,171,2,1,9,128,0,24,15,50,48,50,51,48,55,50,48,49,50,50,57,52,57,90,161,27,48,25,48,23,6,9,43,6,1,5,5,7,48,1,2,4,10,4,8,93,33,1,52,187,3,12,142,48,13,6,9,42,134,72,134,247,13,1,1,11,5,0,3,130,1,1,0,182,228,165,33,
<a name="33"/>   33:           173,232,46,125,152,237,37,120,186,223,188,231,181,61,72,89,210,75,38,182,146,218,223,53,38,104,100,89,19,79,48,159,109,70,25,34,143,253,199,92,162,248,245,240,61,82,39,44,243,148,109,21,112,74,206,246,5,146,12,175,235,170,225,206,115,148,109,1,216,194,98,149,105,106,232,83,95,229,196,237,246,6,177,167,177,52,242,63,56,93,74,92,28,246,138,137,99,28,239,68,130,184,182,140,50,206,10,166,243,118,11,153,79,178,220,166,161,45,83,90,58,152,78,229,27,54,147,125,106,199,192,182,242,242,98,69,94,148,
<a name="34"/>   34:           163,130,154,168,134,24,7,211,176,133,1,156,206,22,197,139,59,66,110,121,187,101,221,16,11,114,106,56,178,21,3,189,89,233,228,8,127,150,247,151,97,145,204,117,80,120,174,191,12,150,148,180,86,16,86,82,170,184,185,10,182,252,210,66,238,144,233,244,94,144,143,200,0,172,179,194,109,137,186,95,180,111,242,81,132,254,70,174,168,9,181,145,154,180,7,78,17,56,24,195,236,80,46,1,241,0,52,172,84,154,43,117,130,153,160,130,4,224,48,130,4,220,48,130,4,216,48,130,3,192,160,3,2,1,2,2,1,1,48,13,6,9,42,134,
<a name="35"/>   35:           72,134,247,13,1,1,11,5,0,48,129,134,49,17,48,15,6,3,85,4,3,12,8,101,114,108,97,110,103,67,65,49,19,48,17,6,3,85,4,11,12,10,69,114,108,97,110,103,32,79,84,80,49,20,48,18,6,3,85,4,10,12,11,69,114,105,99,115,115,111,110,32,65,66,49,18,48,16,6,3,85,4,7,12,9,83,116,111,99,107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,37,48,35,6,9,42,134,72,134,247,13,1,9,1,22,22,112,101,116,101,114,64,101,114,105,120,46,101,114,105,99,115,115,111,110,46,115,101,48,30,23,13,50,51,48,55,50,48,49,50,50,57,
<a name="36"/>   36:           52,52,90,23,13,51,51,48,53,50,56,49,50,50,57,52,52,90,48,129,131,49,14,48,12,6,3,85,4,3,12,5,111,116,112,67,65,49,19,48,17,6,3,85,4,11,12,10,69,114,108,97,110,103,32,79,84,80,49,20,48,18,6,3,85,4,10,12,11,69,114,105,99,115,115,111,110,32,65,66,49,11,48,9,6,3,85,4,6,19,2,83,69,49,18,48,16,6,3,85,4,7,12,9,83,116,111,99,107,104,111,108,109,49,37,48,35,6,9,42,134,72,134,247,13,1,9,1,22,22,112,101,116,101,114,64,101,114,105,120,46,101,114,105,99,115,115,111,110,46,115,101,48,130,1,34,48,13,6,9,42,
<a name="37"/>   37:           134,72,134,247,13,1,1,1,5,0,3,130,1,15,0,48,130,1,10,2,130,1,1,0,224,126,14,188,23,118,17,120,117,2,151,131,96,96,81,128,52,8,219,111,48,52,116,100,176,30,58,84,47,206,254,180,60,112,107,216,0,213,16,164,57,110,181,88,62,78,208,125,127,255,36,56,29,37,165,108,64,115,95,46,212,88,172,92,20,177,247,84,13,124,142,41,248,131,77,91,114,228,157,125,20,155,64,70,60,206,180,54,12,80,153,230,208,10,189,163,140,22,146,156,99,21,213,182,98,144,208,94,71,69,249,100,109,104,226,169,55,210,194,244,111,92,
<a name="38"/>   38:           16,87,6,93,42,174,62,243,175,60,139,134,67,116,107,208,120,214,103,12,182,22,229,195,60,133,235,228,230,17,0,101,185,117,3,52,252,75,173,144,14,30,36,132,251,47,0,161,159,183,230,201,93,76,82,202,66,213,34,44,88,148,92,240,21,152,135,102,160,212,173,100,225,227,143,229,74,120,120,147,179,228,80,127,246,118,213,141,122,209,29,48,47,188,130,179,111,83,234,203,22,0,167,15,53,193,172,80,117,62,98,63,233,161,102,96,21,10,72,179,86,205,96,124,62,133,9,28,197,39,190,23,72,49,2,3,1,0,1,163,130,1,80,
<a name="39"/>   39:           48,130,1,76,48,15,6,3,85,29,19,1,1,255,4,5,48,3,1,1,255,48,11,6,3,85,29,15,4,4,3,2,1,6,48,29,6,3,85,29,14,4,22,4,20,34,25,129,87,115,255,155,246,200,97,92,7,51,110,152,61,97,155,164,171,48,129,198,6,3,85,29,35,4,129,190,48,129,187,128,20,196,35,212,128,180,55,39,81,140,96,141,212,14,41,206,56,214,196,133,175,161,129,140,164,129,137,48,129,134,49,17,48,15,6,3,85,4,3,12,8,101,114,108,97,110,103,67,65,49,19,48,17,6,3,85,4,11,12,10,69,114,108,97,110,103,32,79,84,80,49,20,48,18,6,3,85,4,10,12,11,
<a name="40"/>   40:           69,114,105,99,115,115,111,110,32,65,66,49,18,48,16,6,3,85,4,7,12,9,83,116,111,99,107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,37,48,35,6,9,42,134,72,134,247,13,1,9,1,22,22,112,101,116,101,114,64,101,114,105,120,46,101,114,105,99,115,115,111,110,46,115,101,130,20,43,178,6,127,40,48,98,119,68,20,137,15,178,249,179,119,3,205,202,41,48,33,6,3,85,29,17,4,26,48,24,129,22,112,101,116,101,114,64,101,114,105,120,46,101,114,105,99,115,115,111,110,46,115,101,48,33,6,3,85,29,18,4,26,48,24,129,
<a name="41"/>   41:           22,112,101,116,101,114,64,101,114,105,120,46,101,114,105,99,115,115,111,110,46,115,101,48,13,6,9,42,134,72,134,247,13,1,1,11,5,0,3,130,1,1,0,2,39,149,225,217,60,119,245,177,96,137,169,49,169,0,163,164,218,40,228,230,193,142,138,206,47,0,176,80,99,16,226,79,124,237,230,91,57,148,49,250,208,42,193,106,53,86,163,205,254,245,90,45,240,172,107,162,160,59,7,246,245,41,106,44,239,47,78,197,79,123,55,217,87,181,221,73,88,47,122,30,195,225,6,28,237,49,250,105,85,214,69,86,243,73,81,101,192,31,250,31,
<a name="42"/>   42:           55,111,63,11,1,147,63,144,241,132,32,161,92,168,152,19,29,233,88,234,4,134,144,26,70,162,219,31,125,205,202,94,45,111,3,17,66,62,208,17,188,179,94,222,238,248,79,102,80,138,217,80,233,100,152,240,11,81,36,130,175,152,182,221,2,26,24,33,180,242,63,33,223,18,131,11,52,51,1,193,24,222,91,47,100,131,173,32,69,159,13,94,246,193,182,127,242,164,131,112,92,179,65,79,235,174,161,194,201,255,119,2,251,215,203,135,16,154,55,69,82,33,69,60,223,118,35,56,22,228,106,80,57,180,62,124,121,244,121,197,123,
<a name="43"/>   43:           242,190,55,26,32,214,176,53,28,117,171,162,76,160&gt;&gt;).
<a name="44"/>   44: <b>-define</b>(ISSUER_CERT,
<a name="45"/>   45:         {'OTPCertificate',{'OTPTBSCertificate',v3,1,
<a name="46"/>   46:                            {'SignatureAlgorithm',{1,2,840,113549,1,1,11},'NULL'},
<a name="47"/>   47:                            {rdnSequence,[[{'AttributeTypeAndValue',{2,5,4,3},{utf8String,&lt;&lt;&quot;erlangCA&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,11},{utf8String,&lt;&lt;&quot;Erlang OTP&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,10},{utf8String,&lt;&lt;&quot;Ericsson AB&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,7},{utf8String,&lt;&lt;&quot;Stockholm&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,6},&quot;SE&quot;}],[{'AttributeTypeAndValue',{1,2,840,113549,1,9,1},&quot;peter@erix.ericsson.se&quot;}]]},
<a name="48"/>   48:                            {'Validity',{utcTime,&quot;230720122944Z&quot;},{utcTime,&quot;330528122944Z&quot;}},
<a name="49"/>   49:                            {rdnSequence,[[{'AttributeTypeAndValue',{2,5,4,3},{utf8String,&lt;&lt;&quot;otpCA&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,11},{utf8String,&lt;&lt;&quot;Erlang OTP&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,10},{utf8String,&lt;&lt;&quot;Ericsson AB&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,6},&quot;SE&quot;}],[{'AttributeTypeAndValue',{2,5,4,7},{utf8String,&lt;&lt;&quot;Stockholm&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{1,2,840,113549,1,9,1},&quot;peter@erix.ericsson.se&quot;}]]},
<a name="50"/>   50:                            {'OTPSubjectPublicKeyInfo',{'PublicKeyAlgorithm',{1,2,840,113549,1,1,1},'NULL'},
<a name="51"/>   51:                             {'RSAPublicKey',28339541610808720697355110173776661351591299627563886520724840524156173758352096851973677497931775737934761046080070714946146799362954032218057107079242015447767834113919294749723734648362271942219510034694564267611067362221363996274084106982740657802072527220370548608128815474010110407985824336936761317435951968068792959040741225688753787656107492053262271328711261658605960823613199135109317800726834363235926476527282638847781232871073244485999722937494811217769991698287040924806827188498324716317026838449695477777978536565396172198805249805405552866638039988130119465502001541293012996469049417900821835106353,
<a name="52"/>   52:                              65537}},
<a name="53"/>   53:                            asn1_NOVALUE,asn1_NOVALUE,
<a name="54"/>   54:                            [{'Extension',{2,5,29,19},true,{'BasicConstraints',true,asn1_NOVALUE}},
<a name="55"/>   55:                             {'Extension',{2,5,29,15},false,[keyCertSign,cRLSign]},
<a name="56"/>   56:                             {'Extension',{2,5,29,14},false,&lt;&lt;34,25,129,87,115,255,155,246,200,97,92,7,51,110,152,61,97,155,164,171&gt;&gt;},
<a name="57"/>   57:                             {'Extension',{2,5,29,35},
<a name="58"/>   58:                              false,
<a name="59"/>   59:                              {'AuthorityKeyIdentifier',&lt;&lt;196,35,212,128,180,55,39,81,140,96,141,212,14,41,206,56,214,196,133,175&gt;&gt;,
<a name="60"/>   60:                               [{directoryName,{rdnSequence,[[{'AttributeTypeAndValue',{2,5,4,3},{utf8String,&lt;&lt;&quot;erlangCA&quot;&gt;&gt;}}],
<a name="61"/>   61:                                                             [{'AttributeTypeAndValue',{2,5,4,11},{utf8String,&lt;&lt;&quot;Erlang OTP&quot;&gt;&gt;}}],
<a name="62"/>   62:                                                             [{'AttributeTypeAndValue',{2,5,4,10},{utf8String,&lt;&lt;&quot;Ericsson AB&quot;&gt;&gt;}}],
<a name="63"/>   63:                                                             [{'AttributeTypeAndValue',{2,5,4,7},{utf8String,&lt;&lt;&quot;Stockholm&quot;&gt;&gt;}}],
<a name="64"/>   64:                                                             [{'AttributeTypeAndValue',{2,5,4,6},&quot;SE&quot;}],
<a name="65"/>   65:                                                             [{'AttributeTypeAndValue',{1,2,840,113549,1,9,1},&quot;peter@erix.ericsson.se&quot;}]]}}],
<a name="66"/>   66:                               249456701733760087187851894331345805369320262185}},
<a name="67"/>   67:                             {'Extension',{2,5,29,17},false,[{rfc822Name,&quot;peter@erix.ericsson.se&quot;}]},
<a name="68"/>   68:                             {'Extension',{2,5,29,18},false,[{rfc822Name,&quot;peter@erix.ericsson.se&quot;}]}]},
<a name="69"/>   69:          {'SignatureAlgorithm',{1,2,840,113549,1,1,11},'NULL'},
<a name="70"/>   70:          &lt;&lt;2,39,149,225,217,60,119,245,177,96,137,169,49,169,0,163,164,218,40,228,230,193,142,138,206,47,0,176,80,99,16,226,79,124,237,230,91,57,148,49,250,208,42,193,106,53,86,163,205,254,245,90,45,240,172,107,162,160,59,7,246,245,41,106,44,239,47,78,197,79,123,55,217,87,181,221,73,88,47,122,30,195,225,6,28,237,49,250,105,85,214,69,86,243,73,81,101,192,31,250,31,55,111,63,11,1,147,63,144,241,132,32,161,92,168,152,19,29,233,88,234,4,134,144,26,70,162,219,31,125,205,202,94,45,111,3,17,
<a name="71"/>   71:            66,62,208,17,188,179,94,222,238,248,79,102,80,138,217,80,233,100,152,240,11,81,36,130,175,152,182,221,2,26,24,33,180,242,63,33,223,18,131,11,52,51,1,193,24,222,91,47,100,131,173,32,69,159,13,94,246,193,182,127,242,164,131,112,92,179,65,79,235,174,161,194,201,255,119,2,251,215,203,135,16,154,55,69,82,33,69,60,223,118,35,56,22,228,106,80,57,180,62,124,121,244,121,197,123,242,190,55,26,32,214,176,53,28,117,171,162,76,160&gt;&gt;}
<a name="72"/>   72:        ).
<a name="73"/>   73: <b>-define</b>(RESPONDER_CERT, #cert{otp = ?ISSUER_CERT}).
<a name="74"/>   74: <b>-define</b>(A_SERVER_CERT,
<a name="75"/>   75:         {'OTPCertificate',{'OTPTBSCertificate',v3,9,
<a name="76"/>   76:                            {'SignatureAlgorithm',{1,2,840,113549,1,1,11},'NULL'},
<a name="77"/>   77:                            {rdnSequence,[[{'AttributeTypeAndValue',{2,5,4,3},{utf8String,&lt;&lt;&quot;otpCA&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,11},{utf8String,&lt;&lt;&quot;Erlang OTP&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,10},{utf8String,&lt;&lt;&quot;Ericsson AB&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,6},&quot;SE&quot;}],[{'AttributeTypeAndValue',{2,5,4,7},{utf8String,&lt;&lt;&quot;Stockholm&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{1,2,840,113549,1,9,1},&quot;peter@erix.ericsson.se&quot;}]]},
<a name="78"/>   78:                            {'Validity',{utcTime,&quot;230720133137Z&quot;},{utcTime,&quot;330528133137Z&quot;}},
<a name="79"/>   79:                            {rdnSequence,[[{'AttributeTypeAndValue',{2,5,4,3},{utf8String,&lt;&lt;&quot;a.server&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,11},{utf8String,&lt;&lt;&quot;Erlang OTP&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,10},{utf8String,&lt;&lt;&quot;Ericsson AB&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{2,5,4,6},&quot;SE&quot;}],[{'AttributeTypeAndValue',{2,5,4,7},{utf8String,&lt;&lt;&quot;Stockholm&quot;&gt;&gt;}}],[{'AttributeTypeAndValue',{1,2,840,113549,1,9,1},&quot;peter@erix.ericsson.se&quot;}]]},
<a name="80"/>   80:                            {'OTPSubjectPublicKeyInfo',{'PublicKeyAlgorithm',{1,2,840,113549,1,1,1},'NULL'},
<a name="81"/>   81:                             {'RSAPublicKey',21289228001579879261333836287004823332222603265803194664536540127079242843046558012638236832904402369325784443025964406623777246658832921141960060475804229950419927075126320682148878633948860170628231809668072735203197673472127901696952853229103382707195692260834407944629128675563945194876045436588557031550105450845916227210816469918126215406473272174435113136059751668904728646605321836951857481644376964329827326510385947455341932553729402879301386590388317914766820519616318357183422565964994898098302388155119056040428369731559112404176013041801429296771966314089067058782535413289830323744573459011210321571511,
<a name="82"/>   82:                              65537}},
<a name="83"/>   83:                            asn1_NOVALUE,asn1_NOVALUE,
<a name="84"/>   84:                            [{'Extension',{2,5,29,19},false,{'BasicConstraints',false,asn1_NOVALUE}},
<a name="85"/>   85:                             {'Extension',{2,5,29,15},false,[digitalSignature,nonRepudiation,keyEncipherment]},
<a name="86"/>   86:                             {'Extension',{2,5,29,14},false,&lt;&lt;135,115,253,182,154,247,175,77,237,3,215,88,195,15,182,214,248,144,201,202&gt;&gt;},
<a name="87"/>   87:                             {'Extension',{2,5,29,35},
<a name="88"/>   88:                              false,
<a name="89"/>   89:                              {'AuthorityKeyIdentifier',&lt;&lt;63,22,3,246,66,83,233,142,103,82,105,230,175,132,130,192,87,79,122,232&gt;&gt;,
<a name="90"/>   90:                               [{directoryName,{rdnSequence,[[{'AttributeTypeAndValue',{2,5,4,3},{utf8String,&lt;&lt;&quot;erlangCA&quot;&gt;&gt;}}],
<a name="91"/>   91:                                                             [{'AttributeTypeAndValue',{2,5,4,11},{utf8String,&lt;&lt;&quot;Erlang OTP&quot;&gt;&gt;}}],
<a name="92"/>   92:                                                             [{'AttributeTypeAndValue',{2,5,4,10},{utf8String,&lt;&lt;&quot;Ericsson AB&quot;&gt;&gt;}}],
<a name="93"/>   93:                                                             [{'AttributeTypeAndValue',{2,5,4,7},{utf8String,&lt;&lt;&quot;Stockholm&quot;&gt;&gt;}}],
<a name="94"/>   94:                                                             [{'AttributeTypeAndValue',{2,5,4,6},&quot;SE&quot;}],
<a name="95"/>   95:                                                             [{'AttributeTypeAndValue',{1,2,840,113549,1,9,1},&quot;peter@erix.ericsson.se&quot;}]]}}],
<a name="96"/>   96:                               1}},
<a name="97"/>   97:                             {'Extension',{2,5,29,17},false,[{dNSName,&quot;host.example.com&quot;}]},
<a name="98"/>   98:                             {'Extension',{2,5,29,18},false,[{rfc822Name,&quot;peter@erix.ericsson.se&quot;}]}]},
<a name="99"/>   99:          {'SignatureAlgorithm',{1,2,840,113549,1,1,11},'NULL'},
<a name="100"/>  100:          &lt;&lt;194,57,242,156,210,120,172,248,208,88,233,168,205,61,179,61,2,85,56,96,136,83,210,119,125,103,192,129,116,221,161,132,108,92,219,163,233,228,179,34,47,164,22,72,45,203,239,245,155,67,137,138,191,142,152,135,233,57,229,36,0,69,149,197,54,204,25,147,4,223,251,99,183,6,158,247,67,220,83,177,77,117,131,196,144,151,105,108,83,227,69,84,143,238,81,189,141,167,155,224,8,199,237,102,62,92,133,120,118,133,41,142,45,9,195,211,95,49,101,226,51,225,78,198,255,142,182,113,179,20,36,214,
<a name="101"/>  101:            62,56,147,108,248,95,132,193,0,194,102,78,45,7,102,167,183,146,79,108,190,65,108,0,92,40,164,29,81,63,204,59,252,170,33,209,139,181,226,35,136,229,147,190,3,119,238,178,83,203,7,92,103,21,22,171,75,199,87,255,171,219,146,122,207,235,188,254,247,58,64,1,31,190,233,135,232,47,71,117,82,107,254,74,23,178,186,85,110,204,185,51,113,160,41,145,190,52,63,103,210,54,235,206,82,160,188,238,209,99,90,100,138,147,84,20,30,47,253,73,245,168,13,222&gt;&gt;}
<a name="102"/>  102:        ).
<a name="103"/>  103: 
<a name="104"/>  104: <i>%%--------------------------------------------------------------------</i>
<a name="105"/>  105: <i>%% Common Test interface functions -----------------------------------</i>
<a name="106"/>  106: <i>%%--------------------------------------------------------------------</i>
<a name="all-0"/><a name="107"/>  107: <b>all</b>() -&gt;
<a name="all-last_expr"/><a name="108"/>  108:     [ocsp_test].
<a name="109"/>  109: 
<a name="groups-0"/><a name="110"/>  110: <b>groups</b>() -&gt;
<a name="groups-last_expr"/><a name="111"/>  111:     [].
<a name="112"/>  112: 
<a name="113"/>  113: <i>%%--------------------------------------------------------------------</i>
<a name="init_per_suite-1"/><a name="114"/>  114: <b>init_per_suite</b>(Config) -&gt;
<a name="init_per_suite-last_expr"/><a name="115"/>  115:     Config.
<a name="116"/>  116: 
<a name="end_per_suite-1"/><a name="117"/>  117: <b>end_per_suite</b>(_Config) -&gt;
<a name="end_per_suite-last_expr"/><a name="118"/>  118:     ok.
<a name="119"/>  119: 
<a name="120"/>  120: <i>%%--------------------------------------------------------------------</i>
<a name="121"/>  121: 
<a name="init_per_group-2"/><a name="122"/>  122: <b>init_per_group</b>(_GroupName, Config) -&gt;
<a name="init_per_group-last_expr"/><a name="123"/>  123:     Config.
<a name="124"/>  124: 
<a name="end_per_group-2"/><a name="125"/>  125: <b>end_per_group</b>(_GroupName, Config) -&gt;
<a name="end_per_group-last_expr"/><a name="126"/>  126:     Config.
<a name="127"/>  127: 
<a name="128"/>  128: <i>%%--------------------------------------------------------------------</i>
<a name="init_per_testcase-2"/><a name="129"/>  129: <b>init_per_testcase</b>(_TestCase, Config) -&gt;
<a name="init_per_testcase-last_expr"/><a name="130"/>  130:     Config.
<a name="131"/>  131: 
<a name="end_per_testcase-2"/><a name="132"/>  132: <b>end_per_testcase</b>(_TestCase, _Config) -&gt;
<a name="end_per_testcase-last_expr"/><a name="133"/>  133:     ok.
<a name="134"/>  134: 
<a name="135"/>  135: <i>%%--------------------------------------------------------------------</i>
<a name="136"/>  136: <i>%% Test Cases --------------------------------------------------------</i>
<a name="137"/>  137: <i>%%--------------------------------------------------------------------</i>
<a name="ocsp_test-0"/><a name="138"/>  138: <b>ocsp_test</b>() -&gt;
<a name="ocsp_test-last_expr"/><a name="139"/>  139:     [{doc, &quot;Test functions in pubkey_ocsp&quot;}].
<a name="ocsp_test-1"/><a name="140"/>  140: <b>ocsp_test</b>(Config) when is_list(Config) -&gt;
<a name="141"/>  141:     undefined = pubkey_ocsp:get_nonce_extn(undefined),
<a name="142"/>  142:     #'Extension'{extnID    = ?'id-pkix-ocsp-nonce',
<a name="143"/>  143:                  extnValue = ?NONCE} = pubkey_ocsp:get_nonce_extn(?NONCE),
<a name="144"/>  144: 
<a name="145"/>  145:     {ok, OcspResponse = #'BasicOCSPResponse'{}} =
<a name="146"/>  146:         pubkey_ocsp:decode_response(?OCSP_RESPONSE_DER),
<a name="147"/>  147: 
<a name="148"/>  148:     IsTrustedReponderFun = fun(_) -&gt; true end,
<a name="149"/>  149:     {ok, [SingleResponse]} =
<a name="150"/>  150:         pubkey_ocsp:verify_response(OcspResponse,
<a name="151"/>  151:                                     [?RESPONDER_CERT],
<a name="152"/>  152:                                     ?NONCE,
<a name="153"/>  153:                                     ?ISSUER_CERT,
<a name="154"/>  154:                                     IsTrustedReponderFun),
<a name="155"/>  155:     {'SingleResponse',
<a name="156"/>  156:      {'CertID',
<a name="157"/>  157:       {'AlgorithmIdentifier',
<a name="158"/>  158:        {1,3,14,3,2,26},&lt;&lt;5,0&gt;&gt;},
<a name="159"/>  159:       &lt;&lt;227,147,252,182,155,101,129,45,194,162,22,93,127,46,112,193,196,28,241,232&gt;&gt;,
<a name="160"/>  160:       &lt;&lt;34,25,129,87,115,255,155,246,200,97,92,7,51,110,152,61,97,155,164,171&gt;&gt;,9},
<a name="161"/>  161:      {good,'NULL'},&quot;20230720122949Z&quot;,asn1_NOVALUE,asn1_NOVALUE} =
<a name="162"/>  162:         SingleResponse,
<a name="163"/>  163: 
<a name="164"/>  164:     CertId = SingleResponse#'SingleResponse'.certID,
<a name="165"/>  165:     WrongNameHashSingleResponse =
<a name="166"/>  166:         SingleResponse#'SingleResponse'{
<a name="167"/>  167:           certID = CertId#'CertID'{issuerNameHash = &lt;&lt;&quot;rubbish_hash&quot;&gt;&gt;}},
<a name="168"/>  168:     NextUpdateFromPast = SingleResponse#'SingleResponse'{nextUpdate = &quot;19820720122949Z&quot;},
<a name="169"/>  169:     ThisUpdateFromFuture = SingleResponse#'SingleResponse'{thisUpdate = &quot;21230720122949Z&quot;},
<a name="170"/>  170:     {ok, SingleResponse} =
<a name="171"/>  171:         pubkey_ocsp:find_single_response(
<a name="172"/>  172:           ?A_SERVER_CERT, ?ISSUER_CERT,
<a name="173"/>  173:           [rubbish_single_response,
<a name="174"/>  174:            WrongNameHashSingleResponse,
<a name="175"/>  175:            NextUpdateFromPast,
<a name="176"/>  176:            ThisUpdateFromFuture,
<a name="177"/>  177:            SingleResponse, rubbish_single_response]),
<a name="178"/>  178: 
<a name="179"/>  179:     %% invalid responses
<a name="180"/>  180:     IsNotTrustedReponderFun = fun(_) -&gt; false end,
<a name="181"/>  181:     %% passing A_SERVER_CERT to get into Case3 in pubkey_oscp:is_authorized_responder
<a name="182"/>  182:     {error,ocsp_responder_cert_not_found} =
<a name="183"/>  183:         pubkey_ocsp:verify_response(OcspResponse,
<a name="184"/>  184:                                     [#cert{otp = ?A_SERVER_CERT}],
<a name="185"/>  185:                                     ?NONCE,
<a name="186"/>  186:                                     ?ISSUER_CERT,
<a name="187"/>  187:                                     IsNotTrustedReponderFun),
<a name="188"/>  188:     OcspResponseWrongSignature =
<a name="189"/>  189:         OcspResponse#'BasicOCSPResponse'{signature = &lt;&lt;&quot;rubbish_signature&quot;&gt;&gt;},
<a name="190"/>  190:     {error, ocsp_responder_cert_not_found} =
<a name="191"/>  191:         pubkey_ocsp:verify_response(OcspResponseWrongSignature,
<a name="192"/>  192:                                     [?RESPONDER_CERT],
<a name="193"/>  193:                                     ?NONCE,
<a name="194"/>  194:                                     ?ISSUER_CERT,
<a name="195"/>  195:                                     IsTrustedReponderFun),
<a name="196"/>  196: 
<a name="197"/>  197:     {error, nonce_mismatch} =
<a name="198"/>  198:         pubkey_ocsp:verify_response(OcspResponse,
<a name="199"/>  199:                                     [?RESPONDER_CERT],
<a name="200"/>  200:                                     &lt;&lt;&quot;rubbish_nonce&quot;&gt;&gt;,
<a name="201"/>  201:                                     ?ISSUER_CERT,
<a name="202"/>  202:                                     IsTrustedReponderFun),
<a name="203"/>  203: 
<a name="204"/>  204:     OcspResponseProducedAt22ndCentury = % Year AD 2123
<a name="205"/>  205:         OcspResponse#'BasicOCSPResponse'{
<a name="206"/>  206:           tbsResponseData = #'ResponseData'{producedAt = &quot;21230720122949Z&quot;}},
<a name="207"/>  207:     {error,ocsp_stale_response} =
<a name="208"/>  208:         pubkey_ocsp:verify_response(OcspResponseProducedAt22ndCentury,
<a name="209"/>  209:                                     [?RESPONDER_CERT],
<a name="210"/>  210:                                     ?NONCE,
<a name="211"/>  211:                                     ?ISSUER_CERT,
<a name="212"/>  212:                                     IsTrustedReponderFun),
<a name="ocsp_test-last_expr"/><a name="213"/>  213:     ok.
</pre>
<script>
var hash = window.location.hash.substring(1);
var anchor = document.getElementsByName(hash);
anchor[0].style.backgroundColor="orange";
</script>
</body>
</html>
